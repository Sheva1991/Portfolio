{"version":3,"sources":["three.js"],"names":["global","factory","exports","module","define","amd","self","THREE","this","undefined","Number","EPSILON","Math","pow","isInteger","value","isFinite","floor","sign","x","Function","prototype","Object","defineProperty","get","toString","match","assign","target","TypeError","output","index","arguments","length","source","nextKey","hasOwnProperty","call","EventDispatcher","addEventListener","type","listener","_listeners","listeners","indexOf","push","hasEventListener","removeEventListener","listenerArray","splice","dispatchEvent","event","array","slice","i","l","_lut","_canvas","MathUtils","DEG2RAD","PI","RAD2DEG","generateUUID","d0","random","d1","d2","d3","toUpperCase","clamp","min","max","euclideanModulo","n","m","mapLinear","a1","a2","b1","b2","lerp","y","t","smoothstep","smootherstep","randInt","low","high","randFloat","randFloatSpread","range","degToRad","degrees","radToDeg","radians","isPowerOfTwo","ceilPowerOfTwo","ceil","log","LN2","floorPowerOfTwo","setQuaternionFromProperEuler","q","a","b","c","order","cos","sin","c2","s2","c13","s13","c1_3","s1_3","c3_1","s3_1","set","console","warn","Vector2","Matrix3","elements","error","defineProperties","width","height","isVector2","setScalar","scalar","setX","setY","setComponent","Error","getComponent","clone","constructor","copy","v","add","w","addVectors","addScalar","s","addScaledVector","sub","subVectors","subScalar","multiply","multiplyScalar","divide","divideScalar","applyMatrix3","e","clampScalar","minVal","maxVal","clampLength","round","roundToZero","negate","dot","cross","lengthSq","sqrt","manhattanLength","abs","normalize","angle","atan2","distanceTo","distanceToSquared","dx","dy","manhattanDistanceTo","setLength","alpha","lerpVectors","v1","v2","equals","fromArray","offset","toArray","fromBufferAttribute","attribute","getX","getY","rotateAround","center","isMatrix3","n11","n12","n13","n21","n22","n23","n31","n32","n33","te","identity","me","extractBasis","xAxis","yAxis","zAxis","setFromMatrix3Column","setFromMatrix4","multiplyMatrices","premultiply","ae","be","a11","a12","a13","a21","a22","a23","a31","a32","a33","b11","b12","b13","b21","b22","b23","b31","b32","b33","determinant","d","f","g","h","getInverse","matrix","throwOnDegenerate","t11","t12","t13","det","detInv","transpose","tmp","getNormalMatrix","matrix4","transposeIntoArray","r","setUvTransform","tx","ty","sx","sy","rotation","cx","cy","scale","rotate","theta","translate","ImageUtils","getDataURL","image","canvas","HTMLCanvasElement","src","document","createElementNS","context","getContext","ImageData","putImageData","drawImage","toDataURL","textureId","Texture","mapping","wrapS","wrapT","magFilter","minFilter","format","anisotropy","encoding","uuid","name","DEFAULT_IMAGE","mipmaps","DEFAULT_MAPPING","internalFormat","repeat","matrixAutoUpdate","generateMipmaps","premultiplyAlpha","flipY","unpackAlignment","version","onUpdate","Vector4","z","WebGLRenderTarget","options","scissor","scissorTest","viewport","texture","depthBuffer","stencilBuffer","depthTexture","WebGLMultisampleRenderTarget","samples","Quaternion","_x","_y","_z","_w","create","isTexture","updateMatrix","toJSON","meta","isRootObject","textures","metadata","generator","wrap","images","url","Array","isArray","dispose","transformUv","uv","isVector4","setZ","setW","applyMatrix4","setAxisAngleFromQuaternion","acos","setAxisAngleFromRotationMatrix","m11","m12","m13","m21","m22","m23","m31","m32","m33","xx","yy","zz","xy","xz","yz","getZ","getW","isWebGLRenderTarget","setSize","isWebGLMultisampleRenderTarget","slerp","qa","qb","qm","slerpFlat","dst","dstOffset","src0","srcOffset0","src1","srcOffset1","x0","y0","z0","w0","x1","y1","z1","w1","dir","sqrSin","len","tDir","_onChangeCallback","isQuaternion","quaternion","setFromEuler","euler","update","isEuler","c1","c3","s1","s3","setFromAxisAngle","axis","halfAngle","setFromRotationMatrix","trace","setFromUnitVectors","vFrom","vTo","angleTo","rotateTowards","step","inverse","conjugate","p","multiplyQuaternions","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","cosHalfTheta","sqrSinHalfTheta","sinHalfTheta","halfTheta","ratioA","ratioB","_onChange","callback","_vector","Vector3","_quaternion","isVector3","multiplyVectors","applyEuler","applyQuaternion","applyAxisAngle","applyNormalMatrix","qx","qy","qz","qw","ix","iy","iz","iw","project","camera","matrixWorldInverse","projectionMatrix","unproject","projectionMatrixInverse","matrixWorld","transformDirection","crossVectors","ax","ay","az","bx","by","bz","projectOnVector","denominator","projectOnPlane","planeNormal","reflect","normal","dz","setFromSpherical","setFromSphericalCoords","radius","phi","sinPhiRadius","setFromCylindrical","setFromCylindricalCoords","setFromMatrixPosition","setFromMatrixScale","setFromMatrixColumn","sz","_v1","_m1","Matrix4","_zero","_one","isMatrix4","n14","n24","n34","n41","n42","n43","n44","copyPosition","makeBasis","extractRotation","scaleX","scaleY","scaleZ","makeRotationFromEuler","af","bf","ce","cf","de","df","ac","ad","bc","bd","makeRotationFromQuaternion","compose","lookAt","eye","up","a14","a24","a34","a41","a42","a43","a44","b14","b24","b34","b41","b42","b43","b44","setPosition","t14","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","makeScale","makeShear","position","x2","y2","z2","wx","wy","wz","decompose","invSX","invSY","invSZ","makePerspective","left","right","top","bottom","near","far","makeOrthographic","_matrix","_quaternion$1","Euler","_order","DefaultOrder","Layers","mask","RotationOrders","asin","setFromQuaternion","setFromVector3","reorder","newOrder","toVector3","optionalResult","channel","enable","enableAll","toggle","disable","disableAll","test","layers","_object3DId","_v1$1","_q1","_m1$1","_target","_position","_scale","_quaternion$2","_xAxis","_yAxis","_zAxis","_addedEvent","_removedEvent","Object3D","parent","children","DefaultUp","configurable","enumerable","modelViewMatrix","normalMatrix","DefaultMatrixAutoUpdate","matrixWorldNeedsUpdate","visible","castShadow","receiveShadow","frustumCulled","renderOrder","userData","Scene","background","environment","fog","overrideMaterial","autoUpdate","__THREE_DEVTOOLS__","CustomEvent","detail","isObject3D","onBeforeRender","onAfterRender","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","setRotationFromQuaternion","rotateOnAxis","rotateOnWorldAxis","rotateX","rotateY","rotateZ","translateOnAxis","distance","translateX","translateY","translateZ","localToWorld","vector","worldToLocal","updateWorldMatrix","isCamera","isLight","object","remove","attach","getObjectById","id","getObjectByProperty","getObjectByName","getWorldPosition","updateMatrixWorld","getWorldQuaternion","getWorldScale","getWorldDirection","raycast","traverse","traverseVisible","traverseAncestors","force","updateParents","updateChildren","geometries","materials","shapes","serialize","library","element","JSON","stringify","isInstancedMesh","count","instanceMatrix","isMesh","isLine","isPoints","geometry","parameters","shape","material","uuids","extractFromCache","cache","values","key","data","recursive","parse","child","isScene","_points","_vector$1","_box","Box3","_v0","_v1$2","_v2","_f0","_f1","_f2","_center","_extents","_triangleNormal","_testAxis","Infinity","satForAxes","axes","v0","extents","j","p0","p1","p2","isBox3","setFromArray","minX","minY","minZ","maxX","maxY","maxZ","setFromBufferAttribute","setFromPoints","points","makeEmpty","il","expandByPoint","setFromCenterAndSize","size","halfSize","setFromObject","expandByObject","box","isEmpty","getCenter","getSize","point","expandByVector","expandByScalar","boundingBox","computeBoundingBox","union","containsPoint","containsBox","getParameter","intersectsBox","intersectsSphere","sphere","clampPoint","intersectsPlane","plane","constant","intersectsTriangle","triangle","distanceToPoint","getBoundingSphere","intersect","_box$1","Sphere","optionalCenter","maxRadiusSq","empty","radiusSum","deltaLengthSq","getBoundingBox","_vector$2","_segCenter","_segDir","_diff","_edge1","_edge2","_normal","Ray","origin","direction","ray","at","recast","closestPointToPoint","directionDistance","distanceSqToPoint","distanceSqToSegment","optionalPointOnRay","optionalPointOnSegment","s0","sqrDist","extDet","segExtent","a01","b0","invDet","intersectSphere","tca","radius2","thc","t0","t1","distanceToPlane","intersectPlane","distToPoint","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","_vector1","_vector2","_normalMatrix","Plane","isPlane","setComponents","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","intersectLine","line","delta","start","intersectsLine","startSign","endSign","end","coplanarPoint","optionalNormalMatrix","referencePoint","_v0$1","_v1$3","_v2$1","_v3","_vab","_vac","_vbc","_vap","_vbp","_vcp","Triangle","getNormal","targetLengthSq","getBarycoord","dot00","dot01","dot02","dot11","dot12","denom","invDenom","u","getUV","p3","uv1","uv2","uv3","isFrontFacing","setFromPointsAndIndices","i0","i1","i2","getArea","getMidpoint","getPlane","d4","vc","d5","d6","vb","va","_colorKeywords","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","_hslA","_hslB","Color","setRGB","hue2rgb","SRGBToLinear","LinearToSRGB","Face3","color","materialIndex","vertexNormals","isColor","vertexColors","setHex","setStyle","hex","setHSL","style","handleAlpha","string","parseFloat","exec","components","parseInt","charAt","setColorName","copyGammaToLinear","gammaFactor","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","copySRGBToLinear","copyLinearToSRGB","convertSRGBToLinear","convertLinearToSRGB","getHex","getHexString","getHSL","hue","saturation","lightness","getStyle","offsetHSL","addColors","color1","color2","lerpHSL","NAMES","materialId","Material","blending","side","flatShading","opacity","transparent","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","depthTest","depthWrite","stencilWriteMask","stencilFunc","stencilRef","stencilFuncMask","stencilFail","stencilZFail","stencilZPass","stencilWrite","clippingPlanes","clipIntersection","clipShadows","shadowSide","colorWrite","precision","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","dithering","alphaTest","premultipliedAlpha","toneMapped","MeshBasicMaterial","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","specularMap","alphaMap","envMap","combine","reflectivity","refractionRatio","wireframe","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","skinning","morphTargets","setValues","isMaterial","onBeforeCompile","newValue","currentValue","isRoot","roughness","metalness","sheen","emissive","emissiveIntensity","specular","shininess","clearcoat","clearcoatRoughness","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","clearcoatNormalScale","matcap","bumpMap","bumpScale","normalMap","normalMapType","normalScale","displacementMap","displacementScale","displacementBias","roughnessMap","metalnessMap","emissiveMap","envMapIntensity","gradientMap","sizeAttenuation","linewidth","dashSize","gapSize","morphNormals","srcPlanes","dstPlanes","isMeshBasicMaterial","_vector$3","BufferAttribute","itemSize","normalized","usage","updateRange","Int8BufferAttribute","Int8Array","Uint8BufferAttribute","Uint8Array","Uint8ClampedBufferAttribute","Uint8ClampedArray","Int16BufferAttribute","Int16Array","Uint16BufferAttribute","Uint16Array","Int32BufferAttribute","Int32Array","Uint32BufferAttribute","Uint32Array","Float32BufferAttribute","Float32Array","Float64BufferAttribute","Float64Array","DirectGeometry","vertices","normals","colors","uvs","uvs2","groups","skinWeights","skinIndices","boundingSphere","verticesNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","uvsNeedUpdate","groupsNeedUpdate","arrayMax","isBufferAttribute","onUploadCallback","setUsage","copyAt","index1","index2","copyArray","copyColorsArray","copyVector2sArray","vectors","copyVector3sArray","copyVector4sArray","setXYZ","setXY","setXYZW","onUpload","computeGroups","group","faces","face","fromGeometry","morphTargetsPosition","faceVertexUvs","hasFaceVertexUv","hasFaceVertexUv2","morphTargetsLength","morphTargetsNormal","morphNormalsLength","hasSkinIndices","hasSkinWeights","vertexUvs","morphTarget","morphNormal","_bufferGeometryId","_m1$2","_obj","_offset","_box$2","_boxMorphTargets","_vector$4","BufferGeometry","attributes","morphAttributes","morphTargetsRelative","drawRange","isBufferGeometry","getIndex","setIndex","getAttribute","setAttribute","deleteAttribute","addGroup","clearGroups","setDrawRange","needsUpdate","tangent","computeBoundingSphere","positions","lineDistances","isGeometry","updateFromObject","direct","__directGeometry","elementsNeedUpdate","lineDistancesNeedUpdate","lineDistance","fromDirectGeometry","morphAttributesPosition","morphAttribute","isNaN","jl","computeFaceNormals","computeVertexNormals","vA","vB","vC","pA","pB","pC","cb","ab","indices","normalizeNormals","merge","attributeArray1","attribute2","attributeArray2","attributeOffset","toNonIndexed","convertBufferAttribute","array2","geometry2","newAttribute","morphArray","keys","attributeData","hasMorphAttributes","attributeArray","_inverseMatrix","_ray","_sphere","_vA","_vB","_vC","_tempA","_tempB","_tempC","_morphA","_morphB","_morphC","_uvA","_uvB","_uvC","_intersectionPoint","_intersectionPointWorld","Mesh","updateMorphTargets","checkIntersection","raycaster","checkBufferGeometryIntersection","morphPosition","morphInfluences","morphTargetInfluences","influence","intersection","morphTargetDictionary","ml","String","intersects","groupMaterial","faceIndex","fvA","fvB","fvC","isMultiMaterial","fl","faceMaterial","uvs_f","_geometryId","_m1$3","_obj$1","_offset$1","Geometry","fromBufferGeometry","scope","addFace","areaWeighted","vl","computeFlatVertexNormals","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","dstNormalsFace","dstNormalsVertex","faceNormal","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","colors1","colors2","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","faceVertexUvs2","uvsCopy","k","kl","mergeMesh","mesh","mergeVertices","verticesMap","unique","changes","faceIndicesToRemove","idx","diff","sortFacesByMaterialIndex","_id","sort","newUvs1","newUvs2","uvs1","vertex","normalsHash","colorsHash","uvsHash","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","setBit","getUvIndex","getNormalIndex","getColorIndex","enabled","hash","srcVertexNormal","destVertexNormal","BoxGeometry","depth","widthSegments","heightSegments","depthSegments","BoxBufferGeometry","__proto__","numberOfVertices","groupStart","buildPlane","udir","vdir","gridX","gridY","segmentWidth","segmentHeight","widthHalf","heightHalf","depthHalf","gridX1","gridY1","vertexCounter","groupCount","cloneUniforms","property","mergeUniforms","uniforms","merged","UniformsUtils","ShaderMaterial","defines","vertexShader","fragmentShader","lights","clipping","extensions","derivatives","fragDepth","drawBuffers","shaderTextureLOD","defaultAttributeValues","index0AttributeName","uniformsNeedUpdate","Camera","PerspectiveCamera","fov","aspect","zoom","focus","view","filmGauge","filmOffset","updateProjectionMatrix","isShaderMaterial","isPerspectiveCamera","setFocalLength","focalLength","vExtentSlope","getFilmHeight","atan","getFocalLength","getEffectiveFOV","getFilmWidth","setViewOffset","fullWidth","fullHeight","offsetX","offsetY","clearViewOffset","skew","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","renderTarget","WebGLCubeRenderTarget","renderer","scene","currentRenderTarget","getRenderTarget","setRenderTarget","render","clear","stencil","dummy","DataTexture","isWebGLCubeRenderTarget","fromEquirectangularTexture","shader","tEquirect","join","isDataTexture","_sphere$1","_vector$5","Frustum","p4","p5","planes","frustum","setFromProjectionMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","intersectsObject","intersectsSprite","sprite","negRadius","UniformsLib","common","diffuse","uvTransform","uv2Transform","specularmap","envmap","flipEnvMap","maxMipLevel","aomap","lightmap","emissivemap","bumpmap","normalmap","displacementmap","roughnessmap","metalnessmap","gradientmap","fogDensity","fogNear","fogFar","fogColor","ambientLightColor","lightProbe","directionalLights","properties","directionalLightShadows","shadowBias","shadowRadius","shadowMapSize","directionalShadowMap","directionalShadowMatrix","spotLights","coneCos","penumbraCos","decay","spotLightShadows","spotShadowMap","spotShadowMatrix","pointLights","pointLightShadows","shadowCameraNear","shadowCameraFar","pointShadowMap","pointShadowMatrix","hemisphereLights","skyColor","groundColor","rectAreaLights","WebGLAnimation","isAnimating","animationLoop","onAnimationFrame","time","frame","requestAnimationFrame","stop","setAnimationLoop","setContext","WebGLAttributes","gl","capabilities","isWebGL2","buffers","WeakMap","isInterleavedBufferAttribute","deleteBuffer","buffer","delete","bufferType","createBuffer","bindBuffer","bufferData","bytesPerElement","BYTES_PER_ELEMENT","bufferSubData","subarray","updateBuffer","PlaneGeometry","PlaneBufferGeometry","width_half","height_half","segment_width","segment_height","ShaderChunk","alphamap_fragment","alphamap_pars_fragment","alphatest_fragment","aomap_fragment","aomap_pars_fragment","begin_vertex","beginnormal_vertex","bsdfs","bumpmap_pars_fragment","clipping_planes_fragment","clipping_planes_pars_fragment","clipping_planes_pars_vertex","clipping_planes_vertex","color_fragment","color_pars_fragment","color_pars_vertex","color_vertex","cube_uv_reflection_fragment","defaultnormal_vertex","displacementmap_pars_vertex","displacementmap_vertex","emissivemap_fragment","emissivemap_pars_fragment","encodings_fragment","encodings_pars_fragment","envmap_fragment","envmap_common_pars_fragment","envmap_pars_fragment","envmap_pars_vertex","envmap_physical_pars_fragment","envmap_vertex","fog_vertex","fog_pars_vertex","fog_fragment","fog_pars_fragment","gradientmap_pars_fragment","lightmap_fragment","lightmap_pars_fragment","lights_lambert_vertex","lights_pars_begin","lights_toon_fragment","lights_toon_pars_fragment","lights_phong_fragment","lights_phong_pars_fragment","lights_physical_fragment","lights_physical_pars_fragment","lights_fragment_begin","lights_fragment_maps","lights_fragment_end","logdepthbuf_fragment","logdepthbuf_pars_fragment","logdepthbuf_pars_vertex","logdepthbuf_vertex","map_fragment","map_pars_fragment","map_particle_fragment","map_particle_pars_fragment","metalnessmap_fragment","metalnessmap_pars_fragment","morphnormal_vertex","morphtarget_pars_vertex","morphtarget_vertex","normal_fragment_begin","normal_fragment_maps","normalmap_pars_fragment","clearcoat_normal_fragment_begin","clearcoat_normal_fragment_maps","clearcoat_pars_fragment","packing","premultiplied_alpha_fragment","project_vertex","dithering_fragment","dithering_pars_fragment","roughnessmap_fragment","roughnessmap_pars_fragment","shadowmap_pars_fragment","shadowmap_pars_vertex","shadowmap_vertex","shadowmask_pars_fragment","skinbase_vertex","skinning_pars_vertex","skinning_vertex","skinnormal_vertex","specularmap_fragment","specularmap_pars_fragment","tonemapping_fragment","tonemapping_pars_fragment","uv_pars_fragment","uv_pars_vertex","uv_vertex","uv2_pars_fragment","uv2_pars_vertex","uv2_vertex","worldpos_vertex","background_frag","background_vert","cube_frag","cube_vert","depth_frag","depth_vert","distanceRGBA_frag","distanceRGBA_vert","equirect_frag","equirect_vert","linedashed_frag","linedashed_vert","meshbasic_frag","meshbasic_vert","meshlambert_frag","meshlambert_vert","meshmatcap_frag","meshmatcap_vert","meshtoon_frag","meshtoon_vert","meshphong_frag","meshphong_vert","meshphysical_frag","meshphysical_vert","normal_frag","normal_vert","points_frag","points_vert","shadow_frag","shadow_vert","sprite_frag","sprite_vert","ShaderLib","basic","lambert","phong","standard","toon","dashed","totalSize","t2D","cube","equirect","distanceRGBA","referencePosition","nearDistance","farDistance","shadow","WebGLBackground","state","objects","planeMesh","boxMesh","clearColor","clearAlpha","currentBackground","currentBackgroundVersion","currentTonemapping","setClear","getClearColor","setClearColor","getClearAlpha","setClearAlpha","renderList","forceClear","xr","session","getSession","environmentBlendMode","autoClear","autoClearColor","autoClearDepth","autoClearStencil","isCubeTexture","toneMapping","unshift","WebGLBufferRenderer","info","mode","setMode","drawArrays","renderInstances","primcount","extension","methodName","WebGLCapabilities","maxAnisotropy","getMaxPrecision","getShaderPrecisionFormat","WebGL2RenderingContext","WebGL2ComputeRenderingContext","maxPrecision","logarithmicDepthBuffer","maxTextures","maxVertexTextures","maxTextureSize","maxCubemapSize","maxAttributes","maxVertexUniforms","maxVaryings","maxFragmentUniforms","vertexTextures","floatFragmentTextures","getMaxAnisotropy","MAX_TEXTURE_MAX_ANISOTROPY_EXT","floatVertexTextures","maxSamples","WebGLClipping","globalState","numGlobalPlanes","localClippingEnabled","renderingShadows","viewNormalMatrix","uniform","resetGlobalState","numPlanes","numIntersection","projectPlanes","skipTransform","nPlanes","dstArray","flatSize","viewMatrix","i4","init","enableLocalClipping","beginShadows","endShadows","setState","fromCache","nGlobal","lGlobal","clippingState","WebGLExtensions","getExtension","WebGLGeometries","wireframeAttributes","onGeometryDispose","buffergeometry","memory","updateWireframeAttribute","geometryIndex","geometryPosition","previousAttribute","_bufferGeometry","geometryAttributes","getWireframeAttribute","currentAttribute","WebGLIndexedBufferRenderer","drawElements","WebGLInfo","calls","triangles","lines","programs","autoReset","reset","instanceCount","absNumericalSort","WebGLMorphtargets","influencesList","program","objectInfluences","influences","morphInfluencesSum","morphBaseInfluence","getUniforms","setValue","WebGLObjects","updateMap","CubeTexture","DataTexture2DArray","wrapR","DataTexture3D","physical","transparency","isDataTexture2DArray","isDataTexture3D","emptyTexture","emptyTexture2dArray","emptyTexture3d","emptyCubeTexture","arrayCacheF32","arrayCacheI32","mat4array","mat3array","mat2array","flatten","nBlocks","blockSize","firstElem","arraysEqual","allocTexUnits","allocateTextureUnit","setValueV1f","uniform1f","addr","setValueV2f","uniform2f","uniform2fv","setValueV3f","uniform3f","uniform3fv","setValueV4f","uniform4f","uniform4fv","setValueM2","uniformMatrix2fv","setValueM3","uniformMatrix3fv","setValueM4","uniformMatrix4fv","setValueT1","unit","uniform1i","safeSetTexture2D","setValueT2DArray1","setTexture2DArray","setValueT3D1","setTexture3D","setValueT6","safeSetTextureCube","setValueV1i","setValueV2i","uniform2iv","setValueV3i","uniform3iv","setValueV4i","uniform4iv","setValueV1ui","uniform1ui","setValueV1fArray","uniform1fv","setValueV1iArray","uniform1iv","setValueV2iArray","setValueV3iArray","setValueV4iArray","setValueV2fArray","setValueV3fArray","setValueV4fArray","setValueM2Array","setValueM3Array","setValueM4Array","setValueT1Array","units","setValueT6Array","SingleUniform","activeInfo","getSingularSetter","PureArrayUniform","getPureArraySetter","StructuredUniform","seq","updateCache","RePathPart","addUniform","container","uniformObject","parseUniform","path","pathLength","lastIndex","matchEnd","idIsIndex","subscript","next","WebGLUniforms","getProgramParameter","getActiveUniform","getUniformLocation","WebGLShader","createShader","shaderSource","compileShader","setOptional","upload","seqWithValue","programIdCount","getEncodingComponents","getShaderErrors","status","getShaderParameter","getShaderInfoLog","trim","split","addLineNumbers","getShaderSource","getTexelDecodingFunction","functionName","getToneMappingFunction","toneMappingName","filterEmptyLine","replaceLightNums","replace","numDirLights","numSpotLights","numRectAreaLights","numPointLights","numHemiLights","numDirLightShadows","numSpotLightShadows","numPointLightShadows","replaceClippingPlaneNums","numClippingPlanes","numClipIntersection","includePattern","resolveIncludes","includeReplacer","include","deprecatedUnrollLoopPattern","unrollLoopPattern","unrollLoops","loopReplacer","deprecatedLoopReplacer","snippet","generatePrecision","precisionstring","WebGLProgram","cacheKey","prefixVertex","prefixFragment","shadowMapTypeDefine","shadowMapType","generateShadowMapTypeDefine","envMapTypeDefine","envMapMode","generateEnvMapTypeDefine","envMapModeDefine","generateEnvMapModeDefine","envMapBlendingDefine","generateEnvMapBlendingDefine","gammaFactorDefine","customExtensions","extensionDerivatives","envMapCubeUV","tangentSpaceNormalMap","shaderID","extensionFragDepth","rendererExtensionFragDepth","extensionDrawBuffers","rendererExtensionDrawBuffers","extensionShaderTextureLOD","rendererExtensionShaderTextureLod","filter","generateExtensions","customDefines","chunks","generateDefines","createProgram","isRawShaderMaterial","shaderName","instancing","supportsVertexTextures","maxBones","useFog","fogExp2","objectSpaceNormalMap","vertexTangents","uvsVertexOnly","useVertexTexture","doubleSided","flipSided","shadowMapEnabled","physicallyCorrectLights","outputEncoding","mapEncoding","matcapEncoding","envMapEncoding","emissiveMapEncoding","lightMapEncoding","depthPacking","isGLSL3ShaderMaterial","versionRegex","cachedUniforms","cachedAttributes","fragmentGlsl","glVertexShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","debug","checkShaderErrors","programLog","getProgramInfoLog","vertexLog","fragmentLog","runnable","haveDiagnostics","vertexErrors","fragmentErrors","getError","diagnostics","prefix","detachShader","deleteShader","getAttributes","getActiveAttrib","getAttribLocation","fetchAttributeLocations","destroy","deleteProgram","usedTimes","WebGLPrograms","shaderIDs","MeshDepthMaterial","MeshDistanceMaterial","MeshNormalMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial","MeshStandardMaterial","MeshPhysicalMaterial","MeshMatcapMaterial","LineBasicMaterial","LineDashedMaterial","PointsMaterial","ShadowMaterial","SpriteMaterial","parameterNames","getTextureEncodingFromMap","getParameters","shadows","nClipPlanes","nClipIntersection","isMeshStandardMaterial","isSkinnedMesh","bones","skeleton","nVertexUniforms","nVertexMatrices","allocateBones","shaderobject","getShaderObject","isFogExp2","maxMorphTargets","maxMorphNormals","directional","spot","rectArea","hemi","shadowMap","getProgramCacheKey","acquireProgram","pl","preexistingProgram","releaseProgram","pop","WebGLProperties","painterSortStable","groupOrder","reversePainterSortStable","WebGLRenderList","renderItems","renderItemsIndex","opaque","defaultProgram","getNextRenderItem","renderItem","finish","customOpaqueSort","customTransparentSort","WebGLRenderLists","lists","onSceneDispose","list","cameras","UniformsCache","light","halfWidth","halfHeight","nextVersion","shadowCastingLightsFirst","lightA","lightB","WebGLLights","shadowCache","directionalLength","pointLength","spotLength","rectAreaLength","hemiLength","numDirectionalShadows","numPointShadows","numSpotShadows","ambient","probe","directionalShadow","spotShadow","pointShadow","vector3","matrix42","setup","intensity","isAmbientLight","isLightProbe","sh","coefficients","isDirectionalLight","shadowUniforms","bias","mapSize","isSpotLight","penumbra","isRectAreaLight","isPointLight","isHemisphereLight","WebGLRenderState","lightsArray","shadowsArray","setupLights","pushLight","pushShadow","shadowLight","WebGLRenderStates","renderStates","renderState","has","isMeshDepthMaterial","isMeshDistanceMaterial","WebGLShadowMap","_renderer","_objects","_frustum","_shadowMapSize","_viewportSize","_viewport","_depthMaterials","_distanceMaterials","_materialCache","0","1","2","shadowMaterialVertical","SAMPLE_RATE","HALF_SAMPLE_RATE","shadow_pass","resolution","shadowMaterialHorizonal","HORIZONAL_PASS","fullScreenTri","fullScreenMesh","VSMPass","mapPass","renderBufferDirect","getDepthMaterialVariant","useMorphing","useSkinning","useInstancing","getDistanceMaterialVariant","getDepthMaterial","result","getMaterialVariant","customMaterial","customDepthMaterial","customDistanceMaterial","keyA","keyB","materialsForVariant","cachedMaterial","renderObject","shadowCamera","depthMaterial","activeCubeFace","getActiveCubeFace","activeMipmapLevel","getActiveMipmapLevel","_state","setBlending","setTest","setScissorTest","shadowFrameExtents","getFrameExtents","isPointLightShadow","pars","viewportCount","getViewportCount","vp","getViewport","updateMatrices","getFrustum","WebGLState","colorBuffer","locked","currentColorMask","currentColorClear","setMask","colorMask","setLocked","lock","currentDepthMask","currentDepthFunc","currentDepthClear","depthMask","setFunc","clearDepth","currentStencilMask","currentStencilFunc","currentStencilRef","currentStencilFuncMask","currentStencilFail","currentStencilZFail","currentStencilZPass","currentStencilClear","stencilTest","stencilMask","setOp","stencilOp","clearStencil","maxVertexAttributes","newAttributes","enabledAttributes","attributeDivisors","enabledCapabilities","currentProgram","currentBlendingEnabled","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentPremultipledAlpha","currentFlipSided","currentCullFace","currentLineWidth","currentPolygonOffsetFactor","currentPolygonOffsetUnits","lineWidthAvailable","glVersion","currentTextureSlot","currentBoundTextures","currentScissor","currentViewport","createTexture","bindTexture","texParameteri","texImage2D","emptyTextures","enableAttributeAndDivisor","meshPerAttribute","enableVertexAttribArray","setFlipSided","setCullFace","equationToGL","100","101","102","MIN_EXT","MAX_EXT","factorToGL","blendEquationSeparate","blendFuncSeparate","blendFunc","frontFace","cullFace","setPolygonOffset","factor","activeTexture","webglSlot","initAttributes","enableAttribute","disableUnusedAttributes","disableVertexAttribArray","useProgram","setMaterial","frontFaceCW","setLineWidth","lineWidth","webglType","webglTexture","boundTexture","unbindTexture","compressedTexImage2D","apply","texImage3D","WebGLTextures","_gl","utils","_videoTextures","useOffscreenCanvas","OffscreenCanvas","err","createCanvas","resizeImage","needsPowerOfTwo","needsNewCanvas","maxSize","HTMLImageElement","ImageBitmap","textureNeedsGenerateMipmaps","supportsMips","generateMipmap","__maxMipLevel","LOG2E","getInternalFormat","internalFormatName","glFormat","glType","filterFallback","onTextureDispose","textureProperties","__webglInit","deleteTexture","__webglTexture","deallocateTexture","isVideoTexture","onRenderTargetDispose","renderTargetProperties","deleteFramebuffer","__webglFramebuffer","__webglDepthbuffer","deleteRenderbuffer","__webglMultisampledFramebuffer","__webglColorRenderbuffer","__webglDepthRenderbuffer","deallocateRenderTarget","textureUnits","setTexture2D","slot","updateVideoTexture","__version","complete","uploadTexture","setTextureCube","initTexture","pixelStorei","isCompressed","isCompressedTexture","cubeImage","convert","glInternalFormat","setTextureParameters","mipmap","mipmapImage","setTextureCubeDynamic","wrappingToGL","1000","1001","1002","filterToGL","textureType","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","textureNeedsPowerOfTwo","isDepthTexture","setupFrameBufferTexture","framebuffer","attachment","textureTarget","bindFramebuffer","framebufferTexture2D","setupRenderBufferStorage","renderbuffer","isMultisample","bindRenderbuffer","getRenderTargetSamples","renderbufferStorageMultisample","renderbufferStorage","framebufferRenderbuffer","setupDepthRenderbuffer","isCube","webglDepthTexture","setupDepthTexture","createRenderbuffer","warnedTexture2D","warnedTextureCube","textureUnit","resetTextureUnits","setupRenderTarget","createFramebuffer","updateRenderTargetMipmap","updateMultisampleRenderTarget","blitFramebuffer","WebGLUtils","HALF_FLOAT_OES","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","COMPRESSED_RGB_ETC1_WEBGL","COMPRESSED_RGB8_ETC2","COMPRESSED_RGBA8_ETC2_EAC","UNSIGNED_INT_24_8_WEBGL","ArrayCamera","Group","WebXRManager","framebufferScaleFactor","referenceSpace","referenceSpaceType","pose","controllers","inputSourcesMap","Map","cameraL","cameraR","cameraVR","_currentDepthNear","_currentDepthFar","onSessionEvent","controller","inputSource","targetRay","grip","onSessionEnd","forEach","setFramebuffer","animation","isPresenting","onRequestReferenceSpace","updateInputSources","inputSources","removed","added","getController","getControllerGrip","setFramebufferScaleFactor","setReferenceSpaceType","getReferenceSpace","setSession","getContextAttributes","layerInit","antialias","baseLayer","XRWebGLLayer","updateRenderState","requestReferenceSpace","then","cameraLPos","cameraRPos","updateCamera","getCamera","depthNear","depthFar","ipd","projL","projR","topFov","bottomFov","leftFov","rightFov","zOffset","xOffset","near2","far2","left2","right2","top2","bottom2","setProjectionFromUnion","onAnimationFrameCallback","getViewerPose","views","transform","inputPose","gripPose","getPose","targetRaySpace","gripSpace","WebGLRenderer","_context","_alpha","_depth","_stencil","_antialias","_premultipliedAlpha","_preserveDrawingBuffer","preserveDrawingBuffer","_powerPreference","powerPreference","_failIfMajorPerformanceCaveat","failIfMajorPerformanceCaveat","currentRenderList","currentRenderState","domElement","sortObjects","toneMappingExposure","toneMappingWhitePoint","programCache","renderLists","morphtargets","bufferRenderer","indexedBufferRenderer","_this","_isContextLost","_framebuffer","_currentActiveCubeFace","_currentActiveMipmapLevel","_currentRenderTarget","_currentFramebuffer","_currentMaterialId","_currentGeometryProgram","_currentCamera","_currentArrayCamera","_currentViewport","_currentScissor","_currentScissorTest","_width","_height","_pixelRatio","_opaqueSort","_transparentSort","_scissor","_scissorTest","_clipping","_clippingEnabled","_localClippingEnabled","_projScreenMatrix","_vector3","getTargetPixelRatio","contextAttributes","xrCompatible","onContextLost","onContextRestore","rangeMin","rangeMax","message","initGLContext","preventDefault","onMaterialDispose","releaseMaterialProgramReference","deallocateMaterial","programInfo","forceContextLoss","loseContext","forceContextRestore","restoreContext","getPixelRatio","setPixelRatio","updateStyle","setViewport","getDrawingBufferSize","setDrawingBufferSize","pixelRatio","getCurrentViewport","getScissor","setScissor","getScissorTest","boolean","setOpaqueSort","method","setTransparentSort","bits","renderBufferImmediate","hasPositions","hasNormals","hasUvs","hasColors","programAttributes","positionArray","vertexAttribPointer","normalArray","uvArray","colorArray","tempScene","setProgram","updateBuffers","rangeFactor","isInstancedBufferGeometry","materialDefaultAttributeValues","programAttribute","geometryAttribute","stride","isInstancedInterleavedBuffer","maxInstancedCount","isInstancedBufferAttribute","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttrib1fv","setupVertexAttributes","dataCount","rangeStart","rangeCount","drawStart","drawEnd","drawCount","isLineSegments","isLineLoop","isSprite","compile","compiled","initMaterial","projectObject","isGroup","isLOD","isImmediateRenderObject","renderObjects","isArrayCamera","camera2","renderObjectImmediate","materialProperties","lightsStateVersion","programCacheKey","programChange","numSupportedMorphTargets","numSupportedMorphNormals","needsLights","isMeshLambertMaterial","isMeshToonMaterial","isMeshPhongMaterial","isShadowMaterial","materialNeedsLights","progUniforms","uniformsList","useCache","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","uCamPos","cameraPosition","isOrthographicCamera","boneTexture","boneMatrices","boneTextureSize","isFog","density","refreshUniformsFog","refreshUniformsCommon","refreshUniformsLambert","refreshUniformsToon","refreshUniformsPhong","isMeshPhysicalMaterial","refreshUniformsStandard","refreshUniformsPhysical","isMeshMatcapMaterial","refreshUniformsMatcap","refreshUniformsDepth","refreshUniformsDistance","isMeshNormalMaterial","refreshUniformsNormal","isLineBasicMaterial","refreshUniformsLine","isLineDashedMaterial","refreshUniformsDash","isPointsMaterial","uvScaleMap","refreshUniformsPoints","isSpriteMaterial","refreshUniformsSprites","ltc_1","LTC_1","ltc_2","LTC_2","uv2ScaleMap","window","opaqueObjects","transparentObjects","readRenderTargetPixels","activeCubeFaceIndex","restore","textureFormat","checkFramebufferStatus","readPixels","copyFramebufferToTexture","level","levelScale","copyTexImage2D","copyTextureToTexture","srcTexture","dstTexture","texSubImage2D","FogExp2","Fog","InterleavedBuffer","isInterleavedBuffer","_geometry","_vector$6","InterleavedBufferAttribute","interleavedBuffer","_intersectPoint","_worldScale","_mvPosition","_alignedPosition","_rotatedPosition","_viewWorldMatrix","_vA$1","_vB$1","_vC$1","_uvA$1","_uvB$1","_uvC$1","Sprite","transformVertex","vertexPosition","mvPosition","_v1$4","_v2$2","LOD","_currentLevel","levels","SkinnedMesh","bindMode","bindMatrix","bindMatrixInverse","addLevel","getCurrentLevel","getObjectForDistance","bind","calculateInverses","normalizeSkinWeights","skinWeight","_offsetMatrix","_identityMatrix","Skeleton","boneInverses","Bone","bone","isBone","getBoneByName","_instanceLocalMatrix","_instanceWorldMatrix","_instanceIntersects","_mesh","InstancedMesh","linecap","linejoin","getMatrixAt","raycastTimes","instanceId","setMatrixAt","_start","_end","_inverseMatrix$1","_ray$1","_sphere$2","Line","computeLineDistances","positionAttribute","threshold","params","localThreshold","localThresholdSq","vStart","vEnd","interSegment","interRay","nbVertices","_start$1","_end$1","LineSegments","LineLoop","_inverseMatrix$2","_ray$2","_sphere$3","_position$1","Points","testPoint","rayPointDistanceSq","intersectPoint","distanceToRay","VideoTexture","video","CompressedTexture","CanvasTexture","DepthTexture","WireframeGeometry","o","ol","edge1","edge2","edge","edges","ParametricGeometry","func","slices","stacks","ParametricBufferGeometry","pu","pv","sliceCount","PolyhedronGeometry","PolyhedronBufferGeometry","vertexBuffer","uvBuffer","subdivideFace","cols","aj","bj","rows","pushVertex","getVertexByIndex","correctUV","azimuth","subdivide","applyRadius","centroid","uvA","uvB","uvC","azi","correctUVs","correctSeam","generateUVs","TetrahedronGeometry","TetrahedronBufferGeometry","OctahedronGeometry","OctahedronBufferGeometry","IcosahedronGeometry","IcosahedronBufferGeometry","DodecahedronGeometry","DodecahedronBufferGeometry","TubeGeometry","tubularSegments","radialSegments","closed","taper","bufferGeometry","TubeBufferGeometry","tangents","binormals","frames","computeFrenetFrames","P","generateSegment","getPointAt","N","B","generateIndices","generateBufferData","TorusKnotGeometry","tube","heightScale","TorusKnotBufferGeometry","P1","P2","T","calculatePositionOnCurve","cu","su","quOverP","cs","TorusGeometry","arc","TorusBufferGeometry","readyState","HAVE_CURRENT_DATA","isCanvasTexture","Earcut","holeIndices","dim","invSize","hasHoles","outerLen","outerNode","linkedList","prev","queue","steiner","getLeftmost","compareX","eliminateHole","filterPoints","eliminateHoles","earcutLinked","clockwise","last","sum","signedArea","insertNode","removeNode","again","area","ear","pass","zOrder","prevZ","nextZ","tail","numMerges","pSize","qSize","inSize","sortLinked","indexCurve","isEarHashed","isEar","cureLocalIntersections","splitEarcut","pointInTriangle","minTX","minTY","maxTX","maxTY","locallyInside","isValidDiagonal","splitPolygon","hole","hx","hy","mx","my","tanMin","findHoleBridge","leftmost","px","py","intersectsPolygon","inside","middleInside","q1","q2","Node","an","bp","ShapeUtils","contour","isClockWise","pts","triangulateShape","holes","removeDupEndPts","addContour","holeIndex","ExtrudeGeometry","ExtrudeBufferGeometry","verticesArray","addShape","placeholder","curveSegments","steps","bevelEnabled","bevelThickness","bevelSize","bevelOffset","bevelSegments","extrudePath","uvgen","UVGenerator","WorldUVGenerator","amount","extrudePts","splineTube","binormal","position2","ahole","hl","extrudeByPath","getSpacedPoints","shapePoints","extractPoints","reverse","concat","scalePt2","pt","vec","bs","vert","vlen","flen","getBevelVec","inPt","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","collinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","sf","v_trans_lensq","direction_eq","contourMovements","oneHoleMovements","holesMovements","verticesMovements","sidewalls","layeroffset","sl","slen1","slen2","f4","f3","addVertex","nextIndex","generateTopUV","addUV","generateSideWallUV","vector2","layer","buildLidFaces","buildSideFaces","indexA","indexB","indexC","a_x","a_y","b_x","b_y","c_x","c_y","indexD","a_z","b_z","c_z","d_x","d_y","d_z","TextGeometry","text","TextBufferGeometry","font","isFont","generateShapes","SphereGeometry","phiStart","phiLength","thetaStart","thetaLength","SphereBufferGeometry","thetaEnd","grid","verticesRow","uOffset","RingGeometry","innerRadius","outerRadius","thetaSegments","phiSegments","RingBufferGeometry","segment","radiusStep","thetaSegmentLevel","LatheGeometry","segments","LatheBufferGeometry","base","inverseSegments","n1","n2","ShapeGeometry","ShapeBufferGeometry","shapeHole","indexOffset","shapeVertices","shapeHoles","toJSON$1","EdgesGeometry","thresholdAngle","thresholdDot","sourceVertices","face1","face2","CylinderGeometry","radiusTop","radiusBottom","openEnded","CylinderBufferGeometry","indexArray","generateCap","centerIndexStart","centerIndexEnd","cosTheta","sinTheta","slope","indexRow","generateTorso","ConeGeometry","ConeBufferGeometry","CircleGeometry","CircleBufferGeometry","Geometries","freeze","RawShaderMaterial","STANDARD","PHYSICAL","TOON","MATCAP","Materials","AnimationUtils","arraySlice","from","to","isTypedArray","convertArray","forceClone","ArrayBuffer","isView","DataView","getKeyframeOrder","times","sortedArray","nValues","srcOffset","flattenJSON","jsonKeys","valuePropertyName","subclip","sourceClip","startFrame","endFrame","fps","clip","tracks","track","valueSize","getValueSize","minStartTime","shift","resetDuration","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","_cachedIndex","CubicInterpolant","_weightPrev","_offsetPrev","_weightNext","_offsetNext","LinearInterpolant","DiscreteInterpolant","KeyframeTrack","interpolation","TimeBufferType","ValueBufferType","setInterpolation","DefaultInterpolation","BooleanKeyframeTrack","ColorKeyframeTrack","NumberKeyframeTrack","QuaternionLinearInterpolant","QuaternionKeyframeTrack","StringKeyframeTrack","VectorKeyframeTrack","AnimationClip","duration","parseKeyframeTrack","json","trackType","typeName","toLowerCase","getTrackTypeForValueTypeName","evaluate","pp","validate_interval","seek","linear_scan","forward_scan","giveUpAt","afterEnd_","t1global","beforeStart_","mid","intervalChanged_","interpolate_","settings","DefaultSettings_","getSettings_","copySampleValue_","endingStart","endingEnd","iPrev","iNext","tPrev","tNext","halfDt","o1","o0","oP","oN","wP","wN","ppp","sP","sN","offset1","offset0","weight1","weight0","getInterpolation","ValueTypeName","InterpolantFactoryMethodDiscrete","InterpolantFactoryMethodLinear","InterpolantFactoryMethodSmooth","factoryMethod","createInterpolant","timeOffset","timeScale","startTime","endTime","nKeys","validate","valid","prevTime","currTime","optimize","smoothInterpolation","writeIndex","keep","offsetP","offsetN","readOffset","writeOffset","TypedKeyframeTrack","jsonTracks","frameTime","clipTracks","CreateFromMorphTargetSequence","morphTargetSequence","noLoop","numMorphTargets","findByName","objectOrClipArray","clipArray","animations","CreateClipsFromMorphTargetSequences","animationToMorphTargets","pattern","parts","animationMorphTargets","clips","parseAnimation","addNonemptyTrack","trackName","animationKeys","propertyName","destTracks","clipName","hierarchyTracks","hierarchy","morphTargetNames","morphTargetName","animationKey","boneName","Cache","files","file","LoadingManager","onLoad","onProgress","onError","isLoading","itemsLoaded","itemsTotal","urlModifier","handlers","onStart","itemStart","itemEnd","itemError","resolveURL","setURLModifier","addHandler","regex","loader","removeHandler","getHandler","DefaultLoadingManager","Loader","manager","crossOrigin","resourcePath","load","setCrossOrigin","setPath","setResourcePath","loading","FileLoader","AnimationLoader","CompressedTextureLoader","DataTextureLoader","ImageLoader","CubeTextureLoader","TextureLoader","Curve","arcLengthDivisions","EllipseCurve","aX","aY","xRadius","yRadius","aStartAngle","aEndAngle","aClockwise","aRotation","ArcCurve","aRadius","CubicPoly","c0","initCatmullRom","x3","tension","initNonuniformCatmullRom","dt0","dt1","dt2","t2","calc","cached","setTimeout","dataUriRegexResult","mimeType","isBase64","decodeURIComponent","atob","response","responseType","charCodeAt","Blob","parser","DOMParser","parseFromString","request","XMLHttpRequest","header","open","callbacks","withCredentials","overrideMimeType","requestHeader","setRequestHeader","send","setResponseType","setWithCredentials","setMimeType","loadTexture","texDatas","loaded","mipmapCount","isCubemap","texData","onImageLoad","onImageError","substr","urls","isJPEG","search","getPoint","optionalTarget","getUtoTmapping","getPoints","divisions","getLength","lengths","getLengths","cacheArcLengths","current","updateArcLengths","targetArcLength","arcLengths","comparison","lengthBefore","getTangent","pt1","getTangentAt","mat","MAX_VALUE","tz","fromJSON","isEllipseCurve","twoPi","deltaAngle","samePoints","isArcCurve","pz","CatmullRomCurve3","curveType","CatmullRom","QuadraticBezier","QuadraticBezierP0","QuadraticBezierP1","QuadraticBezierP2","CubicBezier","CubicBezierP0","CubicBezierP1","CubicBezierP2","CubicBezierP3","CubicBezierCurve","v3","CubicBezierCurve3","LineCurve","LineCurve3","QuadraticBezierCurve","QuadraticBezierCurve3","SplineCurve","isCatmullRomCurve3","intPoint","weight","isCubicBezierCurve","isCubicBezierCurve3","isLineCurve","isLineCurve3","isQuadraticBezierCurve","isQuadraticBezierCurve3","isSplineCurve","Curves","CurvePath","curves","autoClose","Path","currentPoint","Shape","Light","HemisphereLight","LightShadow","_frameExtents","_viewportCount","_viewports","SpotLightShadow","SpotLight","power","PointLightShadow","_cubeDirections","_cubeUps","PointLight","OrthographicCamera","DirectionalLightShadow","DirectionalLight","AmbientLight","RectAreaLight","MaterialLoader","curve","closePath","startPoint","endPoint","curveLengths","getCurveLengths","segmentLength","lens","cacheLengths","sums","moveTo","lineTo","quadraticCurveTo","aCPx","aCPy","bezierCurveTo","aCP1x","aCP1y","aCP2x","aCP2y","splineThru","absarc","absellipse","ellipse","firstPoint","lastPoint","getPointsHoles","holesPts","_lightPositionWorld","_lookTarget","shadowMatrix","projScreenMatrix","lookTarget","lightPositionWorld","viewportIndex","isSpotLightShadow","scaleW","scaleH","isDirectionalLightShadow","getTexture","shading","setTextures","LoaderUtils","decodeText","TextDecoder","decode","fromCharCode","escape","extractUrlBase","lastIndexOf","InstancedBufferGeometry","InstancedBufferAttribute","BufferGeometryLoader","typedArray","TYPED_ARRAYS","bufferAttribute","drawcalls","offsets","ObjectLoader","parseShape","parseGeometries","parseImages","parseTextures","parseMaterials","parseObject","parseAnimations","bufferGeometryLoader","details","geometryShapes","loadImage","currentUrl","parseConstant","TEXTURE_MAPPING","TEXTURE_WRAPPING","TEXTURE_FILTER","getGeometry","getMaterial","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","CubeUVReflectionMapping","CubeUVRefractionMapping","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipmapNearestFilter","NearestMipmapLinearFilter","LinearFilter","LinearMipmapNearestFilter","LinearMipmapLinearFilter","ImageBitmapLoader","createImageBitmap","fetch","ShapePath","subPaths","currentPath","Font","createPath","char","glyph","glyphs","cpx","cpy","cpx1","cpy1","cpx2","cpy2","outline","_cachedOutline","ha","familyName","FontLoader","setOptions","res","blob","imageBitmap","catch","toShapes","isCCW","noHoles","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","isPointInsidePolygon","inPolygon","polyLen","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","solid","holesFirst","tmpPoints","tmpHoles","betterShapeHoles","newShapes","newShapeHoles","mainIdx","ambiguous","toChange","sIdx","sLen","sho","hIdx","ho","hole_unassigned","s2Idx","froms","tos","paths","chars","line_height","yMax","yMin","underlineThickness","ret","createPaths","substring","AudioContext","webkitAudioContext","AudioLoader","SphericalHarmonics3","LightProbe","HemisphereLightProbe","sky","ground","AmbientLightProbe","bufferCopy","decodeAudioData","audioBuffer","isSphericalHarmonics3","zero","getAt","coeff","getIrradianceAt","addScaledSH","getBasisAt","shBasis","isHemisphereLightProbe","isAmbientLightProbe","_eyeRight","_eyeLeft","StereoCamera","eyeSep","_cache","Clock","autoStart","oldTime","elapsedTime","running","xmin","xmax","eyeSepHalf","eyeSepOnProjection","ymax","performance","Date","now","getElapsedTime","getDelta","newTime","_position$2","_quaternion$3","_scale$1","_orientation","AudioListener","gain","createGain","connect","destination","timeDelta","_clock","Audio","getInput","autoplay","detune","loop","loopStart","loopEnd","playbackRate","isPlaying","hasPlaybackControl","sourceType","_startedAt","_pausedAt","filters","removeFilter","disconnect","getFilter","setFilter","getMasterVolume","setMasterVolume","setTargetAtTime","currentTime","positionX","linearRampToValueAtTime","positionY","positionZ","forwardX","forwardY","forwardZ","upX","upY","upZ","setOrientation","getOutput","setNodeSource","audioNode","setMediaElementSource","mediaElement","createMediaElementSource","setMediaStreamSource","mediaStream","createMediaStreamSource","setBuffer","play","delay","createBufferSource","onended","onEnded","setDetune","setPlaybackRate","pause","getFilters","setFilters","getDetune","getPlaybackRate","getLoop","setLoop","setLoopStart","setLoopEnd","getVolume","setVolume","_position$3","_quaternion$4","_scale$2","_orientation$1","PositionalAudio","panner","createPanner","panningModel","AudioAnalyser","audio","fftSize","analyser","createAnalyser","frequencyBinCount","PropertyMixer","binding","mixFunction","_slerp","_select","_lerp","_mixBufferRegion","cumulativeWeight","useCount","referenceCount","getRefDistance","refDistance","setRefDistance","getRolloffFactor","rolloffFactor","setRolloffFactor","getDistanceModel","distanceModel","setDistanceModel","getMaxDistance","maxDistance","setMaxDistance","setDirectionalCone","coneInnerAngle","coneOuterAngle","coneOuterGain","orientationX","orientationY","orientationZ","getFrequencyData","getByteFrequencyData","getAverageFrequency","accumulate","accuIndex","currentWeight","mix","originalValueOffset","saveOriginalState","getValue","restoreOriginalState","_reservedRe","RegExp","_wordCharOrDot","_directoryRe","_nodeRe","_objectRe","_propertyRe","_trackRe","_supportedObjectNames","Composite","targetGroup","optionalParsedPath","parsedPath","PropertyBinding","parseTrackName","_targetGroup","_bindings","subscribe_","rootNode","node","findNode","nodeName","AnimationObjectGroup","nCachedObjects_","_indicesByUUID","_paths","_parsedPaths","_bindingsIndicesByPath","stats","total","inUse","bindingsPerObject","AnimationAction","mixer","localRoot","_mixer","_clip","_localRoot","nTracks","interpolants","interpolantSettings","interpolant","_interpolantSettings","_interpolants","_propertyBindings","_cacheIndex","_byClipCacheIndex","_timeScaleInterpolant","_weightInterpolant","_loopCount","_startTime","_effectiveTimeScale","_effectiveWeight","repetitions","paused","clampWhenFinished","zeroSlopeAtStart","zeroSlopeAtEnd","AnimationMixer","root","_root","_initMemoryManager","_accuIndex","Uniform","InstancedInterleavedBuffer","Raycaster","PointCloud","ascSort","intersectObject","Spherical","Cylindrical","firstValidIndex","bindings","unbind","isAnimationObjectGroup","sanitizeNodeName","matches","results","objectName","objectIndex","propertyIndex","lastDot","searchNodeSubtree","childNode","subTreeNode","_getValue_unavailable","_setValue_unavailable","BindingType","Direct","EntireArray","ArrayElement","HasFromToArray","Versioning","None","NeedsUpdate","MatrixWorldNeedsUpdate","GetterByBindingType","resolvedProperty","SetterByBindingTypeAndVersioning","targetObject","dest","targetArray","sourceArray","nodeProperty","versioning","bindingType","_getValue_unbound","_setValue_unbound","nObjects","nCachedObjects","indicesByUUID","parsedPaths","nBindings","knownObject","firstActiveIndex","lastCachedObject","bindingsForPath","lastCached","lastCachedIndex","firstActiveObject","firstActive","uncache","lastObject","indicesByPath","unsubscribe_","lastBindingsIndex","lastBindings","_activateAction","_deactivateAction","stopFading","stopWarping","isRunning","_isActiveAction","isScheduled","startAt","setEffectiveWeight","getEffectiveWeight","fadeIn","_scheduleFading","fadeOut","crossFadeFrom","fadeOutAction","warp","fadeInDuration","fadeOutDuration","startEndRatio","endStartRatio","crossFadeTo","fadeInAction","weightInterpolant","_takeBackControlInterpolant","setEffectiveTimeScale","getEffectiveTimeScale","setDuration","syncWith","action","halt","startTimeScale","endTimeScale","_lendControlInterpolant","timeScaleInterpolant","getMixer","getClip","getRoot","_update","deltaTime","timeDirection","timeRunning","_updateTimeScale","clipTime","_updateTime","_updateWeight","propertyMixers","interpolantValue","loopCount","pingPong","_setEndings","handle_stop","loopDelta","pending","atStart","atEnd","weightNow","weightThen","_bindAction","prototypeAction","rootUuid","bindingsByRoot","_bindingsByRootAndName","bindingsByName","_addInactiveBinding","clipUuid","actionsForClip","_actionsByClip","knownActions","_addInactiveAction","_lendBinding","_lendAction","_takeBackBinding","_takeBackAction","_actions","_nActiveActions","_nActiveBindings","_controlInterpolants","_nActiveControlInterpolants","actions","controlInterpolants","actionsByClip","actionByRoot","_removeInactiveAction","lastInactiveAction","cacheIndex","knownActionsForClip","lastKnownAction","byClipCacheIndex","_removeInactiveBindingsForAction","_removeInactiveBinding","prevIndex","lastActiveIndex","firstInactiveAction","firstInactiveIndex","lastActiveAction","bindingByName","propBinding","lastInactiveBinding","firstInactiveBinding","lastActiveBinding","_controlInterpolantsResultBuffer","__cacheIndex","lastActiveInterpolant","clipAction","optionalRoot","clipObject","existingAction","newAction","stopAllAction","nActions","setTime","timeInSeconds","uncacheClip","actionsToRemove","uncacheRoot","uncacheAction","setFromCamera","coords","intersectObjects","other","makeSafe","setFromCartesianCoords","_vector$7","Box2","_startP","_startEnd","Line3","ImmediateRenderObject","distanceSq","closestPointToPointParameter","clampToLine","startEnd2","_vector$8","SpotLightHelper","cone","coneLength","coneWidth","_vector$9","_boneMatrix","_matrixWorldInv","SkeletonHelper","getBoneList","boneList","PointLightHelper","sphereSize","isSkeletonHelper","_vector$a","_color1","_color2","HemisphereLightHelper","GridHelper","PolarGridHelper","radials","circles","_v1$5","_v2$3","_v3$1","DirectionalLightHelper","lightPlane","targetLine","_vector$b","_camera","CameraHelper","pointMap","colorFrustum","colorCone","colorUp","colorTarget","colorCross","addLine","addPoint","setPoint","_box$3","BoxHelper","Box3Helper","PlaneHelper","_lineGeometry","_coneGeometry","_axis","ArrowHelper","headLength","headWidth","setDirection","AxesHelper","setColor","weights","poleAxis","shaderMaterial","SIZE_MAX","EXTRA_LOD_SIGMA","TOTAL_LODS","LOD_MAX","ENCODINGS","3000","3001","3002","3004","3005","3006","3007","_flatCamera","_blurMaterial","latitudinal","dTheta","mipInt","inputEncoding","_equirectShader","_cubemapShader","ref","_lodPlanes","_sizeLods","_sigmas","lod","sizeLod","sigma","texelSize","positionSize","uvSize","faceIndexSize","coordinates","fill","_createPlanes","_pingPongRenderTarget","_oldTarget","PHI","INV_PHI","_axisDirections","PMREMGenerator","_compileMaterial","_allocateTargets","equirectangular","cubeUVRenderTarget","_createRenderTarget","_cleanup","outputTarget","tmpScene","_setViewport","_applyPMREM","_blur","lodIn","lodOut","_halfBlur","targetIn","targetOut","sigmaRadians","blurScene","blurUniforms","pixels","radiansPerPixel","sigmaPixels","exp","outputSize","_getEquirectShader","_getCubemapShader","fromScene","cubeCamera","upSign","forwardSign","maxComponent","fExp","log2","col","_sceneToCubeUV","fromEquirectangular","fromCubemap","cubemap","_textureToCubeUV","compileCubemapShader","compileEquirectangularShader","ClosedSplineCurve3","SplineCurve3","Spline","construct","createPointsGeometry","createGeometry","createSpacedPointsGeometry","fromPoints","initFromArray","getControlPointsArray","reparametrizeByArcLength","setColors","Handlers","setTexturePath","isIntersectionBox","isIntersectionSphere","setFromMatrix","random16","nearestPowerOfTwo","nextPowerOfTwo","flattenToArrayOffset","multiplyVector3","multiplyVector3Array","applyToBufferAttribute","applyToVector3Array","extractPosition","getPosition","multiplyToArray","multiplyVector4","rotateAxis","crossVector","rotateByAxis","makeFrustum","isIntersectionLine","isIntersectionPlane","barycoordFromPoint","midpoint","extractAllPoints","extrude","makeGeometry","fromAttribute","distanceToManhattan","lengthManhattan","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","getScaleFromMatrix","getColumnFromMatrix","applyProjection","computeTangents","applyMatrix","getChildByName","renderDepth","getWorldRotation","eulerOrder","useQuaternion","setDrawMode","drawMode","initBones","setLens","onlyShadow","shadowCameraFov","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraVisible","shadowDarkness","shadowMapWidth","shadowMapHeight","dynamic","setDynamic","copyIndicesArray","setArray","addIndex","addAttribute","addDrawCall","clearDrawCalls","computeOffsets","removeAttribute","linePrecision","getArrays","addShapeList","wrapAround","overdraw","wrapRGB","metal","clearTarget","animate","getCurrentRenderTarget","getPrecision","resetGLState","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","supportsInstancedArrays","enableScissorTest","addPrePlugin","addPostPlugin","updateShadowMap","setFaceCulling","allocTextureUnit","setTexture","getActiveMipMapLevel","shadowMapCullFace","vr","gammaInput","gammaOutput","renderReverseSided","renderSingleSided","getData","updateCubeMap","GeometryUtils","geometry1","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","SceneUtils","createMultiMaterialObject","detach","revision","ACESFilmicToneMapping","AddEquation","AddOperation","AdditiveBlending","AlphaFormat","AlwaysDepth","AlwaysStencilFunc","AxisHelper","BackSide","BasicDepthPacking","BasicShadowMap","BinaryTextureLoader","BoundingBoxHelper","ByteType","CanvasRenderer","CineonToneMapping","CubeGeometry","CullFaceBack","CullFaceFront","CullFaceFrontBack","CullFaceNone","CustomBlending","DecrementStencilOp","DecrementWrapStencilOp","DepthFormat","DepthStencilFormat","DoubleSide","DstAlphaFactor","DstColorFactor","DynamicBufferAttribute","DynamicCopyUsage","DynamicDrawUsage","DynamicReadUsage","EdgesHelper","EqualDepth","EqualStencilFunc","Face4","FaceColors","FlatShading","Float32Attribute","Float64Attribute","FloatType","FrontFaceDirectionCCW","FrontFaceDirectionCW","FrontSide","GammaEncoding","GreaterDepth","GreaterEqualDepth","GreaterEqualStencilFunc","GreaterStencilFunc","HalfFloatType","IncrementStencilOp","IncrementWrapStencilOp","Int16Attribute","Int32Attribute","Int8Attribute","IntType","InterpolateDiscrete","InterpolateLinear","InterpolateSmooth","InvertStencilOp","JSONLoader","KeepStencilOp","LensFlare","LessDepth","LessEqualDepth","LessEqualStencilFunc","LessStencilFunc","LinePieces","LineStrip","LinearEncoding","LinearMipMapLinearFilter","LinearMipMapNearestFilter","LinearToneMapping","LogLuvEncoding","LoopOnce","LoopPingPong","LoopRepeat","LuminanceAlphaFormat","LuminanceFormat","MOUSE","LEFT","MIDDLE","RIGHT","ROTATE","DOLLY","PAN","MaxEquation","MeshFaceMaterial","MinEquation","MixOperation","MultiMaterial","MultiplyBlending","MultiplyOperation","NearestMipMapLinearFilter","NearestMipMapNearestFilter","NeverDepth","NeverStencilFunc","NoBlending","NoColors","NoToneMapping","NormalBlending","NotEqualDepth","NotEqualStencilFunc","ObjectSpaceNormalMap","OneFactor","OneMinusDstAlphaFactor","OneMinusDstColorFactor","OneMinusSrcAlphaFactor","OneMinusSrcColorFactor","PCFShadowMap","PCFSoftShadowMap","Particle","ParticleBasicMaterial","ParticleSystem","ParticleSystemMaterial","PointCloudMaterial","REVISION","RGBADepthPacking","RGBAFormat","RGBAIntegerFormat","RGBA_ASTC_10x10_Format","RGBA_ASTC_10x5_Format","RGBA_ASTC_10x6_Format","RGBA_ASTC_10x8_Format","RGBA_ASTC_12x10_Format","RGBA_ASTC_12x12_Format","RGBA_ASTC_4x4_Format","RGBA_ASTC_5x4_Format","RGBA_ASTC_5x5_Format","RGBA_ASTC_6x5_Format","RGBA_ASTC_6x6_Format","RGBA_ASTC_8x5_Format","RGBA_ASTC_8x6_Format","RGBA_ASTC_8x8_Format","RGBA_BPTC_Format","RGBA_ETC2_EAC_Format","RGBA_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGBDEncoding","RGBEEncoding","RGBEFormat","RGBFormat","RGBIntegerFormat","RGBM16Encoding","RGBM7Encoding","RGB_ETC1_Format","RGB_ETC2_Format","RGB_PVRTC_2BPPV1_Format","RGB_PVRTC_4BPPV1_Format","RGB_S3TC_DXT1_Format","RGFormat","RGIntegerFormat","RedFormat","RedIntegerFormat","ReinhardToneMapping","ReplaceStencilOp","ReverseSubtractEquation","SRGB8_ALPHA8_ASTC_10x10_Format","SRGB8_ALPHA8_ASTC_10x5_Format","SRGB8_ALPHA8_ASTC_10x6_Format","SRGB8_ALPHA8_ASTC_10x8_Format","SRGB8_ALPHA8_ASTC_12x10_Format","SRGB8_ALPHA8_ASTC_12x12_Format","SRGB8_ALPHA8_ASTC_4x4_Format","SRGB8_ALPHA8_ASTC_5x4_Format","SRGB8_ALPHA8_ASTC_5x5_Format","SRGB8_ALPHA8_ASTC_6x5_Format","SRGB8_ALPHA8_ASTC_6x6_Format","SRGB8_ALPHA8_ASTC_8x5_Format","SRGB8_ALPHA8_ASTC_8x6_Format","SRGB8_ALPHA8_ASTC_8x8_Format","ShortType","SmoothShading","SrcAlphaFactor","SrcAlphaSaturateFactor","SrcColorFactor","StaticCopyUsage","StaticDrawUsage","StaticReadUsage","StreamCopyUsage","StreamDrawUsage","StreamReadUsage","SubtractEquation","SubtractiveBlending","TOUCH","DOLLY_PAN","DOLLY_ROTATE","TangentSpaceNormalMap","TriangleFanDrawMode","TriangleStripDrawMode","TrianglesDrawMode","Uint16Attribute","Uint32Attribute","Uint8Attribute","Uint8ClampedAttribute","Uncharted2ToneMapping","UnsignedByteType","UnsignedInt248Type","UnsignedIntType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","UnsignedShortType","VSMShadowMap","Vertex","VertexColors","WebGLRenderTargetCube","WireframeHelper","WrapAroundEnding","XHRLoader","ZeroCurvatureEnding","ZeroFactor","ZeroSlopeEnding","ZeroStencilOp","sRGBEncoding"],"mappings":"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","file":"three.min.js","sourcesContent":["(function (global, factory) {\r\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\r\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\r\n\t(global = global || self, factory(global.THREE = {}));\r\n}(this, (function (exports) { 'use strict';\r\n\r\n\t// Polyfills\r\n\r\n\tif ( Number.EPSILON === undefined ) {\r\n\r\n\t\tNumber.EPSILON = Math.pow( 2, - 52 );\r\n\r\n\t}\r\n\r\n\tif ( Number.isInteger === undefined ) {\r\n\r\n\t\t// Missing in IE\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger\r\n\r\n\t\tNumber.isInteger = function ( value ) {\r\n\r\n\t\t\treturn typeof value === 'number' && isFinite( value ) && Math.floor( value ) === value;\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tif ( Math.sign === undefined ) {\r\n\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\r\n\r\n\t\tMath.sign = function ( x ) {\r\n\r\n\t\t\treturn ( x < 0 ) ? - 1 : ( x > 0 ) ? 1 : + x;\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tif ( 'name' in Function.prototype === false ) {\r\n\r\n\t\t// Missing in IE\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\r\n\r\n\t\tObject.defineProperty( Function.prototype, 'name', {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.toString().match( /^\\s*function\\s*([^\\(\\s]*)/ )[ 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tif ( Object.assign === undefined ) {\r\n\r\n\t\t// Missing in IE\r\n\t\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\r\n\r\n\t\tObject.assign = function ( target ) {\r\n\r\n\t\t\tif ( target === undefined || target === null ) {\r\n\r\n\t\t\t\tthrow new TypeError( 'Cannot convert undefined or null to object' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar output = Object( target );\r\n\r\n\t\t\tfor ( var index = 1; index < arguments.length; index ++ ) {\r\n\r\n\t\t\t\tvar source = arguments[ index ];\r\n\r\n\t\t\t\tif ( source !== undefined && source !== null ) {\r\n\r\n\t\t\t\t\tfor ( var nextKey in source ) {\r\n\r\n\t\t\t\t\t\tif ( Object.prototype.hasOwnProperty.call( source, nextKey ) ) {\r\n\r\n\t\t\t\t\t\t\toutput[ nextKey ] = source[ nextKey ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn output;\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tvar REVISION = '115';\r\n\tvar MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2, ROTATE: 0, DOLLY: 1, PAN: 2 };\r\n\tvar TOUCH = { ROTATE: 0, PAN: 1, DOLLY_PAN: 2, DOLLY_ROTATE: 3 };\r\n\tvar CullFaceNone = 0;\r\n\tvar CullFaceBack = 1;\r\n\tvar CullFaceFront = 2;\r\n\tvar CullFaceFrontBack = 3;\r\n\tvar FrontFaceDirectionCW = 0;\r\n\tvar FrontFaceDirectionCCW = 1;\r\n\tvar BasicShadowMap = 0;\r\n\tvar PCFShadowMap = 1;\r\n\tvar PCFSoftShadowMap = 2;\r\n\tvar VSMShadowMap = 3;\r\n\tvar FrontSide = 0;\r\n\tvar BackSide = 1;\r\n\tvar DoubleSide = 2;\r\n\tvar FlatShading = 1;\r\n\tvar SmoothShading = 2;\r\n\tvar NoBlending = 0;\r\n\tvar NormalBlending = 1;\r\n\tvar AdditiveBlending = 2;\r\n\tvar SubtractiveBlending = 3;\r\n\tvar MultiplyBlending = 4;\r\n\tvar CustomBlending = 5;\r\n\tvar AddEquation = 100;\r\n\tvar SubtractEquation = 101;\r\n\tvar ReverseSubtractEquation = 102;\r\n\tvar MinEquation = 103;\r\n\tvar MaxEquation = 104;\r\n\tvar ZeroFactor = 200;\r\n\tvar OneFactor = 201;\r\n\tvar SrcColorFactor = 202;\r\n\tvar OneMinusSrcColorFactor = 203;\r\n\tvar SrcAlphaFactor = 204;\r\n\tvar OneMinusSrcAlphaFactor = 205;\r\n\tvar DstAlphaFactor = 206;\r\n\tvar OneMinusDstAlphaFactor = 207;\r\n\tvar DstColorFactor = 208;\r\n\tvar OneMinusDstColorFactor = 209;\r\n\tvar SrcAlphaSaturateFactor = 210;\r\n\tvar NeverDepth = 0;\r\n\tvar AlwaysDepth = 1;\r\n\tvar LessDepth = 2;\r\n\tvar LessEqualDepth = 3;\r\n\tvar EqualDepth = 4;\r\n\tvar GreaterEqualDepth = 5;\r\n\tvar GreaterDepth = 6;\r\n\tvar NotEqualDepth = 7;\r\n\tvar MultiplyOperation = 0;\r\n\tvar MixOperation = 1;\r\n\tvar AddOperation = 2;\r\n\tvar NoToneMapping = 0;\r\n\tvar LinearToneMapping = 1;\r\n\tvar ReinhardToneMapping = 2;\r\n\tvar Uncharted2ToneMapping = 3;\r\n\tvar CineonToneMapping = 4;\r\n\tvar ACESFilmicToneMapping = 5;\r\n\r\n\tvar UVMapping = 300;\r\n\tvar CubeReflectionMapping = 301;\r\n\tvar CubeRefractionMapping = 302;\r\n\tvar EquirectangularReflectionMapping = 303;\r\n\tvar EquirectangularRefractionMapping = 304;\r\n\tvar SphericalReflectionMapping = 305;\r\n\tvar CubeUVReflectionMapping = 306;\r\n\tvar CubeUVRefractionMapping = 307;\r\n\tvar RepeatWrapping = 1000;\r\n\tvar ClampToEdgeWrapping = 1001;\r\n\tvar MirroredRepeatWrapping = 1002;\r\n\tvar NearestFilter = 1003;\r\n\tvar NearestMipmapNearestFilter = 1004;\r\n\tvar NearestMipMapNearestFilter = 1004;\r\n\tvar NearestMipmapLinearFilter = 1005;\r\n\tvar NearestMipMapLinearFilter = 1005;\r\n\tvar LinearFilter = 1006;\r\n\tvar LinearMipmapNearestFilter = 1007;\r\n\tvar LinearMipMapNearestFilter = 1007;\r\n\tvar LinearMipmapLinearFilter = 1008;\r\n\tvar LinearMipMapLinearFilter = 1008;\r\n\tvar UnsignedByteType = 1009;\r\n\tvar ByteType = 1010;\r\n\tvar ShortType = 1011;\r\n\tvar UnsignedShortType = 1012;\r\n\tvar IntType = 1013;\r\n\tvar UnsignedIntType = 1014;\r\n\tvar FloatType = 1015;\r\n\tvar HalfFloatType = 1016;\r\n\tvar UnsignedShort4444Type = 1017;\r\n\tvar UnsignedShort5551Type = 1018;\r\n\tvar UnsignedShort565Type = 1019;\r\n\tvar UnsignedInt248Type = 1020;\r\n\tvar AlphaFormat = 1021;\r\n\tvar RGBFormat = 1022;\r\n\tvar RGBAFormat = 1023;\r\n\tvar LuminanceFormat = 1024;\r\n\tvar LuminanceAlphaFormat = 1025;\r\n\tvar RGBEFormat = RGBAFormat;\r\n\tvar DepthFormat = 1026;\r\n\tvar DepthStencilFormat = 1027;\r\n\tvar RedFormat = 1028;\r\n\tvar RedIntegerFormat = 1029;\r\n\tvar RGFormat = 1030;\r\n\tvar RGIntegerFormat = 1031;\r\n\tvar RGBIntegerFormat = 1032;\r\n\tvar RGBAIntegerFormat = 1033;\r\n\r\n\tvar RGB_S3TC_DXT1_Format = 33776;\r\n\tvar RGBA_S3TC_DXT1_Format = 33777;\r\n\tvar RGBA_S3TC_DXT3_Format = 33778;\r\n\tvar RGBA_S3TC_DXT5_Format = 33779;\r\n\tvar RGB_PVRTC_4BPPV1_Format = 35840;\r\n\tvar RGB_PVRTC_2BPPV1_Format = 35841;\r\n\tvar RGBA_PVRTC_4BPPV1_Format = 35842;\r\n\tvar RGBA_PVRTC_2BPPV1_Format = 35843;\r\n\tvar RGB_ETC1_Format = 36196;\r\n\tvar RGB_ETC2_Format = 37492;\r\n\tvar RGBA_ETC2_EAC_Format = 37496;\r\n\tvar RGBA_ASTC_4x4_Format = 37808;\r\n\tvar RGBA_ASTC_5x4_Format = 37809;\r\n\tvar RGBA_ASTC_5x5_Format = 37810;\r\n\tvar RGBA_ASTC_6x5_Format = 37811;\r\n\tvar RGBA_ASTC_6x6_Format = 37812;\r\n\tvar RGBA_ASTC_8x5_Format = 37813;\r\n\tvar RGBA_ASTC_8x6_Format = 37814;\r\n\tvar RGBA_ASTC_8x8_Format = 37815;\r\n\tvar RGBA_ASTC_10x5_Format = 37816;\r\n\tvar RGBA_ASTC_10x6_Format = 37817;\r\n\tvar RGBA_ASTC_10x8_Format = 37818;\r\n\tvar RGBA_ASTC_10x10_Format = 37819;\r\n\tvar RGBA_ASTC_12x10_Format = 37820;\r\n\tvar RGBA_ASTC_12x12_Format = 37821;\r\n\tvar RGBA_BPTC_Format = 36492;\r\n\tvar SRGB8_ALPHA8_ASTC_4x4_Format = 37840;\r\n\tvar SRGB8_ALPHA8_ASTC_5x4_Format = 37841;\r\n\tvar SRGB8_ALPHA8_ASTC_5x5_Format = 37842;\r\n\tvar SRGB8_ALPHA8_ASTC_6x5_Format = 37843;\r\n\tvar SRGB8_ALPHA8_ASTC_6x6_Format = 37844;\r\n\tvar SRGB8_ALPHA8_ASTC_8x5_Format = 37845;\r\n\tvar SRGB8_ALPHA8_ASTC_8x6_Format = 37846;\r\n\tvar SRGB8_ALPHA8_ASTC_8x8_Format = 37847;\r\n\tvar SRGB8_ALPHA8_ASTC_10x5_Format = 37848;\r\n\tvar SRGB8_ALPHA8_ASTC_10x6_Format = 37849;\r\n\tvar SRGB8_ALPHA8_ASTC_10x8_Format = 37850;\r\n\tvar SRGB8_ALPHA8_ASTC_10x10_Format = 37851;\r\n\tvar SRGB8_ALPHA8_ASTC_12x10_Format = 37852;\r\n\tvar SRGB8_ALPHA8_ASTC_12x12_Format = 37853;\r\n\tvar LoopOnce = 2200;\r\n\tvar LoopRepeat = 2201;\r\n\tvar LoopPingPong = 2202;\r\n\tvar InterpolateDiscrete = 2300;\r\n\tvar InterpolateLinear = 2301;\r\n\tvar InterpolateSmooth = 2302;\r\n\tvar ZeroCurvatureEnding = 2400;\r\n\tvar ZeroSlopeEnding = 2401;\r\n\tvar WrapAroundEnding = 2402;\r\n\tvar TrianglesDrawMode = 0;\r\n\tvar TriangleStripDrawMode = 1;\r\n\tvar TriangleFanDrawMode = 2;\r\n\tvar LinearEncoding = 3000;\r\n\tvar sRGBEncoding = 3001;\r\n\tvar GammaEncoding = 3007;\r\n\tvar RGBEEncoding = 3002;\r\n\tvar LogLuvEncoding = 3003;\r\n\tvar RGBM7Encoding = 3004;\r\n\tvar RGBM16Encoding = 3005;\r\n\tvar RGBDEncoding = 3006;\r\n\tvar BasicDepthPacking = 3200;\r\n\tvar RGBADepthPacking = 3201;\r\n\tvar TangentSpaceNormalMap = 0;\r\n\tvar ObjectSpaceNormalMap = 1;\r\n\r\n\tvar ZeroStencilOp = 0;\r\n\tvar KeepStencilOp = 7680;\r\n\tvar ReplaceStencilOp = 7681;\r\n\tvar IncrementStencilOp = 7682;\r\n\tvar DecrementStencilOp = 7683;\r\n\tvar IncrementWrapStencilOp = 34055;\r\n\tvar DecrementWrapStencilOp = 34056;\r\n\tvar InvertStencilOp = 5386;\r\n\r\n\tvar NeverStencilFunc = 512;\r\n\tvar LessStencilFunc = 513;\r\n\tvar EqualStencilFunc = 514;\r\n\tvar LessEqualStencilFunc = 515;\r\n\tvar GreaterStencilFunc = 516;\r\n\tvar NotEqualStencilFunc = 517;\r\n\tvar GreaterEqualStencilFunc = 518;\r\n\tvar AlwaysStencilFunc = 519;\r\n\r\n\tvar StaticDrawUsage = 35044;\r\n\tvar DynamicDrawUsage = 35048;\r\n\tvar StreamDrawUsage = 35040;\r\n\tvar StaticReadUsage = 35045;\r\n\tvar DynamicReadUsage = 35049;\r\n\tvar StreamReadUsage = 35041;\r\n\tvar StaticCopyUsage = 35046;\r\n\tvar DynamicCopyUsage = 35050;\r\n\tvar StreamCopyUsage = 35042;\r\n\r\n\t/**\r\n\t * https://github.com/mrdoob/eventdispatcher.js/\r\n\t */\r\n\r\n\tfunction EventDispatcher() {}\r\n\r\n\tObject.assign( EventDispatcher.prototype, {\r\n\r\n\t\taddEventListener: function ( type, listener ) {\r\n\r\n\t\t\tif ( this._listeners === undefined ) { this._listeners = {}; }\r\n\r\n\t\t\tvar listeners = this._listeners;\r\n\r\n\t\t\tif ( listeners[ type ] === undefined ) {\r\n\r\n\t\t\t\tlisteners[ type ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\r\n\r\n\t\t\t\tlisteners[ type ].push( listener );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\thasEventListener: function ( type, listener ) {\r\n\r\n\t\t\tif ( this._listeners === undefined ) { return false; }\r\n\r\n\t\t\tvar listeners = this._listeners;\r\n\r\n\t\t\treturn listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1;\r\n\r\n\t\t},\r\n\r\n\t\tremoveEventListener: function ( type, listener ) {\r\n\r\n\t\t\tif ( this._listeners === undefined ) { return; }\r\n\r\n\t\t\tvar listeners = this._listeners;\r\n\t\t\tvar listenerArray = listeners[ type ];\r\n\r\n\t\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\t\tvar index = listenerArray.indexOf( listener );\r\n\r\n\t\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\t\tlistenerArray.splice( index, 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tdispatchEvent: function ( event ) {\r\n\r\n\t\t\tif ( this._listeners === undefined ) { return; }\r\n\r\n\t\t\tvar listeners = this._listeners;\r\n\t\t\tvar listenerArray = listeners[ event.type ];\r\n\r\n\t\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\t\tevent.target = this;\r\n\r\n\t\t\t\t// Make a copy, in case listeners are removed while iterating.\r\n\t\t\t\tvar array = listenerArray.slice( 0 );\r\n\r\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tarray[ i ].call( this, event );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author thezwap\r\n\t */\r\n\r\n\tvar _lut = [];\r\n\r\n\tfor ( var i = 0; i < 256; i ++ ) {\r\n\r\n\t\t_lut[ i ] = ( i < 16 ? '0' : '' ) + ( i ).toString( 16 );\r\n\r\n\t}\r\n\r\n\tvar MathUtils = {\r\n\r\n\t\tDEG2RAD: Math.PI / 180,\r\n\t\tRAD2DEG: 180 / Math.PI,\r\n\r\n\t\tgenerateUUID: function () {\r\n\r\n\t\t\t// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\r\n\r\n\t\t\tvar d0 = Math.random() * 0xffffffff | 0;\r\n\t\t\tvar d1 = Math.random() * 0xffffffff | 0;\r\n\t\t\tvar d2 = Math.random() * 0xffffffff | 0;\r\n\t\t\tvar d3 = Math.random() * 0xffffffff | 0;\r\n\t\t\tvar uuid = _lut[ d0 & 0xff ] + _lut[ d0 >> 8 & 0xff ] + _lut[ d0 >> 16 & 0xff ] + _lut[ d0 >> 24 & 0xff ] + '-' +\r\n\t\t\t\t_lut[ d1 & 0xff ] + _lut[ d1 >> 8 & 0xff ] + '-' + _lut[ d1 >> 16 & 0x0f | 0x40 ] + _lut[ d1 >> 24 & 0xff ] + '-' +\r\n\t\t\t\t_lut[ d2 & 0x3f | 0x80 ] + _lut[ d2 >> 8 & 0xff ] + '-' + _lut[ d2 >> 16 & 0xff ] + _lut[ d2 >> 24 & 0xff ] +\r\n\t\t\t\t_lut[ d3 & 0xff ] + _lut[ d3 >> 8 & 0xff ] + _lut[ d3 >> 16 & 0xff ] + _lut[ d3 >> 24 & 0xff ];\r\n\r\n\t\t\t// .toUpperCase() here flattens concatenated strings to save heap memory space.\r\n\t\t\treturn uuid.toUpperCase();\r\n\r\n\t\t},\r\n\r\n\t\tclamp: function ( value, min, max ) {\r\n\r\n\t\t\treturn Math.max( min, Math.min( max, value ) );\r\n\r\n\t\t},\r\n\r\n\t\t// compute euclidian modulo of m % n\r\n\t\t// https://en.wikipedia.org/wiki/Modulo_operation\r\n\r\n\t\teuclideanModulo: function ( n, m ) {\r\n\r\n\t\t\treturn ( ( n % m ) + m ) % m;\r\n\r\n\t\t},\r\n\r\n\t\t// Linear mapping from range <a1, a2> to range <b1, b2>\r\n\r\n\t\tmapLinear: function ( x, a1, a2, b1, b2 ) {\r\n\r\n\t\t\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\r\n\r\n\t\t},\r\n\r\n\t\t// https://en.wikipedia.org/wiki/Linear_interpolation\r\n\r\n\t\tlerp: function ( x, y, t ) {\r\n\r\n\t\t\treturn ( 1 - t ) * x + t * y;\r\n\r\n\t\t},\r\n\r\n\t\t// http://en.wikipedia.org/wiki/Smoothstep\r\n\r\n\t\tsmoothstep: function ( x, min, max ) {\r\n\r\n\t\t\tif ( x <= min ) { return 0; }\r\n\t\t\tif ( x >= max ) { return 1; }\r\n\r\n\t\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\t\treturn x * x * ( 3 - 2 * x );\r\n\r\n\t\t},\r\n\r\n\t\tsmootherstep: function ( x, min, max ) {\r\n\r\n\t\t\tif ( x <= min ) { return 0; }\r\n\t\t\tif ( x >= max ) { return 1; }\r\n\r\n\t\t\tx = ( x - min ) / ( max - min );\r\n\r\n\t\t\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\r\n\r\n\t\t},\r\n\r\n\t\t// Random integer from <low, high> interval\r\n\r\n\t\trandInt: function ( low, high ) {\r\n\r\n\t\t\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\r\n\r\n\t\t},\r\n\r\n\t\t// Random float from <low, high> interval\r\n\r\n\t\trandFloat: function ( low, high ) {\r\n\r\n\t\t\treturn low + Math.random() * ( high - low );\r\n\r\n\t\t},\r\n\r\n\t\t// Random float from <-range/2, range/2> interval\r\n\r\n\t\trandFloatSpread: function ( range ) {\r\n\r\n\t\t\treturn range * ( 0.5 - Math.random() );\r\n\r\n\t\t},\r\n\r\n\t\tdegToRad: function ( degrees ) {\r\n\r\n\t\t\treturn degrees * MathUtils.DEG2RAD;\r\n\r\n\t\t},\r\n\r\n\t\tradToDeg: function ( radians ) {\r\n\r\n\t\t\treturn radians * MathUtils.RAD2DEG;\r\n\r\n\t\t},\r\n\r\n\t\tisPowerOfTwo: function ( value ) {\r\n\r\n\t\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\r\n\r\n\t\t},\r\n\r\n\t\tceilPowerOfTwo: function ( value ) {\r\n\r\n\t\t\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\r\n\r\n\t\t},\r\n\r\n\t\tfloorPowerOfTwo: function ( value ) {\r\n\r\n\t\t\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\r\n\r\n\t\t},\r\n\r\n\t\tsetQuaternionFromProperEuler: function ( q, a, b, c, order ) {\r\n\r\n\t\t\t// Intrinsic Proper Euler Angles - see https://en.wikipedia.org/wiki/Euler_angles\r\n\r\n\t\t\t// rotations are applied to the axes in the order specified by 'order'\r\n\t\t\t// rotation by angle 'a' is applied first, then by angle 'b', then by angle 'c'\r\n\t\t\t// angles are in radians\r\n\r\n\t\t\tvar cos = Math.cos;\r\n\t\t\tvar sin = Math.sin;\r\n\r\n\t\t\tvar c2 = cos( b / 2 );\r\n\t\t\tvar s2 = sin( b / 2 );\r\n\r\n\t\t\tvar c13 = cos( ( a + c ) / 2 );\r\n\t\t\tvar s13 = sin( ( a + c ) / 2 );\r\n\r\n\t\t\tvar c1_3 = cos( ( a - c ) / 2 );\r\n\t\t\tvar s1_3 = sin( ( a - c ) / 2 );\r\n\r\n\t\t\tvar c3_1 = cos( ( c - a ) / 2 );\r\n\t\t\tvar s3_1 = sin( ( c - a ) / 2 );\r\n\r\n\t\t\tif ( order === 'XYX' ) {\r\n\r\n\t\t\t\tq.set( c2 * s13, s2 * c1_3, s2 * s1_3, c2 * c13 );\r\n\r\n\t\t\t} else if ( order === 'YZY' ) {\r\n\r\n\t\t\t\tq.set( s2 * s1_3, c2 * s13, s2 * c1_3, c2 * c13 );\r\n\r\n\t\t\t} else if ( order === 'ZXZ' ) {\r\n\r\n\t\t\t\tq.set( s2 * c1_3, s2 * s1_3, c2 * s13, c2 * c13 );\r\n\r\n\t\t\t} else if ( order === 'XZX' ) {\r\n\r\n\t\t\t\tq.set( c2 * s13, s2 * s3_1, s2 * c3_1, c2 * c13 );\r\n\r\n\t\t\t} else if ( order === 'YXY' ) {\r\n\r\n\t\t\t\tq.set( s2 * c3_1, c2 * s13, s2 * s3_1, c2 * c13 );\r\n\r\n\t\t\t} else if ( order === 'ZYZ' ) {\r\n\r\n\t\t\t\tq.set( s2 * s3_1, s2 * c3_1, c2 * s13, c2 * c13 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author egraether / http://egraether.com/\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t */\r\n\r\n\tfunction Vector2( x, y ) {\r\n\r\n\t\tthis.x = x || 0;\r\n\t\tthis.y = y || 0;\r\n\r\n\t}\r\n\r\n\tObject.defineProperties( Vector2.prototype, {\r\n\r\n\t\t\"width\": {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.x;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis.x = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t\"height\": {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.y;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis.y = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Vector2.prototype, {\r\n\r\n\t\tisVector2: true,\r\n\r\n\t\tset: function ( x, y ) {\r\n\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x = scalar;\r\n\t\t\tthis.y = scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetX: function ( x ) {\r\n\r\n\t\t\tthis.x = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( y ) {\r\n\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetComponent: function ( index, value ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: this.x = value; break;\r\n\t\t\t\tcase 1: this.y = value; break;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetComponent: function ( index ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: return this.x;\r\n\t\t\t\tcase 1: return this.y;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.x, this.y );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( v ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\t\t\tthis.y = v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tadd: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScalar: function ( s ) {\r\n\r\n\t\t\tthis.x += s;\r\n\t\t\tthis.y += s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x + b.x;\r\n\t\t\tthis.y = a.y + b.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScaledVector: function ( v, s ) {\r\n\r\n\t\t\tthis.x += v.x * s;\r\n\t\t\tthis.y += v.y * s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsub: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x -= v.x;\r\n\t\t\tthis.y -= v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubScalar: function ( s ) {\r\n\r\n\t\t\tthis.x -= s;\r\n\t\t\tthis.y -= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x - b.x;\r\n\t\t\tthis.y = a.y - b.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( v ) {\r\n\r\n\t\t\tthis.x *= v.x;\r\n\t\t\tthis.y *= v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdivide: function ( v ) {\r\n\r\n\t\t\tthis.x /= v.x;\r\n\t\t\tthis.y /= v.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdivideScalar: function ( scalar ) {\r\n\r\n\t\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix3: function ( m ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ];\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmin: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.min( this.x, v.x );\r\n\t\t\tthis.y = Math.min( this.y, v.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmax: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.max( this.x, v.x );\r\n\t\t\tthis.y = Math.max( this.y, v.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclamp: function ( min, max ) {\r\n\r\n\t\t\t// assumes min < max, componentwise\r\n\r\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclampScalar: function ( minVal, maxVal ) {\r\n\r\n\t\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\r\n\t\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclampLength: function ( min, max ) {\r\n\r\n\t\t\tvar length = this.length();\r\n\r\n\t\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\r\n\r\n\t\t},\r\n\r\n\t\tfloor: function () {\r\n\r\n\t\t\tthis.x = Math.floor( this.x );\r\n\t\t\tthis.y = Math.floor( this.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tceil: function () {\r\n\r\n\t\t\tthis.x = Math.ceil( this.x );\r\n\t\t\tthis.y = Math.ceil( this.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tround: function () {\r\n\r\n\t\t\tthis.x = Math.round( this.x );\r\n\t\t\tthis.y = Math.round( this.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\troundToZero: function () {\r\n\r\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnegate: function () {\r\n\r\n\t\t\tthis.x = - this.x;\r\n\t\t\tthis.y = - this.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdot: function ( v ) {\r\n\r\n\t\t\treturn this.x * v.x + this.y * v.y;\r\n\r\n\t\t},\r\n\r\n\t\tcross: function ( v ) {\r\n\r\n\t\t\treturn this.x * v.y - this.y * v.x;\r\n\r\n\t\t},\r\n\r\n\t\tlengthSq: function () {\r\n\r\n\t\t\treturn this.x * this.x + this.y * this.y;\r\n\r\n\t\t},\r\n\r\n\t\tlength: function () {\r\n\r\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanLength: function () {\r\n\r\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y );\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\treturn this.divideScalar( this.length() || 1 );\r\n\r\n\t\t},\r\n\r\n\t\tangle: function () {\r\n\r\n\t\t\t// computes the angle in radians with respect to the positive x-axis\r\n\r\n\t\t\tvar angle = Math.atan2( - this.y, - this.x ) + Math.PI;\r\n\r\n\t\t\treturn angle;\r\n\r\n\t\t},\r\n\r\n\t\tdistanceTo: function ( v ) {\r\n\r\n\t\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToSquared: function ( v ) {\r\n\r\n\t\t\tvar dx = this.x - v.x, dy = this.y - v.y;\r\n\t\t\treturn dx * dx + dy * dy;\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanDistanceTo: function ( v ) {\r\n\r\n\t\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y );\r\n\r\n\t\t},\r\n\r\n\t\tsetLength: function ( length ) {\r\n\r\n\t\t\treturn this.normalize().multiplyScalar( length );\r\n\r\n\t\t},\r\n\r\n\t\tlerp: function ( v, alpha ) {\r\n\r\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( v ) {\r\n\r\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tthis.x = array[ offset ];\r\n\t\t\tthis.y = array[ offset + 1 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) { array = []; }\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tarray[ offset ] = this.x;\r\n\t\t\tarray[ offset + 1 ] = this.y;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\tfromBufferAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector2: offset has been removed from .fromBufferAttribute().' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x = attribute.getX( index );\r\n\t\t\tthis.y = attribute.getY( index );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateAround: function ( center, angle ) {\r\n\r\n\t\t\tvar c = Math.cos( angle ), s = Math.sin( angle );\r\n\r\n\t\t\tvar x = this.x - center.x;\r\n\t\t\tvar y = this.y - center.y;\r\n\r\n\t\t\tthis.x = x * c - y * s + center.x;\r\n\t\t\tthis.y = x * s + y * c + center.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author bhouston / http://clara.io\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction Matrix3() {\r\n\r\n\t\tthis.elements = [\r\n\r\n\t\t\t1, 0, 0,\r\n\t\t\t0, 1, 0,\r\n\t\t\t0, 0, 1\r\n\r\n\t\t];\r\n\r\n\t\tif ( arguments.length > 0 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( Matrix3.prototype, {\r\n\r\n\t\tisMatrix3: true,\r\n\r\n\t\tset: function ( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\r\n\t\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\r\n\t\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tidentity: function () {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0,\r\n\t\t\t\t0, 1, 0,\r\n\t\t\t\t0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().fromArray( this.elements );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( m ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ];\r\n\t\t\tte[ 3 ] = me[ 3 ]; te[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ];\r\n\t\t\tte[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ]; te[ 8 ] = me[ 8 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\textractBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\t\txAxis.setFromMatrix3Column( this, 0 );\r\n\t\t\tyAxis.setFromMatrix3Column( this, 1 );\r\n\t\t\tzAxis.setFromMatrix3Column( this, 2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrix4: function ( m ) {\r\n\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\tme[ 0 ], me[ 4 ], me[ 8 ],\r\n\t\t\t\tme[ 1 ], me[ 5 ], me[ 9 ],\r\n\t\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( m ) {\r\n\r\n\t\t\treturn this.multiplyMatrices( this, m );\r\n\r\n\t\t},\r\n\r\n\t\tpremultiply: function ( m ) {\r\n\r\n\t\t\treturn this.multiplyMatrices( m, this );\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyMatrices: function ( a, b ) {\r\n\r\n\t\t\tvar ae = a.elements;\r\n\t\t\tvar be = b.elements;\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar a11 = ae[ 0 ], a12 = ae[ 3 ], a13 = ae[ 6 ];\r\n\t\t\tvar a21 = ae[ 1 ], a22 = ae[ 4 ], a23 = ae[ 7 ];\r\n\t\t\tvar a31 = ae[ 2 ], a32 = ae[ 5 ], a33 = ae[ 8 ];\r\n\r\n\t\t\tvar b11 = be[ 0 ], b12 = be[ 3 ], b13 = be[ 6 ];\r\n\t\t\tvar b21 = be[ 1 ], b22 = be[ 4 ], b23 = be[ 7 ];\r\n\t\t\tvar b31 = be[ 2 ], b32 = be[ 5 ], b33 = be[ 8 ];\r\n\r\n\t\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31;\r\n\t\t\tte[ 3 ] = a11 * b12 + a12 * b22 + a13 * b32;\r\n\t\t\tte[ 6 ] = a11 * b13 + a12 * b23 + a13 * b33;\r\n\r\n\t\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31;\r\n\t\t\tte[ 4 ] = a21 * b12 + a22 * b22 + a23 * b32;\r\n\t\t\tte[ 7 ] = a21 * b13 + a22 * b23 + a23 * b33;\r\n\r\n\t\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31;\r\n\t\t\tte[ 5 ] = a31 * b12 + a32 * b22 + a33 * b32;\r\n\t\t\tte[ 8 ] = a31 * b13 + a32 * b23 + a33 * b33;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( s ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\r\n\t\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\r\n\t\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdeterminant: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\r\n\t\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\r\n\t\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\r\n\r\n\t\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\r\n\r\n\t\t},\r\n\r\n\t\tgetInverse: function ( matrix, throwOnDegenerate ) {\r\n\r\n\t\t\tif ( throwOnDegenerate !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar me = matrix.elements,\r\n\t\t\t\tte = this.elements,\r\n\r\n\t\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ],\r\n\t\t\t\tn12 = me[ 3 ], n22 = me[ 4 ], n32 = me[ 5 ],\r\n\t\t\t\tn13 = me[ 6 ], n23 = me[ 7 ], n33 = me[ 8 ],\r\n\r\n\t\t\t\tt11 = n33 * n22 - n32 * n23,\r\n\t\t\t\tt12 = n32 * n13 - n33 * n12,\r\n\t\t\t\tt13 = n23 * n12 - n22 * n13,\r\n\r\n\t\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\r\n\r\n\t\t\tif ( det === 0 ) { return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0 ); }\r\n\r\n\t\t\tvar detInv = 1 / det;\r\n\r\n\t\t\tte[ 0 ] = t11 * detInv;\r\n\t\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\r\n\t\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\r\n\r\n\t\t\tte[ 3 ] = t12 * detInv;\r\n\t\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\r\n\t\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\r\n\r\n\t\t\tte[ 6 ] = t13 * detInv;\r\n\t\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\r\n\t\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranspose: function () {\r\n\r\n\t\t\tvar tmp, m = this.elements;\r\n\r\n\t\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\r\n\t\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\r\n\t\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetNormalMatrix: function ( matrix4 ) {\r\n\r\n\t\t\treturn this.setFromMatrix4( matrix4 ).getInverse( this ).transpose();\r\n\r\n\t\t},\r\n\r\n\t\ttransposeIntoArray: function ( r ) {\r\n\r\n\t\t\tvar m = this.elements;\r\n\r\n\t\t\tr[ 0 ] = m[ 0 ];\r\n\t\t\tr[ 1 ] = m[ 3 ];\r\n\t\t\tr[ 2 ] = m[ 6 ];\r\n\t\t\tr[ 3 ] = m[ 1 ];\r\n\t\t\tr[ 4 ] = m[ 4 ];\r\n\t\t\tr[ 5 ] = m[ 7 ];\r\n\t\t\tr[ 6 ] = m[ 2 ];\r\n\t\t\tr[ 7 ] = m[ 5 ];\r\n\t\t\tr[ 8 ] = m[ 8 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetUvTransform: function ( tx, ty, sx, sy, rotation, cx, cy ) {\r\n\r\n\t\t\tvar c = Math.cos( rotation );\r\n\t\t\tvar s = Math.sin( rotation );\r\n\r\n\t\t\tthis.set(\r\n\t\t\t\tsx * c, sx * s, - sx * ( c * cx + s * cy ) + cx + tx,\r\n\t\t\t\t- sy * s, sy * c, - sy * ( - s * cx + c * cy ) + cy + ty,\r\n\t\t\t\t0, 0, 1\r\n\t\t\t);\r\n\r\n\t\t},\r\n\r\n\t\tscale: function ( sx, sy ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] *= sx; te[ 3 ] *= sx; te[ 6 ] *= sx;\r\n\t\t\tte[ 1 ] *= sy; te[ 4 ] *= sy; te[ 7 ] *= sy;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotate: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta );\r\n\t\t\tvar s = Math.sin( theta );\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar a11 = te[ 0 ], a12 = te[ 3 ], a13 = te[ 6 ];\r\n\t\t\tvar a21 = te[ 1 ], a22 = te[ 4 ], a23 = te[ 7 ];\r\n\r\n\t\t\tte[ 0 ] = c * a11 + s * a21;\r\n\t\t\tte[ 3 ] = c * a12 + s * a22;\r\n\t\t\tte[ 6 ] = c * a13 + s * a23;\r\n\r\n\t\t\tte[ 1 ] = - s * a11 + c * a21;\r\n\t\t\tte[ 4 ] = - s * a12 + c * a22;\r\n\t\t\tte[ 7 ] = - s * a13 + c * a23;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( tx, ty ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] += tx * te[ 2 ]; te[ 3 ] += tx * te[ 5 ]; te[ 6 ] += tx * te[ 8 ];\r\n\t\t\tte[ 1 ] += ty * te[ 2 ]; te[ 4 ] += ty * te[ 5 ]; te[ 7 ] += ty * te[ 8 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( matrix ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = matrix.elements;\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tif ( te[ i ] !== me[ i ] ) { return false; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tthis.elements[ i ] = array[ i + offset ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) { array = []; }\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tarray[ offset ] = te[ 0 ];\r\n\t\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\r\n\t\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\t\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\r\n\t\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\t\t\tarray[ offset + 8 ] = te[ 8 ];\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author szimek / https://github.com/szimek/\r\n\t */\r\n\r\n\tvar _canvas;\r\n\r\n\tvar ImageUtils = {\r\n\r\n\t\tgetDataURL: function ( image ) {\r\n\r\n\t\t\tvar canvas;\r\n\r\n\t\t\tif ( typeof HTMLCanvasElement == 'undefined' ) {\r\n\r\n\t\t\t\treturn image.src;\r\n\r\n\t\t\t} else if ( image instanceof HTMLCanvasElement ) {\r\n\r\n\t\t\t\tcanvas = image;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( _canvas === undefined ) { _canvas = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' ); }\r\n\r\n\t\t\t\t_canvas.width = image.width;\r\n\t\t\t\t_canvas.height = image.height;\r\n\r\n\t\t\t\tvar context = _canvas.getContext( '2d' );\r\n\r\n\t\t\t\tif ( image instanceof ImageData ) {\r\n\r\n\t\t\t\t\tcontext.putImageData( image, 0, 0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcanvas = _canvas;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn canvas.toDataURL( 'image/png' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author szimek / https://github.com/szimek/\r\n\t */\r\n\r\n\tvar textureId = 0;\r\n\r\n\tfunction Texture( image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: textureId ++ } );\r\n\r\n\t\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\r\n\t\tthis.image = image !== undefined ? image : Texture.DEFAULT_IMAGE;\r\n\t\tthis.mipmaps = [];\r\n\r\n\t\tthis.mapping = mapping !== undefined ? mapping : Texture.DEFAULT_MAPPING;\r\n\r\n\t\tthis.wrapS = wrapS !== undefined ? wrapS : ClampToEdgeWrapping;\r\n\t\tthis.wrapT = wrapT !== undefined ? wrapT : ClampToEdgeWrapping;\r\n\r\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : LinearFilter;\r\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : LinearMipmapLinearFilter;\r\n\r\n\t\tthis.anisotropy = anisotropy !== undefined ? anisotropy : 1;\r\n\r\n\t\tthis.format = format !== undefined ? format : RGBAFormat;\r\n\t\tthis.internalFormat = null;\r\n\t\tthis.type = type !== undefined ? type : UnsignedByteType;\r\n\r\n\t\tthis.offset = new Vector2( 0, 0 );\r\n\t\tthis.repeat = new Vector2( 1, 1 );\r\n\t\tthis.center = new Vector2( 0, 0 );\r\n\t\tthis.rotation = 0;\r\n\r\n\t\tthis.matrixAutoUpdate = true;\r\n\t\tthis.matrix = new Matrix3();\r\n\r\n\t\tthis.generateMipmaps = true;\r\n\t\tthis.premultiplyAlpha = false;\r\n\t\tthis.flipY = true;\r\n\t\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\r\n\r\n\t\t// Values of encoding !== THREE.LinearEncoding only supported on map, envMap and emissiveMap.\r\n\t\t//\r\n\t\t// Also changing the encoding after already used by a Material will not automatically make the Material\r\n\t\t// update. You need to explicitly call Material.needsUpdate to trigger it to recompile.\r\n\t\tthis.encoding = encoding !== undefined ? encoding : LinearEncoding;\r\n\r\n\t\tthis.version = 0;\r\n\t\tthis.onUpdate = null;\r\n\r\n\t}\r\n\r\n\tTexture.DEFAULT_IMAGE = undefined;\r\n\tTexture.DEFAULT_MAPPING = UVMapping;\r\n\r\n\tTexture.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: Texture,\r\n\r\n\t\tisTexture: true,\r\n\r\n\t\tupdateMatrix: function () {\r\n\r\n\t\t\tthis.matrix.setUvTransform( this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\tthis.image = source.image;\r\n\t\t\tthis.mipmaps = source.mipmaps.slice( 0 );\r\n\r\n\t\t\tthis.mapping = source.mapping;\r\n\r\n\t\t\tthis.wrapS = source.wrapS;\r\n\t\t\tthis.wrapT = source.wrapT;\r\n\r\n\t\t\tthis.magFilter = source.magFilter;\r\n\t\t\tthis.minFilter = source.minFilter;\r\n\r\n\t\t\tthis.anisotropy = source.anisotropy;\r\n\r\n\t\t\tthis.format = source.format;\r\n\t\t\tthis.internalFormat = source.internalFormat;\r\n\t\t\tthis.type = source.type;\r\n\r\n\t\t\tthis.offset.copy( source.offset );\r\n\t\t\tthis.repeat.copy( source.repeat );\r\n\t\t\tthis.center.copy( source.center );\r\n\t\t\tthis.rotation = source.rotation;\r\n\r\n\t\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\t\t\tthis.matrix.copy( source.matrix );\r\n\r\n\t\t\tthis.generateMipmaps = source.generateMipmaps;\r\n\t\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\r\n\t\t\tthis.flipY = source.flipY;\r\n\t\t\tthis.unpackAlignment = source.unpackAlignment;\r\n\t\t\tthis.encoding = source.encoding;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar isRootObject = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\t\t\tif ( ! isRootObject && meta.textures[ this.uuid ] !== undefined ) {\r\n\r\n\t\t\t\treturn meta.textures[ this.uuid ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar output = {\r\n\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Texture',\r\n\t\t\t\t\tgenerator: 'Texture.toJSON'\r\n\t\t\t\t},\r\n\r\n\t\t\t\tuuid: this.uuid,\r\n\t\t\t\tname: this.name,\r\n\r\n\t\t\t\tmapping: this.mapping,\r\n\r\n\t\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\r\n\t\t\t\toffset: [ this.offset.x, this.offset.y ],\r\n\t\t\t\tcenter: [ this.center.x, this.center.y ],\r\n\t\t\t\trotation: this.rotation,\r\n\r\n\t\t\t\twrap: [ this.wrapS, this.wrapT ],\r\n\r\n\t\t\t\tformat: this.format,\r\n\t\t\t\ttype: this.type,\r\n\t\t\t\tencoding: this.encoding,\r\n\r\n\t\t\t\tminFilter: this.minFilter,\r\n\t\t\t\tmagFilter: this.magFilter,\r\n\t\t\t\tanisotropy: this.anisotropy,\r\n\r\n\t\t\t\tflipY: this.flipY,\r\n\r\n\t\t\t\tpremultiplyAlpha: this.premultiplyAlpha,\r\n\t\t\t\tunpackAlignment: this.unpackAlignment\r\n\r\n\t\t\t};\r\n\r\n\t\t\tif ( this.image !== undefined ) {\r\n\r\n\t\t\t\t// TODO: Move to THREE.Image\r\n\r\n\t\t\t\tvar image = this.image;\r\n\r\n\t\t\t\tif ( image.uuid === undefined ) {\r\n\r\n\t\t\t\t\timage.uuid = MathUtils.generateUUID(); // UGH\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! isRootObject && meta.images[ image.uuid ] === undefined ) {\r\n\r\n\t\t\t\t\tvar url;\r\n\r\n\t\t\t\t\tif ( Array.isArray( image ) ) {\r\n\r\n\t\t\t\t\t\t// process array of images e.g. CubeTexture\r\n\r\n\t\t\t\t\t\turl = [];\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, l = image.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\turl.push( ImageUtils.getDataURL( image[ i ] ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// process single image\r\n\r\n\t\t\t\t\t\turl = ImageUtils.getDataURL( image );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmeta.images[ image.uuid ] = {\r\n\t\t\t\t\t\tuuid: image.uuid,\r\n\t\t\t\t\t\turl: url\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\toutput.image = image.uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! isRootObject ) {\r\n\r\n\t\t\t\tmeta.textures[ this.uuid ] = output;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn output;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t},\r\n\r\n\t\ttransformUv: function ( uv ) {\r\n\r\n\t\t\tif ( this.mapping !== UVMapping ) { return uv; }\r\n\r\n\t\t\tuv.applyMatrix3( this.matrix );\r\n\r\n\t\t\tif ( uv.x < 0 || uv.x > 1 ) {\r\n\r\n\t\t\t\tswitch ( this.wrapS ) {\r\n\r\n\t\t\t\t\tcase RepeatWrapping:\r\n\r\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uv.y < 0 || uv.y > 1 ) {\r\n\r\n\t\t\t\tswitch ( this.wrapT ) {\r\n\r\n\t\t\t\t\tcase RepeatWrapping:\r\n\r\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase ClampToEdgeWrapping:\r\n\r\n\t\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase MirroredRepeatWrapping:\r\n\r\n\t\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\r\n\r\n\t\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.flipY ) {\r\n\r\n\t\t\t\tuv.y = 1 - uv.y;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn uv;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperty( Texture.prototype, \"needsUpdate\", {\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value === true ) { this.version ++; }\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author egraether / http://egraether.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction Vector4( x, y, z, w ) {\r\n\r\n\t\tthis.x = x || 0;\r\n\t\tthis.y = y || 0;\r\n\t\tthis.z = z || 0;\r\n\t\tthis.w = ( w !== undefined ) ? w : 1;\r\n\r\n\t}\r\n\r\n\tObject.defineProperties( Vector4.prototype, {\r\n\r\n\t\t\"width\": {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.z;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis.z = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t\"height\": {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.w;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis.w = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Vector4.prototype, {\r\n\r\n\t\tisVector4: true,\r\n\r\n\t\tset: function ( x, y, z, w ) {\r\n\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\t\t\tthis.z = z;\r\n\t\t\tthis.w = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x = scalar;\r\n\t\t\tthis.y = scalar;\r\n\t\t\tthis.z = scalar;\r\n\t\t\tthis.w = scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetX: function ( x ) {\r\n\r\n\t\t\tthis.x = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( y ) {\r\n\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetZ: function ( z ) {\r\n\r\n\t\t\tthis.z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetW: function ( w ) {\r\n\r\n\t\t\tthis.w = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetComponent: function ( index, value ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: this.x = value; break;\r\n\t\t\t\tcase 1: this.y = value; break;\r\n\t\t\t\tcase 2: this.z = value; break;\r\n\t\t\t\tcase 3: this.w = value; break;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetComponent: function ( index ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: return this.x;\r\n\t\t\t\tcase 1: return this.y;\r\n\t\t\t\tcase 2: return this.z;\r\n\t\t\t\tcase 3: return this.w;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( v ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\t\t\tthis.y = v.y;\r\n\t\t\tthis.z = v.z;\r\n\t\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tadd: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\t\t\tthis.z += v.z;\r\n\t\t\tthis.w += v.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScalar: function ( s ) {\r\n\r\n\t\t\tthis.x += s;\r\n\t\t\tthis.y += s;\r\n\t\t\tthis.z += s;\r\n\t\t\tthis.w += s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x + b.x;\r\n\t\t\tthis.y = a.y + b.y;\r\n\t\t\tthis.z = a.z + b.z;\r\n\t\t\tthis.w = a.w + b.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScaledVector: function ( v, s ) {\r\n\r\n\t\t\tthis.x += v.x * s;\r\n\t\t\tthis.y += v.y * s;\r\n\t\t\tthis.z += v.z * s;\r\n\t\t\tthis.w += v.w * s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsub: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x -= v.x;\r\n\t\t\tthis.y -= v.y;\r\n\t\t\tthis.z -= v.z;\r\n\t\t\tthis.w -= v.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubScalar: function ( s ) {\r\n\r\n\t\t\tthis.x -= s;\r\n\t\t\tthis.y -= s;\r\n\t\t\tthis.z -= s;\r\n\t\t\tthis.w -= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x - b.x;\r\n\t\t\tthis.y = a.y - b.y;\r\n\t\t\tthis.z = a.z - b.z;\r\n\t\t\tthis.w = a.w - b.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\t\t\tthis.w *= scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z, w = this.w;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\r\n\t\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdivideScalar: function ( scalar ) {\r\n\r\n\t\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t\t},\r\n\r\n\t\tsetAxisAngleFromQuaternion: function ( q ) {\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\r\n\r\n\t\t\t// q is assumed to be normalized\r\n\r\n\t\t\tthis.w = 2 * Math.acos( q.w );\r\n\r\n\t\t\tvar s = Math.sqrt( 1 - q.w * q.w );\r\n\r\n\t\t\tif ( s < 0.0001 ) {\r\n\r\n\t\t\t\tthis.x = 1;\r\n\t\t\t\tthis.y = 0;\r\n\t\t\t\tthis.z = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.x = q.x / s;\r\n\t\t\t\tthis.y = q.y / s;\r\n\t\t\t\tthis.z = q.z / s;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetAxisAngleFromRotationMatrix: function ( m ) {\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\r\n\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\t\tvar angle, x, y, z,\t\t// variables for result\r\n\t\t\t\tepsilon = 0.01,\t\t// margin to allow for rounding errors\r\n\t\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\r\n\r\n\t\t\t\tte = m.elements,\r\n\r\n\t\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\r\n\t\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\r\n\t\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\r\n\r\n\t\t\t\t// singularity found\r\n\t\t\t\t// first check for identity matrix which must have +1 for all terms\r\n\t\t\t\t// in leading diagonal and zero in other terms\r\n\r\n\t\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\r\n\t\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\r\n\t\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\r\n\t\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\r\n\r\n\t\t\t\t\t// this singularity is identity matrix so angle = 0\r\n\r\n\t\t\t\t\tthis.set( 1, 0, 0, 0 );\r\n\r\n\t\t\t\t\treturn this; // zero angle, arbitrary axis\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// otherwise this singularity is angle = 180\r\n\r\n\t\t\t\tangle = Math.PI;\r\n\r\n\t\t\t\tvar xx = ( m11 + 1 ) / 2;\r\n\t\t\t\tvar yy = ( m22 + 1 ) / 2;\r\n\t\t\t\tvar zz = ( m33 + 1 ) / 2;\r\n\t\t\t\tvar xy = ( m12 + m21 ) / 4;\r\n\t\t\t\tvar xz = ( m13 + m31 ) / 4;\r\n\t\t\t\tvar yz = ( m23 + m32 ) / 4;\r\n\r\n\t\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\r\n\r\n\t\t\t\t\t// m11 is the largest diagonal term\r\n\r\n\t\t\t\t\tif ( xx < epsilon ) {\r\n\r\n\t\t\t\t\t\tx = 0;\r\n\t\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tx = Math.sqrt( xx );\r\n\t\t\t\t\t\ty = xy / x;\r\n\t\t\t\t\t\tz = xz / x;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( yy > zz ) {\r\n\r\n\t\t\t\t\t// m22 is the largest diagonal term\r\n\r\n\t\t\t\t\tif ( yy < epsilon ) {\r\n\r\n\t\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\t\ty = 0;\r\n\t\t\t\t\t\tz = 0.707106781;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ty = Math.sqrt( yy );\r\n\t\t\t\t\t\tx = xy / y;\r\n\t\t\t\t\t\tz = yz / y;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// m33 is the largest diagonal term so base result on this\r\n\r\n\t\t\t\t\tif ( zz < epsilon ) {\r\n\r\n\t\t\t\t\t\tx = 0.707106781;\r\n\t\t\t\t\t\ty = 0.707106781;\r\n\t\t\t\t\t\tz = 0;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tz = Math.sqrt( zz );\r\n\t\t\t\t\t\tx = xz / z;\r\n\t\t\t\t\t\ty = yz / z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.set( x, y, z, angle );\r\n\r\n\t\t\t\treturn this; // return 180 deg rotation\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// as we have reached here there are no singularities so we can handle normally\r\n\r\n\t\t\tvar s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\r\n\t\t\t                   ( m13 - m31 ) * ( m13 - m31 ) +\r\n\t\t\t                   ( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\r\n\r\n\t\t\tif ( Math.abs( s ) < 0.001 ) { s = 1; }\r\n\r\n\t\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\r\n\t\t\t// caught by singularity test above, but I've left it in just in case\r\n\r\n\t\t\tthis.x = ( m32 - m23 ) / s;\r\n\t\t\tthis.y = ( m13 - m31 ) / s;\r\n\t\t\tthis.z = ( m21 - m12 ) / s;\r\n\t\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmin: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.min( this.x, v.x );\r\n\t\t\tthis.y = Math.min( this.y, v.y );\r\n\t\t\tthis.z = Math.min( this.z, v.z );\r\n\t\t\tthis.w = Math.min( this.w, v.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmax: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.max( this.x, v.x );\r\n\t\t\tthis.y = Math.max( this.y, v.y );\r\n\t\t\tthis.z = Math.max( this.z, v.z );\r\n\t\t\tthis.w = Math.max( this.w, v.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclamp: function ( min, max ) {\r\n\r\n\t\t\t// assumes min < max, componentwise\r\n\r\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\t\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclampScalar: function ( minVal, maxVal ) {\r\n\r\n\t\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\r\n\t\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\r\n\t\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\r\n\t\t\tthis.w = Math.max( minVal, Math.min( maxVal, this.w ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclampLength: function ( min, max ) {\r\n\r\n\t\t\tvar length = this.length();\r\n\r\n\t\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\r\n\r\n\t\t},\r\n\r\n\t\tfloor: function () {\r\n\r\n\t\t\tthis.x = Math.floor( this.x );\r\n\t\t\tthis.y = Math.floor( this.y );\r\n\t\t\tthis.z = Math.floor( this.z );\r\n\t\t\tthis.w = Math.floor( this.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tceil: function () {\r\n\r\n\t\t\tthis.x = Math.ceil( this.x );\r\n\t\t\tthis.y = Math.ceil( this.y );\r\n\t\t\tthis.z = Math.ceil( this.z );\r\n\t\t\tthis.w = Math.ceil( this.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tround: function () {\r\n\r\n\t\t\tthis.x = Math.round( this.x );\r\n\t\t\tthis.y = Math.round( this.y );\r\n\t\t\tthis.z = Math.round( this.z );\r\n\t\t\tthis.w = Math.round( this.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\troundToZero: function () {\r\n\r\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\t\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnegate: function () {\r\n\r\n\t\t\tthis.x = - this.x;\r\n\t\t\tthis.y = - this.y;\r\n\t\t\tthis.z = - this.z;\r\n\t\t\tthis.w = - this.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdot: function ( v ) {\r\n\r\n\t\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\r\n\r\n\t\t},\r\n\r\n\t\tlengthSq: function () {\r\n\r\n\t\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\r\n\r\n\t\t},\r\n\r\n\t\tlength: function () {\r\n\r\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanLength: function () {\r\n\r\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\treturn this.divideScalar( this.length() || 1 );\r\n\r\n\t\t},\r\n\r\n\t\tsetLength: function ( length ) {\r\n\r\n\t\t\treturn this.normalize().multiplyScalar( length );\r\n\r\n\t\t},\r\n\r\n\t\tlerp: function ( v, alpha ) {\r\n\r\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\t\t\tthis.w += ( v.w - this.w ) * alpha;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( v ) {\r\n\r\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tthis.x = array[ offset ];\r\n\t\t\tthis.y = array[ offset + 1 ];\r\n\t\t\tthis.z = array[ offset + 2 ];\r\n\t\t\tthis.w = array[ offset + 3 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) { array = []; }\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tarray[ offset ] = this.x;\r\n\t\t\tarray[ offset + 1 ] = this.y;\r\n\t\t\tarray[ offset + 2 ] = this.z;\r\n\t\t\tarray[ offset + 3 ] = this.w;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\tfromBufferAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: offset has been removed from .fromBufferAttribute().' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x = attribute.getX( index );\r\n\t\t\tthis.y = attribute.getY( index );\r\n\t\t\tthis.z = attribute.getZ( index );\r\n\t\t\tthis.w = attribute.getW( index );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author szimek / https://github.com/szimek/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author Marius Kintel / https://github.com/kintel\r\n\t */\r\n\r\n\t/*\r\n\t In options, we can specify:\r\n\t * Texture parameters for an auto-generated target texture\r\n\t * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\r\n\t*/\r\n\tfunction WebGLRenderTarget( width, height, options ) {\r\n\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\r\n\t\tthis.scissor = new Vector4( 0, 0, width, height );\r\n\t\tthis.scissorTest = false;\r\n\r\n\t\tthis.viewport = new Vector4( 0, 0, width, height );\r\n\r\n\t\toptions = options || {};\r\n\r\n\t\tthis.texture = new Texture( undefined, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.encoding );\r\n\r\n\t\tthis.texture.image = {};\r\n\t\tthis.texture.image.width = width;\r\n\t\tthis.texture.image.height = height;\r\n\r\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : false;\r\n\t\tthis.texture.minFilter = options.minFilter !== undefined ? options.minFilter : LinearFilter;\r\n\r\n\t\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\r\n\t\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\r\n\t\tthis.depthTexture = options.depthTexture !== undefined ? options.depthTexture : null;\r\n\r\n\t}\r\n\r\n\tWebGLRenderTarget.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: WebGLRenderTarget,\r\n\r\n\t\tisWebGLRenderTarget: true,\r\n\r\n\t\tsetSize: function ( width, height ) {\r\n\r\n\t\t\tif ( this.width !== width || this.height !== height ) {\r\n\r\n\t\t\t\tthis.width = width;\r\n\t\t\t\tthis.height = height;\r\n\r\n\t\t\t\tthis.texture.image.width = width;\r\n\t\t\t\tthis.texture.image.height = height;\r\n\r\n\t\t\t\tthis.dispose();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.viewport.set( 0, 0, width, height );\r\n\t\t\tthis.scissor.set( 0, 0, width, height );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.width = source.width;\r\n\t\t\tthis.height = source.height;\r\n\r\n\t\t\tthis.viewport.copy( source.viewport );\r\n\r\n\t\t\tthis.texture = source.texture.clone();\r\n\r\n\t\t\tthis.depthBuffer = source.depthBuffer;\r\n\t\t\tthis.stencilBuffer = source.stencilBuffer;\r\n\t\t\tthis.depthTexture = source.depthTexture;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t * @author Matt DesLauriers / @mattdesl\r\n\t */\r\n\r\n\tfunction WebGLMultisampleRenderTarget( width, height, options ) {\r\n\r\n\t\tWebGLRenderTarget.call( this, width, height, options );\r\n\r\n\t\tthis.samples = 4;\r\n\r\n\t}\r\n\r\n\tWebGLMultisampleRenderTarget.prototype = Object.assign( Object.create( WebGLRenderTarget.prototype ), {\r\n\r\n\t\tconstructor: WebGLMultisampleRenderTarget,\r\n\r\n\t\tisWebGLMultisampleRenderTarget: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tWebGLRenderTarget.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.samples = source.samples;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tfunction Quaternion( x, y, z, w ) {\r\n\r\n\t\tthis._x = x || 0;\r\n\t\tthis._y = y || 0;\r\n\t\tthis._z = z || 0;\r\n\t\tthis._w = ( w !== undefined ) ? w : 1;\r\n\r\n\t}\r\n\r\n\tObject.assign( Quaternion, {\r\n\r\n\t\tslerp: function ( qa, qb, qm, t ) {\r\n\r\n\t\t\treturn qm.copy( qa ).slerp( qb, t );\r\n\r\n\t\t},\r\n\r\n\t\tslerpFlat: function ( dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\r\n\r\n\t\t\t// fuzz-free, array-based Quaternion SLERP operation\r\n\r\n\t\t\tvar x0 = src0[ srcOffset0 + 0 ],\r\n\t\t\t\ty0 = src0[ srcOffset0 + 1 ],\r\n\t\t\t\tz0 = src0[ srcOffset0 + 2 ],\r\n\t\t\t\tw0 = src0[ srcOffset0 + 3 ],\r\n\r\n\t\t\t\tx1 = src1[ srcOffset1 + 0 ],\r\n\t\t\t\ty1 = src1[ srcOffset1 + 1 ],\r\n\t\t\t\tz1 = src1[ srcOffset1 + 2 ],\r\n\t\t\t\tw1 = src1[ srcOffset1 + 3 ];\r\n\r\n\t\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\r\n\r\n\t\t\t\tvar s = 1 - t,\r\n\r\n\t\t\t\t\tcos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\r\n\r\n\t\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\r\n\t\t\t\t\tsqrSin = 1 - cos * cos;\r\n\r\n\t\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\r\n\t\t\t\tif ( sqrSin > Number.EPSILON ) {\r\n\r\n\t\t\t\t\tvar sin = Math.sqrt( sqrSin ),\r\n\t\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\r\n\r\n\t\t\t\t\ts = Math.sin( s * len ) / sin;\r\n\t\t\t\t\tt = Math.sin( t * len ) / sin;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar tDir = t * dir;\r\n\r\n\t\t\t\tx0 = x0 * s + x1 * tDir;\r\n\t\t\t\ty0 = y0 * s + y1 * tDir;\r\n\t\t\t\tz0 = z0 * s + z1 * tDir;\r\n\t\t\t\tw0 = w0 * s + w1 * tDir;\r\n\r\n\t\t\t\t// Normalize in case we just did a lerp:\r\n\t\t\t\tif ( s === 1 - t ) {\r\n\r\n\t\t\t\t\tvar f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\r\n\r\n\t\t\t\t\tx0 *= f;\r\n\t\t\t\t\ty0 *= f;\r\n\t\t\t\t\tz0 *= f;\r\n\t\t\t\t\tw0 *= f;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdst[ dstOffset ] = x0;\r\n\t\t\tdst[ dstOffset + 1 ] = y0;\r\n\t\t\tdst[ dstOffset + 2 ] = z0;\r\n\t\t\tdst[ dstOffset + 3 ] = w0;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( Quaternion.prototype, {\r\n\r\n\t\tx: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._x;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._x = value;\r\n\t\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ty: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._y;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._y = value;\r\n\t\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tz: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._z;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._z = value;\r\n\t\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tw: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._w;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._w = value;\r\n\t\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Quaternion.prototype, {\r\n\r\n\t\tisQuaternion: true,\r\n\r\n\t\tset: function ( x, y, z, w ) {\r\n\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\t\t\tthis._w = w;\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( quaternion ) {\r\n\r\n\t\t\tthis._x = quaternion.x;\r\n\t\t\tthis._y = quaternion.y;\r\n\t\t\tthis._z = quaternion.z;\r\n\t\t\tthis._w = quaternion.w;\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromEuler: function ( euler, update ) {\r\n\r\n\t\t\tif ( ! ( euler && euler.isEuler ) ) {\r\n\r\n\t\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar x = euler._x, y = euler._y, z = euler._z, order = euler.order;\r\n\r\n\t\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\r\n\t\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\r\n\t\t\t//\tcontent/SpinCalc.m\r\n\r\n\t\t\tvar cos = Math.cos;\r\n\t\t\tvar sin = Math.sin;\r\n\r\n\t\t\tvar c1 = cos( x / 2 );\r\n\t\t\tvar c2 = cos( y / 2 );\r\n\t\t\tvar c3 = cos( z / 2 );\r\n\r\n\t\t\tvar s1 = sin( x / 2 );\r\n\t\t\tvar s2 = sin( y / 2 );\r\n\t\t\tvar s3 = sin( z / 2 );\r\n\r\n\t\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\r\n\r\n\t\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\r\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\r\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\r\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( update !== false ) { this._onChangeCallback(); }\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\r\n\r\n\t\t\t// assumes axis is normalized\r\n\r\n\t\t\tvar halfAngle = angle / 2, s = Math.sin( halfAngle );\r\n\r\n\t\t\tthis._x = axis.x * s;\r\n\t\t\tthis._y = axis.y * s;\r\n\t\t\tthis._z = axis.z * s;\r\n\t\t\tthis._w = Math.cos( halfAngle );\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromRotationMatrix: function ( m ) {\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\r\n\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\t\tvar te = m.elements,\r\n\r\n\t\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\r\n\t\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\r\n\t\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\r\n\r\n\t\t\t\ttrace = m11 + m22 + m33,\r\n\t\t\t\ts;\r\n\r\n\t\t\tif ( trace > 0 ) {\r\n\r\n\t\t\t\ts = 0.5 / Math.sqrt( trace + 1.0 );\r\n\r\n\t\t\t\tthis._w = 0.25 / s;\r\n\t\t\t\tthis._x = ( m32 - m23 ) * s;\r\n\t\t\t\tthis._y = ( m13 - m31 ) * s;\r\n\t\t\t\tthis._z = ( m21 - m12 ) * s;\r\n\r\n\t\t\t} else if ( m11 > m22 && m11 > m33 ) {\r\n\r\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\r\n\r\n\t\t\t\tthis._w = ( m32 - m23 ) / s;\r\n\t\t\t\tthis._x = 0.25 * s;\r\n\t\t\t\tthis._y = ( m12 + m21 ) / s;\r\n\t\t\t\tthis._z = ( m13 + m31 ) / s;\r\n\r\n\t\t\t} else if ( m22 > m33 ) {\r\n\r\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\r\n\r\n\t\t\t\tthis._w = ( m13 - m31 ) / s;\r\n\t\t\t\tthis._x = ( m12 + m21 ) / s;\r\n\t\t\t\tthis._y = 0.25 * s;\r\n\t\t\t\tthis._z = ( m23 + m32 ) / s;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ts = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\r\n\r\n\t\t\t\tthis._w = ( m21 - m12 ) / s;\r\n\t\t\t\tthis._x = ( m13 + m31 ) / s;\r\n\t\t\t\tthis._y = ( m23 + m32 ) / s;\r\n\t\t\t\tthis._z = 0.25 * s;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromUnitVectors: function ( vFrom, vTo ) {\r\n\r\n\t\t\t// assumes direction vectors vFrom and vTo are normalized\r\n\r\n\t\t\tvar EPS = 0.000001;\r\n\r\n\t\t\tvar r = vFrom.dot( vTo ) + 1;\r\n\r\n\t\t\tif ( r < EPS ) {\r\n\r\n\t\t\t\tr = 0;\r\n\r\n\t\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\r\n\r\n\t\t\t\t\tthis._x = - vFrom.y;\r\n\t\t\t\t\tthis._y = vFrom.x;\r\n\t\t\t\t\tthis._z = 0;\r\n\t\t\t\t\tthis._w = r;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._x = 0;\r\n\t\t\t\t\tthis._y = - vFrom.z;\r\n\t\t\t\t\tthis._z = vFrom.y;\r\n\t\t\t\t\tthis._w = r;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3\r\n\r\n\t\t\t\tthis._x = vFrom.y * vTo.z - vFrom.z * vTo.y;\r\n\t\t\t\tthis._y = vFrom.z * vTo.x - vFrom.x * vTo.z;\r\n\t\t\t\tthis._z = vFrom.x * vTo.y - vFrom.y * vTo.x;\r\n\t\t\t\tthis._w = r;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.normalize();\r\n\r\n\t\t},\r\n\r\n\t\tangleTo: function ( q ) {\r\n\r\n\t\t\treturn 2 * Math.acos( Math.abs( MathUtils.clamp( this.dot( q ), - 1, 1 ) ) );\r\n\r\n\t\t},\r\n\r\n\t\trotateTowards: function ( q, step ) {\r\n\r\n\t\t\tvar angle = this.angleTo( q );\r\n\r\n\t\t\tif ( angle === 0 ) { return this; }\r\n\r\n\t\t\tvar t = Math.min( 1, step / angle );\r\n\r\n\t\t\tthis.slerp( q, t );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tinverse: function () {\r\n\r\n\t\t\t// quaternion is assumed to have unit length\r\n\r\n\t\t\treturn this.conjugate();\r\n\r\n\t\t},\r\n\r\n\t\tconjugate: function () {\r\n\r\n\t\t\tthis._x *= - 1;\r\n\t\t\tthis._y *= - 1;\r\n\t\t\tthis._z *= - 1;\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdot: function ( v ) {\r\n\r\n\t\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\r\n\r\n\t\t},\r\n\r\n\t\tlengthSq: function () {\r\n\r\n\t\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\r\n\r\n\t\t},\r\n\r\n\t\tlength: function () {\r\n\r\n\t\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\tvar l = this.length();\r\n\r\n\t\t\tif ( l === 0 ) {\r\n\r\n\t\t\t\tthis._x = 0;\r\n\t\t\t\tthis._y = 0;\r\n\t\t\t\tthis._z = 0;\r\n\t\t\t\tthis._w = 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tl = 1 / l;\r\n\r\n\t\t\t\tthis._x = this._x * l;\r\n\t\t\t\tthis._y = this._y * l;\r\n\t\t\t\tthis._z = this._z * l;\r\n\t\t\t\tthis._w = this._w * l;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( q, p ) {\r\n\r\n\t\t\tif ( p !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyQuaternions( q, p );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.multiplyQuaternions( this, q );\r\n\r\n\t\t},\r\n\r\n\t\tpremultiply: function ( q ) {\r\n\r\n\t\t\treturn this.multiplyQuaternions( q, this );\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyQuaternions: function ( a, b ) {\r\n\r\n\t\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\r\n\r\n\t\t\tvar qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\r\n\t\t\tvar qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\r\n\r\n\t\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\r\n\t\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\r\n\t\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\r\n\t\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tslerp: function ( qb, t ) {\r\n\r\n\t\t\tif ( t === 0 ) { return this; }\r\n\t\t\tif ( t === 1 ) { return this.copy( qb ); }\r\n\r\n\t\t\tvar x = this._x, y = this._y, z = this._z, w = this._w;\r\n\r\n\t\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\r\n\r\n\t\t\tvar cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\r\n\r\n\t\t\tif ( cosHalfTheta < 0 ) {\r\n\r\n\t\t\t\tthis._w = - qb._w;\r\n\t\t\t\tthis._x = - qb._x;\r\n\t\t\t\tthis._y = - qb._y;\r\n\t\t\t\tthis._z = - qb._z;\r\n\r\n\t\t\t\tcosHalfTheta = - cosHalfTheta;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.copy( qb );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( cosHalfTheta >= 1.0 ) {\r\n\r\n\t\t\t\tthis._w = w;\r\n\t\t\t\tthis._x = x;\r\n\t\t\t\tthis._y = y;\r\n\t\t\t\tthis._z = z;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\r\n\r\n\t\t\tif ( sqrSinHalfTheta <= Number.EPSILON ) {\r\n\r\n\t\t\t\tvar s = 1 - t;\r\n\t\t\t\tthis._w = s * w + t * this._w;\r\n\t\t\t\tthis._x = s * x + t * this._x;\r\n\t\t\t\tthis._y = s * y + t * this._y;\r\n\t\t\t\tthis._z = s * z + t * this._z;\r\n\r\n\t\t\t\tthis.normalize();\r\n\t\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar sinHalfTheta = Math.sqrt( sqrSinHalfTheta );\r\n\t\t\tvar halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\r\n\t\t\tvar ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\r\n\t\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\r\n\r\n\t\t\tthis._w = ( w * ratioA + this._w * ratioB );\r\n\t\t\tthis._x = ( x * ratioA + this._x * ratioB );\r\n\t\t\tthis._y = ( y * ratioA + this._y * ratioB );\r\n\t\t\tthis._z = ( z * ratioA + this._z * ratioB );\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( quaternion ) {\r\n\r\n\t\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tthis._x = array[ offset ];\r\n\t\t\tthis._y = array[ offset + 1 ];\r\n\t\t\tthis._z = array[ offset + 2 ];\r\n\t\t\tthis._w = array[ offset + 3 ];\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) { array = []; }\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tarray[ offset ] = this._x;\r\n\t\t\tarray[ offset + 1 ] = this._y;\r\n\t\t\tarray[ offset + 2 ] = this._z;\r\n\t\t\tarray[ offset + 3 ] = this._w;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\tfromBufferAttribute: function ( attribute, index ) {\r\n\r\n\t\t\tthis._x = attribute.getX( index );\r\n\t\t\tthis._y = attribute.getY( index );\r\n\t\t\tthis._z = attribute.getZ( index );\r\n\t\t\tthis._w = attribute.getW( index );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t_onChange: function ( callback ) {\r\n\r\n\t\t\tthis._onChangeCallback = callback;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t_onChangeCallback: function () {}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author kile / http://kile.stravaganza.org/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author egraether / http://egraether.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tvar _vector = new Vector3();\r\n\tvar _quaternion = new Quaternion();\r\n\r\n\tfunction Vector3( x, y, z ) {\r\n\r\n\t\tthis.x = x || 0;\r\n\t\tthis.y = y || 0;\r\n\t\tthis.z = z || 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Vector3.prototype, {\r\n\r\n\t\tisVector3: true,\r\n\r\n\t\tset: function ( x, y, z ) {\r\n\r\n\t\t\tthis.x = x;\r\n\t\t\tthis.y = y;\r\n\t\t\tthis.z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x = scalar;\r\n\t\t\tthis.y = scalar;\r\n\t\t\tthis.z = scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetX: function ( x ) {\r\n\r\n\t\t\tthis.x = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( y ) {\r\n\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetZ: function ( z ) {\r\n\r\n\t\t\tthis.z = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetComponent: function ( index, value ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: this.x = value; break;\r\n\t\t\t\tcase 1: this.y = value; break;\r\n\t\t\t\tcase 2: this.z = value; break;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetComponent: function ( index ) {\r\n\r\n\t\t\tswitch ( index ) {\r\n\r\n\t\t\t\tcase 0: return this.x;\r\n\t\t\t\tcase 1: return this.y;\r\n\t\t\t\tcase 2: return this.z;\r\n\t\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.x, this.y, this.z );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( v ) {\r\n\r\n\t\t\tthis.x = v.x;\r\n\t\t\tthis.y = v.y;\r\n\t\t\tthis.z = v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tadd: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\t\t\tthis.z += v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScalar: function ( s ) {\r\n\r\n\t\t\tthis.x += s;\r\n\t\t\tthis.y += s;\r\n\t\t\tthis.z += s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x + b.x;\r\n\t\t\tthis.y = a.y + b.y;\r\n\t\t\tthis.z = a.z + b.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScaledVector: function ( v, s ) {\r\n\r\n\t\t\tthis.x += v.x * s;\r\n\t\t\tthis.y += v.y * s;\r\n\t\t\tthis.z += v.z * s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsub: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.subVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x -= v.x;\r\n\t\t\tthis.y -= v.y;\r\n\t\t\tthis.z -= v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubScalar: function ( s ) {\r\n\r\n\t\t\tthis.x -= s;\r\n\t\t\tthis.y -= s;\r\n\t\t\tthis.z -= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsubVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x - b.x;\r\n\t\t\tthis.y = a.y - b.y;\r\n\t\t\tthis.z = a.z - b.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x *= v.x;\r\n\t\t\tthis.y *= v.y;\r\n\t\t\tthis.z *= v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.x *= scalar;\r\n\t\t\tthis.y *= scalar;\r\n\t\t\tthis.z *= scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyVectors: function ( a, b ) {\r\n\r\n\t\t\tthis.x = a.x * b.x;\r\n\t\t\tthis.y = a.y * b.y;\r\n\t\t\tthis.z = a.z * b.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyEuler: function ( euler ) {\r\n\r\n\t\t\tif ( ! ( euler && euler.isEuler ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.applyQuaternion( _quaternion.setFromEuler( euler ) );\r\n\r\n\t\t},\r\n\r\n\t\tapplyAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t\treturn this.applyQuaternion( _quaternion.setFromAxisAngle( axis, angle ) );\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix3: function ( m ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyNormalMatrix: function ( m ) {\r\n\r\n\t\t\treturn this.applyMatrix3( m ).normalize();\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tvar w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\r\n\r\n\t\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\r\n\t\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\r\n\t\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyQuaternion: function ( q ) {\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\t\tvar qx = q.x, qy = q.y, qz = q.z, qw = q.w;\r\n\r\n\t\t\t// calculate quat * vector\r\n\r\n\t\t\tvar ix = qw * x + qy * z - qz * y;\r\n\t\t\tvar iy = qw * y + qz * x - qx * z;\r\n\t\t\tvar iz = qw * z + qx * y - qy * x;\r\n\t\t\tvar iw = - qx * x - qy * y - qz * z;\r\n\r\n\t\t\t// calculate result * inverse quat\r\n\r\n\t\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\r\n\t\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\r\n\t\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tproject: function ( camera ) {\r\n\r\n\t\t\treturn this.applyMatrix4( camera.matrixWorldInverse ).applyMatrix4( camera.projectionMatrix );\r\n\r\n\t\t},\r\n\r\n\t\tunproject: function ( camera ) {\r\n\r\n\t\t\treturn this.applyMatrix4( camera.projectionMatrixInverse ).applyMatrix4( camera.matrixWorld );\r\n\r\n\t\t},\r\n\r\n\t\ttransformDirection: function ( m ) {\r\n\r\n\t\t\t// input: THREE.Matrix4 affine matrix\r\n\t\t\t// vector interpreted as a direction\r\n\r\n\t\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z;\r\n\t\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z;\r\n\t\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\r\n\t\t\treturn this.normalize();\r\n\r\n\t\t},\r\n\r\n\t\tdivide: function ( v ) {\r\n\r\n\t\t\tthis.x /= v.x;\r\n\t\t\tthis.y /= v.y;\r\n\t\t\tthis.z /= v.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdivideScalar: function ( scalar ) {\r\n\r\n\t\t\treturn this.multiplyScalar( 1 / scalar );\r\n\r\n\t\t},\r\n\r\n\t\tmin: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.min( this.x, v.x );\r\n\t\t\tthis.y = Math.min( this.y, v.y );\r\n\t\t\tthis.z = Math.min( this.z, v.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmax: function ( v ) {\r\n\r\n\t\t\tthis.x = Math.max( this.x, v.x );\r\n\t\t\tthis.y = Math.max( this.y, v.y );\r\n\t\t\tthis.z = Math.max( this.z, v.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclamp: function ( min, max ) {\r\n\r\n\t\t\t// assumes min < max, componentwise\r\n\r\n\t\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\r\n\t\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\r\n\t\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclampScalar: function ( minVal, maxVal ) {\r\n\r\n\t\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\r\n\t\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\r\n\t\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclampLength: function ( min, max ) {\r\n\r\n\t\t\tvar length = this.length();\r\n\r\n\t\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\r\n\r\n\t\t},\r\n\r\n\t\tfloor: function () {\r\n\r\n\t\t\tthis.x = Math.floor( this.x );\r\n\t\t\tthis.y = Math.floor( this.y );\r\n\t\t\tthis.z = Math.floor( this.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tceil: function () {\r\n\r\n\t\t\tthis.x = Math.ceil( this.x );\r\n\t\t\tthis.y = Math.ceil( this.y );\r\n\t\t\tthis.z = Math.ceil( this.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tround: function () {\r\n\r\n\t\t\tthis.x = Math.round( this.x );\r\n\t\t\tthis.y = Math.round( this.y );\r\n\t\t\tthis.z = Math.round( this.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\troundToZero: function () {\r\n\r\n\t\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\r\n\t\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\r\n\t\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnegate: function () {\r\n\r\n\t\t\tthis.x = - this.x;\r\n\t\t\tthis.y = - this.y;\r\n\t\t\tthis.z = - this.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdot: function ( v ) {\r\n\r\n\t\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\r\n\r\n\t\t},\r\n\r\n\t\t// TODO lengthSquared?\r\n\r\n\t\tlengthSq: function () {\r\n\r\n\t\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\r\n\r\n\t\t},\r\n\r\n\t\tlength: function () {\r\n\r\n\t\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanLength: function () {\r\n\r\n\t\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\treturn this.divideScalar( this.length() || 1 );\r\n\r\n\t\t},\r\n\r\n\t\tsetLength: function ( length ) {\r\n\r\n\t\t\treturn this.normalize().multiplyScalar( length );\r\n\r\n\t\t},\r\n\r\n\t\tlerp: function ( v, alpha ) {\r\n\r\n\t\t\tthis.x += ( v.x - this.x ) * alpha;\r\n\t\t\tthis.y += ( v.y - this.y ) * alpha;\r\n\t\t\tthis.z += ( v.z - this.z ) * alpha;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerpVectors: function ( v1, v2, alpha ) {\r\n\r\n\t\t\treturn this.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\r\n\r\n\t\t},\r\n\r\n\t\tcross: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.crossVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.crossVectors( this, v );\r\n\r\n\t\t},\r\n\r\n\t\tcrossVectors: function ( a, b ) {\r\n\r\n\t\t\tvar ax = a.x, ay = a.y, az = a.z;\r\n\t\t\tvar bx = b.x, by = b.y, bz = b.z;\r\n\r\n\t\t\tthis.x = ay * bz - az * by;\r\n\t\t\tthis.y = az * bx - ax * bz;\r\n\t\t\tthis.z = ax * by - ay * bx;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tprojectOnVector: function ( v ) {\r\n\r\n\t\t\tvar denominator = v.lengthSq();\r\n\r\n\t\t\tif ( denominator === 0 ) { return this.set( 0, 0, 0 ); }\r\n\r\n\t\t\tvar scalar = v.dot( this ) / denominator;\r\n\r\n\t\t\treturn this.copy( v ).multiplyScalar( scalar );\r\n\r\n\t\t},\r\n\r\n\t\tprojectOnPlane: function ( planeNormal ) {\r\n\r\n\t\t\t_vector.copy( this ).projectOnVector( planeNormal );\r\n\r\n\t\t\treturn this.sub( _vector );\r\n\r\n\t\t},\r\n\r\n\t\treflect: function ( normal ) {\r\n\r\n\t\t\t// reflect incident vector off plane orthogonal to normal\r\n\t\t\t// normal is assumed to have unit length\r\n\r\n\t\t\treturn this.sub( _vector.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\r\n\r\n\t\t},\r\n\r\n\t\tangleTo: function ( v ) {\r\n\r\n\t\t\tvar denominator = Math.sqrt( this.lengthSq() * v.lengthSq() );\r\n\r\n\t\t\tif ( denominator === 0 ) { return Math.PI / 2; }\r\n\r\n\t\t\tvar theta = this.dot( v ) / denominator;\r\n\r\n\t\t\t// clamp, to handle numerical problems\r\n\r\n\t\t\treturn Math.acos( MathUtils.clamp( theta, - 1, 1 ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceTo: function ( v ) {\r\n\r\n\t\t\treturn Math.sqrt( this.distanceToSquared( v ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToSquared: function ( v ) {\r\n\r\n\t\t\tvar dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\r\n\r\n\t\t\treturn dx * dx + dy * dy + dz * dz;\r\n\r\n\t\t},\r\n\r\n\t\tmanhattanDistanceTo: function ( v ) {\r\n\r\n\t\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y ) + Math.abs( this.z - v.z );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromSpherical: function ( s ) {\r\n\r\n\t\t\treturn this.setFromSphericalCoords( s.radius, s.phi, s.theta );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromSphericalCoords: function ( radius, phi, theta ) {\r\n\r\n\t\t\tvar sinPhiRadius = Math.sin( phi ) * radius;\r\n\r\n\t\t\tthis.x = sinPhiRadius * Math.sin( theta );\r\n\t\t\tthis.y = Math.cos( phi ) * radius;\r\n\t\t\tthis.z = sinPhiRadius * Math.cos( theta );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCylindrical: function ( c ) {\r\n\r\n\t\t\treturn this.setFromCylindricalCoords( c.radius, c.theta, c.y );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCylindricalCoords: function ( radius, theta, y ) {\r\n\r\n\t\t\tthis.x = radius * Math.sin( theta );\r\n\t\t\tthis.y = y;\r\n\t\t\tthis.z = radius * Math.cos( theta );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrixPosition: function ( m ) {\r\n\r\n\t\t\tvar e = m.elements;\r\n\r\n\t\t\tthis.x = e[ 12 ];\r\n\t\t\tthis.y = e[ 13 ];\r\n\t\t\tthis.z = e[ 14 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrixScale: function ( m ) {\r\n\r\n\t\t\tvar sx = this.setFromMatrixColumn( m, 0 ).length();\r\n\t\t\tvar sy = this.setFromMatrixColumn( m, 1 ).length();\r\n\t\t\tvar sz = this.setFromMatrixColumn( m, 2 ).length();\r\n\r\n\t\t\tthis.x = sx;\r\n\t\t\tthis.y = sy;\r\n\t\t\tthis.z = sz;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrixColumn: function ( m, index ) {\r\n\r\n\t\t\treturn this.fromArray( m.elements, index * 4 );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromMatrix3Column: function ( m, index ) {\r\n\r\n\t\t\treturn this.fromArray( m.elements, index * 3 );\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( v ) {\r\n\r\n\t\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tthis.x = array[ offset ];\r\n\t\t\tthis.y = array[ offset + 1 ];\r\n\t\t\tthis.z = array[ offset + 2 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) { array = []; }\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tarray[ offset ] = this.x;\r\n\t\t\tarray[ offset + 1 ] = this.y;\r\n\t\t\tarray[ offset + 2 ] = this.z;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\tfromBufferAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tif ( offset !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector3: offset has been removed from .fromBufferAttribute().' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x = attribute.getX( index );\r\n\t\t\tthis.y = attribute.getY( index );\r\n\t\t\tthis.z = attribute.getZ( index );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar _v1 = new Vector3();\r\n\tvar _m1 = new Matrix4();\r\n\tvar _zero = new Vector3( 0, 0, 0 );\r\n\tvar _one = new Vector3( 1, 1, 1 );\r\n\tvar _x = new Vector3();\r\n\tvar _y = new Vector3();\r\n\tvar _z = new Vector3();\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\r\n\t * @author philogb / http://blog.thejit.org/\r\n\t * @author jordi_ros / http://plattsoft.com\r\n\t * @author D1plo1d / http://github.com/D1plo1d\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author timknip / http://www.floorplanner.com/\r\n\t * @author bhouston / http://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction Matrix4() {\r\n\r\n\t\tthis.elements = [\r\n\r\n\t\t\t1, 0, 0, 0,\r\n\t\t\t0, 1, 0, 0,\r\n\t\t\t0, 0, 1, 0,\r\n\t\t\t0, 0, 0, 1\r\n\r\n\t\t];\r\n\r\n\t\tif ( arguments.length > 0 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( Matrix4.prototype, {\r\n\r\n\t\tisMatrix4: true,\r\n\r\n\t\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\r\n\t\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\r\n\t\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\r\n\t\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tidentity: function () {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t0, 1, 0, 0,\r\n\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new Matrix4().fromArray( this.elements );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( m ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ]; te[ 3 ] = me[ 3 ];\r\n\t\t\tte[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ]; te[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ];\r\n\t\t\tte[ 8 ] = me[ 8 ]; te[ 9 ] = me[ 9 ]; te[ 10 ] = me[ 10 ]; te[ 11 ] = me[ 11 ];\r\n\t\t\tte[ 12 ] = me[ 12 ]; te[ 13 ] = me[ 13 ]; te[ 14 ] = me[ 14 ]; te[ 15 ] = me[ 15 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyPosition: function ( m ) {\r\n\r\n\t\t\tvar te = this.elements, me = m.elements;\r\n\r\n\t\t\tte[ 12 ] = me[ 12 ];\r\n\t\t\tte[ 13 ] = me[ 13 ];\r\n\t\t\tte[ 14 ] = me[ 14 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\textractBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\t\txAxis.setFromMatrixColumn( this, 0 );\r\n\t\t\tyAxis.setFromMatrixColumn( this, 1 );\r\n\t\t\tzAxis.setFromMatrixColumn( this, 2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\t\tthis.set(\r\n\t\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\r\n\t\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\r\n\t\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\textractRotation: function ( m ) {\r\n\r\n\t\t\t// this method does not support reflection matrices\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tvar scaleX = 1 / _v1.setFromMatrixColumn( m, 0 ).length();\r\n\t\t\tvar scaleY = 1 / _v1.setFromMatrixColumn( m, 1 ).length();\r\n\t\t\tvar scaleZ = 1 / _v1.setFromMatrixColumn( m, 2 ).length();\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\r\n\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\r\n\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\r\n\t\t\tte[ 3 ] = 0;\r\n\r\n\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\r\n\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\r\n\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\r\n\t\t\tte[ 7 ] = 0;\r\n\r\n\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\r\n\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\r\n\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\r\n\t\t\tte[ 11 ] = 0;\r\n\r\n\t\t\tte[ 12 ] = 0;\r\n\t\t\tte[ 13 ] = 0;\r\n\t\t\tte[ 14 ] = 0;\r\n\t\t\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationFromEuler: function ( euler ) {\r\n\r\n\t\t\tif ( ! ( euler && euler.isEuler ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar x = euler.x, y = euler.y, z = euler.z;\r\n\t\t\tvar a = Math.cos( x ), b = Math.sin( x );\r\n\t\t\tvar c = Math.cos( y ), d = Math.sin( y );\r\n\t\t\tvar e = Math.cos( z ), f = Math.sin( z );\r\n\r\n\t\t\tif ( euler.order === 'XYZ' ) {\r\n\r\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = - c * f;\r\n\t\t\t\tte[ 8 ] = d;\r\n\r\n\t\t\t\tte[ 1 ] = af + be * d;\r\n\t\t\t\tte[ 5 ] = ae - bf * d;\r\n\t\t\t\tte[ 9 ] = - b * c;\r\n\r\n\t\t\t\tte[ 2 ] = bf - ae * d;\r\n\t\t\t\tte[ 6 ] = be + af * d;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'YXZ' ) {\r\n\r\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\t\tte[ 0 ] = ce + df * b;\r\n\t\t\t\tte[ 4 ] = de * b - cf;\r\n\t\t\t\tte[ 8 ] = a * d;\r\n\r\n\t\t\t\tte[ 1 ] = a * f;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = - b;\r\n\r\n\t\t\t\tte[ 2 ] = cf * b - de;\r\n\t\t\t\tte[ 6 ] = df + ce * b;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'ZXY' ) {\r\n\r\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\t\tte[ 0 ] = ce - df * b;\r\n\t\t\t\tte[ 4 ] = - a * f;\r\n\t\t\t\tte[ 8 ] = de + cf * b;\r\n\r\n\t\t\t\tte[ 1 ] = cf + de * b;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = df - ce * b;\r\n\r\n\t\t\t\tte[ 2 ] = - a * d;\r\n\t\t\t\tte[ 6 ] = b;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'ZYX' ) {\r\n\r\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = be * d - af;\r\n\t\t\t\tte[ 8 ] = ae * d + bf;\r\n\r\n\t\t\t\tte[ 1 ] = c * f;\r\n\t\t\t\tte[ 5 ] = bf * d + ae;\r\n\t\t\t\tte[ 9 ] = af * d - be;\r\n\r\n\t\t\t\tte[ 2 ] = - d;\r\n\t\t\t\tte[ 6 ] = b * c;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'YZX' ) {\r\n\r\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = bd - ac * f;\r\n\t\t\t\tte[ 8 ] = bc * f + ad;\r\n\r\n\t\t\t\tte[ 1 ] = f;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = - b * e;\r\n\r\n\t\t\t\tte[ 2 ] = - d * e;\r\n\t\t\t\tte[ 6 ] = ad * f + bc;\r\n\t\t\t\tte[ 10 ] = ac - bd * f;\r\n\r\n\t\t\t} else if ( euler.order === 'XZY' ) {\r\n\r\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = - f;\r\n\t\t\t\tte[ 8 ] = d * e;\r\n\r\n\t\t\t\tte[ 1 ] = ac * f + bd;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = ad * f - bc;\r\n\r\n\t\t\t\tte[ 2 ] = bc * f - ad;\r\n\t\t\t\tte[ 6 ] = b * e;\r\n\t\t\t\tte[ 10 ] = bd * f + ac;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bottom row\r\n\t\t\tte[ 3 ] = 0;\r\n\t\t\tte[ 7 ] = 0;\r\n\t\t\tte[ 11 ] = 0;\r\n\r\n\t\t\t// last column\r\n\t\t\tte[ 12 ] = 0;\r\n\t\t\tte[ 13 ] = 0;\r\n\t\t\tte[ 14 ] = 0;\r\n\t\t\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t\treturn this.compose( _zero, q, _one );\r\n\r\n\t\t},\r\n\r\n\t\tlookAt: function ( eye, target, up ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\t_z.subVectors( eye, target );\r\n\r\n\t\t\tif ( _z.lengthSq() === 0 ) {\r\n\r\n\t\t\t\t// eye and target are in the same position\r\n\r\n\t\t\t\t_z.z = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_z.normalize();\r\n\t\t\t_x.crossVectors( up, _z );\r\n\r\n\t\t\tif ( _x.lengthSq() === 0 ) {\r\n\r\n\t\t\t\t// up and z are parallel\r\n\r\n\t\t\t\tif ( Math.abs( up.z ) === 1 ) {\r\n\r\n\t\t\t\t\t_z.x += 0.0001;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_z.z += 0.0001;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_z.normalize();\r\n\t\t\t\t_x.crossVectors( up, _z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_x.normalize();\r\n\t\t\t_y.crossVectors( _z, _x );\r\n\r\n\t\t\tte[ 0 ] = _x.x; te[ 4 ] = _y.x; te[ 8 ] = _z.x;\r\n\t\t\tte[ 1 ] = _x.y; te[ 5 ] = _y.y; te[ 9 ] = _z.y;\r\n\t\t\tte[ 2 ] = _x.z; te[ 6 ] = _y.z; te[ 10 ] = _z.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( m, n ) {\r\n\r\n\t\t\tif ( n !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyMatrices( m, n );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.multiplyMatrices( this, m );\r\n\r\n\t\t},\r\n\r\n\t\tpremultiply: function ( m ) {\r\n\r\n\t\t\treturn this.multiplyMatrices( m, this );\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyMatrices: function ( a, b ) {\r\n\r\n\t\t\tvar ae = a.elements;\r\n\t\t\tvar be = b.elements;\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\r\n\t\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\r\n\t\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\r\n\t\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\r\n\r\n\t\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\r\n\t\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\r\n\t\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\r\n\t\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\r\n\r\n\t\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n\t\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n\t\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n\t\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n\t\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n\t\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n\t\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n\t\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n\t\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n\t\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n\t\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n\t\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n\t\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n\t\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n\t\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n\t\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( s ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\r\n\t\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\r\n\t\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\r\n\t\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdeterminant: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\r\n\t\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\r\n\t\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\r\n\t\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\r\n\r\n\t\t\t//TODO: make this more efficient\r\n\t\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n\t\t\treturn (\r\n\t\t\t\tn41 * (\r\n\t\t\t\t\t+ n14 * n23 * n32\r\n\t\t\t\t\t - n13 * n24 * n32\r\n\t\t\t\t\t - n14 * n22 * n33\r\n\t\t\t\t\t + n12 * n24 * n33\r\n\t\t\t\t\t + n13 * n22 * n34\r\n\t\t\t\t\t - n12 * n23 * n34\r\n\t\t\t\t) +\r\n\t\t\t\tn42 * (\r\n\t\t\t\t\t+ n11 * n23 * n34\r\n\t\t\t\t\t - n11 * n24 * n33\r\n\t\t\t\t\t + n14 * n21 * n33\r\n\t\t\t\t\t - n13 * n21 * n34\r\n\t\t\t\t\t + n13 * n24 * n31\r\n\t\t\t\t\t - n14 * n23 * n31\r\n\t\t\t\t) +\r\n\t\t\t\tn43 * (\r\n\t\t\t\t\t+ n11 * n24 * n32\r\n\t\t\t\t\t - n11 * n22 * n34\r\n\t\t\t\t\t - n14 * n21 * n32\r\n\t\t\t\t\t + n12 * n21 * n34\r\n\t\t\t\t\t + n14 * n22 * n31\r\n\t\t\t\t\t - n12 * n24 * n31\r\n\t\t\t\t) +\r\n\t\t\t\tn44 * (\r\n\t\t\t\t\t- n13 * n22 * n31\r\n\t\t\t\t\t - n11 * n23 * n32\r\n\t\t\t\t\t + n11 * n22 * n33\r\n\t\t\t\t\t + n13 * n21 * n32\r\n\t\t\t\t\t - n12 * n21 * n33\r\n\t\t\t\t\t + n12 * n23 * n31\r\n\t\t\t\t)\r\n\r\n\t\t\t);\r\n\r\n\t\t},\r\n\r\n\t\ttranspose: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar tmp;\r\n\r\n\t\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\r\n\t\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\r\n\t\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\r\n\r\n\t\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\r\n\t\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\r\n\t\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetPosition: function ( x, y, z ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tif ( x.isVector3 ) {\r\n\r\n\t\t\t\tte[ 12 ] = x.x;\r\n\t\t\t\tte[ 13 ] = x.y;\r\n\t\t\t\tte[ 14 ] = x.z;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tte[ 12 ] = x;\r\n\t\t\t\tte[ 13 ] = y;\r\n\t\t\t\tte[ 14 ] = z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetInverse: function ( m, throwOnDegenerate ) {\r\n\r\n\t\t\tif ( throwOnDegenerate !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n\t\t\tvar te = this.elements,\r\n\t\t\t\tme = m.elements,\r\n\r\n\t\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ], n41 = me[ 3 ],\r\n\t\t\t\tn12 = me[ 4 ], n22 = me[ 5 ], n32 = me[ 6 ], n42 = me[ 7 ],\r\n\t\t\t\tn13 = me[ 8 ], n23 = me[ 9 ], n33 = me[ 10 ], n43 = me[ 11 ],\r\n\t\t\t\tn14 = me[ 12 ], n24 = me[ 13 ], n34 = me[ 14 ], n44 = me[ 15 ],\r\n\r\n\t\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\r\n\t\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\r\n\t\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\r\n\t\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n\r\n\t\t\tvar det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\r\n\r\n\t\t\tif ( det === 0 ) { return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ); }\r\n\r\n\t\t\tvar detInv = 1 / det;\r\n\r\n\t\t\tte[ 0 ] = t11 * detInv;\r\n\t\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\r\n\t\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\r\n\t\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\r\n\r\n\t\t\tte[ 4 ] = t12 * detInv;\r\n\t\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\r\n\t\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\r\n\t\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\r\n\r\n\t\t\tte[ 8 ] = t13 * detInv;\r\n\t\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\r\n\t\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\r\n\t\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\r\n\r\n\t\t\tte[ 12 ] = t14 * detInv;\r\n\t\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\r\n\t\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\r\n\t\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tscale: function ( v ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar x = v.x, y = v.y, z = v.z;\r\n\r\n\t\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\r\n\t\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\r\n\t\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\r\n\t\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetMaxScaleOnAxis: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\r\n\t\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\r\n\t\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\r\n\r\n\t\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\r\n\r\n\t\t},\r\n\r\n\t\tmakeTranslation: function ( x, y, z ) {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0, x,\r\n\t\t\t\t0, 1, 0, y,\r\n\t\t\t\t0, 0, 1, z,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationX: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t0, c, - s, 0,\r\n\t\t\t\t0, s, c, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationY: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t c, 0, s, 0,\r\n\t\t\t\t 0, 1, 0, 0,\r\n\t\t\t\t- s, 0, c, 0,\r\n\t\t\t\t 0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationZ: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\tc, - s, 0, 0,\r\n\t\t\t\ts, c, 0, 0,\r\n\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationAxis: function ( axis, angle ) {\r\n\r\n\t\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n\t\t\tvar c = Math.cos( angle );\r\n\t\t\tvar s = Math.sin( angle );\r\n\t\t\tvar t = 1 - c;\r\n\t\t\tvar x = axis.x, y = axis.y, z = axis.z;\r\n\t\t\tvar tx = t * x, ty = t * y;\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n\t\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n\t\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\t return this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeScale: function ( x, y, z ) {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\tx, 0, 0, 0,\r\n\t\t\t\t0, y, 0, 0,\r\n\t\t\t\t0, 0, z, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeShear: function ( x, y, z ) {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, y, z, 0,\r\n\t\t\t\tx, 1, z, 0,\r\n\t\t\t\tx, y, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcompose: function ( position, quaternion, scale ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar x = quaternion._x, y = quaternion._y, z = quaternion._z, w = quaternion._w;\r\n\t\t\tvar x2 = x + x,\ty2 = y + y, z2 = z + z;\r\n\t\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\r\n\t\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\r\n\t\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\r\n\r\n\t\t\tvar sx = scale.x, sy = scale.y, sz = scale.z;\r\n\r\n\t\t\tte[ 0 ] = ( 1 - ( yy + zz ) ) * sx;\r\n\t\t\tte[ 1 ] = ( xy + wz ) * sx;\r\n\t\t\tte[ 2 ] = ( xz - wy ) * sx;\r\n\t\t\tte[ 3 ] = 0;\r\n\r\n\t\t\tte[ 4 ] = ( xy - wz ) * sy;\r\n\t\t\tte[ 5 ] = ( 1 - ( xx + zz ) ) * sy;\r\n\t\t\tte[ 6 ] = ( yz + wx ) * sy;\r\n\t\t\tte[ 7 ] = 0;\r\n\r\n\t\t\tte[ 8 ] = ( xz + wy ) * sz;\r\n\t\t\tte[ 9 ] = ( yz - wx ) * sz;\r\n\t\t\tte[ 10 ] = ( 1 - ( xx + yy ) ) * sz;\r\n\t\t\tte[ 11 ] = 0;\r\n\r\n\t\t\tte[ 12 ] = position.x;\r\n\t\t\tte[ 13 ] = position.y;\r\n\t\t\tte[ 14 ] = position.z;\r\n\t\t\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdecompose: function ( position, quaternion, scale ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar sx = _v1.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\r\n\t\t\tvar sy = _v1.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\r\n\t\t\tvar sz = _v1.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\r\n\r\n\t\t\t// if determine is negative, we need to invert one scale\r\n\t\t\tvar det = this.determinant();\r\n\t\t\tif ( det < 0 ) { sx = - sx; }\r\n\r\n\t\t\tposition.x = te[ 12 ];\r\n\t\t\tposition.y = te[ 13 ];\r\n\t\t\tposition.z = te[ 14 ];\r\n\r\n\t\t\t// scale the rotation part\r\n\t\t\t_m1.copy( this );\r\n\r\n\t\t\tvar invSX = 1 / sx;\r\n\t\t\tvar invSY = 1 / sy;\r\n\t\t\tvar invSZ = 1 / sz;\r\n\r\n\t\t\t_m1.elements[ 0 ] *= invSX;\r\n\t\t\t_m1.elements[ 1 ] *= invSX;\r\n\t\t\t_m1.elements[ 2 ] *= invSX;\r\n\r\n\t\t\t_m1.elements[ 4 ] *= invSY;\r\n\t\t\t_m1.elements[ 5 ] *= invSY;\r\n\t\t\t_m1.elements[ 6 ] *= invSY;\r\n\r\n\t\t\t_m1.elements[ 8 ] *= invSZ;\r\n\t\t\t_m1.elements[ 9 ] *= invSZ;\r\n\t\t\t_m1.elements[ 10 ] *= invSZ;\r\n\r\n\t\t\tquaternion.setFromRotationMatrix( _m1 );\r\n\r\n\t\t\tscale.x = sx;\r\n\t\t\tscale.y = sy;\r\n\t\t\tscale.z = sz;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakePerspective: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\t\tif ( far === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar x = 2 * near / ( right - left );\r\n\t\t\tvar y = 2 * near / ( top - bottom );\r\n\r\n\t\t\tvar a = ( right + left ) / ( right - left );\r\n\t\t\tvar b = ( top + bottom ) / ( top - bottom );\r\n\t\t\tvar c = - ( far + near ) / ( far - near );\r\n\t\t\tvar d = - 2 * far * near / ( far - near );\r\n\r\n\t\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\r\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\r\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\r\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar w = 1.0 / ( right - left );\r\n\t\t\tvar h = 1.0 / ( top - bottom );\r\n\t\t\tvar p = 1.0 / ( far - near );\r\n\r\n\t\t\tvar x = ( right + left ) * w;\r\n\t\t\tvar y = ( top + bottom ) * h;\r\n\t\t\tvar z = ( far + near ) * p;\r\n\r\n\t\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\r\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\r\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\r\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( matrix ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = matrix.elements;\r\n\r\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\t\tif ( te[ i ] !== me[ i ] ) { return false; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\t\tthis.elements[ i ] = array[ i + offset ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) { array = []; }\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tarray[ offset ] = te[ 0 ];\r\n\t\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\t\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\r\n\t\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\t\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\r\n\t\t\tarray[ offset + 8 ] = te[ 8 ];\r\n\t\t\tarray[ offset + 9 ] = te[ 9 ];\r\n\t\t\tarray[ offset + 10 ] = te[ 10 ];\r\n\t\t\tarray[ offset + 11 ] = te[ 11 ];\r\n\r\n\t\t\tarray[ offset + 12 ] = te[ 12 ];\r\n\t\t\tarray[ offset + 13 ] = te[ 13 ];\r\n\t\t\tarray[ offset + 14 ] = te[ 14 ];\r\n\t\t\tarray[ offset + 15 ] = te[ 15 ];\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tvar _matrix = new Matrix4();\r\n\tvar _quaternion$1 = new Quaternion();\r\n\r\n\tfunction Euler( x, y, z, order ) {\r\n\r\n\t\tthis._x = x || 0;\r\n\t\tthis._y = y || 0;\r\n\t\tthis._z = z || 0;\r\n\t\tthis._order = order || Euler.DefaultOrder;\r\n\r\n\t}\r\n\r\n\tEuler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\r\n\r\n\tEuler.DefaultOrder = 'XYZ';\r\n\r\n\tObject.defineProperties( Euler.prototype, {\r\n\r\n\t\tx: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._x;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._x = value;\r\n\t\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ty: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._y;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._y = value;\r\n\t\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tz: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._z;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._z = value;\r\n\t\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\torder: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this._order;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tthis._order = value;\r\n\t\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Euler.prototype, {\r\n\r\n\t\tisEuler: true,\r\n\r\n\t\tset: function ( x, y, z, order ) {\r\n\r\n\t\t\tthis._x = x;\r\n\t\t\tthis._y = y;\r\n\t\t\tthis._z = z;\r\n\t\t\tthis._order = order || this._order;\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( euler ) {\r\n\r\n\t\t\tthis._x = euler._x;\r\n\t\t\tthis._y = euler._y;\r\n\t\t\tthis._z = euler._z;\r\n\t\t\tthis._order = euler._order;\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromRotationMatrix: function ( m, order, update ) {\r\n\r\n\t\t\tvar clamp = MathUtils.clamp;\r\n\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\t\tvar te = m.elements;\r\n\t\t\tvar m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\r\n\t\t\tvar m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\r\n\t\t\tvar m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\r\n\r\n\t\t\torder = order || this._order;\r\n\r\n\t\t\tif ( order === 'XYZ' ) {\r\n\r\n\t\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m13 ) < 0.9999999 ) {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'YXZ' ) {\r\n\r\n\t\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m23 ) < 0.9999999 ) {\r\n\r\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\t\t\t\t\tthis._z = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'ZXY' ) {\r\n\r\n\t\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m32 ) < 0.9999999 ) {\r\n\r\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._y = 0;\r\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'ZYX' ) {\r\n\r\n\t\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m31 ) < 0.9999999 ) {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\r\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._x = 0;\r\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'YZX' ) {\r\n\r\n\t\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m21 ) < 0.9999999 ) {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\r\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._x = 0;\r\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( order === 'XZY' ) {\r\n\r\n\t\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\r\n\r\n\t\t\t\tif ( Math.abs( m12 ) < 0.9999999 ) {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\r\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\r\n\t\t\t\t\tthis._y = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._order = order;\r\n\r\n\t\t\tif ( update !== false ) { this._onChangeCallback(); }\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromQuaternion: function ( q, order, update ) {\r\n\r\n\t\t\t_matrix.makeRotationFromQuaternion( q );\r\n\r\n\t\t\treturn this.setFromRotationMatrix( _matrix, order, update );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromVector3: function ( v, order ) {\r\n\r\n\t\t\treturn this.set( v.x, v.y, v.z, order || this._order );\r\n\r\n\t\t},\r\n\r\n\t\treorder: function ( newOrder ) {\r\n\r\n\t\t\t// WARNING: this discards revolution information -bhouston\r\n\r\n\t\t\t_quaternion$1.setFromEuler( this );\r\n\r\n\t\t\treturn this.setFromQuaternion( _quaternion$1, newOrder );\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( euler ) {\r\n\r\n\t\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array ) {\r\n\r\n\t\t\tthis._x = array[ 0 ];\r\n\t\t\tthis._y = array[ 1 ];\r\n\t\t\tthis._z = array[ 2 ];\r\n\t\t\tif ( array[ 3 ] !== undefined ) { this._order = array[ 3 ]; }\r\n\r\n\t\t\tthis._onChangeCallback();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) { array = []; }\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tarray[ offset ] = this._x;\r\n\t\t\tarray[ offset + 1 ] = this._y;\r\n\t\t\tarray[ offset + 2 ] = this._z;\r\n\t\t\tarray[ offset + 3 ] = this._order;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\ttoVector3: function ( optionalResult ) {\r\n\r\n\t\t\tif ( optionalResult ) {\r\n\r\n\t\t\t\treturn optionalResult.set( this._x, this._y, this._z );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn new Vector3( this._x, this._y, this._z );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_onChange: function ( callback ) {\r\n\r\n\t\t\tthis._onChangeCallback = callback;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t_onChangeCallback: function () {}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Layers() {\r\n\r\n\t\tthis.mask = 1 | 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Layers.prototype, {\r\n\r\n\t\tset: function ( channel ) {\r\n\r\n\t\t\tthis.mask = 1 << channel | 0;\r\n\r\n\t\t},\r\n\r\n\t\tenable: function ( channel ) {\r\n\r\n\t\t\tthis.mask |= 1 << channel | 0;\r\n\r\n\t\t},\r\n\r\n\t\tenableAll: function () {\r\n\r\n\t\t\tthis.mask = 0xffffffff | 0;\r\n\r\n\t\t},\r\n\r\n\t\ttoggle: function ( channel ) {\r\n\r\n\t\t\tthis.mask ^= 1 << channel | 0;\r\n\r\n\t\t},\r\n\r\n\t\tdisable: function ( channel ) {\r\n\r\n\t\t\tthis.mask &= ~ ( 1 << channel | 0 );\r\n\r\n\t\t},\r\n\r\n\t\tdisableAll: function () {\r\n\r\n\t\t\tthis.mask = 0;\r\n\r\n\t\t},\r\n\r\n\t\ttest: function ( layers ) {\r\n\r\n\t\t\treturn ( this.mask & layers.mask ) !== 0;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar _object3DId = 0;\r\n\r\n\tvar _v1$1 = new Vector3();\r\n\tvar _q1 = new Quaternion();\r\n\tvar _m1$1 = new Matrix4();\r\n\tvar _target = new Vector3();\r\n\r\n\tvar _position = new Vector3();\r\n\tvar _scale = new Vector3();\r\n\tvar _quaternion$2 = new Quaternion();\r\n\r\n\tvar _xAxis = new Vector3( 1, 0, 0 );\r\n\tvar _yAxis = new Vector3( 0, 1, 0 );\r\n\tvar _zAxis = new Vector3( 0, 0, 1 );\r\n\r\n\tvar _addedEvent = { type: 'added' };\r\n\tvar _removedEvent = { type: 'removed' };\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author elephantatwork / www.elephantatwork.ch\r\n\t */\r\n\r\n\tfunction Object3D() {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: _object3DId ++ } );\r\n\r\n\t\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'Object3D';\r\n\r\n\t\tthis.parent = null;\r\n\t\tthis.children = [];\r\n\r\n\t\tthis.up = Object3D.DefaultUp.clone();\r\n\r\n\t\tvar position = new Vector3();\r\n\t\tvar rotation = new Euler();\r\n\t\tvar quaternion = new Quaternion();\r\n\t\tvar scale = new Vector3( 1, 1, 1 );\r\n\r\n\t\tfunction onRotationChange() {\r\n\r\n\t\t\tquaternion.setFromEuler( rotation, false );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onQuaternionChange() {\r\n\r\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\r\n\r\n\t\t}\r\n\r\n\t\trotation._onChange( onRotationChange );\r\n\t\tquaternion._onChange( onQuaternionChange );\r\n\r\n\t\tObject.defineProperties( this, {\r\n\t\t\tposition: {\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: position\r\n\t\t\t},\r\n\t\t\trotation: {\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: rotation\r\n\t\t\t},\r\n\t\t\tquaternion: {\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: quaternion\r\n\t\t\t},\r\n\t\t\tscale: {\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: scale\r\n\t\t\t},\r\n\t\t\tmodelViewMatrix: {\r\n\t\t\t\tvalue: new Matrix4()\r\n\t\t\t},\r\n\t\t\tnormalMatrix: {\r\n\t\t\t\tvalue: new Matrix3()\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\tthis.matrix = new Matrix4();\r\n\t\tthis.matrixWorld = new Matrix4();\r\n\r\n\t\tthis.matrixAutoUpdate = Object3D.DefaultMatrixAutoUpdate;\r\n\t\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\t\tthis.layers = new Layers();\r\n\t\tthis.visible = true;\r\n\r\n\t\tthis.castShadow = false;\r\n\t\tthis.receiveShadow = false;\r\n\r\n\t\tthis.frustumCulled = true;\r\n\t\tthis.renderOrder = 0;\r\n\r\n\t\tthis.userData = {};\r\n\r\n\t}\r\n\r\n\tObject3D.DefaultUp = new Vector3( 0, 1, 0 );\r\n\tObject3D.DefaultMatrixAutoUpdate = true;\r\n\r\n\tObject3D.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: Object3D,\r\n\r\n\t\tisObject3D: true,\r\n\r\n\t\tonBeforeRender: function () {},\r\n\t\tonAfterRender: function () {},\r\n\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\t\tif ( this.matrixAutoUpdate ) { this.updateMatrix(); }\r\n\r\n\t\t\tthis.matrix.premultiply( matrix );\r\n\r\n\t\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\r\n\r\n\t\t},\r\n\r\n\t\tapplyQuaternion: function ( q ) {\r\n\r\n\t\t\tthis.quaternion.premultiply( q );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetRotationFromAxisAngle: function ( axis, angle ) {\r\n\r\n\t\t\t// assumes axis is normalized\r\n\r\n\t\t\tthis.quaternion.setFromAxisAngle( axis, angle );\r\n\r\n\t\t},\r\n\r\n\t\tsetRotationFromEuler: function ( euler ) {\r\n\r\n\t\t\tthis.quaternion.setFromEuler( euler, true );\r\n\r\n\t\t},\r\n\r\n\t\tsetRotationFromMatrix: function ( m ) {\r\n\r\n\t\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\r\n\r\n\t\t\tthis.quaternion.setFromRotationMatrix( m );\r\n\r\n\t\t},\r\n\r\n\t\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t\t// assumes q is normalized\r\n\r\n\t\t\tthis.quaternion.copy( q );\r\n\r\n\t\t},\r\n\r\n\t\trotateOnAxis: function ( axis, angle ) {\r\n\r\n\t\t\t// rotate object on axis in object space\r\n\t\t\t// axis is assumed to be normalized\r\n\r\n\t\t\t_q1.setFromAxisAngle( axis, angle );\r\n\r\n\t\t\tthis.quaternion.multiply( _q1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateOnWorldAxis: function ( axis, angle ) {\r\n\r\n\t\t\t// rotate object on axis in world space\r\n\t\t\t// axis is assumed to be normalized\r\n\t\t\t// method assumes no rotated parent\r\n\r\n\t\t\t_q1.setFromAxisAngle( axis, angle );\r\n\r\n\t\t\tthis.quaternion.premultiply( _q1 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateX: function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( _xAxis, angle );\r\n\r\n\t\t},\r\n\r\n\t\trotateY: function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( _yAxis, angle );\r\n\r\n\t\t},\r\n\r\n\t\trotateZ: function ( angle ) {\r\n\r\n\t\t\treturn this.rotateOnAxis( _zAxis, angle );\r\n\r\n\t\t},\r\n\r\n\t\ttranslateOnAxis: function ( axis, distance ) {\r\n\r\n\t\t\t// translate object by distance along axis in object space\r\n\t\t\t// axis is assumed to be normalized\r\n\r\n\t\t\t_v1$1.copy( axis ).applyQuaternion( this.quaternion );\r\n\r\n\t\t\tthis.position.add( _v1$1.multiplyScalar( distance ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslateX: function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( _xAxis, distance );\r\n\r\n\t\t},\r\n\r\n\t\ttranslateY: function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( _yAxis, distance );\r\n\r\n\t\t},\r\n\r\n\t\ttranslateZ: function ( distance ) {\r\n\r\n\t\t\treturn this.translateOnAxis( _zAxis, distance );\r\n\r\n\t\t},\r\n\r\n\t\tlocalToWorld: function ( vector ) {\r\n\r\n\t\t\treturn vector.applyMatrix4( this.matrixWorld );\r\n\r\n\t\t},\r\n\r\n\t\tworldToLocal: function ( vector ) {\r\n\r\n\t\t\treturn vector.applyMatrix4( _m1$1.getInverse( this.matrixWorld ) );\r\n\r\n\t\t},\r\n\r\n\t\tlookAt: function ( x, y, z ) {\r\n\r\n\t\t\t// This method does not support objects having non-uniformly-scaled parent(s)\r\n\r\n\t\t\tif ( x.isVector3 ) {\r\n\r\n\t\t\t\t_target.copy( x );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_target.set( x, y, z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar parent = this.parent;\r\n\r\n\t\t\tthis.updateWorldMatrix( true, false );\r\n\r\n\t\t\t_position.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\tif ( this.isCamera || this.isLight ) {\r\n\r\n\t\t\t\t_m1$1.lookAt( _position, _target, this.up );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_m1$1.lookAt( _target, _position, this.up );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.quaternion.setFromRotationMatrix( _m1$1 );\r\n\r\n\t\t\tif ( parent ) {\r\n\r\n\t\t\t\t_m1$1.extractRotation( parent.matrixWorld );\r\n\t\t\t\t_q1.setFromRotationMatrix( _m1$1 );\r\n\t\t\t\tthis.quaternion.premultiply( _q1.inverse() );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tadd: function ( object ) {\r\n\r\n\t\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\t\tthis.add( arguments[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object === this ) {\r\n\r\n\t\t\t\tconsole.error( \"THREE.Object3D.add: object can't be added as a child of itself.\", object );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( object && object.isObject3D ) ) {\r\n\r\n\t\t\t\tif ( object.parent !== null ) {\r\n\r\n\t\t\t\t\tobject.parent.remove( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tobject.parent = this;\r\n\t\t\t\tthis.children.push( object );\r\n\r\n\t\t\t\tobject.dispatchEvent( _addedEvent );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( \"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tremove: function ( object ) {\r\n\r\n\t\t\tif ( arguments.length > 1 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\t\t\tthis.remove( arguments[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar index = this.children.indexOf( object );\r\n\r\n\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\tobject.parent = null;\r\n\t\t\t\tthis.children.splice( index, 1 );\r\n\r\n\t\t\t\tobject.dispatchEvent( _removedEvent );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tattach: function ( object ) {\r\n\r\n\t\t\t// adds object as a child of this, while maintaining the object's world transform\r\n\r\n\t\t\tthis.updateWorldMatrix( true, false );\r\n\r\n\t\t\t_m1$1.getInverse( this.matrixWorld );\r\n\r\n\t\t\tif ( object.parent !== null ) {\r\n\r\n\t\t\t\tobject.parent.updateWorldMatrix( true, false );\r\n\r\n\t\t\t\t_m1$1.multiply( object.parent.matrixWorld );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.applyMatrix4( _m1$1 );\r\n\r\n\t\t\tobject.updateWorldMatrix( false, false );\r\n\r\n\t\t\tthis.add( object );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetObjectById: function ( id ) {\r\n\r\n\t\t\treturn this.getObjectByProperty( 'id', id );\r\n\r\n\t\t},\r\n\r\n\t\tgetObjectByName: function ( name ) {\r\n\r\n\t\t\treturn this.getObjectByProperty( 'name', name );\r\n\r\n\t\t},\r\n\r\n\t\tgetObjectByProperty: function ( name, value ) {\r\n\r\n\t\t\tif ( this[ name ] === value ) { return this; }\r\n\r\n\t\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar child = this.children[ i ];\r\n\t\t\t\tvar object = child.getObjectByProperty( name, value );\r\n\r\n\t\t\t\tif ( object !== undefined ) {\r\n\r\n\t\t\t\t\treturn object;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\r\n\t\t},\r\n\r\n\t\tgetWorldPosition: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .getWorldPosition() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\treturn target.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t},\r\n\r\n\t\tgetWorldQuaternion: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .getWorldQuaternion() target is now required' );\r\n\t\t\t\ttarget = new Quaternion();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( _position, target, _scale );\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tgetWorldScale: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .getWorldScale() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tthis.matrixWorld.decompose( _position, _quaternion$2, target );\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tgetWorldDirection: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .getWorldDirection() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tvar e = this.matrixWorld.elements;\r\n\r\n\t\t\treturn target.set( e[ 8 ], e[ 9 ], e[ 10 ] ).normalize();\r\n\r\n\t\t},\r\n\r\n\t\traycast: function () {},\r\n\r\n\t\ttraverse: function ( callback ) {\r\n\r\n\t\t\tcallback( this );\r\n\r\n\t\t\tvar children = this.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tchildren[ i ].traverse( callback );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttraverseVisible: function ( callback ) {\r\n\r\n\t\t\tif ( this.visible === false ) { return; }\r\n\r\n\t\t\tcallback( this );\r\n\r\n\t\t\tvar children = this.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tchildren[ i ].traverseVisible( callback );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttraverseAncestors: function ( callback ) {\r\n\r\n\t\t\tvar parent = this.parent;\r\n\r\n\t\t\tif ( parent !== null ) {\r\n\r\n\t\t\t\tcallback( parent );\r\n\r\n\t\t\t\tparent.traverseAncestors( callback );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrix: function () {\r\n\r\n\t\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\r\n\r\n\t\t\tthis.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\t\tif ( this.matrixAutoUpdate ) { this.updateMatrix(); }\r\n\r\n\t\t\tif ( this.matrixWorldNeedsUpdate || force ) {\r\n\r\n\t\t\t\tif ( this.parent === null ) {\r\n\r\n\t\t\t\t\tthis.matrixWorld.copy( this.matrix );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.matrixWorldNeedsUpdate = false;\r\n\r\n\t\t\t\tforce = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update children\r\n\r\n\t\t\tvar children = this.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tchildren[ i ].updateMatrixWorld( force );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdateWorldMatrix: function ( updateParents, updateChildren ) {\r\n\r\n\t\t\tvar parent = this.parent;\r\n\r\n\t\t\tif ( updateParents === true && parent !== null ) {\r\n\r\n\t\t\t\tparent.updateWorldMatrix( true, false );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.matrixAutoUpdate ) { this.updateMatrix(); }\r\n\r\n\t\t\tif ( this.parent === null ) {\r\n\r\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update children\r\n\r\n\t\t\tif ( updateChildren === true ) {\r\n\r\n\t\t\t\tvar children = this.children;\r\n\r\n\t\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tchildren[ i ].updateWorldMatrix( false, true );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\t// meta is a string when called from JSON.stringify\r\n\t\t\tvar isRootObject = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\t\t\tvar output = {};\r\n\r\n\t\t\t// meta is a hash used to collect geometries, materials.\r\n\t\t\t// not providing it implies that this is the root object\r\n\t\t\t// being serialized.\r\n\t\t\tif ( isRootObject ) {\r\n\r\n\t\t\t\t// initialize meta obj\r\n\t\t\t\tmeta = {\r\n\t\t\t\t\tgeometries: {},\r\n\t\t\t\t\tmaterials: {},\r\n\t\t\t\t\ttextures: {},\r\n\t\t\t\t\timages: {},\r\n\t\t\t\t\tshapes: {}\r\n\t\t\t\t};\r\n\r\n\t\t\t\toutput.metadata = {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Object',\r\n\t\t\t\t\tgenerator: 'Object3D.toJSON'\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// standard Object3D serialization\r\n\r\n\t\t\tvar object = {};\r\n\r\n\t\t\tobject.uuid = this.uuid;\r\n\t\t\tobject.type = this.type;\r\n\r\n\t\t\tif ( this.name !== '' ) { object.name = this.name; }\r\n\t\t\tif ( this.castShadow === true ) { object.castShadow = true; }\r\n\t\t\tif ( this.receiveShadow === true ) { object.receiveShadow = true; }\r\n\t\t\tif ( this.visible === false ) { object.visible = false; }\r\n\t\t\tif ( this.frustumCulled === false ) { object.frustumCulled = false; }\r\n\t\t\tif ( this.renderOrder !== 0 ) { object.renderOrder = this.renderOrder; }\r\n\t\t\tif ( JSON.stringify( this.userData ) !== '{}' ) { object.userData = this.userData; }\r\n\r\n\t\t\tobject.layers = this.layers.mask;\r\n\t\t\tobject.matrix = this.matrix.toArray();\r\n\r\n\t\t\tif ( this.matrixAutoUpdate === false ) { object.matrixAutoUpdate = false; }\r\n\r\n\t\t\t// object specific properties\r\n\r\n\t\t\tif ( this.isInstancedMesh ) {\r\n\r\n\t\t\t\tobject.type = 'InstancedMesh';\r\n\t\t\t\tobject.count = this.count;\r\n\t\t\t\tobject.instanceMatrix = this.instanceMatrix.toJSON();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tfunction serialize( library, element ) {\r\n\r\n\t\t\t\tif ( library[ element.uuid ] === undefined ) {\r\n\r\n\t\t\t\t\tlibrary[ element.uuid ] = element.toJSON( meta );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn element.uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.isMesh || this.isLine || this.isPoints ) {\r\n\r\n\t\t\t\tobject.geometry = serialize( meta.geometries, this.geometry );\r\n\r\n\t\t\t\tvar parameters = this.geometry.parameters;\r\n\r\n\t\t\t\tif ( parameters !== undefined && parameters.shapes !== undefined ) {\r\n\r\n\t\t\t\t\tvar shapes = parameters.shapes;\r\n\r\n\t\t\t\t\tif ( Array.isArray( shapes ) ) {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar shape = shapes[ i ];\r\n\r\n\t\t\t\t\t\t\tserialize( meta.shapes, shape );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tserialize( meta.shapes, shapes );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.material !== undefined ) {\r\n\r\n\t\t\t\tif ( Array.isArray( this.material ) ) {\r\n\r\n\t\t\t\t\tvar uuids = [];\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = this.material.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tuuids.push( serialize( meta.materials, this.material[ i ] ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobject.material = uuids;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tobject.material = serialize( meta.materials, this.material );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( this.children.length > 0 ) {\r\n\r\n\t\t\t\tobject.children = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\r\n\t\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( isRootObject ) {\r\n\r\n\t\t\t\tvar geometries = extractFromCache( meta.geometries );\r\n\t\t\t\tvar materials = extractFromCache( meta.materials );\r\n\t\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\t\tvar images = extractFromCache( meta.images );\r\n\t\t\t\tvar shapes = extractFromCache( meta.shapes );\r\n\r\n\t\t\t\tif ( geometries.length > 0 ) { output.geometries = geometries; }\r\n\t\t\t\tif ( materials.length > 0 ) { output.materials = materials; }\r\n\t\t\t\tif ( textures.length > 0 ) { output.textures = textures; }\r\n\t\t\t\tif ( images.length > 0 ) { output.images = images; }\r\n\t\t\t\tif ( shapes.length > 0 ) { output.shapes = shapes; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\toutput.object = object;\r\n\r\n\t\t\treturn output;\r\n\r\n\t\t\t// extract data from the cache hash\r\n\t\t\t// remove metadata on each item\r\n\t\t\t// and return as array\r\n\t\t\tfunction extractFromCache( cache ) {\r\n\r\n\t\t\t\tvar values = [];\r\n\t\t\t\tfor ( var key in cache ) {\r\n\r\n\t\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\t\tdelete data.metadata;\r\n\t\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn values;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function ( recursive ) {\r\n\r\n\t\t\treturn new this.constructor().copy( this, recursive );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tif ( recursive === undefined ) { recursive = true; }\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\tthis.up.copy( source.up );\r\n\r\n\t\t\tthis.position.copy( source.position );\r\n\t\t\tthis.quaternion.copy( source.quaternion );\r\n\t\t\tthis.scale.copy( source.scale );\r\n\r\n\t\t\tthis.matrix.copy( source.matrix );\r\n\t\t\tthis.matrixWorld.copy( source.matrixWorld );\r\n\r\n\t\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\t\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\r\n\r\n\t\t\tthis.layers.mask = source.layers.mask;\r\n\t\t\tthis.visible = source.visible;\r\n\r\n\t\t\tthis.castShadow = source.castShadow;\r\n\t\t\tthis.receiveShadow = source.receiveShadow;\r\n\r\n\t\t\tthis.frustumCulled = source.frustumCulled;\r\n\t\t\tthis.renderOrder = source.renderOrder;\r\n\r\n\t\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n\t\t\tif ( recursive === true ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < source.children.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar child = source.children[ i ];\r\n\t\t\t\t\tthis.add( child.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Scene() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Scene';\r\n\r\n\t\tthis.background = null;\r\n\t\tthis.environment = null;\r\n\t\tthis.fog = null;\r\n\r\n\t\tthis.overrideMaterial = null;\r\n\r\n\t\tthis.autoUpdate = true; // checked by the renderer\r\n\r\n\t\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\r\n\r\n\t\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) ); // eslint-disable-line no-undef\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tScene.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Scene,\r\n\r\n\t\tisScene: true,\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source, recursive );\r\n\r\n\t\t\tif ( source.background !== null ) { this.background = source.background.clone(); }\r\n\t\t\tif ( source.environment !== null ) { this.environment = source.environment.clone(); }\r\n\t\t\tif ( source.fog !== null ) { this.fog = source.fog.clone(); }\r\n\r\n\t\t\tif ( source.overrideMaterial !== null ) { this.overrideMaterial = source.overrideMaterial.clone(); }\r\n\r\n\t\t\tthis.autoUpdate = source.autoUpdate;\r\n\t\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tif ( this.background !== null ) { data.object.background = this.background.toJSON( meta ); }\r\n\t\t\tif ( this.environment !== null ) { data.object.environment = this.environment.toJSON( meta ); }\r\n\t\t\tif ( this.fog !== null ) { data.object.fog = this.fog.toJSON(); }\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar _points = [\r\n\t\tnew Vector3(),\r\n\t\tnew Vector3(),\r\n\t\tnew Vector3(),\r\n\t\tnew Vector3(),\r\n\t\tnew Vector3(),\r\n\t\tnew Vector3(),\r\n\t\tnew Vector3(),\r\n\t\tnew Vector3()\r\n\t];\r\n\r\n\tvar _vector$1 = new Vector3();\r\n\r\n\tvar _box = new Box3();\r\n\r\n\t// triangle centered vertices\r\n\r\n\tvar _v0 = new Vector3();\r\n\tvar _v1$2 = new Vector3();\r\n\tvar _v2 = new Vector3();\r\n\r\n\t// triangle edge vectors\r\n\r\n\tvar _f0 = new Vector3();\r\n\tvar _f1 = new Vector3();\r\n\tvar _f2 = new Vector3();\r\n\r\n\tvar _center = new Vector3();\r\n\tvar _extents = new Vector3();\r\n\tvar _triangleNormal = new Vector3();\r\n\tvar _testAxis = new Vector3();\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction Box3( min, max ) {\r\n\r\n\t\tthis.min = ( min !== undefined ) ? min : new Vector3( + Infinity, + Infinity, + Infinity );\r\n\t\tthis.max = ( max !== undefined ) ? max : new Vector3( - Infinity, - Infinity, - Infinity );\r\n\r\n\t}\r\n\r\n\r\n\tObject.assign( Box3.prototype, {\r\n\r\n\t\tisBox3: true,\r\n\r\n\t\tset: function ( min, max ) {\r\n\r\n\t\t\tthis.min.copy( min );\r\n\t\t\tthis.max.copy( max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromArray: function ( array ) {\r\n\r\n\t\t\tvar minX = + Infinity;\r\n\t\t\tvar minY = + Infinity;\r\n\t\t\tvar minZ = + Infinity;\r\n\r\n\t\t\tvar maxX = - Infinity;\r\n\t\t\tvar maxY = - Infinity;\r\n\t\t\tvar maxZ = - Infinity;\r\n\r\n\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\tvar x = array[ i ];\r\n\t\t\t\tvar y = array[ i + 1 ];\r\n\t\t\t\tvar z = array[ i + 2 ];\r\n\r\n\t\t\t\tif ( x < minX ) { minX = x; }\r\n\t\t\t\tif ( y < minY ) { minY = y; }\r\n\t\t\t\tif ( z < minZ ) { minZ = z; }\r\n\r\n\t\t\t\tif ( x > maxX ) { maxX = x; }\r\n\t\t\t\tif ( y > maxY ) { maxY = y; }\r\n\t\t\t\tif ( z > maxZ ) { maxZ = z; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.min.set( minX, minY, minZ );\r\n\t\t\tthis.max.set( maxX, maxY, maxZ );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromBufferAttribute: function ( attribute ) {\r\n\r\n\t\t\tvar minX = + Infinity;\r\n\t\t\tvar minY = + Infinity;\r\n\t\t\tvar minZ = + Infinity;\r\n\r\n\t\t\tvar maxX = - Infinity;\r\n\t\t\tvar maxY = - Infinity;\r\n\t\t\tvar maxZ = - Infinity;\r\n\r\n\t\t\tfor ( var i = 0, l = attribute.count; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar x = attribute.getX( i );\r\n\t\t\t\tvar y = attribute.getY( i );\r\n\t\t\t\tvar z = attribute.getZ( i );\r\n\r\n\t\t\t\tif ( x < minX ) { minX = x; }\r\n\t\t\t\tif ( y < minY ) { minY = y; }\r\n\t\t\t\tif ( z < minZ ) { minZ = z; }\r\n\r\n\t\t\t\tif ( x > maxX ) { maxX = x; }\r\n\t\t\t\tif ( y > maxY ) { maxY = y; }\r\n\t\t\t\tif ( z > maxZ ) { maxZ = z; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.min.set( minX, minY, minZ );\r\n\t\t\tthis.max.set( maxX, maxY, maxZ );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.expandByPoint( points[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCenterAndSize: function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = _vector$1.copy( size ).multiplyScalar( 0.5 );\r\n\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromObject: function ( object ) {\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\treturn this.expandByObject( object );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( box ) {\r\n\r\n\t\t\tthis.min.copy( box.min );\r\n\t\t\tthis.max.copy( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeEmpty: function () {\r\n\r\n\t\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\r\n\t\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tisEmpty: function () {\r\n\r\n\t\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\r\n\r\n\t\t},\r\n\r\n\t\tgetCenter: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box3: .getCenter() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t\t},\r\n\r\n\t\tgetSize: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box3: .getSize() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.subVectors( this.max, this.min );\r\n\r\n\t\t},\r\n\r\n\t\texpandByPoint: function ( point ) {\r\n\r\n\t\t\tthis.min.min( point );\r\n\t\t\tthis.max.max( point );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByVector: function ( vector ) {\r\n\r\n\t\t\tthis.min.sub( vector );\r\n\t\t\tthis.max.add( vector );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.min.addScalar( - scalar );\r\n\t\t\tthis.max.addScalar( scalar );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByObject: function ( object ) {\r\n\r\n\t\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\r\n\t\t\t// accounting for both the object's, and children's, world transforms\r\n\r\n\t\t\tobject.updateWorldMatrix( false, false );\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( geometry !== undefined ) {\r\n\r\n\t\t\t\tif ( geometry.boundingBox === null ) {\r\n\r\n\t\t\t\t\tgeometry.computeBoundingBox();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_box.copy( geometry.boundingBox );\r\n\t\t\t\t_box.applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\t\tthis.union( _box );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.expandByObject( children[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\treturn point.x < this.min.x || point.x > this.max.x ||\r\n\t\t\t\tpoint.y < this.min.y || point.y > this.max.y ||\r\n\t\t\t\tpoint.z < this.min.z || point.z > this.max.z ? false : true;\r\n\r\n\t\t},\r\n\r\n\t\tcontainsBox: function ( box ) {\r\n\r\n\t\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\r\n\t\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y &&\r\n\t\t\t\tthis.min.z <= box.min.z && box.max.z <= this.max.z;\r\n\r\n\t\t},\r\n\r\n\t\tgetParameter: function ( point, target ) {\r\n\r\n\t\t\t// This can potentially have a divide by zero if the box\r\n\t\t\t// has a size dimension of 0.\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box3: .getParameter() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.set(\r\n\t\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\r\n\t\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\r\n\t\t\t);\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\t// using 6 splitting planes to rule out intersections.\r\n\t\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ||\r\n\t\t\t\tbox.max.z < this.min.z || box.min.z > this.max.z ? false : true;\r\n\r\n\t\t},\r\n\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\t\t// Find the point on the AABB closest to the sphere center.\r\n\t\t\tthis.clampPoint( sphere.center, _vector$1 );\r\n\r\n\t\t\t// If that point is inside the sphere, the AABB and sphere intersect.\r\n\t\t\treturn _vector$1.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t\t// We compute the minimum and maximum dot product values. If those values\r\n\t\t\t// are on the same side (back or front) of the plane, then there is no intersection.\r\n\r\n\t\t\tvar min, max;\r\n\r\n\t\t\tif ( plane.normal.x > 0 ) {\r\n\r\n\t\t\t\tmin = plane.normal.x * this.min.x;\r\n\t\t\t\tmax = plane.normal.x * this.max.x;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmin = plane.normal.x * this.max.x;\r\n\t\t\t\tmax = plane.normal.x * this.min.x;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( plane.normal.y > 0 ) {\r\n\r\n\t\t\t\tmin += plane.normal.y * this.min.y;\r\n\t\t\t\tmax += plane.normal.y * this.max.y;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmin += plane.normal.y * this.max.y;\r\n\t\t\t\tmax += plane.normal.y * this.min.y;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( plane.normal.z > 0 ) {\r\n\r\n\t\t\t\tmin += plane.normal.z * this.min.z;\r\n\t\t\t\tmax += plane.normal.z * this.max.z;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmin += plane.normal.z * this.max.z;\r\n\t\t\t\tmax += plane.normal.z * this.min.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn ( min <= - plane.constant && max >= - plane.constant );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsTriangle: function ( triangle ) {\r\n\r\n\t\t\tif ( this.isEmpty() ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// compute box center and extents\r\n\t\t\tthis.getCenter( _center );\r\n\t\t\t_extents.subVectors( this.max, _center );\r\n\r\n\t\t\t// translate triangle to aabb origin\r\n\t\t\t_v0.subVectors( triangle.a, _center );\r\n\t\t\t_v1$2.subVectors( triangle.b, _center );\r\n\t\t\t_v2.subVectors( triangle.c, _center );\r\n\r\n\t\t\t// compute edge vectors for triangle\r\n\t\t\t_f0.subVectors( _v1$2, _v0 );\r\n\t\t\t_f1.subVectors( _v2, _v1$2 );\r\n\t\t\t_f2.subVectors( _v0, _v2 );\r\n\r\n\t\t\t// test against axes that are given by cross product combinations of the edges of the triangle and the edges of the aabb\r\n\t\t\t// make an axis testing of each of the 3 sides of the aabb against each of the 3 sides of the triangle = 9 axis of separation\r\n\t\t\t// axis_ij = u_i x f_j (u0, u1, u2 = face normals of aabb = x,y,z axes vectors since aabb is axis aligned)\r\n\t\t\tvar axes = [\r\n\t\t\t\t0, - _f0.z, _f0.y, 0, - _f1.z, _f1.y, 0, - _f2.z, _f2.y,\r\n\t\t\t\t_f0.z, 0, - _f0.x, _f1.z, 0, - _f1.x, _f2.z, 0, - _f2.x,\r\n\t\t\t\t- _f0.y, _f0.x, 0, - _f1.y, _f1.x, 0, - _f2.y, _f2.x, 0\r\n\t\t\t];\r\n\t\t\tif ( ! satForAxes( axes, _v0, _v1$2, _v2, _extents ) ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// test 3 face normals from the aabb\r\n\t\t\taxes = [ 1, 0, 0, 0, 1, 0, 0, 0, 1 ];\r\n\t\t\tif ( ! satForAxes( axes, _v0, _v1$2, _v2, _extents ) ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// finally testing the face normal of the triangle\r\n\t\t\t// use already existing triangle edge vectors here\r\n\t\t\t_triangleNormal.crossVectors( _f0, _f1 );\r\n\t\t\taxes = [ _triangleNormal.x, _triangleNormal.y, _triangleNormal.z ];\r\n\r\n\t\t\treturn satForAxes( axes, _v0, _v1$2, _v2, _extents );\r\n\r\n\t\t},\r\n\r\n\t\tclampPoint: function ( point, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box3: .clampPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( point ).clamp( this.min, this.max );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = _vector$1.copy( point ).clamp( this.min, this.max );\r\n\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t},\r\n\r\n\t\tgetBoundingSphere: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Box3: .getBoundingSphere() target is now required' );\r\n\t\t\t\t//target = new Sphere(); // removed to avoid cyclic dependency\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.getCenter( target.center );\r\n\r\n\t\t\ttarget.radius = this.getSize( _vector$1 ).length() * 0.5;\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tintersect: function ( box ) {\r\n\r\n\t\t\tthis.min.max( box.min );\r\n\t\t\tthis.max.min( box.max );\r\n\r\n\t\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\r\n\t\t\tif ( this.isEmpty() ) { this.makeEmpty(); }\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tunion: function ( box ) {\r\n\r\n\t\t\tthis.min.min( box.min );\r\n\t\t\tthis.max.max( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\t\t// transform of empty box is an empty box.\r\n\t\t\tif ( this.isEmpty() ) { return this; }\r\n\r\n\t\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\r\n\t\t\t_points[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\r\n\t\t\t_points[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\r\n\t\t\t_points[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\r\n\t\t\t_points[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\r\n\t\t\t_points[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\r\n\t\t\t_points[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\r\n\t\t\t_points[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\r\n\t\t\t_points[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 111\r\n\r\n\t\t\tthis.setFromPoints( _points );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( offset ) {\r\n\r\n\t\t\tthis.min.add( offset );\r\n\t\t\tthis.max.add( offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( box ) {\r\n\r\n\t\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction satForAxes( axes, v0, v1, v2, extents ) {\r\n\r\n\t\tvar i, j;\r\n\r\n\t\tfor ( i = 0, j = axes.length - 3; i <= j; i += 3 ) {\r\n\r\n\t\t\t_testAxis.fromArray( axes, i );\r\n\t\t\t// project the aabb onto the seperating axis\r\n\t\t\tvar r = extents.x * Math.abs( _testAxis.x ) + extents.y * Math.abs( _testAxis.y ) + extents.z * Math.abs( _testAxis.z );\r\n\t\t\t// project all 3 vertices of the triangle onto the seperating axis\r\n\t\t\tvar p0 = v0.dot( _testAxis );\r\n\t\t\tvar p1 = v1.dot( _testAxis );\r\n\t\t\tvar p2 = v2.dot( _testAxis );\r\n\t\t\t// actual test, basically see if either of the most extreme of the triangle points intersects r\r\n\t\t\tif ( Math.max( - Math.max( p0, p1, p2 ), Math.min( p0, p1, p2 ) ) > r ) {\r\n\r\n\t\t\t\t// points of the projected triangle are outside the projected half-length of the aabb\r\n\t\t\t\t// the axis is seperating and we can exit\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\tvar _box$1 = new Box3();\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Sphere( center, radius ) {\r\n\r\n\t\tthis.center = ( center !== undefined ) ? center : new Vector3();\r\n\t\tthis.radius = ( radius !== undefined ) ? radius : 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Sphere.prototype, {\r\n\r\n\t\tset: function ( center, radius ) {\r\n\r\n\t\t\tthis.center.copy( center );\r\n\t\t\tthis.radius = radius;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function ( points, optionalCenter ) {\r\n\r\n\t\t\tvar center = this.center;\r\n\r\n\t\t\tif ( optionalCenter !== undefined ) {\r\n\r\n\t\t\t\tcenter.copy( optionalCenter );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_box$1.setFromPoints( points ).getCenter( center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( sphere ) {\r\n\r\n\t\t\tthis.center.copy( sphere.center );\r\n\t\t\tthis.radius = sphere.radius;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tempty: function () {\r\n\r\n\t\t\treturn ( this.radius <= 0 );\r\n\r\n\t\t},\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function ( point ) {\r\n\r\n\t\t\treturn ( point.distanceTo( this.center ) - this.radius );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\t\tvar radiusSum = this.radius + sphere.radius;\r\n\r\n\t\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\treturn box.intersectsSphere( this );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t\treturn Math.abs( plane.distanceToPoint( this.center ) ) <= this.radius;\r\n\r\n\t\t},\r\n\r\n\t\tclampPoint: function ( point, target ) {\r\n\r\n\t\t\tvar deltaLengthSq = this.center.distanceToSquared( point );\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Sphere: .clampPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.copy( point );\r\n\r\n\t\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\r\n\r\n\t\t\t\ttarget.sub( this.center ).normalize();\r\n\t\t\t\ttarget.multiplyScalar( this.radius ).add( this.center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tgetBoundingBox: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Sphere: .getBoundingBox() target is now required' );\r\n\t\t\t\ttarget = new Box3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.set( this.center, this.center );\r\n\t\t\ttarget.expandByScalar( this.radius );\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\t\tthis.center.applyMatrix4( matrix );\r\n\t\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( offset ) {\r\n\r\n\t\t\tthis.center.add( offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( sphere ) {\r\n\r\n\t\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar _vector$2 = new Vector3();\r\n\tvar _segCenter = new Vector3();\r\n\tvar _segDir = new Vector3();\r\n\tvar _diff = new Vector3();\r\n\r\n\tvar _edge1 = new Vector3();\r\n\tvar _edge2 = new Vector3();\r\n\tvar _normal = new Vector3();\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tfunction Ray( origin, direction ) {\r\n\r\n\t\tthis.origin = ( origin !== undefined ) ? origin : new Vector3();\r\n\t\tthis.direction = ( direction !== undefined ) ? direction : new Vector3( 0, 0, - 1 );\r\n\r\n\t}\r\n\r\n\tObject.assign( Ray.prototype, {\r\n\r\n\t\tset: function ( origin, direction ) {\r\n\r\n\t\t\tthis.origin.copy( origin );\r\n\t\t\tthis.direction.copy( direction );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( ray ) {\r\n\r\n\t\t\tthis.origin.copy( ray.origin );\r\n\t\t\tthis.direction.copy( ray.direction );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tat: function ( t, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Ray: .at() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( this.direction ).multiplyScalar( t ).add( this.origin );\r\n\r\n\t\t},\r\n\r\n\t\tlookAt: function ( v ) {\r\n\r\n\t\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trecast: function ( t ) {\r\n\r\n\t\t\tthis.origin.copy( this.at( t, _vector$2 ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclosestPointToPoint: function ( point, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Ray: .closestPointToPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.subVectors( point, this.origin );\r\n\r\n\t\t\tvar directionDistance = target.dot( this.direction );\r\n\r\n\t\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\t\treturn target.copy( this.origin );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function ( point ) {\r\n\r\n\t\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceSqToPoint: function ( point ) {\r\n\r\n\t\t\tvar directionDistance = _vector$2.subVectors( point, this.origin ).dot( this.direction );\r\n\r\n\t\t\t// point behind the ray\r\n\r\n\t\t\tif ( directionDistance < 0 ) {\r\n\r\n\t\t\t\treturn this.origin.distanceToSquared( point );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_vector$2.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\r\n\r\n\t\t\treturn _vector$2.distanceToSquared( point );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceSqToSegment: function ( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\r\n\r\n\t\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteDistRaySegment.h\r\n\t\t\t// It returns the min distance between the ray and the segment\r\n\t\t\t// defined by v0 and v1\r\n\t\t\t// It can also set two optional targets :\r\n\t\t\t// - The closest point on the ray\r\n\t\t\t// - The closest point on the segment\r\n\r\n\t\t\t_segCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\r\n\t\t\t_segDir.copy( v1 ).sub( v0 ).normalize();\r\n\t\t\t_diff.copy( this.origin ).sub( _segCenter );\r\n\r\n\t\t\tvar segExtent = v0.distanceTo( v1 ) * 0.5;\r\n\t\t\tvar a01 = - this.direction.dot( _segDir );\r\n\t\t\tvar b0 = _diff.dot( this.direction );\r\n\t\t\tvar b1 = - _diff.dot( _segDir );\r\n\t\t\tvar c = _diff.lengthSq();\r\n\t\t\tvar det = Math.abs( 1 - a01 * a01 );\r\n\t\t\tvar s0, s1, sqrDist, extDet;\r\n\r\n\t\t\tif ( det > 0 ) {\r\n\r\n\t\t\t\t// The ray and segment are not parallel.\r\n\r\n\t\t\t\ts0 = a01 * b1 - b0;\r\n\t\t\t\ts1 = a01 * b0 - b1;\r\n\t\t\t\textDet = segExtent * det;\r\n\r\n\t\t\t\tif ( s0 >= 0 ) {\r\n\r\n\t\t\t\t\tif ( s1 >= - extDet ) {\r\n\r\n\t\t\t\t\t\tif ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t\t// region 0\r\n\t\t\t\t\t\t\t// Minimum at interior points of ray and segment.\r\n\r\n\t\t\t\t\t\t\tvar invDet = 1 / det;\r\n\t\t\t\t\t\t\ts0 *= invDet;\r\n\t\t\t\t\t\t\ts1 *= invDet;\r\n\t\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// region 1\r\n\r\n\t\t\t\t\t\t\ts1 = segExtent;\r\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 5\r\n\r\n\t\t\t\t\t\ts1 = - segExtent;\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( s1 <= - extDet ) {\r\n\r\n\t\t\t\t\t\t// region 4\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else if ( s1 <= extDet ) {\r\n\r\n\t\t\t\t\t\t// region 3\r\n\r\n\t\t\t\t\t\ts0 = 0;\r\n\t\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// region 2\r\n\r\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\r\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\r\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Ray and segment are parallel.\r\n\r\n\t\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\r\n\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\r\n\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnRay ) {\r\n\r\n\t\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( optionalPointOnSegment ) {\r\n\r\n\t\t\t\toptionalPointOnSegment.copy( _segDir ).multiplyScalar( s1 ).add( _segCenter );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn sqrDist;\r\n\r\n\t\t},\r\n\r\n\t\tintersectSphere: function ( sphere, target ) {\r\n\r\n\t\t\t_vector$2.subVectors( sphere.center, this.origin );\r\n\t\t\tvar tca = _vector$2.dot( this.direction );\r\n\t\t\tvar d2 = _vector$2.dot( _vector$2 ) - tca * tca;\r\n\t\t\tvar radius2 = sphere.radius * sphere.radius;\r\n\r\n\t\t\tif ( d2 > radius2 ) { return null; }\r\n\r\n\t\t\tvar thc = Math.sqrt( radius2 - d2 );\r\n\r\n\t\t\t// t0 = first intersect point - entrance on front of sphere\r\n\t\t\tvar t0 = tca - thc;\r\n\r\n\t\t\t// t1 = second intersect point - exit point on back of sphere\r\n\t\t\tvar t1 = tca + thc;\r\n\r\n\t\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\r\n\t\t\tif ( t0 < 0 && t1 < 0 ) { return null; }\r\n\r\n\t\t\t// test to see if t0 is behind the ray:\r\n\t\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\r\n\t\t\t// in order to always return an intersect point that is in front of the ray.\r\n\t\t\tif ( t0 < 0 ) { return this.at( t1, target ); }\r\n\r\n\t\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\r\n\t\t\treturn this.at( t0, target );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\t\treturn this.distanceSqToPoint( sphere.center ) <= ( sphere.radius * sphere.radius );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPlane: function ( plane ) {\r\n\r\n\t\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\r\n\r\n\t\t\t\t\treturn 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\r\n\r\n\t\t\t// Return if the ray never intersects the plane\r\n\r\n\t\t\treturn t >= 0 ? t : null;\r\n\r\n\t\t},\r\n\r\n\t\tintersectPlane: function ( plane, target ) {\r\n\r\n\t\t\tvar t = this.distanceToPlane( plane );\r\n\r\n\t\t\tif ( t === null ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.at( t, target );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsPlane: function ( plane ) {\r\n\r\n\t\t\t// check if the ray lies on the plane first\r\n\r\n\t\t\tvar distToPoint = plane.distanceToPoint( this.origin );\r\n\r\n\t\t\tif ( distToPoint === 0 ) {\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar denominator = plane.normal.dot( this.direction );\r\n\r\n\t\t\tif ( denominator * distToPoint < 0 ) {\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// ray origin is behind the plane (and is pointing behind it)\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t},\r\n\r\n\t\tintersectBox: function ( box, target ) {\r\n\r\n\t\t\tvar tmin, tmax, tymin, tymax, tzmin, tzmax;\r\n\r\n\t\t\tvar invdirx = 1 / this.direction.x,\r\n\t\t\t\tinvdiry = 1 / this.direction.y,\r\n\t\t\t\tinvdirz = 1 / this.direction.z;\r\n\r\n\t\t\tvar origin = this.origin;\r\n\r\n\t\t\tif ( invdirx >= 0 ) {\r\n\r\n\t\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\r\n\t\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\r\n\t\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( invdiry >= 0 ) {\r\n\r\n\t\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\r\n\t\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\r\n\t\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) { return null; }\r\n\r\n\t\t\t// These lines also handle the case where tmin or tmax is NaN\r\n\t\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\r\n\r\n\t\t\tif ( tymin > tmin || tmin !== tmin ) { tmin = tymin; }\r\n\r\n\t\t\tif ( tymax < tmax || tmax !== tmax ) { tmax = tymax; }\r\n\r\n\t\t\tif ( invdirz >= 0 ) {\r\n\r\n\t\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\r\n\t\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\r\n\t\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) { return null; }\r\n\r\n\t\t\tif ( tzmin > tmin || tmin !== tmin ) { tmin = tzmin; }\r\n\r\n\t\t\tif ( tzmax < tmax || tmax !== tmax ) { tmax = tzmax; }\r\n\r\n\t\t\t//return point closest to the ray (positive side)\r\n\r\n\t\t\tif ( tmax < 0 ) { return null; }\r\n\r\n\t\t\treturn this.at( tmin >= 0 ? tmin : tmax, target );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\treturn this.intersectBox( box, _vector$2 ) !== null;\r\n\r\n\t\t},\r\n\r\n\t\tintersectTriangle: function ( a, b, c, backfaceCulling, target ) {\r\n\r\n\t\t\t// Compute the offset origin, edges, and normal.\r\n\r\n\t\t\t// from http://www.geometrictools.com/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\r\n\r\n\t\t\t_edge1.subVectors( b, a );\r\n\t\t\t_edge2.subVectors( c, a );\r\n\t\t\t_normal.crossVectors( _edge1, _edge2 );\r\n\r\n\t\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\r\n\t\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\r\n\t\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\r\n\t\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\r\n\t\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\r\n\t\t\tvar DdN = this.direction.dot( _normal );\r\n\t\t\tvar sign;\r\n\r\n\t\t\tif ( DdN > 0 ) {\r\n\r\n\t\t\t\tif ( backfaceCulling ) { return null; }\r\n\t\t\t\tsign = 1;\r\n\r\n\t\t\t} else if ( DdN < 0 ) {\r\n\r\n\t\t\t\tsign = - 1;\r\n\t\t\t\tDdN = - DdN;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_diff.subVectors( this.origin, a );\r\n\t\t\tvar DdQxE2 = sign * this.direction.dot( _edge2.crossVectors( _diff, _edge2 ) );\r\n\r\n\t\t\t// b1 < 0, no intersection\r\n\t\t\tif ( DdQxE2 < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar DdE1xQ = sign * this.direction.dot( _edge1.cross( _diff ) );\r\n\r\n\t\t\t// b2 < 0, no intersection\r\n\t\t\tif ( DdE1xQ < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// b1+b2 > 1, no intersection\r\n\t\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Line intersects triangle, check if ray does.\r\n\t\t\tvar QdN = - sign * _diff.dot( _normal );\r\n\r\n\t\t\t// t < 0, no intersection\r\n\t\t\tif ( QdN < 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Ray intersects triangle.\r\n\t\t\treturn this.at( QdN / DdN, target );\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( matrix4 ) {\r\n\r\n\t\t\tthis.origin.applyMatrix4( matrix4 );\r\n\t\t\tthis.direction.transformDirection( matrix4 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( ray ) {\r\n\r\n\t\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tvar _vector1 = new Vector3();\r\n\tvar _vector2 = new Vector3();\r\n\tvar _normalMatrix = new Matrix3();\r\n\r\n\tfunction Plane( normal, constant ) {\r\n\r\n\t\t// normal is assumed to be normalized\r\n\r\n\t\tthis.normal = ( normal !== undefined ) ? normal : new Vector3( 1, 0, 0 );\r\n\t\tthis.constant = ( constant !== undefined ) ? constant : 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Plane.prototype, {\r\n\r\n\t\tisPlane: true,\r\n\r\n\t\tset: function ( normal, constant ) {\r\n\r\n\t\t\tthis.normal.copy( normal );\r\n\t\t\tthis.constant = constant;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetComponents: function ( x, y, z, w ) {\r\n\r\n\t\t\tthis.normal.set( x, y, z );\r\n\t\t\tthis.constant = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromNormalAndCoplanarPoint: function ( normal, point ) {\r\n\r\n\t\t\tthis.normal.copy( normal );\r\n\t\t\tthis.constant = - point.dot( this.normal );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCoplanarPoints: function ( a, b, c ) {\r\n\r\n\t\t\tvar normal = _vector1.subVectors( c, b ).cross( _vector2.subVectors( a, b ) ).normalize();\r\n\r\n\t\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\r\n\r\n\t\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( plane ) {\r\n\r\n\t\t\tthis.normal.copy( plane.normal );\r\n\t\t\tthis.constant = plane.constant;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\t// Note: will lead to a divide by zero if the plane is invalid.\r\n\r\n\t\t\tvar inverseNormalLength = 1.0 / this.normal.length();\r\n\t\t\tthis.normal.multiplyScalar( inverseNormalLength );\r\n\t\t\tthis.constant *= inverseNormalLength;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnegate: function () {\r\n\r\n\t\t\tthis.constant *= - 1;\r\n\t\t\tthis.normal.negate();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function ( point ) {\r\n\r\n\t\t\treturn this.normal.dot( point ) + this.constant;\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToSphere: function ( sphere ) {\r\n\r\n\t\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\r\n\r\n\t\t},\r\n\r\n\t\tprojectPoint: function ( point, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Plane: .projectPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( this.normal ).multiplyScalar( - this.distanceToPoint( point ) ).add( point );\r\n\r\n\t\t},\r\n\r\n\t\tintersectLine: function ( line, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Plane: .intersectLine() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar direction = line.delta( _vector1 );\r\n\r\n\t\t\tvar denominator = this.normal.dot( direction );\r\n\r\n\t\t\tif ( denominator === 0 ) {\r\n\r\n\t\t\t\t// line is coplanar, return origin\r\n\t\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\r\n\r\n\t\t\t\t\treturn target.copy( line.start );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Unsure if this is the correct method to handle this case.\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\r\n\r\n\t\t\tif ( t < 0 || t > 1 ) {\r\n\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( direction ).multiplyScalar( t ).add( line.start );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsLine: function ( line ) {\r\n\r\n\t\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\r\n\r\n\t\t\tvar startSign = this.distanceToPoint( line.start );\r\n\t\t\tvar endSign = this.distanceToPoint( line.end );\r\n\r\n\t\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\treturn box.intersectsPlane( this );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\t\treturn sphere.intersectsPlane( this );\r\n\r\n\t\t},\r\n\r\n\t\tcoplanarPoint: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Plane: .coplanarPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( this.normal ).multiplyScalar( - this.constant );\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( matrix, optionalNormalMatrix ) {\r\n\r\n\t\t\tvar normalMatrix = optionalNormalMatrix || _normalMatrix.getNormalMatrix( matrix );\r\n\r\n\t\t\tvar referencePoint = this.coplanarPoint( _vector1 ).applyMatrix4( matrix );\r\n\r\n\t\t\tvar normal = this.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\tthis.constant = - referencePoint.dot( normal );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( offset ) {\r\n\r\n\t\t\tthis.constant -= offset.dot( this.normal );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( plane ) {\r\n\r\n\t\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _v0$1 = new Vector3();\r\n\tvar _v1$3 = new Vector3();\r\n\tvar _v2$1 = new Vector3();\r\n\tvar _v3 = new Vector3();\r\n\r\n\tvar _vab = new Vector3();\r\n\tvar _vac = new Vector3();\r\n\tvar _vbc = new Vector3();\r\n\tvar _vap = new Vector3();\r\n\tvar _vbp = new Vector3();\r\n\tvar _vcp = new Vector3();\r\n\r\n\tfunction Triangle( a, b, c ) {\r\n\r\n\t\tthis.a = ( a !== undefined ) ? a : new Vector3();\r\n\t\tthis.b = ( b !== undefined ) ? b : new Vector3();\r\n\t\tthis.c = ( c !== undefined ) ? c : new Vector3();\r\n\r\n\t}\r\n\r\n\tObject.assign( Triangle, {\r\n\r\n\t\tgetNormal: function ( a, b, c, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Triangle: .getNormal() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.subVectors( c, b );\r\n\t\t\t_v0$1.subVectors( a, b );\r\n\t\t\ttarget.cross( _v0$1 );\r\n\r\n\t\t\tvar targetLengthSq = target.lengthSq();\r\n\t\t\tif ( targetLengthSq > 0 ) {\r\n\r\n\t\t\t\treturn target.multiplyScalar( 1 / Math.sqrt( targetLengthSq ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.set( 0, 0, 0 );\r\n\r\n\t\t},\r\n\r\n\t\t// static/instance method to calculate barycentric coordinates\r\n\t\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\r\n\t\tgetBarycoord: function ( point, a, b, c, target ) {\r\n\r\n\t\t\t_v0$1.subVectors( c, a );\r\n\t\t\t_v1$3.subVectors( b, a );\r\n\t\t\t_v2$1.subVectors( point, a );\r\n\r\n\t\t\tvar dot00 = _v0$1.dot( _v0$1 );\r\n\t\t\tvar dot01 = _v0$1.dot( _v1$3 );\r\n\t\t\tvar dot02 = _v0$1.dot( _v2$1 );\r\n\t\t\tvar dot11 = _v1$3.dot( _v1$3 );\r\n\t\t\tvar dot12 = _v1$3.dot( _v2$1 );\r\n\r\n\t\t\tvar denom = ( dot00 * dot11 - dot01 * dot01 );\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Triangle: .getBarycoord() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// collinear or singular triangle\r\n\t\t\tif ( denom === 0 ) {\r\n\r\n\t\t\t\t// arbitrary location outside of triangle?\r\n\t\t\t\t// not sure if this is the best idea, maybe should be returning undefined\r\n\t\t\t\treturn target.set( - 2, - 1, - 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar invDenom = 1 / denom;\r\n\t\t\tvar u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\r\n\t\t\tvar v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\r\n\r\n\t\t\t// barycentric coordinates must always sum to 1\r\n\t\t\treturn target.set( 1 - u - v, v, u );\r\n\r\n\t\t},\r\n\r\n\t\tcontainsPoint: function ( point, a, b, c ) {\r\n\r\n\t\t\tTriangle.getBarycoord( point, a, b, c, _v3 );\r\n\r\n\t\t\treturn ( _v3.x >= 0 ) && ( _v3.y >= 0 ) && ( ( _v3.x + _v3.y ) <= 1 );\r\n\r\n\t\t},\r\n\r\n\t\tgetUV: function ( point, p1, p2, p3, uv1, uv2, uv3, target ) {\r\n\r\n\t\t\tthis.getBarycoord( point, p1, p2, p3, _v3 );\r\n\r\n\t\t\ttarget.set( 0, 0 );\r\n\t\t\ttarget.addScaledVector( uv1, _v3.x );\r\n\t\t\ttarget.addScaledVector( uv2, _v3.y );\r\n\t\t\ttarget.addScaledVector( uv3, _v3.z );\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tisFrontFacing: function ( a, b, c, direction ) {\r\n\r\n\t\t\t_v0$1.subVectors( c, b );\r\n\t\t\t_v1$3.subVectors( a, b );\r\n\r\n\t\t\t// strictly front facing\r\n\t\t\treturn ( _v0$1.cross( _v1$3 ).dot( direction ) < 0 ) ? true : false;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Triangle.prototype, {\r\n\r\n\t\tset: function ( a, b, c ) {\r\n\r\n\t\t\tthis.a.copy( a );\r\n\t\t\tthis.b.copy( b );\r\n\t\t\tthis.c.copy( c );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPointsAndIndices: function ( points, i0, i1, i2 ) {\r\n\r\n\t\t\tthis.a.copy( points[ i0 ] );\r\n\t\t\tthis.b.copy( points[ i1 ] );\r\n\t\t\tthis.c.copy( points[ i2 ] );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( triangle ) {\r\n\r\n\t\t\tthis.a.copy( triangle.a );\r\n\t\t\tthis.b.copy( triangle.b );\r\n\t\t\tthis.c.copy( triangle.c );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetArea: function () {\r\n\r\n\t\t\t_v0$1.subVectors( this.c, this.b );\r\n\t\t\t_v1$3.subVectors( this.a, this.b );\r\n\r\n\t\t\treturn _v0$1.cross( _v1$3 ).length() * 0.5;\r\n\r\n\t\t},\r\n\r\n\t\tgetMidpoint: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Triangle: .getMidpoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\r\n\r\n\t\t},\r\n\r\n\t\tgetNormal: function ( target ) {\r\n\r\n\t\t\treturn Triangle.getNormal( this.a, this.b, this.c, target );\r\n\r\n\t\t},\r\n\r\n\t\tgetPlane: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Triangle: .getPlane() target is now required' );\r\n\t\t\t\ttarget = new Plane();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.setFromCoplanarPoints( this.a, this.b, this.c );\r\n\r\n\t\t},\r\n\r\n\t\tgetBarycoord: function ( point, target ) {\r\n\r\n\t\t\treturn Triangle.getBarycoord( point, this.a, this.b, this.c, target );\r\n\r\n\t\t},\r\n\r\n\t\tgetUV: function ( point, uv1, uv2, uv3, target ) {\r\n\r\n\t\t\treturn Triangle.getUV( point, this.a, this.b, this.c, uv1, uv2, uv3, target );\r\n\r\n\t\t},\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\treturn Triangle.containsPoint( point, this.a, this.b, this.c );\r\n\r\n\t\t},\r\n\r\n\t\tisFrontFacing: function ( direction ) {\r\n\r\n\t\t\treturn Triangle.isFrontFacing( this.a, this.b, this.c, direction );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\treturn box.intersectsTriangle( this );\r\n\r\n\t\t},\r\n\r\n\t\tclosestPointToPoint: function ( p, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Triangle: .closestPointToPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar a = this.a, b = this.b, c = this.c;\r\n\t\t\tvar v, w;\r\n\r\n\t\t\t// algorithm thanks to Real-Time Collision Detection by Christer Ericson,\r\n\t\t\t// published by Morgan Kaufmann Publishers, (c) 2005 Elsevier Inc.,\r\n\t\t\t// under the accompanying license; see chapter 5.1.5 for detailed explanation.\r\n\t\t\t// basically, we're distinguishing which of the voronoi regions of the triangle\r\n\t\t\t// the point lies in with the minimum amount of redundant computation.\r\n\r\n\t\t\t_vab.subVectors( b, a );\r\n\t\t\t_vac.subVectors( c, a );\r\n\t\t\t_vap.subVectors( p, a );\r\n\t\t\tvar d1 = _vab.dot( _vap );\r\n\t\t\tvar d2 = _vac.dot( _vap );\r\n\t\t\tif ( d1 <= 0 && d2 <= 0 ) {\r\n\r\n\t\t\t\t// vertex region of A; barycentric coords (1, 0, 0)\r\n\t\t\t\treturn target.copy( a );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_vbp.subVectors( p, b );\r\n\t\t\tvar d3 = _vab.dot( _vbp );\r\n\t\t\tvar d4 = _vac.dot( _vbp );\r\n\t\t\tif ( d3 >= 0 && d4 <= d3 ) {\r\n\r\n\t\t\t\t// vertex region of B; barycentric coords (0, 1, 0)\r\n\t\t\t\treturn target.copy( b );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar vc = d1 * d4 - d3 * d2;\r\n\t\t\tif ( vc <= 0 && d1 >= 0 && d3 <= 0 ) {\r\n\r\n\t\t\t\tv = d1 / ( d1 - d3 );\r\n\t\t\t\t// edge region of AB; barycentric coords (1-v, v, 0)\r\n\t\t\t\treturn target.copy( a ).addScaledVector( _vab, v );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_vcp.subVectors( p, c );\r\n\t\t\tvar d5 = _vab.dot( _vcp );\r\n\t\t\tvar d6 = _vac.dot( _vcp );\r\n\t\t\tif ( d6 >= 0 && d5 <= d6 ) {\r\n\r\n\t\t\t\t// vertex region of C; barycentric coords (0, 0, 1)\r\n\t\t\t\treturn target.copy( c );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar vb = d5 * d2 - d1 * d6;\r\n\t\t\tif ( vb <= 0 && d2 >= 0 && d6 <= 0 ) {\r\n\r\n\t\t\t\tw = d2 / ( d2 - d6 );\r\n\t\t\t\t// edge region of AC; barycentric coords (1-w, 0, w)\r\n\t\t\t\treturn target.copy( a ).addScaledVector( _vac, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar va = d3 * d6 - d5 * d4;\r\n\t\t\tif ( va <= 0 && ( d4 - d3 ) >= 0 && ( d5 - d6 ) >= 0 ) {\r\n\r\n\t\t\t\t_vbc.subVectors( c, b );\r\n\t\t\t\tw = ( d4 - d3 ) / ( ( d4 - d3 ) + ( d5 - d6 ) );\r\n\t\t\t\t// edge region of BC; barycentric coords (0, 1-w, w)\r\n\t\t\t\treturn target.copy( b ).addScaledVector( _vbc, w ); // edge region of BC\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// face region\r\n\t\t\tvar denom = 1 / ( va + vb + vc );\r\n\t\t\t// u = va * denom\r\n\t\t\tv = vb * denom;\r\n\t\t\tw = vc * denom;\r\n\r\n\t\t\treturn target.copy( a ).addScaledVector( _vab, v ).addScaledVector( _vac, w );\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( triangle ) {\r\n\r\n\t\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _colorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\r\n\t\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\r\n\t\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\r\n\t\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\r\n\t\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\r\n\t\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\r\n\t\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\r\n\t\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\r\n\t\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\r\n\t\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\r\n\t\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\r\n\t\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\r\n\t\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\r\n\t\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\r\n\t\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\r\n\t\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\r\n\t\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\r\n\t\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\r\n\t\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\r\n\t\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'rebeccapurple': 0x663399, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\r\n\t\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\r\n\t\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\r\n\t\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\r\n\t\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\r\n\r\n\tvar _hslA = { h: 0, s: 0, l: 0 };\r\n\tvar _hslB = { h: 0, s: 0, l: 0 };\r\n\r\n\tfunction Color( r, g, b ) {\r\n\r\n\t\tif ( g === undefined && b === undefined ) {\r\n\r\n\t\t\t// r is THREE.Color, hex or string\r\n\t\t\treturn this.set( r );\r\n\r\n\t\t}\r\n\r\n\t\treturn this.setRGB( r, g, b );\r\n\r\n\t}\r\n\r\n\tfunction hue2rgb( p, q, t ) {\r\n\r\n\t\tif ( t < 0 ) { t += 1; }\r\n\t\tif ( t > 1 ) { t -= 1; }\r\n\t\tif ( t < 1 / 6 ) { return p + ( q - p ) * 6 * t; }\r\n\t\tif ( t < 1 / 2 ) { return q; }\r\n\t\tif ( t < 2 / 3 ) { return p + ( q - p ) * 6 * ( 2 / 3 - t ); }\r\n\t\treturn p;\r\n\r\n\t}\r\n\r\n\tfunction SRGBToLinear( c ) {\r\n\r\n\t\treturn ( c < 0.04045 ) ? c * 0.0773993808 : Math.pow( c * 0.9478672986 + 0.0521327014, 2.4 );\r\n\r\n\t}\r\n\r\n\tfunction LinearToSRGB( c ) {\r\n\r\n\t\treturn ( c < 0.0031308 ) ? c * 12.92 : 1.055 * ( Math.pow( c, 0.41666 ) ) - 0.055;\r\n\r\n\t}\r\n\r\n\tObject.assign( Color.prototype, {\r\n\r\n\t\tisColor: true,\r\n\r\n\t\tr: 1, g: 1, b: 1,\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value && value.isColor ) {\r\n\r\n\t\t\t\tthis.copy( value );\r\n\r\n\t\t\t} else if ( typeof value === 'number' ) {\r\n\r\n\t\t\t\tthis.setHex( value );\r\n\r\n\t\t\t} else if ( typeof value === 'string' ) {\r\n\r\n\t\t\t\tthis.setStyle( value );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.r = scalar;\r\n\t\t\tthis.g = scalar;\r\n\t\t\tthis.b = scalar;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetHex: function ( hex ) {\r\n\r\n\t\t\thex = Math.floor( hex );\r\n\r\n\t\t\tthis.r = ( hex >> 16 & 255 ) / 255;\r\n\t\t\tthis.g = ( hex >> 8 & 255 ) / 255;\r\n\t\t\tthis.b = ( hex & 255 ) / 255;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetRGB: function ( r, g, b ) {\r\n\r\n\t\t\tthis.r = r;\r\n\t\t\tthis.g = g;\r\n\t\t\tthis.b = b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetHSL: function ( h, s, l ) {\r\n\r\n\t\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\t\t\th = MathUtils.euclideanModulo( h, 1 );\r\n\t\t\ts = MathUtils.clamp( s, 0, 1 );\r\n\t\t\tl = MathUtils.clamp( l, 0, 1 );\r\n\r\n\t\t\tif ( s === 0 ) {\r\n\r\n\t\t\t\tthis.r = this.g = this.b = l;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\r\n\t\t\t\tvar q = ( 2 * l ) - p;\r\n\r\n\t\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\r\n\t\t\t\tthis.g = hue2rgb( q, p, h );\r\n\t\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetStyle: function ( style ) {\r\n\r\n\t\t\tfunction handleAlpha( string ) {\r\n\r\n\t\t\t\tif ( string === undefined ) { return; }\r\n\r\n\t\t\t\tif ( parseFloat( string ) < 1 ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar m;\r\n\r\n\t\t\tif ( m = /^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec( style ) ) {\r\n\r\n\t\t\t\t// rgb / hsl\r\n\r\n\t\t\t\tvar color;\r\n\t\t\t\tvar name = m[ 1 ];\r\n\t\t\t\tvar components = m[ 2 ];\r\n\r\n\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\tcase 'rgb':\r\n\t\t\t\t\tcase 'rgba':\r\n\r\n\t\t\t\t\t\tif ( color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\r\n\t\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\r\n\t\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\r\n\t\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\r\n\r\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\r\n\t\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\r\n\t\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\r\n\t\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\r\n\r\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'hsl':\r\n\t\t\t\t\tcase 'hsla':\r\n\r\n\t\t\t\t\t\tif ( color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(,\\s*([0-9]*\\.?[0-9]+)\\s*)?$/.exec( components ) ) {\r\n\r\n\t\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\r\n\t\t\t\t\t\t\tvar h = parseFloat( color[ 1 ] ) / 360;\r\n\t\t\t\t\t\t\tvar s = parseInt( color[ 2 ], 10 ) / 100;\r\n\t\t\t\t\t\t\tvar l = parseInt( color[ 3 ], 10 ) / 100;\r\n\r\n\t\t\t\t\t\t\thandleAlpha( color[ 5 ] );\r\n\r\n\t\t\t\t\t\t\treturn this.setHSL( h, s, l );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( m = /^\\#([A-Fa-f0-9]+)$/.exec( style ) ) {\r\n\r\n\t\t\t\t// hex color\r\n\r\n\t\t\t\tvar hex = m[ 1 ];\r\n\t\t\t\tvar size = hex.length;\r\n\r\n\t\t\t\tif ( size === 3 ) {\r\n\r\n\t\t\t\t\t// #ff0\r\n\t\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\r\n\t\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t} else if ( size === 6 ) {\r\n\r\n\t\t\t\t\t// #ff0000\r\n\t\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\r\n\t\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\r\n\t\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( style && style.length > 0 ) {\r\n\r\n\t\t\t\treturn this.setColorName( style );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetColorName: function ( style ) {\r\n\r\n\t\t\t// color keywords\r\n\t\t\tvar hex = _colorKeywords[ style ];\r\n\r\n\t\t\tif ( hex !== undefined ) {\r\n\r\n\t\t\t\t// red\r\n\t\t\t\tthis.setHex( hex );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// unknown color\r\n\t\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.r, this.g, this.b );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( color ) {\r\n\r\n\t\t\tthis.r = color.r;\r\n\t\t\tthis.g = color.g;\r\n\t\t\tthis.b = color.b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyGammaToLinear: function ( color, gammaFactor ) {\r\n\r\n\t\t\tif ( gammaFactor === undefined ) { gammaFactor = 2.0; }\r\n\r\n\t\t\tthis.r = Math.pow( color.r, gammaFactor );\r\n\t\t\tthis.g = Math.pow( color.g, gammaFactor );\r\n\t\t\tthis.b = Math.pow( color.b, gammaFactor );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyLinearToGamma: function ( color, gammaFactor ) {\r\n\r\n\t\t\tif ( gammaFactor === undefined ) { gammaFactor = 2.0; }\r\n\r\n\t\t\tvar safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\r\n\r\n\t\t\tthis.r = Math.pow( color.r, safeInverse );\r\n\t\t\tthis.g = Math.pow( color.g, safeInverse );\r\n\t\t\tthis.b = Math.pow( color.b, safeInverse );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tconvertGammaToLinear: function ( gammaFactor ) {\r\n\r\n\t\t\tthis.copyGammaToLinear( this, gammaFactor );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tconvertLinearToGamma: function ( gammaFactor ) {\r\n\r\n\t\t\tthis.copyLinearToGamma( this, gammaFactor );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopySRGBToLinear: function ( color ) {\r\n\r\n\t\t\tthis.r = SRGBToLinear( color.r );\r\n\t\t\tthis.g = SRGBToLinear( color.g );\r\n\t\t\tthis.b = SRGBToLinear( color.b );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyLinearToSRGB: function ( color ) {\r\n\r\n\t\t\tthis.r = LinearToSRGB( color.r );\r\n\t\t\tthis.g = LinearToSRGB( color.g );\r\n\t\t\tthis.b = LinearToSRGB( color.b );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tconvertSRGBToLinear: function () {\r\n\r\n\t\t\tthis.copySRGBToLinear( this );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tconvertLinearToSRGB: function () {\r\n\r\n\t\t\tthis.copyLinearToSRGB( this );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetHex: function () {\r\n\r\n\t\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\r\n\r\n\t\t},\r\n\r\n\t\tgetHexString: function () {\r\n\r\n\t\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\r\n\r\n\t\t},\r\n\r\n\t\tgetHSL: function ( target ) {\r\n\r\n\t\t\t// h,s,l ranges are in 0.0 - 1.0\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Color: .getHSL() target is now required' );\r\n\t\t\t\ttarget = { h: 0, s: 0, l: 0 };\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar r = this.r, g = this.g, b = this.b;\r\n\r\n\t\t\tvar max = Math.max( r, g, b );\r\n\t\t\tvar min = Math.min( r, g, b );\r\n\r\n\t\t\tvar hue, saturation;\r\n\t\t\tvar lightness = ( min + max ) / 2.0;\r\n\r\n\t\t\tif ( min === max ) {\r\n\r\n\t\t\t\thue = 0;\r\n\t\t\t\tsaturation = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar delta = max - min;\r\n\r\n\t\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\r\n\r\n\t\t\t\tswitch ( max ) {\r\n\r\n\t\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\r\n\t\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\r\n\t\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\thue /= 6;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttarget.h = hue;\r\n\t\t\ttarget.s = saturation;\r\n\t\t\ttarget.l = lightness;\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tgetStyle: function () {\r\n\r\n\t\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\r\n\r\n\t\t},\r\n\r\n\t\toffsetHSL: function ( h, s, l ) {\r\n\r\n\t\t\tthis.getHSL( _hslA );\r\n\r\n\t\t\t_hslA.h += h; _hslA.s += s; _hslA.l += l;\r\n\r\n\t\t\tthis.setHSL( _hslA.h, _hslA.s, _hslA.l );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tadd: function ( color ) {\r\n\r\n\t\t\tthis.r += color.r;\r\n\t\t\tthis.g += color.g;\r\n\t\t\tthis.b += color.b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddColors: function ( color1, color2 ) {\r\n\r\n\t\t\tthis.r = color1.r + color2.r;\r\n\t\t\tthis.g = color1.g + color2.g;\r\n\t\t\tthis.b = color1.b + color2.b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScalar: function ( s ) {\r\n\r\n\t\t\tthis.r += s;\r\n\t\t\tthis.g += s;\r\n\t\t\tthis.b += s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsub: function ( color ) {\r\n\r\n\t\t\tthis.r = Math.max( 0, this.r - color.r );\r\n\t\t\tthis.g = Math.max( 0, this.g - color.g );\r\n\t\t\tthis.b = Math.max( 0, this.b - color.b );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( color ) {\r\n\r\n\t\t\tthis.r *= color.r;\r\n\t\t\tthis.g *= color.g;\r\n\t\t\tthis.b *= color.b;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( s ) {\r\n\r\n\t\t\tthis.r *= s;\r\n\t\t\tthis.g *= s;\r\n\t\t\tthis.b *= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerp: function ( color, alpha ) {\r\n\r\n\t\t\tthis.r += ( color.r - this.r ) * alpha;\r\n\t\t\tthis.g += ( color.g - this.g ) * alpha;\r\n\t\t\tthis.b += ( color.b - this.b ) * alpha;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerpHSL: function ( color, alpha ) {\r\n\r\n\t\t\tthis.getHSL( _hslA );\r\n\t\t\tcolor.getHSL( _hslB );\r\n\r\n\t\t\tvar h = MathUtils.lerp( _hslA.h, _hslB.h, alpha );\r\n\t\t\tvar s = MathUtils.lerp( _hslA.s, _hslB.s, alpha );\r\n\t\t\tvar l = MathUtils.lerp( _hslA.l, _hslB.l, alpha );\r\n\r\n\t\t\tthis.setHSL( h, s, l );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( c ) {\r\n\r\n\t\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tthis.r = array[ offset ];\r\n\t\t\tthis.g = array[ offset + 1 ];\r\n\t\t\tthis.b = array[ offset + 2 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) { array = []; }\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tarray[ offset ] = this.r;\r\n\t\t\tarray[ offset + 1 ] = this.g;\r\n\t\t\tarray[ offset + 2 ] = this.b;\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\treturn this.getHex();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tColor.NAMES = _colorKeywords;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Face3( a, b, c, normal, color, materialIndex ) {\r\n\r\n\t\tthis.a = a;\r\n\t\tthis.b = b;\r\n\t\tthis.c = c;\r\n\r\n\t\tthis.normal = ( normal && normal.isVector3 ) ? normal : new Vector3();\r\n\t\tthis.vertexNormals = Array.isArray( normal ) ? normal : [];\r\n\r\n\t\tthis.color = ( color && color.isColor ) ? color : new Color();\r\n\t\tthis.vertexColors = Array.isArray( color ) ? color : [];\r\n\r\n\t\tthis.materialIndex = materialIndex !== undefined ? materialIndex : 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( Face3.prototype, {\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.a = source.a;\r\n\t\t\tthis.b = source.b;\r\n\t\t\tthis.c = source.c;\r\n\r\n\t\t\tthis.normal.copy( source.normal );\r\n\t\t\tthis.color.copy( source.color );\r\n\r\n\t\t\tthis.materialIndex = source.materialIndex;\r\n\r\n\t\t\tfor ( var i = 0, il = source.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.vertexNormals[ i ] = source.vertexNormals[ i ].clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, il = source.vertexColors.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.vertexColors[ i ] = source.vertexColors[ i ].clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tvar materialId = 0;\r\n\r\n\tfunction Material() {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: materialId ++ } );\r\n\r\n\t\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'Material';\r\n\r\n\t\tthis.fog = true;\r\n\r\n\t\tthis.blending = NormalBlending;\r\n\t\tthis.side = FrontSide;\r\n\t\tthis.flatShading = false;\r\n\t\tthis.vertexColors = false;\r\n\r\n\t\tthis.opacity = 1;\r\n\t\tthis.transparent = false;\r\n\r\n\t\tthis.blendSrc = SrcAlphaFactor;\r\n\t\tthis.blendDst = OneMinusSrcAlphaFactor;\r\n\t\tthis.blendEquation = AddEquation;\r\n\t\tthis.blendSrcAlpha = null;\r\n\t\tthis.blendDstAlpha = null;\r\n\t\tthis.blendEquationAlpha = null;\r\n\r\n\t\tthis.depthFunc = LessEqualDepth;\r\n\t\tthis.depthTest = true;\r\n\t\tthis.depthWrite = true;\r\n\r\n\t\tthis.stencilWriteMask = 0xff;\r\n\t\tthis.stencilFunc = AlwaysStencilFunc;\r\n\t\tthis.stencilRef = 0;\r\n\t\tthis.stencilFuncMask = 0xff;\r\n\t\tthis.stencilFail = KeepStencilOp;\r\n\t\tthis.stencilZFail = KeepStencilOp;\r\n\t\tthis.stencilZPass = KeepStencilOp;\r\n\t\tthis.stencilWrite = false;\r\n\r\n\t\tthis.clippingPlanes = null;\r\n\t\tthis.clipIntersection = false;\r\n\t\tthis.clipShadows = false;\r\n\r\n\t\tthis.shadowSide = null;\r\n\r\n\t\tthis.colorWrite = true;\r\n\r\n\t\tthis.precision = null; // override the renderer's default precision for this material\r\n\r\n\t\tthis.polygonOffset = false;\r\n\t\tthis.polygonOffsetFactor = 0;\r\n\t\tthis.polygonOffsetUnits = 0;\r\n\r\n\t\tthis.dithering = false;\r\n\r\n\t\tthis.alphaTest = 0;\r\n\t\tthis.premultipliedAlpha = false;\r\n\r\n\t\tthis.visible = true;\r\n\r\n\t\tthis.toneMapped = true;\r\n\r\n\t\tthis.userData = {};\r\n\r\n\t\tthis.version = 0;\r\n\r\n\t}\r\n\r\n\tMaterial.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: Material,\r\n\r\n\t\tisMaterial: true,\r\n\r\n\t\tonBeforeCompile: function () {},\r\n\r\n\t\tsetValues: function ( values ) {\r\n\r\n\t\t\tif ( values === undefined ) { return; }\r\n\r\n\t\t\tfor ( var key in values ) {\r\n\r\n\t\t\t\tvar newValue = values[ key ];\r\n\r\n\t\t\t\tif ( newValue === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( \"THREE.Material: '\" + key + \"' parameter is undefined.\" );\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// for backward compatability if shading is set in the constructor\r\n\t\t\t\tif ( key === 'shading' ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\r\n\t\t\t\t\tthis.flatShading = ( newValue === FlatShading ) ? true : false;\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar currentValue = this[ key ];\r\n\r\n\t\t\t\tif ( currentValue === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( \"THREE.\" + this.type + \": '\" + key + \"' is not a property of this material.\" );\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( currentValue && currentValue.isColor ) {\r\n\r\n\t\t\t\t\tcurrentValue.set( newValue );\r\n\r\n\t\t\t\t} else if ( ( currentValue && currentValue.isVector3 ) && ( newValue && newValue.isVector3 ) ) {\r\n\r\n\t\t\t\t\tcurrentValue.copy( newValue );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis[ key ] = newValue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar isRoot = ( meta === undefined || typeof meta === 'string' );\r\n\r\n\t\t\tif ( isRoot ) {\r\n\r\n\t\t\t\tmeta = {\r\n\t\t\t\t\ttextures: {},\r\n\t\t\t\t\timages: {}\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Material',\r\n\t\t\t\t\tgenerator: 'Material.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// standard Material serialization\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = this.type;\r\n\r\n\t\t\tif ( this.name !== '' ) { data.name = this.name; }\r\n\r\n\t\t\tif ( this.color && this.color.isColor ) { data.color = this.color.getHex(); }\r\n\r\n\t\t\tif ( this.roughness !== undefined ) { data.roughness = this.roughness; }\r\n\t\t\tif ( this.metalness !== undefined ) { data.metalness = this.metalness; }\r\n\r\n\t\t\tif ( this.sheen && this.sheen.isColor ) { data.sheen = this.sheen.getHex(); }\r\n\t\t\tif ( this.emissive && this.emissive.isColor ) { data.emissive = this.emissive.getHex(); }\r\n\t\t\tif ( this.emissiveIntensity && this.emissiveIntensity !== 1 ) { data.emissiveIntensity = this.emissiveIntensity; }\r\n\r\n\t\t\tif ( this.specular && this.specular.isColor ) { data.specular = this.specular.getHex(); }\r\n\t\t\tif ( this.shininess !== undefined ) { data.shininess = this.shininess; }\r\n\t\t\tif ( this.clearcoat !== undefined ) { data.clearcoat = this.clearcoat; }\r\n\t\t\tif ( this.clearcoatRoughness !== undefined ) { data.clearcoatRoughness = this.clearcoatRoughness; }\r\n\r\n\t\t\tif ( this.clearcoatMap && this.clearcoatMap.isTexture ) {\r\n\r\n\t\t\t\tdata.clearcoatMap = this.clearcoatMap.toJSON( meta ).uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture ) {\r\n\r\n\t\t\t\tdata.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON( meta ).uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture ) {\r\n\r\n\t\t\t\tdata.clearcoatNormalMap = this.clearcoatNormalMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.clearcoatNormalScale = this.clearcoatNormalScale.toArray();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.map && this.map.isTexture ) { data.map = this.map.toJSON( meta ).uuid; }\r\n\t\t\tif ( this.matcap && this.matcap.isTexture ) { data.matcap = this.matcap.toJSON( meta ).uuid; }\r\n\t\t\tif ( this.alphaMap && this.alphaMap.isTexture ) { data.alphaMap = this.alphaMap.toJSON( meta ).uuid; }\r\n\t\t\tif ( this.lightMap && this.lightMap.isTexture ) { data.lightMap = this.lightMap.toJSON( meta ).uuid; }\r\n\r\n\t\t\tif ( this.aoMap && this.aoMap.isTexture ) {\r\n\r\n\t\t\t\tdata.aoMap = this.aoMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.aoMapIntensity = this.aoMapIntensity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.bumpMap && this.bumpMap.isTexture ) {\r\n\r\n\t\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.bumpScale = this.bumpScale;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.normalMap && this.normalMap.isTexture ) {\r\n\r\n\t\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.normalMapType = this.normalMapType;\r\n\t\t\t\tdata.normalScale = this.normalScale.toArray();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.displacementMap && this.displacementMap.isTexture ) {\r\n\r\n\t\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.displacementScale = this.displacementScale;\r\n\t\t\t\tdata.displacementBias = this.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.roughnessMap && this.roughnessMap.isTexture ) { data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid; }\r\n\t\t\tif ( this.metalnessMap && this.metalnessMap.isTexture ) { data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid; }\r\n\r\n\t\t\tif ( this.emissiveMap && this.emissiveMap.isTexture ) { data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid; }\r\n\t\t\tif ( this.specularMap && this.specularMap.isTexture ) { data.specularMap = this.specularMap.toJSON( meta ).uuid; }\r\n\r\n\t\t\tif ( this.envMap && this.envMap.isTexture ) {\r\n\r\n\t\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\r\n\t\t\t\tdata.reflectivity = this.reflectivity; // Scale behind envMap\r\n\t\t\t\tdata.refractionRatio = this.refractionRatio;\r\n\r\n\t\t\t\tif ( this.combine !== undefined ) { data.combine = this.combine; }\r\n\t\t\t\tif ( this.envMapIntensity !== undefined ) { data.envMapIntensity = this.envMapIntensity; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.gradientMap && this.gradientMap.isTexture ) {\r\n\r\n\t\t\t\tdata.gradientMap = this.gradientMap.toJSON( meta ).uuid;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.size !== undefined ) { data.size = this.size; }\r\n\t\t\tif ( this.sizeAttenuation !== undefined ) { data.sizeAttenuation = this.sizeAttenuation; }\r\n\r\n\t\t\tif ( this.blending !== NormalBlending ) { data.blending = this.blending; }\r\n\t\t\tif ( this.flatShading === true ) { data.flatShading = this.flatShading; }\r\n\t\t\tif ( this.side !== FrontSide ) { data.side = this.side; }\r\n\t\t\tif ( this.vertexColors ) { data.vertexColors = true; }\r\n\r\n\t\t\tif ( this.opacity < 1 ) { data.opacity = this.opacity; }\r\n\t\t\tif ( this.transparent === true ) { data.transparent = this.transparent; }\r\n\r\n\t\t\tdata.depthFunc = this.depthFunc;\r\n\t\t\tdata.depthTest = this.depthTest;\r\n\t\t\tdata.depthWrite = this.depthWrite;\r\n\r\n\t\t\tdata.stencilWrite = this.stencilWrite;\r\n\t\t\tdata.stencilWriteMask = this.stencilWriteMask;\r\n\t\t\tdata.stencilFunc = this.stencilFunc;\r\n\t\t\tdata.stencilRef = this.stencilRef;\r\n\t\t\tdata.stencilFuncMask = this.stencilFuncMask;\r\n\t\t\tdata.stencilFail = this.stencilFail;\r\n\t\t\tdata.stencilZFail = this.stencilZFail;\r\n\t\t\tdata.stencilZPass = this.stencilZPass;\r\n\r\n\t\t\t// rotation (SpriteMaterial)\r\n\t\t\tif ( this.rotation && this.rotation !== 0 ) { data.rotation = this.rotation; }\r\n\r\n\t\t\tif ( this.polygonOffset === true ) { data.polygonOffset = true; }\r\n\t\t\tif ( this.polygonOffsetFactor !== 0 ) { data.polygonOffsetFactor = this.polygonOffsetFactor; }\r\n\t\t\tif ( this.polygonOffsetUnits !== 0 ) { data.polygonOffsetUnits = this.polygonOffsetUnits; }\r\n\r\n\t\t\tif ( this.linewidth && this.linewidth !== 1 ) { data.linewidth = this.linewidth; }\r\n\t\t\tif ( this.dashSize !== undefined ) { data.dashSize = this.dashSize; }\r\n\t\t\tif ( this.gapSize !== undefined ) { data.gapSize = this.gapSize; }\r\n\t\t\tif ( this.scale !== undefined ) { data.scale = this.scale; }\r\n\r\n\t\t\tif ( this.dithering === true ) { data.dithering = true; }\r\n\r\n\t\t\tif ( this.alphaTest > 0 ) { data.alphaTest = this.alphaTest; }\r\n\t\t\tif ( this.premultipliedAlpha === true ) { data.premultipliedAlpha = this.premultipliedAlpha; }\r\n\r\n\t\t\tif ( this.wireframe === true ) { data.wireframe = this.wireframe; }\r\n\t\t\tif ( this.wireframeLinewidth > 1 ) { data.wireframeLinewidth = this.wireframeLinewidth; }\r\n\t\t\tif ( this.wireframeLinecap !== 'round' ) { data.wireframeLinecap = this.wireframeLinecap; }\r\n\t\t\tif ( this.wireframeLinejoin !== 'round' ) { data.wireframeLinejoin = this.wireframeLinejoin; }\r\n\r\n\t\t\tif ( this.morphTargets === true ) { data.morphTargets = true; }\r\n\t\t\tif ( this.morphNormals === true ) { data.morphNormals = true; }\r\n\t\t\tif ( this.skinning === true ) { data.skinning = true; }\r\n\r\n\t\t\tif ( this.visible === false ) { data.visible = false; }\r\n\r\n\t\t\tif ( this.toneMapped === false ) { data.toneMapped = false; }\r\n\r\n\t\t\tif ( JSON.stringify( this.userData ) !== '{}' ) { data.userData = this.userData; }\r\n\r\n\t\t\t// TODO: Copied from Object3D.toJSON\r\n\r\n\t\t\tfunction extractFromCache( cache ) {\r\n\r\n\t\t\t\tvar values = [];\r\n\r\n\t\t\t\tfor ( var key in cache ) {\r\n\r\n\t\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\t\tdelete data.metadata;\r\n\t\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn values;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( isRoot ) {\r\n\r\n\t\t\t\tvar textures = extractFromCache( meta.textures );\r\n\t\t\t\tvar images = extractFromCache( meta.images );\r\n\r\n\t\t\t\tif ( textures.length > 0 ) { data.textures = textures; }\r\n\t\t\t\tif ( images.length > 0 ) { data.images = images; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\tthis.fog = source.fog;\r\n\r\n\t\t\tthis.blending = source.blending;\r\n\t\t\tthis.side = source.side;\r\n\t\t\tthis.flatShading = source.flatShading;\r\n\t\t\tthis.vertexColors = source.vertexColors;\r\n\r\n\t\t\tthis.opacity = source.opacity;\r\n\t\t\tthis.transparent = source.transparent;\r\n\r\n\t\t\tthis.blendSrc = source.blendSrc;\r\n\t\t\tthis.blendDst = source.blendDst;\r\n\t\t\tthis.blendEquation = source.blendEquation;\r\n\t\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\r\n\t\t\tthis.blendDstAlpha = source.blendDstAlpha;\r\n\t\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\r\n\r\n\t\t\tthis.depthFunc = source.depthFunc;\r\n\t\t\tthis.depthTest = source.depthTest;\r\n\t\t\tthis.depthWrite = source.depthWrite;\r\n\r\n\t\t\tthis.stencilWriteMask = source.stencilWriteMask;\r\n\t\t\tthis.stencilFunc = source.stencilFunc;\r\n\t\t\tthis.stencilRef = source.stencilRef;\r\n\t\t\tthis.stencilFuncMask = source.stencilFuncMask;\r\n\t\t\tthis.stencilFail = source.stencilFail;\r\n\t\t\tthis.stencilZFail = source.stencilZFail;\r\n\t\t\tthis.stencilZPass = source.stencilZPass;\r\n\t\t\tthis.stencilWrite = source.stencilWrite;\r\n\r\n\t\t\tvar srcPlanes = source.clippingPlanes,\r\n\t\t\t\tdstPlanes = null;\r\n\r\n\t\t\tif ( srcPlanes !== null ) {\r\n\r\n\t\t\t\tvar n = srcPlanes.length;\r\n\t\t\t\tdstPlanes = new Array( n );\r\n\r\n\t\t\t\tfor ( var i = 0; i !== n; ++ i )\r\n\t\t\t\t\t{ dstPlanes[ i ] = srcPlanes[ i ].clone(); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.clippingPlanes = dstPlanes;\r\n\t\t\tthis.clipIntersection = source.clipIntersection;\r\n\t\t\tthis.clipShadows = source.clipShadows;\r\n\r\n\t\t\tthis.shadowSide = source.shadowSide;\r\n\r\n\t\t\tthis.colorWrite = source.colorWrite;\r\n\r\n\t\t\tthis.precision = source.precision;\r\n\r\n\t\t\tthis.polygonOffset = source.polygonOffset;\r\n\t\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\r\n\t\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\r\n\r\n\t\t\tthis.dithering = source.dithering;\r\n\r\n\t\t\tthis.alphaTest = source.alphaTest;\r\n\t\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\r\n\r\n\t\t\tthis.visible = source.visible;\r\n\r\n\t\t\tthis.toneMapped = source.toneMapped;\r\n\r\n\t\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperty( Material.prototype, 'needsUpdate', {\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value === true ) { this.version ++; }\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  combine: THREE.Multiply,\r\n\t *  reflectivity: <float>,\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  depthTest: <bool>,\r\n\t *  depthWrite: <bool>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshBasicMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshBasicMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff ); // emissive\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\r\n\t\tthis.specularMap = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.envMap = null;\r\n\t\tthis.combine = MultiplyOperation;\r\n\t\tthis.reflectivity = 1;\r\n\t\tthis.refractionRatio = 0.98;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshBasicMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshBasicMaterial.prototype.constructor = MeshBasicMaterial;\r\n\r\n\tMeshBasicMaterial.prototype.isMeshBasicMaterial = true;\r\n\r\n\tMeshBasicMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\t\tthis.specularMap = source.specularMap;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.combine = source.combine;\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _vector$3 = new Vector3();\r\n\r\n\tfunction BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tif ( Array.isArray( array ) ) {\r\n\r\n\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\r\n\r\n\t\t}\r\n\r\n\t\tthis.name = '';\r\n\r\n\t\tthis.array = array;\r\n\t\tthis.itemSize = itemSize;\r\n\t\tthis.count = array !== undefined ? array.length / itemSize : 0;\r\n\t\tthis.normalized = normalized === true;\r\n\r\n\t\tthis.usage = StaticDrawUsage;\r\n\t\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\t\tthis.version = 0;\r\n\r\n\t}\r\n\r\n\tObject.defineProperty( BufferAttribute.prototype, 'needsUpdate', {\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value === true ) { this.version ++; }\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( BufferAttribute.prototype, {\r\n\r\n\t\tisBufferAttribute: true,\r\n\r\n\t\tonUploadCallback: function () {},\r\n\r\n\t\tsetUsage: function ( value ) {\r\n\r\n\t\t\tthis.usage = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.name = source.name;\r\n\t\t\tthis.array = new source.array.constructor( source.array );\r\n\t\t\tthis.itemSize = source.itemSize;\r\n\t\t\tthis.count = source.count;\r\n\t\t\tthis.normalized = source.normalized;\r\n\r\n\t\t\tthis.usage = source.usage;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\t\tindex1 *= this.itemSize;\r\n\t\t\tindex2 *= attribute.itemSize;\r\n\r\n\t\t\tfor ( var i = 0, l = this.itemSize; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyArray: function ( array ) {\r\n\r\n\t\t\tthis.array.set( array );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyColorsArray: function ( colors ) {\r\n\r\n\t\t\tvar array = this.array, offset = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = colors.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar color = colors[ i ];\r\n\r\n\t\t\t\tif ( color === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\r\n\t\t\t\t\tcolor = new Color();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarray[ offset ++ ] = color.r;\r\n\t\t\t\tarray[ offset ++ ] = color.g;\r\n\t\t\t\tarray[ offset ++ ] = color.b;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyVector2sArray: function ( vectors ) {\r\n\r\n\t\t\tvar array = this.array, offset = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\r\n\t\t\t\t\tvector = new Vector2();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\t\tarray[ offset ++ ] = vector.y;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyVector3sArray: function ( vectors ) {\r\n\r\n\t\t\tvar array = this.array, offset = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\r\n\t\t\t\t\tvector = new Vector3();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\t\tarray[ offset ++ ] = vector.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyVector4sArray: function ( vectors ) {\r\n\r\n\t\t\tvar array = this.array, offset = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar vector = vectors[ i ];\r\n\r\n\t\t\t\tif ( vector === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\r\n\t\t\t\t\tvector = new Vector4();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarray[ offset ++ ] = vector.x;\r\n\t\t\t\tarray[ offset ++ ] = vector.y;\r\n\t\t\t\tarray[ offset ++ ] = vector.z;\r\n\t\t\t\tarray[ offset ++ ] = vector.w;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix3: function ( m ) {\r\n\r\n\t\t\tfor ( var i = 0, l = this.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t_vector$3.x = this.getX( i );\r\n\t\t\t\t_vector$3.y = this.getY( i );\r\n\t\t\t\t_vector$3.z = this.getZ( i );\r\n\r\n\t\t\t\t_vector$3.applyMatrix3( m );\r\n\r\n\t\t\t\tthis.setXYZ( i, _vector$3.x, _vector$3.y, _vector$3.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t\tfor ( var i = 0, l = this.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t_vector$3.x = this.getX( i );\r\n\t\t\t\t_vector$3.y = this.getY( i );\r\n\t\t\t\t_vector$3.z = this.getZ( i );\r\n\r\n\t\t\t\t_vector$3.applyMatrix4( m );\r\n\r\n\t\t\t\tthis.setXYZ( i, _vector$3.x, _vector$3.y, _vector$3.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tapplyNormalMatrix: function ( m ) {\r\n\r\n\t\t\tfor ( var i = 0, l = this.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t_vector$3.x = this.getX( i );\r\n\t\t\t\t_vector$3.y = this.getY( i );\r\n\t\t\t\t_vector$3.z = this.getZ( i );\r\n\r\n\t\t\t\t_vector$3.applyNormalMatrix( m );\r\n\r\n\t\t\t\tthis.setXYZ( i, _vector$3.x, _vector$3.y, _vector$3.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttransformDirection: function ( m ) {\r\n\r\n\t\t\tfor ( var i = 0, l = this.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t_vector$3.x = this.getX( i );\r\n\t\t\t\t_vector$3.y = this.getY( i );\r\n\t\t\t\t_vector$3.z = this.getZ( i );\r\n\r\n\t\t\t\t_vector$3.transformDirection( m );\r\n\r\n\t\t\t\tthis.setXYZ( i, _vector$3.x, _vector$3.y, _vector$3.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tthis.array.set( value, offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetX: function ( index ) {\r\n\r\n\t\t\treturn this.array[ index * this.itemSize ];\r\n\r\n\t\t},\r\n\r\n\t\tsetX: function ( index, x ) {\r\n\r\n\t\t\tthis.array[ index * this.itemSize ] = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetY: function ( index ) {\r\n\r\n\t\t\treturn this.array[ index * this.itemSize + 1 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( index, y ) {\r\n\r\n\t\t\tthis.array[ index * this.itemSize + 1 ] = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetZ: function ( index ) {\r\n\r\n\t\t\treturn this.array[ index * this.itemSize + 2 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetZ: function ( index, z ) {\r\n\r\n\t\t\tthis.array[ index * this.itemSize + 2 ] = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetW: function ( index ) {\r\n\r\n\t\t\treturn this.array[ index * this.itemSize + 3 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetW: function ( index, w ) {\r\n\r\n\t\t\tthis.array[ index * this.itemSize + 3 ] = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXY: function ( index, x, y ) {\r\n\r\n\t\t\tindex *= this.itemSize;\r\n\r\n\t\t\tthis.array[ index + 0 ] = x;\r\n\t\t\tthis.array[ index + 1 ] = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\t\tindex *= this.itemSize;\r\n\r\n\t\t\tthis.array[ index + 0 ] = x;\r\n\t\t\tthis.array[ index + 1 ] = y;\r\n\t\t\tthis.array[ index + 2 ] = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\t\tindex *= this.itemSize;\r\n\r\n\t\t\tthis.array[ index + 0 ] = x;\r\n\t\t\tthis.array[ index + 1 ] = y;\r\n\t\t\tthis.array[ index + 2 ] = z;\r\n\t\t\tthis.array[ index + 3 ] = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tonUpload: function ( callback ) {\r\n\r\n\t\t\tthis.onUploadCallback = callback;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.array, this.itemSize ).copy( this );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\treturn {\r\n\t\t\t\titemSize: this.itemSize,\r\n\t\t\t\ttype: this.array.constructor.name,\r\n\t\t\t\tarray: Array.prototype.slice.call( this.array ),\r\n\t\t\t\tnormalized: this.normalized\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tfunction Int8BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Int8Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tInt8BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tInt8BufferAttribute.prototype.constructor = Int8BufferAttribute;\r\n\r\n\r\n\tfunction Uint8BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Uint8Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tUint8BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tUint8BufferAttribute.prototype.constructor = Uint8BufferAttribute;\r\n\r\n\r\n\tfunction Uint8ClampedBufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Uint8ClampedArray( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tUint8ClampedBufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tUint8ClampedBufferAttribute.prototype.constructor = Uint8ClampedBufferAttribute;\r\n\r\n\r\n\tfunction Int16BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Int16Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tInt16BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tInt16BufferAttribute.prototype.constructor = Int16BufferAttribute;\r\n\r\n\r\n\tfunction Uint16BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Uint16Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tUint16BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tUint16BufferAttribute.prototype.constructor = Uint16BufferAttribute;\r\n\r\n\r\n\tfunction Int32BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Int32Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tInt32BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tInt32BufferAttribute.prototype.constructor = Int32BufferAttribute;\r\n\r\n\r\n\tfunction Uint32BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Uint32Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tUint32BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tUint32BufferAttribute.prototype.constructor = Uint32BufferAttribute;\r\n\r\n\r\n\tfunction Float32BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Float32Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tFloat32BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tFloat32BufferAttribute.prototype.constructor = Float32BufferAttribute;\r\n\r\n\r\n\tfunction Float64BufferAttribute( array, itemSize, normalized ) {\r\n\r\n\t\tBufferAttribute.call( this, new Float64Array( array ), itemSize, normalized );\r\n\r\n\t}\r\n\r\n\tFloat64BufferAttribute.prototype = Object.create( BufferAttribute.prototype );\r\n\tFloat64BufferAttribute.prototype.constructor = Float64BufferAttribute;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction DirectGeometry() {\r\n\r\n\t\tthis.vertices = [];\r\n\t\tthis.normals = [];\r\n\t\tthis.colors = [];\r\n\t\tthis.uvs = [];\r\n\t\tthis.uvs2 = [];\r\n\r\n\t\tthis.groups = [];\r\n\r\n\t\tthis.morphTargets = {};\r\n\r\n\t\tthis.skinWeights = [];\r\n\t\tthis.skinIndices = [];\r\n\r\n\t\t// this.lineDistances = [];\r\n\r\n\t\tthis.boundingBox = null;\r\n\t\tthis.boundingSphere = null;\r\n\r\n\t\t// update flags\r\n\r\n\t\tthis.verticesNeedUpdate = false;\r\n\t\tthis.normalsNeedUpdate = false;\r\n\t\tthis.colorsNeedUpdate = false;\r\n\t\tthis.uvsNeedUpdate = false;\r\n\t\tthis.groupsNeedUpdate = false;\r\n\r\n\t}\r\n\r\n\tObject.assign( DirectGeometry.prototype, {\r\n\r\n\t\tcomputeGroups: function ( geometry ) {\r\n\r\n\t\t\tvar group;\r\n\t\t\tvar groups = [];\r\n\t\t\tvar materialIndex = undefined;\r\n\r\n\t\t\tvar faces = geometry.faces;\r\n\r\n\t\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\t// materials\r\n\r\n\t\t\t\tif ( face.materialIndex !== materialIndex ) {\r\n\r\n\t\t\t\t\tmaterialIndex = face.materialIndex;\r\n\r\n\t\t\t\t\tif ( group !== undefined ) {\r\n\r\n\t\t\t\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\t\t\t\tgroups.push( group );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgroup = {\r\n\t\t\t\t\t\tstart: i * 3,\r\n\t\t\t\t\t\tmaterialIndex: materialIndex\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( group !== undefined ) {\r\n\r\n\t\t\t\tgroup.count = ( i * 3 ) - group.start;\r\n\t\t\t\tgroups.push( group );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.groups = groups;\r\n\r\n\t\t},\r\n\r\n\t\tfromGeometry: function ( geometry ) {\r\n\r\n\t\t\tvar faces = geometry.faces;\r\n\t\t\tvar vertices = geometry.vertices;\r\n\t\t\tvar faceVertexUvs = geometry.faceVertexUvs;\r\n\r\n\t\t\tvar hasFaceVertexUv = faceVertexUvs[ 0 ] && faceVertexUvs[ 0 ].length > 0;\r\n\t\t\tvar hasFaceVertexUv2 = faceVertexUvs[ 1 ] && faceVertexUvs[ 1 ].length > 0;\r\n\r\n\t\t\t// morphs\r\n\r\n\t\t\tvar morphTargets = geometry.morphTargets;\r\n\t\t\tvar morphTargetsLength = morphTargets.length;\r\n\r\n\t\t\tvar morphTargetsPosition;\r\n\r\n\t\t\tif ( morphTargetsLength > 0 ) {\r\n\r\n\t\t\t\tmorphTargetsPosition = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < morphTargetsLength; i ++ ) {\r\n\r\n\t\t\t\t\tmorphTargetsPosition[ i ] = {\r\n\t\t\t\t\t\tname: morphTargets[ i ].name,\r\n\t\t\t\t\t \tdata: []\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphTargets.position = morphTargetsPosition;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphNormals = geometry.morphNormals;\r\n\t\t\tvar morphNormalsLength = morphNormals.length;\r\n\r\n\t\t\tvar morphTargetsNormal;\r\n\r\n\t\t\tif ( morphNormalsLength > 0 ) {\r\n\r\n\t\t\t\tmorphTargetsNormal = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < morphNormalsLength; i ++ ) {\r\n\r\n\t\t\t\t\tmorphTargetsNormal[ i ] = {\r\n\t\t\t\t\t\tname: morphNormals[ i ].name,\r\n\t\t\t\t\t \tdata: []\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphTargets.normal = morphTargetsNormal;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skins\r\n\r\n\t\t\tvar skinIndices = geometry.skinIndices;\r\n\t\t\tvar skinWeights = geometry.skinWeights;\r\n\r\n\t\t\tvar hasSkinIndices = skinIndices.length === vertices.length;\r\n\t\t\tvar hasSkinWeights = skinWeights.length === vertices.length;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( vertices.length > 0 && faces.length === 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.DirectGeometry: Faceless geometries are not supported.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < faces.length; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tthis.vertices.push( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ] );\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\t\tthis.normals.push( vertexNormals[ 0 ], vertexNormals[ 1 ], vertexNormals[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar normal = face.normal;\r\n\r\n\t\t\t\t\tthis.normals.push( normal, normal, normal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\t\tif ( vertexColors.length === 3 ) {\r\n\r\n\t\t\t\t\tthis.colors.push( vertexColors[ 0 ], vertexColors[ 1 ], vertexColors[ 2 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar color = face.color;\r\n\r\n\t\t\t\t\tthis.colors.push( color, color, color );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexUv === true ) {\r\n\r\n\t\t\t\t\tvar vertexUvs = faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\t\tthis.uvs.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i );\r\n\r\n\t\t\t\t\t\tthis.uvs.push( new Vector2(), new Vector2(), new Vector2() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexUv2 === true ) {\r\n\r\n\t\t\t\t\tvar vertexUvs = faceVertexUvs[ 1 ][ i ];\r\n\r\n\t\t\t\t\tif ( vertexUvs !== undefined ) {\r\n\r\n\t\t\t\t\t\tthis.uvs2.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i );\r\n\r\n\t\t\t\t\t\tthis.uvs2.push( new Vector2(), new Vector2(), new Vector2() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// morphs\r\n\r\n\t\t\t\tfor ( var j = 0; j < morphTargetsLength; j ++ ) {\r\n\r\n\t\t\t\t\tvar morphTarget = morphTargets[ j ].vertices;\r\n\r\n\t\t\t\t\tmorphTargetsPosition[ j ].data.push( morphTarget[ face.a ], morphTarget[ face.b ], morphTarget[ face.c ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 0; j < morphNormalsLength; j ++ ) {\r\n\r\n\t\t\t\t\tvar morphNormal = morphNormals[ j ].vertexNormals[ i ];\r\n\r\n\t\t\t\t\tmorphTargetsNormal[ j ].data.push( morphNormal.a, morphNormal.b, morphNormal.c );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// skins\r\n\r\n\t\t\t\tif ( hasSkinIndices ) {\r\n\r\n\t\t\t\t\tthis.skinIndices.push( skinIndices[ face.a ], skinIndices[ face.b ], skinIndices[ face.c ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasSkinWeights ) {\r\n\r\n\t\t\t\t\tthis.skinWeights.push( skinWeights[ face.a ], skinWeights[ face.b ], skinWeights[ face.c ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.computeGroups( geometry );\r\n\r\n\t\t\tthis.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\t\tthis.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\t\tthis.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\t\tthis.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\t\tthis.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction arrayMax( array ) {\r\n\r\n\t\tif ( array.length === 0 ) { return - Infinity; }\r\n\r\n\t\tvar max = array[ 0 ];\r\n\r\n\t\tfor ( var i = 1, l = array.length; i < l; ++ i ) {\r\n\r\n\t\t\tif ( array[ i ] > max ) { max = array[ i ]; }\r\n\r\n\t\t}\r\n\r\n\t\treturn max;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _bufferGeometryId = 1; // BufferGeometry uses odd numbers as Id\r\n\r\n\tvar _m1$2 = new Matrix4();\r\n\tvar _obj = new Object3D();\r\n\tvar _offset = new Vector3();\r\n\tvar _box$2 = new Box3();\r\n\tvar _boxMorphTargets = new Box3();\r\n\tvar _vector$4 = new Vector3();\r\n\r\n\tfunction BufferGeometry() {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: _bufferGeometryId += 2 } );\r\n\r\n\t\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'BufferGeometry';\r\n\r\n\t\tthis.index = null;\r\n\t\tthis.attributes = {};\r\n\r\n\t\tthis.morphAttributes = {};\r\n\t\tthis.morphTargetsRelative = false;\r\n\r\n\t\tthis.groups = [];\r\n\r\n\t\tthis.boundingBox = null;\r\n\t\tthis.boundingSphere = null;\r\n\r\n\t\tthis.drawRange = { start: 0, count: Infinity };\r\n\r\n\t\tthis.userData = {};\r\n\r\n\t}\r\n\r\n\tBufferGeometry.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: BufferGeometry,\r\n\r\n\t\tisBufferGeometry: true,\r\n\r\n\t\tgetIndex: function () {\r\n\r\n\t\t\treturn this.index;\r\n\r\n\t\t},\r\n\r\n\t\tsetIndex: function ( index ) {\r\n\r\n\t\t\tif ( Array.isArray( index ) ) {\r\n\r\n\t\t\t\tthis.index = new ( arrayMax( index ) > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( index, 1 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.index = index;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tgetAttribute: function ( name ) {\r\n\r\n\t\t\treturn this.attributes[ name ];\r\n\r\n\t\t},\r\n\r\n\t\tsetAttribute: function ( name, attribute ) {\r\n\r\n\t\t\tthis.attributes[ name ] = attribute;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdeleteAttribute: function ( name ) {\r\n\r\n\t\t\tdelete this.attributes[ name ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddGroup: function ( start, count, materialIndex ) {\r\n\r\n\t\t\tthis.groups.push( {\r\n\r\n\t\t\t\tstart: start,\r\n\t\t\t\tcount: count,\r\n\t\t\t\tmaterialIndex: materialIndex !== undefined ? materialIndex : 0\r\n\r\n\t\t\t} );\r\n\r\n\t\t},\r\n\r\n\t\tclearGroups: function () {\r\n\r\n\t\t\tthis.groups = [];\r\n\r\n\t\t},\r\n\r\n\t\tsetDrawRange: function ( start, count ) {\r\n\r\n\t\t\tthis.drawRange.start = start;\r\n\t\t\tthis.drawRange.count = count;\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\t\tvar position = this.attributes.position;\r\n\r\n\t\t\tif ( position !== undefined ) {\r\n\r\n\t\t\t\tposition.applyMatrix4( matrix );\r\n\r\n\t\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar normal = this.attributes.normal;\r\n\r\n\t\t\tif ( normal !== undefined ) {\r\n\r\n\t\t\t\tvar normalMatrix = new Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\t\tnormal.applyNormalMatrix( normalMatrix );\r\n\r\n\t\t\t\tnormal.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar tangent = this.attributes.tangent;\r\n\r\n\t\t\tif ( tangent !== undefined ) {\r\n\r\n\t\t\t\ttangent.transformDirection( matrix );\r\n\r\n\t\t\t\ttangent.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateX: function ( angle ) {\r\n\r\n\t\t\t// rotate geometry around world x-axis\r\n\r\n\t\t\t_m1$2.makeRotationX( angle );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateY: function ( angle ) {\r\n\r\n\t\t\t// rotate geometry around world y-axis\r\n\r\n\t\t\t_m1$2.makeRotationY( angle );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateZ: function ( angle ) {\r\n\r\n\t\t\t// rotate geometry around world z-axis\r\n\r\n\t\t\t_m1$2.makeRotationZ( angle );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( x, y, z ) {\r\n\r\n\t\t\t// translate geometry\r\n\r\n\t\t\t_m1$2.makeTranslation( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tscale: function ( x, y, z ) {\r\n\r\n\t\t\t// scale geometry\r\n\r\n\t\t\t_m1$2.makeScale( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlookAt: function ( vector ) {\r\n\r\n\t\t\t_obj.lookAt( vector );\r\n\r\n\t\t\t_obj.updateMatrix();\r\n\r\n\t\t\tthis.applyMatrix4( _obj.matrix );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcenter: function () {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\tthis.boundingBox.getCenter( _offset ).negate();\r\n\r\n\t\t\tthis.translate( _offset.x, _offset.y, _offset.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromObject: function ( object ) {\r\n\r\n\t\t\t// console.log( 'THREE.BufferGeometry.setFromObject(). Converting', object, this );\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( object.isPoints || object.isLine ) {\r\n\r\n\t\t\t\tvar positions = new Float32BufferAttribute( geometry.vertices.length * 3, 3 );\r\n\t\t\t\tvar colors = new Float32BufferAttribute( geometry.colors.length * 3, 3 );\r\n\r\n\t\t\t\tthis.setAttribute( 'position', positions.copyVector3sArray( geometry.vertices ) );\r\n\t\t\t\tthis.setAttribute( 'color', colors.copyColorsArray( geometry.colors ) );\r\n\r\n\t\t\t\tif ( geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length ) {\r\n\r\n\t\t\t\t\tvar lineDistances = new Float32BufferAttribute( geometry.lineDistances.length, 1 );\r\n\r\n\t\t\t\t\tthis.setAttribute( 'lineDistance', lineDistances.copyArray( geometry.lineDistances ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object.isMesh ) {\r\n\r\n\t\t\t\tif ( geometry && geometry.isGeometry ) {\r\n\r\n\t\t\t\t\tthis.fromGeometry( geometry );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tvar position = [];\r\n\r\n\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar point = points[ i ];\r\n\t\t\t\tposition.push( point.x, point.y, point.z || 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tupdateFromObject: function ( object ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( object.isMesh ) {\r\n\r\n\t\t\t\tvar direct = geometry.__directGeometry;\r\n\r\n\t\t\t\tif ( geometry.elementsNeedUpdate === true ) {\r\n\r\n\t\t\t\t\tdirect = undefined;\r\n\t\t\t\t\tgeometry.elementsNeedUpdate = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( direct === undefined ) {\r\n\r\n\t\t\t\t\treturn this.fromGeometry( geometry );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdirect.verticesNeedUpdate = geometry.verticesNeedUpdate;\r\n\t\t\t\tdirect.normalsNeedUpdate = geometry.normalsNeedUpdate;\r\n\t\t\t\tdirect.colorsNeedUpdate = geometry.colorsNeedUpdate;\r\n\t\t\t\tdirect.uvsNeedUpdate = geometry.uvsNeedUpdate;\r\n\t\t\t\tdirect.groupsNeedUpdate = geometry.groupsNeedUpdate;\r\n\r\n\t\t\t\tgeometry.verticesNeedUpdate = false;\r\n\t\t\t\tgeometry.normalsNeedUpdate = false;\r\n\t\t\t\tgeometry.colorsNeedUpdate = false;\r\n\t\t\t\tgeometry.uvsNeedUpdate = false;\r\n\t\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t\t\tgeometry = direct;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attribute;\r\n\r\n\t\t\tif ( geometry.verticesNeedUpdate === true ) {\r\n\r\n\t\t\t\tattribute = this.attributes.position;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyVector3sArray( geometry.vertices );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.verticesNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.normalsNeedUpdate === true ) {\r\n\r\n\t\t\t\tattribute = this.attributes.normal;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyVector3sArray( geometry.normals );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.normalsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.colorsNeedUpdate === true ) {\r\n\r\n\t\t\t\tattribute = this.attributes.color;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyColorsArray( geometry.colors );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.colorsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.uvsNeedUpdate ) {\r\n\r\n\t\t\t\tattribute = this.attributes.uv;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyVector2sArray( geometry.uvs );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.uvsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.lineDistancesNeedUpdate ) {\r\n\r\n\t\t\t\tattribute = this.attributes.lineDistance;\r\n\r\n\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\tattribute.copyArray( geometry.lineDistances );\r\n\t\t\t\t\tattribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.lineDistancesNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.groupsNeedUpdate ) {\r\n\r\n\t\t\t\tgeometry.computeGroups( object.geometry );\r\n\t\t\t\tthis.groups = geometry.groups;\r\n\r\n\t\t\t\tgeometry.groupsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tfromGeometry: function ( geometry ) {\r\n\r\n\t\t\tgeometry.__directGeometry = new DirectGeometry().fromGeometry( geometry );\r\n\r\n\t\t\treturn this.fromDirectGeometry( geometry.__directGeometry );\r\n\r\n\t\t},\r\n\r\n\t\tfromDirectGeometry: function ( geometry ) {\r\n\r\n\t\t\tvar positions = new Float32Array( geometry.vertices.length * 3 );\r\n\t\t\tthis.setAttribute( 'position', new BufferAttribute( positions, 3 ).copyVector3sArray( geometry.vertices ) );\r\n\r\n\t\t\tif ( geometry.normals.length > 0 ) {\r\n\r\n\t\t\t\tvar normals = new Float32Array( geometry.normals.length * 3 );\r\n\t\t\t\tthis.setAttribute( 'normal', new BufferAttribute( normals, 3 ).copyVector3sArray( geometry.normals ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.colors.length > 0 ) {\r\n\r\n\t\t\t\tvar colors = new Float32Array( geometry.colors.length * 3 );\r\n\t\t\t\tthis.setAttribute( 'color', new BufferAttribute( colors, 3 ).copyColorsArray( geometry.colors ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.uvs.length > 0 ) {\r\n\r\n\t\t\t\tvar uvs = new Float32Array( geometry.uvs.length * 2 );\r\n\t\t\t\tthis.setAttribute( 'uv', new BufferAttribute( uvs, 2 ).copyVector2sArray( geometry.uvs ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.uvs2.length > 0 ) {\r\n\r\n\t\t\t\tvar uvs2 = new Float32Array( geometry.uvs2.length * 2 );\r\n\t\t\t\tthis.setAttribute( 'uv2', new BufferAttribute( uvs2, 2 ).copyVector2sArray( geometry.uvs2 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// groups\r\n\r\n\t\t\tthis.groups = geometry.groups;\r\n\r\n\t\t\t// morphs\r\n\r\n\t\t\tfor ( var name in geometry.morphTargets ) {\r\n\r\n\t\t\t\tvar array = [];\r\n\t\t\t\tvar morphTargets = geometry.morphTargets[ name ];\r\n\r\n\t\t\t\tfor ( var i = 0, l = morphTargets.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar morphTarget = morphTargets[ i ];\r\n\r\n\t\t\t\t\tvar attribute = new Float32BufferAttribute( morphTarget.data.length * 3, 3 );\r\n\t\t\t\t\tattribute.name = morphTarget.name;\r\n\r\n\t\t\t\t\tarray.push( attribute.copyVector3sArray( morphTarget.data ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphAttributes[ name ] = array;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skinning\r\n\r\n\t\t\tif ( geometry.skinIndices.length > 0 ) {\r\n\r\n\t\t\t\tvar skinIndices = new Float32BufferAttribute( geometry.skinIndices.length * 4, 4 );\r\n\t\t\t\tthis.setAttribute( 'skinIndex', skinIndices.copyVector4sArray( geometry.skinIndices ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.skinWeights.length > 0 ) {\r\n\r\n\t\t\t\tvar skinWeights = new Float32BufferAttribute( geometry.skinWeights.length * 4, 4 );\r\n\t\t\t\tthis.setAttribute( 'skinWeight', skinWeights.copyVector4sArray( geometry.skinWeights ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcomputeBoundingBox: function () {\r\n\r\n\t\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\t\tthis.boundingBox = new Box3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar position = this.attributes.position;\r\n\t\t\tvar morphAttributesPosition = this.morphAttributes.position;\r\n\r\n\t\t\tif ( position !== undefined ) {\r\n\r\n\t\t\t\tthis.boundingBox.setFromBufferAttribute( position );\r\n\r\n\t\t\t\t// process morph attributes if present\r\n\r\n\t\t\t\tif ( morphAttributesPosition ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar morphAttribute = morphAttributesPosition[ i ];\r\n\t\t\t\t\t\t_box$2.setFromBufferAttribute( morphAttribute );\r\n\r\n\t\t\t\t\t\tif ( this.morphTargetsRelative ) {\r\n\r\n\t\t\t\t\t\t\t_vector$4.addVectors( this.boundingBox.min, _box$2.min );\r\n\t\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$4 );\r\n\r\n\t\t\t\t\t\t\t_vector$4.addVectors( this.boundingBox.max, _box$2.max );\r\n\t\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$4 );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$2.min );\r\n\t\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$2.max );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.boundingBox.makeEmpty();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeBoundingSphere: function () {\r\n\r\n\t\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = new Sphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar position = this.attributes.position;\r\n\t\t\tvar morphAttributesPosition = this.morphAttributes.position;\r\n\r\n\t\t\tif ( position ) {\r\n\r\n\t\t\t\t// first, find the center of the bounding sphere\r\n\r\n\t\t\t\tvar center = this.boundingSphere.center;\r\n\r\n\t\t\t\t_box$2.setFromBufferAttribute( position );\r\n\r\n\t\t\t\t// process morph attributes if present\r\n\r\n\t\t\t\tif ( morphAttributesPosition ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar morphAttribute = morphAttributesPosition[ i ];\r\n\t\t\t\t\t\t_boxMorphTargets.setFromBufferAttribute( morphAttribute );\r\n\r\n\t\t\t\t\t\tif ( this.morphTargetsRelative ) {\r\n\r\n\t\t\t\t\t\t\t_vector$4.addVectors( _box$2.min, _boxMorphTargets.min );\r\n\t\t\t\t\t\t\t_box$2.expandByPoint( _vector$4 );\r\n\r\n\t\t\t\t\t\t\t_vector$4.addVectors( _box$2.max, _boxMorphTargets.max );\r\n\t\t\t\t\t\t\t_box$2.expandByPoint( _vector$4 );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t_box$2.expandByPoint( _boxMorphTargets.min );\r\n\t\t\t\t\t\t\t_box$2.expandByPoint( _boxMorphTargets.max );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_box$2.getCenter( center );\r\n\r\n\t\t\t\t// second, try to find a boundingSphere with a radius smaller than the\r\n\t\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\r\n\r\n\t\t\t\tvar maxRadiusSq = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, il = position.count; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t_vector$4.fromBufferAttribute( position, i );\r\n\r\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$4 ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// process morph attributes if present\r\n\r\n\t\t\t\tif ( morphAttributesPosition ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar morphAttribute = morphAttributesPosition[ i ];\r\n\t\t\t\t\t\tvar morphTargetsRelative = this.morphTargetsRelative;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, jl = morphAttribute.count; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t_vector$4.fromBufferAttribute( morphAttribute, j );\r\n\r\n\t\t\t\t\t\t\tif ( morphTargetsRelative ) {\r\n\r\n\t\t\t\t\t\t\t\t_offset.fromBufferAttribute( position, j );\r\n\t\t\t\t\t\t\t\t_vector$4.add( _offset );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$4 ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeFaceNormals: function () {\r\n\r\n\t\t\t// backwards compatibility\r\n\r\n\t\t},\r\n\r\n\t\tcomputeVertexNormals: function () {\r\n\r\n\t\t\tvar index = this.index;\r\n\t\t\tvar attributes = this.attributes;\r\n\r\n\t\t\tif ( attributes.position ) {\r\n\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tif ( attributes.normal === undefined ) {\r\n\r\n\t\t\t\t\tthis.setAttribute( 'normal', new BufferAttribute( new Float32Array( positions.length ), 3 ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// reset existing normals to zero\r\n\r\n\t\t\t\t\tvar array = attributes.normal.array;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = array.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tarray[ i ] = 0;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar normals = attributes.normal.array;\r\n\r\n\t\t\t\tvar vA, vB, vC;\r\n\t\t\t\tvar pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\r\n\t\t\t\tvar cb = new Vector3(), ab = new Vector3();\r\n\r\n\t\t\t\t// indexed elements\r\n\r\n\t\t\t\tif ( index ) {\r\n\r\n\t\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = index.count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\tvA = indices[ i + 0 ] * 3;\r\n\t\t\t\t\t\tvB = indices[ i + 1 ] * 3;\r\n\t\t\t\t\t\tvC = indices[ i + 2 ] * 3;\r\n\r\n\t\t\t\t\t\tpA.fromArray( positions, vA );\r\n\t\t\t\t\t\tpB.fromArray( positions, vB );\r\n\t\t\t\t\t\tpC.fromArray( positions, vC );\r\n\r\n\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\tnormals[ vA ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vA + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vA + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vB ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vB + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vB + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ vC ] += cb.x;\r\n\t\t\t\t\t\tnormals[ vC + 1 ] += cb.y;\r\n\t\t\t\t\t\tnormals[ vC + 2 ] += cb.z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// non-indexed elements (unconnected triangle soup)\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 9 ) {\r\n\r\n\t\t\t\t\t\tpA.fromArray( positions, i );\r\n\t\t\t\t\t\tpB.fromArray( positions, i + 3 );\r\n\t\t\t\t\t\tpC.fromArray( positions, i + 6 );\r\n\r\n\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\tnormals[ i ] = cb.x;\r\n\t\t\t\t\t\tnormals[ i + 1 ] = cb.y;\r\n\t\t\t\t\t\tnormals[ i + 2 ] = cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ i + 3 ] = cb.x;\r\n\t\t\t\t\t\tnormals[ i + 4 ] = cb.y;\r\n\t\t\t\t\t\tnormals[ i + 5 ] = cb.z;\r\n\r\n\t\t\t\t\t\tnormals[ i + 6 ] = cb.x;\r\n\t\t\t\t\t\tnormals[ i + 7 ] = cb.y;\r\n\t\t\t\t\t\tnormals[ i + 8 ] = cb.z;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.normalizeNormals();\r\n\r\n\t\t\t\tattributes.normal.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tmerge: function ( geometry, offset ) {\r\n\r\n\t\t\tif ( ! ( geometry && geometry.isBufferGeometry ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( offset === undefined ) {\r\n\r\n\t\t\t\toffset = 0;\r\n\r\n\t\t\t\tconsole.warn(\r\n\t\t\t\t\t'THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. '\r\n\t\t\t\t\t+ 'Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.'\r\n\t\t\t\t);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attributes = this.attributes;\r\n\r\n\t\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\t\tif ( geometry.attributes[ key ] === undefined ) { continue; }\r\n\r\n\t\t\t\tvar attribute1 = attributes[ key ];\r\n\t\t\t\tvar attributeArray1 = attribute1.array;\r\n\r\n\t\t\t\tvar attribute2 = geometry.attributes[ key ];\r\n\t\t\t\tvar attributeArray2 = attribute2.array;\r\n\r\n\t\t\t\tvar attributeOffset = attribute2.itemSize * offset;\r\n\t\t\t\tvar length = Math.min( attributeArray2.length, attributeArray1.length - attributeOffset );\r\n\r\n\t\t\t\tfor ( var i = 0, j = attributeOffset; i < length; i ++, j ++ ) {\r\n\r\n\t\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnormalizeNormals: function () {\r\n\r\n\t\t\tvar normals = this.attributes.normal;\r\n\r\n\t\t\tfor ( var i = 0, il = normals.count; i < il; i ++ ) {\r\n\r\n\t\t\t\t_vector$4.x = normals.getX( i );\r\n\t\t\t\t_vector$4.y = normals.getY( i );\r\n\t\t\t\t_vector$4.z = normals.getZ( i );\r\n\r\n\t\t\t\t_vector$4.normalize();\r\n\r\n\t\t\t\tnormals.setXYZ( i, _vector$4.x, _vector$4.y, _vector$4.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttoNonIndexed: function () {\r\n\r\n\t\t\tfunction convertBufferAttribute( attribute, indices ) {\r\n\r\n\t\t\t\tvar array = attribute.array;\r\n\t\t\t\tvar itemSize = attribute.itemSize;\r\n\r\n\t\t\t\tvar array2 = new array.constructor( indices.length * itemSize );\r\n\r\n\t\t\t\tvar index = 0, index2 = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tindex = indices[ i ] * itemSize;\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < itemSize; j ++ ) {\r\n\r\n\t\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn new BufferAttribute( array2, itemSize );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( this.index === null ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.' );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar geometry2 = new BufferGeometry();\r\n\r\n\t\t\tvar indices = this.index.array;\r\n\t\t\tvar attributes = this.attributes;\r\n\r\n\t\t\t// attributes\r\n\r\n\t\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\t\tvar attribute = attributes[ name ];\r\n\r\n\t\t\t\tvar newAttribute = convertBufferAttribute( attribute, indices );\r\n\r\n\t\t\t\tgeometry2.setAttribute( name, newAttribute );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morph attributes\r\n\r\n\t\t\tvar morphAttributes = this.morphAttributes;\r\n\r\n\t\t\tfor ( name in morphAttributes ) {\r\n\r\n\t\t\t\tvar morphArray = [];\r\n\t\t\t\tvar morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\r\n\r\n\t\t\t\tfor ( var i = 0, il = morphAttribute.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvar attribute = morphAttribute[ i ];\r\n\r\n\t\t\t\t\tvar newAttribute = convertBufferAttribute( attribute, indices );\r\n\r\n\t\t\t\t\tmorphArray.push( newAttribute );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry2.morphAttributes[ name ] = morphArray;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry2.morphTargetsRelative = this.morphTargetsRelative;\r\n\r\n\t\t\t// groups\r\n\r\n\t\t\tvar groups = this.groups;\r\n\r\n\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\tgeometry2.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn geometry2;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'BufferGeometry',\r\n\t\t\t\t\tgenerator: 'BufferGeometry.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// standard BufferGeometry serialization\r\n\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = this.type;\r\n\t\t\tif ( this.name !== '' ) { data.name = this.name; }\r\n\t\t\tif ( Object.keys( this.userData ).length > 0 ) { data.userData = this.userData; }\r\n\r\n\t\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\t\tif ( parameters[ key ] !== undefined ) { data[ key ] = parameters[ key ]; }\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdata.data = { attributes: {} };\r\n\r\n\t\t\tvar index = this.index;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tdata.data.index = {\r\n\t\t\t\t\ttype: index.array.constructor.name,\r\n\t\t\t\t\tarray: Array.prototype.slice.call( index.array )\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attributes = this.attributes;\r\n\r\n\t\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\t\tvar attribute = attributes[ key ];\r\n\r\n\t\t\t\tvar attributeData = attribute.toJSON();\r\n\r\n\t\t\t\tif ( attribute.name !== '' ) { attributeData.name = attribute.name; }\r\n\r\n\t\t\t\tdata.data.attributes[ key ] = attributeData;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphAttributes = {};\r\n\t\t\tvar hasMorphAttributes = false;\r\n\r\n\t\t\tfor ( var key in this.morphAttributes ) {\r\n\r\n\t\t\t\tvar attributeArray = this.morphAttributes[ key ];\r\n\r\n\t\t\t\tvar array = [];\r\n\r\n\t\t\t\tfor ( var i = 0, il = attributeArray.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvar attribute = attributeArray[ i ];\r\n\r\n\t\t\t\t\tvar attributeData = attribute.toJSON();\r\n\r\n\t\t\t\t\tif ( attribute.name !== '' ) { attributeData.name = attribute.name; }\r\n\r\n\t\t\t\t\tarray.push( attributeData );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( array.length > 0 ) {\r\n\r\n\t\t\t\t\tmorphAttributes[ key ] = array;\r\n\r\n\t\t\t\t\thasMorphAttributes = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( hasMorphAttributes ) {\r\n\r\n\t\t\t\tdata.data.morphAttributes = morphAttributes;\r\n\t\t\t\tdata.data.morphTargetsRelative = this.morphTargetsRelative;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar groups = this.groups;\r\n\r\n\t\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar boundingSphere = this.boundingSphere;\r\n\r\n\t\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\t\tdata.data.boundingSphere = {\r\n\t\t\t\t\tcenter: boundingSphere.center.toArray(),\r\n\t\t\t\t\tradius: boundingSphere.radius\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\t/*\r\n\t\t\t // Handle primitives\r\n\r\n\t\t\t var parameters = this.parameters;\r\n\r\n\t\t\t if ( parameters !== undefined ) {\r\n\r\n\t\t\t var values = [];\r\n\r\n\t\t\t for ( var key in parameters ) {\r\n\r\n\t\t\t values.push( parameters[ key ] );\r\n\r\n\t\t\t }\r\n\r\n\t\t\t var geometry = Object.create( this.constructor.prototype );\r\n\t\t\t this.constructor.apply( geometry, values );\r\n\t\t\t return geometry;\r\n\r\n\t\t\t }\r\n\r\n\t\t\t return new this.constructor().copy( this );\r\n\t\t\t */\r\n\r\n\t\t\treturn new BufferGeometry().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tvar name, i, l;\r\n\r\n\t\t\t// reset\r\n\r\n\t\t\tthis.index = null;\r\n\t\t\tthis.attributes = {};\r\n\t\t\tthis.morphAttributes = {};\r\n\t\t\tthis.groups = [];\r\n\t\t\tthis.boundingBox = null;\r\n\t\t\tthis.boundingSphere = null;\r\n\r\n\t\t\t// name\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\t// index\r\n\r\n\t\t\tvar index = source.index;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tthis.setIndex( index.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// attributes\r\n\r\n\t\t\tvar attributes = source.attributes;\r\n\r\n\t\t\tfor ( name in attributes ) {\r\n\r\n\t\t\t\tvar attribute = attributes[ name ];\r\n\t\t\t\tthis.setAttribute( name, attribute.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morph attributes\r\n\r\n\t\t\tvar morphAttributes = source.morphAttributes;\r\n\r\n\t\t\tfor ( name in morphAttributes ) {\r\n\r\n\t\t\t\tvar array = [];\r\n\t\t\t\tvar morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\r\n\r\n\t\t\t\tfor ( i = 0, l = morphAttribute.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tarray.push( morphAttribute[ i ].clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphAttributes[ name ] = array;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.morphTargetsRelative = source.morphTargetsRelative;\r\n\r\n\t\t\t// groups\r\n\r\n\t\t\tvar groups = source.groups;\r\n\r\n\t\t\tfor ( i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bounding box\r\n\r\n\t\t\tvar boundingBox = source.boundingBox;\r\n\r\n\t\t\tif ( boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bounding sphere\r\n\r\n\t\t\tvar boundingSphere = source.boundingSphere;\r\n\r\n\t\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// draw range\r\n\r\n\t\t\tthis.drawRange.start = source.drawRange.start;\r\n\t\t\tthis.drawRange.count = source.drawRange.count;\r\n\r\n\t\t\t// user data\r\n\r\n\t\t\tthis.userData = source.userData;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author jonobr1 / http://jonobr1.com/\r\n\t */\r\n\r\n\tvar _inverseMatrix = new Matrix4();\r\n\tvar _ray = new Ray();\r\n\tvar _sphere = new Sphere();\r\n\r\n\tvar _vA = new Vector3();\r\n\tvar _vB = new Vector3();\r\n\tvar _vC = new Vector3();\r\n\r\n\tvar _tempA = new Vector3();\r\n\tvar _tempB = new Vector3();\r\n\tvar _tempC = new Vector3();\r\n\r\n\tvar _morphA = new Vector3();\r\n\tvar _morphB = new Vector3();\r\n\tvar _morphC = new Vector3();\r\n\r\n\tvar _uvA = new Vector2();\r\n\tvar _uvB = new Vector2();\r\n\tvar _uvC = new Vector2();\r\n\r\n\tvar _intersectionPoint = new Vector3();\r\n\tvar _intersectionPointWorld = new Vector3();\r\n\r\n\tfunction Mesh( geometry, material ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Mesh';\r\n\r\n\t\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\r\n\t\tthis.material = material !== undefined ? material : new MeshBasicMaterial();\r\n\r\n\t\tthis.updateMorphTargets();\r\n\r\n\t}\r\n\r\n\tMesh.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Mesh,\r\n\r\n\t\tisMesh: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source );\r\n\r\n\t\t\tif ( source.morphTargetInfluences !== undefined ) {\r\n\r\n\t\t\t\tthis.morphTargetInfluences = source.morphTargetInfluences.slice();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( source.morphTargetDictionary !== undefined ) {\r\n\r\n\t\t\t\tthis.morphTargetDictionary = Object.assign( {}, source.morphTargetDictionary );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tupdateMorphTargets: function () {\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar m, ml, name;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\t\t\t\tvar keys = Object.keys( morphAttributes );\r\n\r\n\t\t\t\tif ( keys.length > 0 ) {\r\n\r\n\t\t\t\t\tvar morphAttribute = morphAttributes[ keys[ 0 ] ];\r\n\r\n\t\t\t\t\tif ( morphAttribute !== undefined ) {\r\n\r\n\t\t\t\t\t\tthis.morphTargetInfluences = [];\r\n\t\t\t\t\t\tthis.morphTargetDictionary = {};\r\n\r\n\t\t\t\t\t\tfor ( m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\r\n\r\n\t\t\t\t\t\t\tname = morphAttribute[ m ].name || String( m );\r\n\r\n\t\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\r\n\t\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar morphTargets = geometry.morphTargets;\r\n\r\n\t\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\traycast: function ( raycaster, intersects ) {\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar material = this.material;\r\n\t\t\tvar matrixWorld = this.matrixWorld;\r\n\r\n\t\t\tif ( material === undefined ) { return; }\r\n\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) { geometry.computeBoundingSphere(); }\r\n\r\n\t\t\t_sphere.copy( geometry.boundingSphere );\r\n\t\t\t_sphere.applyMatrix4( matrixWorld );\r\n\r\n\t\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) { return; }\r\n\r\n\t\t\t//\r\n\r\n\t\t\t_inverseMatrix.getInverse( matrixWorld );\r\n\t\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\r\n\r\n\t\t\t// Check boundingBox before continuing\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tif ( _ray.intersectsBox( geometry.boundingBox ) === false ) { return; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar intersection;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tvar a, b, c;\r\n\t\t\t\tvar index = geometry.index;\r\n\t\t\t\tvar position = geometry.attributes.position;\r\n\t\t\t\tvar morphPosition = geometry.morphAttributes.position;\r\n\t\t\t\tvar morphTargetsRelative = geometry.morphTargetsRelative;\r\n\t\t\t\tvar uv = geometry.attributes.uv;\r\n\t\t\t\tvar uv2 = geometry.attributes.uv2;\r\n\t\t\t\tvar groups = geometry.groups;\r\n\t\t\t\tvar drawRange = geometry.drawRange;\r\n\t\t\t\tvar i, j, il, jl;\r\n\t\t\t\tvar group, groupMaterial;\r\n\t\t\t\tvar start, end;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\t// indexed buffer geometry\r\n\r\n\t\t\t\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tgroup = groups[ i ];\r\n\t\t\t\t\t\t\tgroupMaterial = material[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\tstart = Math.max( group.start, drawRange.start );\r\n\t\t\t\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\r\n\r\n\t\t\t\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\t\t\ta = index.getX( j );\r\n\t\t\t\t\t\t\t\tb = index.getX( j + 1 );\r\n\t\t\t\t\t\t\t\tc = index.getX( j + 2 );\r\n\r\n\t\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\r\n\r\n\t\t\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in indexed buffer semantics\r\n\t\t\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\r\n\t\t\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tstart = Math.max( 0, drawRange.start );\r\n\t\t\t\t\t\tend = Math.min( index.count, ( drawRange.start + drawRange.count ) );\r\n\r\n\t\t\t\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\ta = index.getX( i );\r\n\t\t\t\t\t\t\tb = index.getX( i + 1 );\r\n\t\t\t\t\t\t\tc = index.getX( i + 2 );\r\n\r\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\r\n\r\n\t\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indexed buffer semantics\r\n\t\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( position !== undefined ) {\r\n\r\n\t\t\t\t\t// non-indexed buffer geometry\r\n\r\n\t\t\t\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\t\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tgroup = groups[ i ];\r\n\t\t\t\t\t\t\tgroupMaterial = material[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\tstart = Math.max( group.start, drawRange.start );\r\n\t\t\t\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\r\n\r\n\t\t\t\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\t\t\ta = j;\r\n\t\t\t\t\t\t\t\tb = j + 1;\r\n\t\t\t\t\t\t\t\tc = j + 2;\r\n\r\n\t\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, groupMaterial, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\r\n\r\n\t\t\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in non-indexed buffer semantics\r\n\t\t\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\r\n\t\t\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tstart = Math.max( 0, drawRange.start );\r\n\t\t\t\t\t\tend = Math.min( position.count, ( drawRange.start + drawRange.count ) );\r\n\r\n\t\t\t\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\ta = i;\r\n\t\t\t\t\t\t\tb = i + 1;\r\n\t\t\t\t\t\t\tc = i + 2;\r\n\r\n\t\t\t\t\t\t\tintersection = checkBufferGeometryIntersection( this, material, raycaster, _ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c );\r\n\r\n\t\t\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in non-indexed buffer semantics\r\n\t\t\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\tvar fvA, fvB, fvC;\r\n\t\t\t\tvar isMultiMaterial = Array.isArray( material );\r\n\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\tvar faces = geometry.faces;\r\n\t\t\t\tvar uvs;\r\n\r\n\t\t\t\tvar faceVertexUvs = geometry.faceVertexUvs[ 0 ];\r\n\t\t\t\tif ( faceVertexUvs.length > 0 ) { uvs = faceVertexUvs; }\r\n\r\n\t\t\t\tfor ( var f = 0, fl = faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tvar face = faces[ f ];\r\n\t\t\t\t\tvar faceMaterial = isMultiMaterial ? material[ face.materialIndex ] : material;\r\n\r\n\t\t\t\t\tif ( faceMaterial === undefined ) { continue; }\r\n\r\n\t\t\t\t\tfvA = vertices[ face.a ];\r\n\t\t\t\t\tfvB = vertices[ face.b ];\r\n\t\t\t\t\tfvC = vertices[ face.c ];\r\n\r\n\t\t\t\t\tintersection = checkIntersection( this, faceMaterial, raycaster, _ray, fvA, fvB, fvC, _intersectionPoint );\r\n\r\n\t\t\t\t\tif ( intersection ) {\r\n\r\n\t\t\t\t\t\tif ( uvs && uvs[ f ] ) {\r\n\r\n\t\t\t\t\t\t\tvar uvs_f = uvs[ f ];\r\n\t\t\t\t\t\t\t_uvA.copy( uvs_f[ 0 ] );\r\n\t\t\t\t\t\t\t_uvB.copy( uvs_f[ 1 ] );\r\n\t\t\t\t\t\t\t_uvC.copy( uvs_f[ 2 ] );\r\n\r\n\t\t\t\t\t\t\tintersection.uv = Triangle.getUV( _intersectionPoint, fvA, fvB, fvC, _uvA, _uvB, _uvC, new Vector2() );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tintersection.face = face;\r\n\t\t\t\t\t\tintersection.faceIndex = f;\r\n\t\t\t\t\t\tintersects.push( intersection );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction checkIntersection( object, material, raycaster, ray, pA, pB, pC, point ) {\r\n\r\n\t\tvar intersect;\r\n\r\n\t\tif ( material.side === BackSide ) {\r\n\r\n\t\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tintersect = ray.intersectTriangle( pA, pB, pC, material.side !== DoubleSide, point );\r\n\r\n\t\t}\r\n\r\n\t\tif ( intersect === null ) { return null; }\r\n\r\n\t\t_intersectionPointWorld.copy( point );\r\n\t\t_intersectionPointWorld.applyMatrix4( object.matrixWorld );\r\n\r\n\t\tvar distance = raycaster.ray.origin.distanceTo( _intersectionPointWorld );\r\n\r\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) { return null; }\r\n\r\n\t\treturn {\r\n\t\t\tdistance: distance,\r\n\t\t\tpoint: _intersectionPointWorld.clone(),\r\n\t\t\tobject: object\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tfunction checkBufferGeometryIntersection( object, material, raycaster, ray, position, morphPosition, morphTargetsRelative, uv, uv2, a, b, c ) {\r\n\r\n\t\t_vA.fromBufferAttribute( position, a );\r\n\t\t_vB.fromBufferAttribute( position, b );\r\n\t\t_vC.fromBufferAttribute( position, c );\r\n\r\n\t\tvar morphInfluences = object.morphTargetInfluences;\r\n\r\n\t\tif ( material.morphTargets && morphPosition && morphInfluences ) {\r\n\r\n\t\t\t_morphA.set( 0, 0, 0 );\r\n\t\t\t_morphB.set( 0, 0, 0 );\r\n\t\t\t_morphC.set( 0, 0, 0 );\r\n\r\n\t\t\tfor ( var i = 0, il = morphPosition.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar influence = morphInfluences[ i ];\r\n\t\t\t\tvar morphAttribute = morphPosition[ i ];\r\n\r\n\t\t\t\tif ( influence === 0 ) { continue; }\r\n\r\n\t\t\t\t_tempA.fromBufferAttribute( morphAttribute, a );\r\n\t\t\t\t_tempB.fromBufferAttribute( morphAttribute, b );\r\n\t\t\t\t_tempC.fromBufferAttribute( morphAttribute, c );\r\n\r\n\t\t\t\tif ( morphTargetsRelative ) {\r\n\r\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\r\n\t\t\t\t\t_morphB.addScaledVector( _tempB, influence );\r\n\t\t\t\t\t_morphC.addScaledVector( _tempC, influence );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA ), influence );\r\n\t\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB ), influence );\r\n\t\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC ), influence );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_vA.add( _morphA );\r\n\t\t\t_vB.add( _morphB );\r\n\t\t\t_vC.add( _morphC );\r\n\r\n\t\t}\r\n\r\n\t\tvar intersection = checkIntersection( object, material, raycaster, ray, _vA, _vB, _vC, _intersectionPoint );\r\n\r\n\t\tif ( intersection ) {\r\n\r\n\t\t\tif ( uv ) {\r\n\r\n\t\t\t\t_uvA.fromBufferAttribute( uv, a );\r\n\t\t\t\t_uvB.fromBufferAttribute( uv, b );\r\n\t\t\t\t_uvC.fromBufferAttribute( uv, c );\r\n\r\n\t\t\t\tintersection.uv = Triangle.getUV( _intersectionPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uv2 ) {\r\n\r\n\t\t\t\t_uvA.fromBufferAttribute( uv2, a );\r\n\t\t\t\t_uvB.fromBufferAttribute( uv2, b );\r\n\t\t\t\t_uvC.fromBufferAttribute( uv2, c );\r\n\r\n\t\t\t\tintersection.uv2 = Triangle.getUV( _intersectionPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar face = new Face3( a, b, c );\r\n\t\t\tTriangle.getNormal( _vA, _vB, _vC, face.normal );\r\n\r\n\t\t\tintersection.face = face;\r\n\r\n\t\t}\r\n\r\n\t\treturn intersection;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author kile / http://kile.stravaganza.org/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tvar _geometryId = 0; // Geometry uses even numbers as Id\r\n\tvar _m1$3 = new Matrix4();\r\n\tvar _obj$1 = new Object3D();\r\n\tvar _offset$1 = new Vector3();\r\n\r\n\tfunction Geometry() {\r\n\r\n\t\tObject.defineProperty( this, 'id', { value: _geometryId += 2 } );\r\n\r\n\t\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\t\tthis.name = '';\r\n\t\tthis.type = 'Geometry';\r\n\r\n\t\tthis.vertices = [];\r\n\t\tthis.colors = [];\r\n\t\tthis.faces = [];\r\n\t\tthis.faceVertexUvs = [[]];\r\n\r\n\t\tthis.morphTargets = [];\r\n\t\tthis.morphNormals = [];\r\n\r\n\t\tthis.skinWeights = [];\r\n\t\tthis.skinIndices = [];\r\n\r\n\t\tthis.lineDistances = [];\r\n\r\n\t\tthis.boundingBox = null;\r\n\t\tthis.boundingSphere = null;\r\n\r\n\t\t// update flags\r\n\r\n\t\tthis.elementsNeedUpdate = false;\r\n\t\tthis.verticesNeedUpdate = false;\r\n\t\tthis.uvsNeedUpdate = false;\r\n\t\tthis.normalsNeedUpdate = false;\r\n\t\tthis.colorsNeedUpdate = false;\r\n\t\tthis.lineDistancesNeedUpdate = false;\r\n\t\tthis.groupsNeedUpdate = false;\r\n\r\n\t}\r\n\r\n\tGeometry.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: Geometry,\r\n\r\n\t\tisGeometry: true,\r\n\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\t\tvar normalMatrix = new Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\tfor ( var i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\t\tvertex.applyMatrix4( matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar face = this.faces[ i ];\r\n\t\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.verticesNeedUpdate = true;\r\n\t\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateX: function ( angle ) {\r\n\r\n\t\t\t// rotate geometry around world x-axis\r\n\r\n\t\t\t_m1$3.makeRotationX( angle );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$3 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateY: function ( angle ) {\r\n\r\n\t\t\t// rotate geometry around world y-axis\r\n\r\n\t\t\t_m1$3.makeRotationY( angle );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$3 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\trotateZ: function ( angle ) {\r\n\r\n\t\t\t// rotate geometry around world z-axis\r\n\r\n\t\t\t_m1$3.makeRotationZ( angle );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$3 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( x, y, z ) {\r\n\r\n\t\t\t// translate geometry\r\n\r\n\t\t\t_m1$3.makeTranslation( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$3 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tscale: function ( x, y, z ) {\r\n\r\n\t\t\t// scale geometry\r\n\r\n\t\t\t_m1$3.makeScale( x, y, z );\r\n\r\n\t\t\tthis.applyMatrix4( _m1$3 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlookAt: function ( vector ) {\r\n\r\n\t\t\t_obj$1.lookAt( vector );\r\n\r\n\t\t\t_obj$1.updateMatrix();\r\n\r\n\t\t\tthis.applyMatrix4( _obj$1.matrix );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tfromBufferGeometry: function ( geometry ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar indices = geometry.index !== null ? geometry.index.array : undefined;\r\n\t\t\tvar attributes = geometry.attributes;\r\n\r\n\t\t\tif ( attributes.position === undefined ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion.' );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar positions = attributes.position.array;\r\n\t\t\tvar normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\r\n\t\t\tvar colors = attributes.color !== undefined ? attributes.color.array : undefined;\r\n\t\t\tvar uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\r\n\t\t\tvar uvs2 = attributes.uv2 !== undefined ? attributes.uv2.array : undefined;\r\n\r\n\t\t\tif ( uvs2 !== undefined ) { this.faceVertexUvs[ 1 ] = []; }\r\n\r\n\t\t\tfor ( var i = 0; i < positions.length; i += 3 ) {\r\n\r\n\t\t\t\tscope.vertices.push( new Vector3().fromArray( positions, i ) );\r\n\r\n\t\t\t\tif ( colors !== undefined ) {\r\n\r\n\t\t\t\t\tscope.colors.push( new Color().fromArray( colors, i ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction addFace( a, b, c, materialIndex ) {\r\n\r\n\t\t\t\tvar vertexColors = ( colors === undefined ) ? [] : [\r\n\t\t\t\t\tscope.colors[ a ].clone(),\r\n\t\t\t\t\tscope.colors[ b ].clone(),\r\n\t\t\t\t\tscope.colors[ c ].clone() ];\r\n\r\n\t\t\t\tvar vertexNormals = ( normals === undefined ) ? [] : [\r\n\t\t\t\t\tnew Vector3().fromArray( normals, a * 3 ),\r\n\t\t\t\t\tnew Vector3().fromArray( normals, b * 3 ),\r\n\t\t\t\t\tnew Vector3().fromArray( normals, c * 3 )\r\n\t\t\t\t];\r\n\r\n\t\t\t\tvar face = new Face3( a, b, c, vertexNormals, vertexColors, materialIndex );\r\n\r\n\t\t\t\tscope.faces.push( face );\r\n\r\n\t\t\t\tif ( uvs !== undefined ) {\r\n\r\n\t\t\t\t\tscope.faceVertexUvs[ 0 ].push( [\r\n\t\t\t\t\t\tnew Vector2().fromArray( uvs, a * 2 ),\r\n\t\t\t\t\t\tnew Vector2().fromArray( uvs, b * 2 ),\r\n\t\t\t\t\t\tnew Vector2().fromArray( uvs, c * 2 )\r\n\t\t\t\t\t] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( uvs2 !== undefined ) {\r\n\r\n\t\t\t\t\tscope.faceVertexUvs[ 1 ].push( [\r\n\t\t\t\t\t\tnew Vector2().fromArray( uvs2, a * 2 ),\r\n\t\t\t\t\t\tnew Vector2().fromArray( uvs2, b * 2 ),\r\n\t\t\t\t\t\tnew Vector2().fromArray( uvs2, c * 2 )\r\n\t\t\t\t\t] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar groups = geometry.groups;\r\n\r\n\t\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < groups.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\t\tvar start = group.start;\r\n\t\t\t\t\tvar count = group.count;\r\n\r\n\t\t\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\tif ( indices !== undefined ) {\r\n\r\n\t\t\t\t\t\t\taddFace( indices[ j ], indices[ j + 1 ], indices[ j + 2 ], group.materialIndex );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\taddFace( j, j + 1, j + 2, group.materialIndex );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( indices !== undefined ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\r\n\r\n\t\t\t\t\t\taddFace( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < positions.length / 3; i += 3 ) {\r\n\r\n\t\t\t\t\t\taddFace( i, i + 1, i + 2 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.computeFaceNormals();\r\n\r\n\t\t\tif ( geometry.boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcenter: function () {\r\n\r\n\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\tthis.boundingBox.getCenter( _offset$1 ).negate();\r\n\r\n\t\t\tthis.translate( _offset$1.x, _offset$1.y, _offset$1.z );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tnormalize: function () {\r\n\r\n\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t\tvar center = this.boundingSphere.center;\r\n\t\t\tvar radius = this.boundingSphere.radius;\r\n\r\n\t\t\tvar s = radius === 0 ? 1 : 1.0 / radius;\r\n\r\n\t\t\tvar matrix = new Matrix4();\r\n\t\t\tmatrix.set(\r\n\t\t\t\ts, 0, 0, - s * center.x,\r\n\t\t\t\t0, s, 0, - s * center.y,\r\n\t\t\t\t0, 0, s, - s * center.z,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\t\t);\r\n\r\n\t\t\tthis.applyMatrix4( matrix );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcomputeFaceNormals: function () {\r\n\r\n\t\t\tvar cb = new Vector3(), ab = new Vector3();\r\n\r\n\t\t\tfor ( var f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tvar face = this.faces[ f ];\r\n\r\n\t\t\t\tvar vA = this.vertices[ face.a ];\r\n\t\t\t\tvar vB = this.vertices[ face.b ];\r\n\t\t\t\tvar vC = this.vertices[ face.c ];\r\n\r\n\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\tcb.normalize();\r\n\r\n\t\t\t\tface.normal.copy( cb );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeVertexNormals: function ( areaWeighted ) {\r\n\r\n\t\t\tif ( areaWeighted === undefined ) { areaWeighted = true; }\r\n\r\n\t\t\tvar v, vl, f, fl, face, vertices;\r\n\r\n\t\t\tvertices = new Array( this.vertices.length );\r\n\r\n\t\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\t\tvertices[ v ] = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( areaWeighted ) {\r\n\r\n\t\t\t\t// vertex normals weighted by triangle areas\r\n\t\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\r\n\r\n\t\t\t\tvar vA, vB, vC;\r\n\t\t\t\tvar cb = new Vector3(), ab = new Vector3();\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\t\tvA = this.vertices[ face.a ];\r\n\t\t\t\t\tvB = this.vertices[ face.b ];\r\n\t\t\t\t\tvC = this.vertices[ face.c ];\r\n\r\n\t\t\t\t\tcb.subVectors( vC, vB );\r\n\t\t\t\t\tab.subVectors( vA, vB );\r\n\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\tvertices[ face.a ].add( cb );\r\n\t\t\t\t\tvertices[ face.b ].add( cb );\r\n\t\t\t\t\tvertices[ face.c ].add( cb );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.computeFaceNormals();\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\t\tvertices[ face.a ].add( face.normal );\r\n\t\t\t\t\tvertices[ face.b ].add( face.normal );\r\n\t\t\t\t\tvertices[ face.c ].add( face.normal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\r\n\r\n\t\t\t\tvertices[ v ].normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\t\tvertexNormals[ 0 ].copy( vertices[ face.a ] );\r\n\t\t\t\t\tvertexNormals[ 1 ].copy( vertices[ face.b ] );\r\n\t\t\t\t\tvertexNormals[ 2 ].copy( vertices[ face.c ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvertexNormals[ 0 ] = vertices[ face.a ].clone();\r\n\t\t\t\t\tvertexNormals[ 1 ] = vertices[ face.b ].clone();\r\n\t\t\t\t\tvertexNormals[ 2 ] = vertices[ face.c ].clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.faces.length > 0 ) {\r\n\r\n\t\t\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeFlatVertexNormals: function () {\r\n\r\n\t\t\tvar f, fl, face;\r\n\r\n\t\t\tthis.computeFaceNormals();\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\tif ( vertexNormals.length === 3 ) {\r\n\r\n\t\t\t\t\tvertexNormals[ 0 ].copy( face.normal );\r\n\t\t\t\t\tvertexNormals[ 1 ].copy( face.normal );\r\n\t\t\t\t\tvertexNormals[ 2 ].copy( face.normal );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvertexNormals[ 0 ] = face.normal.clone();\r\n\t\t\t\t\tvertexNormals[ 1 ] = face.normal.clone();\r\n\t\t\t\t\tvertexNormals[ 2 ] = face.normal.clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.faces.length > 0 ) {\r\n\r\n\t\t\t\tthis.normalsNeedUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeMorphNormals: function () {\r\n\r\n\t\t\tvar i, il, f, fl, face;\r\n\r\n\t\t\t// save original normals\r\n\t\t\t// - create temp variables on first access\r\n\t\t\t//   otherwise just copy (for faster repeated calls)\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tif ( ! face.__originalFaceNormal ) {\r\n\r\n\t\t\t\t\tface.__originalFaceNormal = face.normal.clone();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tface.__originalFaceNormal.copy( face.normal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! face.__originalVertexNormals ) { face.__originalVertexNormals = []; }\r\n\r\n\t\t\t\tfor ( i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\r\n\r\n\t\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// use temp geometry to compute face and vertex normals for each morph\r\n\r\n\t\t\tvar tmpGeo = new Geometry();\r\n\t\t\ttmpGeo.faces = this.faces;\r\n\r\n\t\t\tfor ( i = 0, il = this.morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t// create on first access\r\n\r\n\t\t\t\tif ( ! this.morphNormals[ i ] ) {\r\n\r\n\t\t\t\t\tthis.morphNormals[ i ] = {};\r\n\t\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\r\n\t\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\r\n\r\n\t\t\t\t\tvar dstNormalsFace = this.morphNormals[ i ].faceNormals;\r\n\t\t\t\t\tvar dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\r\n\r\n\t\t\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\t\tfaceNormal = new Vector3();\r\n\t\t\t\t\t\tvertexNormals = { a: new Vector3(), b: new Vector3(), c: new Vector3() };\r\n\r\n\t\t\t\t\t\tdstNormalsFace.push( faceNormal );\r\n\t\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar morphNormals = this.morphNormals[ i ];\r\n\r\n\t\t\t\t// set vertices to morph target\r\n\r\n\t\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\r\n\r\n\t\t\t\t// compute morph normals\r\n\r\n\t\t\t\ttmpGeo.computeFaceNormals();\r\n\t\t\t\ttmpGeo.computeVertexNormals();\r\n\r\n\t\t\t\t// store morph normals\r\n\r\n\t\t\t\tvar faceNormal, vertexNormals;\r\n\r\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\t\tfaceNormal = morphNormals.faceNormals[ f ];\r\n\t\t\t\t\tvertexNormals = morphNormals.vertexNormals[ f ];\r\n\r\n\t\t\t\t\tfaceNormal.copy( face.normal );\r\n\r\n\t\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\r\n\t\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\r\n\t\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// restore original normals\r\n\r\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ f ];\r\n\r\n\t\t\t\tface.normal = face.__originalFaceNormal;\r\n\t\t\t\tface.vertexNormals = face.__originalVertexNormals;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcomputeBoundingBox: function () {\r\n\r\n\t\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\t\tthis.boundingBox = new Box3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.boundingBox.setFromPoints( this.vertices );\r\n\r\n\t\t},\r\n\r\n\t\tcomputeBoundingSphere: function () {\r\n\r\n\t\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = new Sphere();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.boundingSphere.setFromPoints( this.vertices );\r\n\r\n\t\t},\r\n\r\n\t\tmerge: function ( geometry, matrix, materialIndexOffset ) {\r\n\r\n\t\t\tif ( ! ( geometry && geometry.isGeometry ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar normalMatrix,\r\n\t\t\t\tvertexOffset = this.vertices.length,\r\n\t\t\t\tvertices1 = this.vertices,\r\n\t\t\t\tvertices2 = geometry.vertices,\r\n\t\t\t\tfaces1 = this.faces,\r\n\t\t\t\tfaces2 = geometry.faces,\r\n\t\t\t\tcolors1 = this.colors,\r\n\t\t\t\tcolors2 = geometry.colors;\r\n\r\n\t\t\tif ( materialIndexOffset === undefined ) { materialIndexOffset = 0; }\r\n\r\n\t\t\tif ( matrix !== undefined ) {\r\n\r\n\t\t\t\tnormalMatrix = new Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// vertices\r\n\r\n\t\t\tfor ( var i = 0, il = vertices2.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar vertex = vertices2[ i ];\r\n\r\n\t\t\t\tvar vertexCopy = vertex.clone();\r\n\r\n\t\t\t\tif ( matrix !== undefined ) { vertexCopy.applyMatrix4( matrix ); }\r\n\r\n\t\t\t\tvertices1.push( vertexCopy );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// colors\r\n\r\n\t\t\tfor ( var i = 0, il = colors2.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tcolors1.push( colors2[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// faces\r\n\r\n\t\t\tfor ( i = 0, il = faces2.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces2[ i ], faceCopy, normal, color,\r\n\t\t\t\t\tfaceVertexNormals = face.vertexNormals,\r\n\t\t\t\t\tfaceVertexColors = face.vertexColors;\r\n\r\n\t\t\t\tfaceCopy = new Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\r\n\t\t\t\tfaceCopy.normal.copy( face.normal );\r\n\r\n\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tnormal = faceVertexNormals[ j ].clone();\r\n\r\n\t\t\t\t\tif ( normalMatrix !== undefined ) {\r\n\r\n\t\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfaceCopy.vertexNormals.push( normal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfaceCopy.color.copy( face.color );\r\n\r\n\t\t\t\tfor ( var j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tcolor = faceVertexColors[ j ];\r\n\t\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\r\n\r\n\t\t\t\tfaces1.push( faceCopy );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// uvs\r\n\r\n\t\t\tfor ( var i = 0, il = geometry.faceVertexUvs.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar faceVertexUvs2 = geometry.faceVertexUvs[ i ];\r\n\r\n\t\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) { this.faceVertexUvs[ i ] = []; }\r\n\r\n\t\t\t\tfor ( var j = 0, jl = faceVertexUvs2.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar uvs2 = faceVertexUvs2[ j ], uvsCopy = [];\r\n\r\n\t\t\t\t\tfor ( var k = 0, kl = uvs2.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\t\tuvsCopy.push( uvs2[ k ].clone() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tmergeMesh: function ( mesh ) {\r\n\r\n\t\t\tif ( ! ( mesh && mesh.isMesh ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( mesh.matrixAutoUpdate ) { mesh.updateMatrix(); }\r\n\r\n\t\t\tthis.merge( mesh.geometry, mesh.matrix );\r\n\r\n\t\t},\r\n\r\n\t\t/*\r\n\t\t * Checks for duplicate vertices with hashmap.\r\n\t\t * Duplicated vertices are removed\r\n\t\t * and faces' vertices are updated.\r\n\t\t */\r\n\r\n\t\tmergeVertices: function () {\r\n\r\n\t\t\tvar verticesMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\r\n\t\t\tvar unique = [], changes = [];\r\n\r\n\t\t\tvar v, key;\r\n\t\t\tvar precisionPoints = 4; // number of decimal points, e.g. 4 for epsilon of 0.0001\r\n\t\t\tvar precision = Math.pow( 10, precisionPoints );\r\n\t\t\tvar i, il, face;\r\n\t\t\tvar indices, j, jl;\r\n\r\n\t\t\tfor ( i = 0, il = this.vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tv = this.vertices[ i ];\r\n\t\t\t\tkey = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\r\n\r\n\t\t\t\tif ( verticesMap[ key ] === undefined ) {\r\n\r\n\t\t\t\t\tverticesMap[ key ] = i;\r\n\t\t\t\t\tunique.push( this.vertices[ i ] );\r\n\t\t\t\t\tchanges[ i ] = unique.length - 1;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\r\n\t\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// if faces are completely degenerate after merging vertices, we\r\n\t\t\t// have to remove them from the geometry.\r\n\t\t\tvar faceIndicesToRemove = [];\r\n\r\n\t\t\tfor ( i = 0, il = this.faces.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tface = this.faces[ i ];\r\n\r\n\t\t\t\tface.a = changes[ face.a ];\r\n\t\t\t\tface.b = changes[ face.b ];\r\n\t\t\t\tface.c = changes[ face.c ];\r\n\r\n\t\t\t\tindices = [ face.a, face.b, face.c ];\r\n\r\n\t\t\t\t// if any duplicate vertices are found in a Face3\r\n\t\t\t\t// we have to remove the face as nothing can be saved\r\n\t\t\t\tfor ( var n = 0; n < 3; n ++ ) {\r\n\r\n\t\t\t\t\tif ( indices[ n ] === indices[ ( n + 1 ) % 3 ] ) {\r\n\r\n\t\t\t\t\t\tfaceIndicesToRemove.push( i );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\r\n\r\n\t\t\t\tvar idx = faceIndicesToRemove[ i ];\r\n\r\n\t\t\t\tthis.faces.splice( idx, 1 );\r\n\r\n\t\t\t\tfor ( j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Use unique set of vertices\r\n\r\n\t\t\tvar diff = this.vertices.length - unique.length;\r\n\t\t\tthis.vertices = unique;\r\n\t\t\treturn diff;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tthis.vertices = [];\r\n\r\n\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar point = points[ i ];\r\n\t\t\t\tthis.vertices.push( new Vector3( point.x, point.y, point.z || 0 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsortFacesByMaterialIndex: function () {\r\n\r\n\t\t\tvar faces = this.faces;\r\n\t\t\tvar length = faces.length;\r\n\r\n\t\t\t// tag faces\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tfaces[ i ]._id = i;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// sort faces\r\n\r\n\t\t\tfunction materialIndexSort( a, b ) {\r\n\r\n\t\t\t\treturn a.materialIndex - b.materialIndex;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfaces.sort( materialIndexSort );\r\n\r\n\t\t\t// sort uvs\r\n\r\n\t\t\tvar uvs1 = this.faceVertexUvs[ 0 ];\r\n\t\t\tvar uvs2 = this.faceVertexUvs[ 1 ];\r\n\r\n\t\t\tvar newUvs1, newUvs2;\r\n\r\n\t\t\tif ( uvs1 && uvs1.length === length ) { newUvs1 = []; }\r\n\t\t\tif ( uvs2 && uvs2.length === length ) { newUvs2 = []; }\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tvar id = faces[ i ]._id;\r\n\r\n\t\t\t\tif ( newUvs1 ) { newUvs1.push( uvs1[ id ] ); }\r\n\t\t\t\tif ( newUvs2 ) { newUvs2.push( uvs2[ id ] ); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( newUvs1 ) { this.faceVertexUvs[ 0 ] = newUvs1; }\r\n\t\t\tif ( newUvs2 ) { this.faceVertexUvs[ 1 ] = newUvs2; }\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Geometry',\r\n\t\t\t\t\tgenerator: 'Geometry.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t// standard Geometry serialization\r\n\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.type = this.type;\r\n\t\t\tif ( this.name !== '' ) { data.name = this.name; }\r\n\r\n\t\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\t\tvar parameters = this.parameters;\r\n\r\n\t\t\t\tfor ( var key in parameters ) {\r\n\r\n\t\t\t\t\tif ( parameters[ key ] !== undefined ) { data[ key ] = parameters[ key ]; }\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar vertices = [];\r\n\r\n\t\t\tfor ( var i = 0; i < this.vertices.length; i ++ ) {\r\n\r\n\t\t\t\tvar vertex = this.vertices[ i ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar faces = [];\r\n\t\t\tvar normals = [];\r\n\t\t\tvar normalsHash = {};\r\n\t\t\tvar colors = [];\r\n\t\t\tvar colorsHash = {};\r\n\t\t\tvar uvs = [];\r\n\t\t\tvar uvsHash = {};\r\n\r\n\t\t\tfor ( var i = 0; i < this.faces.length; i ++ ) {\r\n\r\n\t\t\t\tvar face = this.faces[ i ];\r\n\r\n\t\t\t\tvar hasMaterial = true;\r\n\t\t\t\tvar hasFaceUv = false; // deprecated\r\n\t\t\t\tvar hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\r\n\t\t\t\tvar hasFaceNormal = face.normal.length() > 0;\r\n\t\t\t\tvar hasFaceVertexNormal = face.vertexNormals.length > 0;\r\n\t\t\t\tvar hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\r\n\t\t\t\tvar hasFaceVertexColor = face.vertexColors.length > 0;\r\n\r\n\t\t\t\tvar faceType = 0;\r\n\r\n\t\t\t\tfaceType = setBit( faceType, 0, 0 ); // isQuad\r\n\t\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\r\n\t\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\r\n\t\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\r\n\t\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\r\n\t\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\r\n\t\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\r\n\t\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\r\n\r\n\t\t\t\tfaces.push( faceType );\r\n\t\t\t\tfaces.push( face.a, face.b, face.c );\r\n\t\t\t\tfaces.push( face.materialIndex );\r\n\r\n\t\t\t\tif ( hasFaceVertexUv ) {\r\n\r\n\t\t\t\t\tvar faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\r\n\r\n\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\r\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\r\n\t\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceNormal ) {\r\n\r\n\t\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexNormal ) {\r\n\r\n\t\t\t\t\tvar vertexNormals = face.vertexNormals;\r\n\r\n\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\r\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\r\n\t\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceColor ) {\r\n\r\n\t\t\t\t\tfaces.push( getColorIndex( face.color ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasFaceVertexColor ) {\r\n\r\n\t\t\t\t\tvar vertexColors = face.vertexColors;\r\n\r\n\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\r\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\r\n\t\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction setBit( value, position, enabled ) {\r\n\r\n\t\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getNormalIndex( normal ) {\r\n\r\n\t\t\t\tvar hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\r\n\r\n\t\t\t\tif ( normalsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnormalsHash[ hash ] = normals.length / 3;\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\treturn normalsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getColorIndex( color ) {\r\n\r\n\t\t\t\tvar hash = color.r.toString() + color.g.toString() + color.b.toString();\r\n\r\n\t\t\t\tif ( colorsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcolorsHash[ hash ] = colors.length;\r\n\t\t\t\tcolors.push( color.getHex() );\r\n\r\n\t\t\t\treturn colorsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getUvIndex( uv ) {\r\n\r\n\t\t\t\tvar hash = uv.x.toString() + uv.y.toString();\r\n\r\n\t\t\t\tif ( uvsHash[ hash ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuvsHash[ hash ] = uvs.length / 2;\r\n\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\t\treturn uvsHash[ hash ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdata.data = {};\r\n\r\n\t\t\tdata.data.vertices = vertices;\r\n\t\t\tdata.data.normals = normals;\r\n\t\t\tif ( colors.length > 0 ) { data.data.colors = colors; }\r\n\t\t\tif ( uvs.length > 0 ) { data.data.uvs = [ uvs ]; } // temporal backward compatibility\r\n\t\t\tdata.data.faces = faces;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\t/*\r\n\t\t\t // Handle primitives\r\n\r\n\t\t\t var parameters = this.parameters;\r\n\r\n\t\t\t if ( parameters !== undefined ) {\r\n\r\n\t\t\t var values = [];\r\n\r\n\t\t\t for ( var key in parameters ) {\r\n\r\n\t\t\t values.push( parameters[ key ] );\r\n\r\n\t\t\t }\r\n\r\n\t\t\t var geometry = Object.create( this.constructor.prototype );\r\n\t\t\t this.constructor.apply( geometry, values );\r\n\t\t\t return geometry;\r\n\r\n\t\t\t }\r\n\r\n\t\t\t return new this.constructor().copy( this );\r\n\t\t\t */\r\n\r\n\t\t\treturn new Geometry().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tvar i, il, j, jl, k, kl;\r\n\r\n\t\t\t// reset\r\n\r\n\t\t\tthis.vertices = [];\r\n\t\t\tthis.colors = [];\r\n\t\t\tthis.faces = [];\r\n\t\t\tthis.faceVertexUvs = [[]];\r\n\t\t\tthis.morphTargets = [];\r\n\t\t\tthis.morphNormals = [];\r\n\t\t\tthis.skinWeights = [];\r\n\t\t\tthis.skinIndices = [];\r\n\t\t\tthis.lineDistances = [];\r\n\t\t\tthis.boundingBox = null;\r\n\t\t\tthis.boundingSphere = null;\r\n\r\n\t\t\t// name\r\n\r\n\t\t\tthis.name = source.name;\r\n\r\n\t\t\t// vertices\r\n\r\n\t\t\tvar vertices = source.vertices;\r\n\r\n\t\t\tfor ( i = 0, il = vertices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.vertices.push( vertices[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// colors\r\n\r\n\t\t\tvar colors = source.colors;\r\n\r\n\t\t\tfor ( i = 0, il = colors.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.colors.push( colors[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// faces\r\n\r\n\t\t\tvar faces = source.faces;\r\n\r\n\t\t\tfor ( i = 0, il = faces.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.faces.push( faces[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// face vertex uvs\r\n\r\n\t\t\tfor ( i = 0, il = source.faceVertexUvs.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar faceVertexUvs = source.faceVertexUvs[ i ];\r\n\r\n\t\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) {\r\n\r\n\t\t\t\t\tthis.faceVertexUvs[ i ] = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\tvar uvs = faceVertexUvs[ j ], uvsCopy = [];\r\n\r\n\t\t\t\t\tfor ( k = 0, kl = uvs.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\t\tvar uv = uvs[ k ];\r\n\r\n\t\t\t\t\t\tuvsCopy.push( uv.clone() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morph targets\r\n\r\n\t\t\tvar morphTargets = source.morphTargets;\r\n\r\n\t\t\tfor ( i = 0, il = morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = {};\r\n\t\t\t\tmorphTarget.name = morphTargets[ i ].name;\r\n\r\n\t\t\t\t// vertices\r\n\r\n\t\t\t\tif ( morphTargets[ i ].vertices !== undefined ) {\r\n\r\n\t\t\t\t\tmorphTarget.vertices = [];\r\n\r\n\t\t\t\t\tfor ( j = 0, jl = morphTargets[ i ].vertices.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tmorphTarget.vertices.push( morphTargets[ i ].vertices[ j ].clone() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// normals\r\n\r\n\t\t\t\tif ( morphTargets[ i ].normals !== undefined ) {\r\n\r\n\t\t\t\t\tmorphTarget.normals = [];\r\n\r\n\t\t\t\t\tfor ( j = 0, jl = morphTargets[ i ].normals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tmorphTarget.normals.push( morphTargets[ i ].normals[ j ].clone() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphTargets.push( morphTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morph normals\r\n\r\n\t\t\tvar morphNormals = source.morphNormals;\r\n\r\n\t\t\tfor ( i = 0, il = morphNormals.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar morphNormal = {};\r\n\r\n\t\t\t\t// vertex normals\r\n\r\n\t\t\t\tif ( morphNormals[ i ].vertexNormals !== undefined ) {\r\n\r\n\t\t\t\t\tmorphNormal.vertexNormals = [];\r\n\r\n\t\t\t\t\tfor ( j = 0, jl = morphNormals[ i ].vertexNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar srcVertexNormal = morphNormals[ i ].vertexNormals[ j ];\r\n\t\t\t\t\t\tvar destVertexNormal = {};\r\n\r\n\t\t\t\t\t\tdestVertexNormal.a = srcVertexNormal.a.clone();\r\n\t\t\t\t\t\tdestVertexNormal.b = srcVertexNormal.b.clone();\r\n\t\t\t\t\t\tdestVertexNormal.c = srcVertexNormal.c.clone();\r\n\r\n\t\t\t\t\t\tmorphNormal.vertexNormals.push( destVertexNormal );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// face normals\r\n\r\n\t\t\t\tif ( morphNormals[ i ].faceNormals !== undefined ) {\r\n\r\n\t\t\t\t\tmorphNormal.faceNormals = [];\r\n\r\n\t\t\t\t\tfor ( j = 0, jl = morphNormals[ i ].faceNormals.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tmorphNormal.faceNormals.push( morphNormals[ i ].faceNormals[ j ].clone() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphNormals.push( morphNormal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skin weights\r\n\r\n\t\t\tvar skinWeights = source.skinWeights;\r\n\r\n\t\t\tfor ( i = 0, il = skinWeights.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.skinWeights.push( skinWeights[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skin indices\r\n\r\n\t\t\tvar skinIndices = source.skinIndices;\r\n\r\n\t\t\tfor ( i = 0, il = skinIndices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.skinIndices.push( skinIndices[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// line distances\r\n\r\n\t\t\tvar lineDistances = source.lineDistances;\r\n\r\n\t\t\tfor ( i = 0, il = lineDistances.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.lineDistances.push( lineDistances[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bounding box\r\n\r\n\t\t\tvar boundingBox = source.boundingBox;\r\n\r\n\t\t\tif ( boundingBox !== null ) {\r\n\r\n\t\t\t\tthis.boundingBox = boundingBox.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bounding sphere\r\n\r\n\t\t\tvar boundingSphere = source.boundingSphere;\r\n\r\n\t\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\t\tthis.boundingSphere = boundingSphere.clone();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update flags\r\n\r\n\t\t\tthis.elementsNeedUpdate = source.elementsNeedUpdate;\r\n\t\t\tthis.verticesNeedUpdate = source.verticesNeedUpdate;\r\n\t\t\tthis.uvsNeedUpdate = source.uvsNeedUpdate;\r\n\t\t\tthis.normalsNeedUpdate = source.normalsNeedUpdate;\r\n\t\t\tthis.colorsNeedUpdate = source.colorsNeedUpdate;\r\n\t\t\tthis.lineDistancesNeedUpdate = source.lineDistancesNeedUpdate;\r\n\t\t\tthis.groupsNeedUpdate = source.groupsNeedUpdate;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function () {\r\n\r\n\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// BoxGeometry\r\n\r\n\tvar BoxGeometry = /*@__PURE__*/(function (Geometry) {\r\n\t\tfunction BoxGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\t\t\tGeometry.call(this);\r\n\r\n\t\t\tthis.type = 'BoxGeometry';\r\n\r\n\t\t\tthis.parameters = {\r\n\t\t\t\twidth: width,\r\n\t\t\t\theight: height,\r\n\t\t\t\tdepth: depth,\r\n\t\t\t\twidthSegments: widthSegments,\r\n\t\t\t\theightSegments: heightSegments,\r\n\t\t\t\tdepthSegments: depthSegments\r\n\t\t\t};\r\n\r\n\t\t\tthis.fromBufferGeometry( new BoxBufferGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) );\r\n\t\t\tthis.mergeVertices();\r\n\r\n\t\t}\r\n\r\n\t\tif ( Geometry ) BoxGeometry.__proto__ = Geometry;\r\n\t\tBoxGeometry.prototype = Object.create( Geometry && Geometry.prototype );\r\n\t\tBoxGeometry.prototype.constructor = BoxGeometry;\r\n\r\n\t\treturn BoxGeometry;\r\n\t}(Geometry));\r\n\r\n\t// BoxBufferGeometry\r\n\r\n\tvar BoxBufferGeometry = /*@__PURE__*/(function (BufferGeometry) {\r\n\t\tfunction BoxBufferGeometry( width, height, depth, widthSegments, heightSegments, depthSegments ) {\r\n\r\n\t\t\tBufferGeometry.call(this);\r\n\r\n\t\t\tthis.type = 'BoxBufferGeometry';\r\n\r\n\t\t\tthis.parameters = {\r\n\t\t\t\twidth: width,\r\n\t\t\t\theight: height,\r\n\t\t\t\tdepth: depth,\r\n\t\t\t\twidthSegments: widthSegments,\r\n\t\t\t\theightSegments: heightSegments,\r\n\t\t\t\tdepthSegments: depthSegments\r\n\t\t\t};\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\twidth = width || 1;\r\n\t\t\theight = height || 1;\r\n\t\t\tdepth = depth || 1;\r\n\r\n\t\t\t// segments\r\n\r\n\t\t\twidthSegments = Math.floor( widthSegments ) || 1;\r\n\t\t\theightSegments = Math.floor( heightSegments ) || 1;\r\n\t\t\tdepthSegments = Math.floor( depthSegments ) || 1;\r\n\r\n\t\t\t// buffers\r\n\r\n\t\t\tvar indices = [];\r\n\t\t\tvar vertices = [];\r\n\t\t\tvar normals = [];\r\n\t\t\tvar uvs = [];\r\n\r\n\t\t\t// helper variables\r\n\r\n\t\t\tvar numberOfVertices = 0;\r\n\t\t\tvar groupStart = 0;\r\n\r\n\t\t\t// build each side of the box geometry\r\n\r\n\t\t\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height, width, depthSegments, heightSegments, 0 ); // px\r\n\t\t\tbuildPlane( 'z', 'y', 'x', 1, - 1, depth, height, - width, depthSegments, heightSegments, 1 ); // nx\r\n\t\t\tbuildPlane( 'x', 'z', 'y', 1, 1, width, depth, height, widthSegments, depthSegments, 2 ); // py\r\n\t\t\tbuildPlane( 'x', 'z', 'y', 1, - 1, width, depth, - height, widthSegments, depthSegments, 3 ); // ny\r\n\t\t\tbuildPlane( 'x', 'y', 'z', 1, - 1, width, height, depth, widthSegments, heightSegments, 4 ); // pz\r\n\t\t\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth, widthSegments, heightSegments, 5 ); // nz\r\n\r\n\t\t\t// build geometry\r\n\r\n\t\t\tthis.setIndex( indices );\r\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\t\tfunction buildPlane( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\r\n\r\n\t\t\t\tvar segmentWidth = width / gridX;\r\n\t\t\t\tvar segmentHeight = height / gridY;\r\n\r\n\t\t\t\tvar widthHalf = width / 2;\r\n\t\t\t\tvar heightHalf = height / 2;\r\n\t\t\t\tvar depthHalf = depth / 2;\r\n\r\n\t\t\t\tvar gridX1 = gridX + 1;\r\n\t\t\t\tvar gridY1 = gridY + 1;\r\n\r\n\t\t\t\tvar vertexCounter = 0;\r\n\t\t\t\tvar groupCount = 0;\r\n\r\n\t\t\t\tvar ix, iy;\r\n\r\n\t\t\t\tvar vector = new Vector3();\r\n\r\n\t\t\t\t// generate vertices, normals and uvs\r\n\r\n\t\t\t\tfor ( iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\t\t\t\tvar y = iy * segmentHeight - heightHalf;\r\n\r\n\t\t\t\t\tfor ( ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\t\t\t\tvar x = ix * segmentWidth - widthHalf;\r\n\r\n\t\t\t\t\t\t// set values to correct vector component\r\n\r\n\t\t\t\t\t\tvector[ u ] = x * udir;\r\n\t\t\t\t\t\tvector[ v ] = y * vdir;\r\n\t\t\t\t\t\tvector[ w ] = depthHalf;\r\n\r\n\t\t\t\t\t\t// now apply vector to vertex buffer\r\n\r\n\t\t\t\t\t\tvertices.push( vector.x, vector.y, vector.z );\r\n\r\n\t\t\t\t\t\t// set values to correct vector component\r\n\r\n\t\t\t\t\t\tvector[ u ] = 0;\r\n\t\t\t\t\t\tvector[ v ] = 0;\r\n\t\t\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\r\n\r\n\t\t\t\t\t\t// now apply vector to normal buffer\r\n\r\n\t\t\t\t\t\tnormals.push( vector.x, vector.y, vector.z );\r\n\r\n\t\t\t\t\t\t// uvs\r\n\r\n\t\t\t\t\t\tuvs.push( ix / gridX );\r\n\t\t\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\r\n\r\n\t\t\t\t\t\t// counters\r\n\r\n\t\t\t\t\t\tvertexCounter += 1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// indices\r\n\r\n\t\t\t\t// 1. you need three indices to draw a single face\r\n\t\t\t\t// 2. a single segment consists of two faces\r\n\t\t\t\t// 3. so we need to generate six (2*3) indices per segment\r\n\r\n\t\t\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\t\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\t\t\t\tvar a = numberOfVertices + ix + gridX1 * iy;\r\n\t\t\t\t\t\tvar b = numberOfVertices + ix + gridX1 * ( iy + 1 );\r\n\t\t\t\t\t\tvar c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\t\t\tvar d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\t\t\t\t// faces\r\n\r\n\t\t\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t\t\t\t// increase counter\r\n\r\n\t\t\t\t\t\tgroupCount += 6;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// add a group to the geometry. this will ensure multi material support\r\n\r\n\t\t\t\tscope.addGroup( groupStart, groupCount, materialIndex );\r\n\r\n\t\t\t\t// calculate new start value for groups\r\n\r\n\t\t\t\tgroupStart += groupCount;\r\n\r\n\t\t\t\t// update total number of vertices\r\n\r\n\t\t\t\tnumberOfVertices += vertexCounter;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( BufferGeometry ) BoxBufferGeometry.__proto__ = BufferGeometry;\r\n\t\tBoxBufferGeometry.prototype = Object.create( BufferGeometry && BufferGeometry.prototype );\r\n\t\tBoxBufferGeometry.prototype.constructor = BoxBufferGeometry;\r\n\r\n\t\treturn BoxBufferGeometry;\r\n\t}(BufferGeometry));\r\n\r\n\t/**\r\n\t * Uniform Utilities\r\n\t */\r\n\r\n\tfunction cloneUniforms( src ) {\r\n\r\n\t\tvar dst = {};\r\n\r\n\t\tfor ( var u in src ) {\r\n\r\n\t\t\tdst[ u ] = {};\r\n\r\n\t\t\tfor ( var p in src[ u ] ) {\r\n\r\n\t\t\t\tvar property = src[ u ][ p ];\r\n\r\n\t\t\t\tif ( property && ( property.isColor ||\r\n\t\t\t\t\tproperty.isMatrix3 || property.isMatrix4 ||\r\n\t\t\t\t\tproperty.isVector2 || property.isVector3 || property.isVector4 ||\r\n\t\t\t\t\tproperty.isTexture ) ) {\r\n\r\n\t\t\t\t\tdst[ u ][ p ] = property.clone();\r\n\r\n\t\t\t\t} else if ( Array.isArray( property ) ) {\r\n\r\n\t\t\t\t\tdst[ u ][ p ] = property.slice();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tdst[ u ][ p ] = property;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn dst;\r\n\r\n\t}\r\n\r\n\tfunction mergeUniforms( uniforms ) {\r\n\r\n\t\tvar merged = {};\r\n\r\n\t\tfor ( var u = 0; u < uniforms.length; u ++ ) {\r\n\r\n\t\t\tvar tmp = cloneUniforms( uniforms[ u ] );\r\n\r\n\t\t\tfor ( var p in tmp ) {\r\n\r\n\t\t\t\tmerged[ p ] = tmp[ p ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn merged;\r\n\r\n\t}\r\n\r\n\t// Legacy\r\n\r\n\tvar UniformsUtils = { clone: cloneUniforms, merge: mergeUniforms };\r\n\r\n\tvar default_vertex = \"void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}\";\r\n\r\n\tvar default_fragment = \"void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}\";\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  defines: { \"label\" : \"value\" },\r\n\t *  uniforms: { \"parameter1\": { value: 1.0 }, \"parameter2\": { value2: 2 } },\r\n\t *\r\n\t *  fragmentShader: <string>,\r\n\t *  vertexShader: <string>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  lights: <bool>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction ShaderMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'ShaderMaterial';\r\n\r\n\t\tthis.defines = {};\r\n\t\tthis.uniforms = {};\r\n\r\n\t\tthis.vertexShader = default_vertex;\r\n\t\tthis.fragmentShader = default_fragment;\r\n\r\n\t\tthis.linewidth = 1;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\r\n\t\tthis.fog = false; // set to use scene fog\r\n\t\tthis.lights = false; // set to use scene lights\r\n\t\tthis.clipping = false; // set to use user-defined clipping planes\r\n\r\n\t\tthis.skinning = false; // set to use skinning attribute streams\r\n\t\tthis.morphTargets = false; // set to use morph targets\r\n\t\tthis.morphNormals = false; // set to use morph normals\r\n\r\n\t\tthis.extensions = {\r\n\t\t\tderivatives: false, // set to use derivatives\r\n\t\t\tfragDepth: false, // set to use fragment depth values\r\n\t\t\tdrawBuffers: false, // set to use draw buffers\r\n\t\t\tshaderTextureLOD: false // set to use shader texture LOD\r\n\t\t};\r\n\r\n\t\t// When rendered geometry doesn't include these attributes but the material does,\r\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\r\n\t\tthis.defaultAttributeValues = {\r\n\t\t\t'color': [ 1, 1, 1 ],\r\n\t\t\t'uv': [ 0, 0 ],\r\n\t\t\t'uv2': [ 0, 0 ]\r\n\t\t};\r\n\r\n\t\tthis.index0AttributeName = undefined;\r\n\t\tthis.uniformsNeedUpdate = false;\r\n\r\n\t\tif ( parameters !== undefined ) {\r\n\r\n\t\t\tif ( parameters.attributes !== undefined ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setValues( parameters );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tShaderMaterial.prototype = Object.create( Material.prototype );\r\n\tShaderMaterial.prototype.constructor = ShaderMaterial;\r\n\r\n\tShaderMaterial.prototype.isShaderMaterial = true;\r\n\r\n\tShaderMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.fragmentShader = source.fragmentShader;\r\n\t\tthis.vertexShader = source.vertexShader;\r\n\r\n\t\tthis.uniforms = cloneUniforms( source.uniforms );\r\n\r\n\t\tthis.defines = Object.assign( {}, source.defines );\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\t\tthis.lights = source.lights;\r\n\t\tthis.clipping = source.clipping;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\tthis.extensions = source.extensions;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tShaderMaterial.prototype.toJSON = function ( meta ) {\r\n\r\n\t\tvar data = Material.prototype.toJSON.call( this, meta );\r\n\r\n\t\tdata.uniforms = {};\r\n\r\n\t\tfor ( var name in this.uniforms ) {\r\n\r\n\t\t\tvar uniform = this.uniforms[ name ];\r\n\t\t\tvar value = uniform.value;\r\n\r\n\t\t\tif ( value && value.isTexture ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 't',\r\n\t\t\t\t\tvalue: value.toJSON( meta ).uuid\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value && value.isColor ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'c',\r\n\t\t\t\t\tvalue: value.getHex()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value && value.isVector2 ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'v2',\r\n\t\t\t\t\tvalue: value.toArray()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value && value.isVector3 ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'v3',\r\n\t\t\t\t\tvalue: value.toArray()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value && value.isVector4 ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'v4',\r\n\t\t\t\t\tvalue: value.toArray()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value && value.isMatrix3 ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'm3',\r\n\t\t\t\t\tvalue: value.toArray()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else if ( value && value.isMatrix4 ) {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\ttype: 'm4',\r\n\t\t\t\t\tvalue: value.toArray()\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdata.uniforms[ name ] = {\r\n\t\t\t\t\tvalue: value\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// note: the array variants v2v, v3v, v4v, m4v and tv are not supported so far\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( Object.keys( this.defines ).length > 0 ) { data.defines = this.defines; }\r\n\r\n\t\tdata.vertexShader = this.vertexShader;\r\n\t\tdata.fragmentShader = this.fragmentShader;\r\n\r\n\t\tvar extensions = {};\r\n\r\n\t\tfor ( var key in this.extensions ) {\r\n\r\n\t\t\tif ( this.extensions[ key ] === true ) { extensions[ key ] = true; }\r\n\r\n\t\t}\r\n\r\n\t\tif ( Object.keys( extensions ).length > 0 ) { data.extensions = extensions; }\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t*/\r\n\r\n\tfunction Camera() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Camera';\r\n\r\n\t\tthis.matrixWorldInverse = new Matrix4();\r\n\r\n\t\tthis.projectionMatrix = new Matrix4();\r\n\t\tthis.projectionMatrixInverse = new Matrix4();\r\n\r\n\t}\r\n\r\n\tCamera.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Camera,\r\n\r\n\t\tisCamera: true,\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source, recursive );\r\n\r\n\t\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\r\n\r\n\t\t\tthis.projectionMatrix.copy( source.projectionMatrix );\r\n\t\t\tthis.projectionMatrixInverse.copy( source.projectionMatrixInverse );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetWorldDirection: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Camera: .getWorldDirection() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\tvar e = this.matrixWorld.elements;\r\n\r\n\t\t\treturn target.set( - e[ 8 ], - e[ 9 ], - e[ 10 ] ).normalize();\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\tthis.matrixWorldInverse.getInverse( this.matrixWorld );\r\n\r\n\t\t},\r\n\r\n\t\tupdateWorldMatrix: function ( updateParents, updateChildren ) {\r\n\r\n\t\t\tObject3D.prototype.updateWorldMatrix.call( this, updateParents, updateChildren );\r\n\r\n\t\t\tthis.matrixWorldInverse.getInverse( this.matrixWorld );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author greggman / http://games.greggman.com/\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction PerspectiveCamera( fov, aspect, near, far ) {\r\n\r\n\t\tCamera.call( this );\r\n\r\n\t\tthis.type = 'PerspectiveCamera';\r\n\r\n\t\tthis.fov = fov !== undefined ? fov : 50;\r\n\t\tthis.zoom = 1;\r\n\r\n\t\tthis.near = near !== undefined ? near : 0.1;\r\n\t\tthis.far = far !== undefined ? far : 2000;\r\n\t\tthis.focus = 10;\r\n\r\n\t\tthis.aspect = aspect !== undefined ? aspect : 1;\r\n\t\tthis.view = null;\r\n\r\n\t\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\r\n\t\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\r\n\r\n\t\tthis.updateProjectionMatrix();\r\n\r\n\t}\r\n\r\n\tPerspectiveCamera.prototype = Object.assign( Object.create( Camera.prototype ), {\r\n\r\n\t\tconstructor: PerspectiveCamera,\r\n\r\n\t\tisPerspectiveCamera: true,\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tCamera.prototype.copy.call( this, source, recursive );\r\n\r\n\t\t\tthis.fov = source.fov;\r\n\t\t\tthis.zoom = source.zoom;\r\n\r\n\t\t\tthis.near = source.near;\r\n\t\t\tthis.far = source.far;\r\n\t\t\tthis.focus = source.focus;\r\n\r\n\t\t\tthis.aspect = source.aspect;\r\n\t\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\r\n\r\n\t\t\tthis.filmGauge = source.filmGauge;\r\n\t\t\tthis.filmOffset = source.filmOffset;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Sets the FOV by focal length in respect to the current .filmGauge.\r\n\t\t *\r\n\t\t * The default film gauge is 35, so that the focal length can be specified for\r\n\t\t * a 35mm (full frame) camera.\r\n\t\t *\r\n\t\t * Values for focal length and film gauge must have the same unit.\r\n\t\t */\r\n\t\tsetFocalLength: function ( focalLength ) {\r\n\r\n\t\t\t// see http://www.bobatkins.com/photography/technical/field_of_view.html\r\n\t\t\tvar vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\r\n\r\n\t\t\tthis.fov = MathUtils.RAD2DEG * 2 * Math.atan( vExtentSlope );\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Calculates the focal length from the current .fov and .filmGauge.\r\n\t\t */\r\n\t\tgetFocalLength: function () {\r\n\r\n\t\t\tvar vExtentSlope = Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov );\r\n\r\n\t\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\r\n\r\n\t\t},\r\n\r\n\t\tgetEffectiveFOV: function () {\r\n\r\n\t\t\treturn MathUtils.RAD2DEG * 2 * Math.atan(\r\n\t\t\t\tMath.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom );\r\n\r\n\t\t},\r\n\r\n\t\tgetFilmWidth: function () {\r\n\r\n\t\t\t// film not completely covered in portrait format (aspect < 1)\r\n\t\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\r\n\r\n\t\t},\r\n\r\n\t\tgetFilmHeight: function () {\r\n\r\n\t\t\t// film not completely covered in landscape format (aspect > 1)\r\n\t\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Sets an offset in a larger frustum. This is useful for multi-window or\r\n\t\t * multi-monitor/multi-machine setups.\r\n\t\t *\r\n\t\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\r\n\t\t * the monitors are in grid like this\r\n\t\t *\r\n\t\t *   +---+---+---+\r\n\t\t *   | A | B | C |\r\n\t\t *   +---+---+---+\r\n\t\t *   | D | E | F |\r\n\t\t *   +---+---+---+\r\n\t\t *\r\n\t\t * then for each monitor you would call it like this\r\n\t\t *\r\n\t\t *   var w = 1920;\r\n\t\t *   var h = 1080;\r\n\t\t *   var fullWidth = w * 3;\r\n\t\t *   var fullHeight = h * 2;\r\n\t\t *\r\n\t\t *   --A--\r\n\t\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\r\n\t\t *   --B--\r\n\t\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\r\n\t\t *   --C--\r\n\t\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\r\n\t\t *   --D--\r\n\t\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\r\n\t\t *   --E--\r\n\t\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\r\n\t\t *   --F--\r\n\t\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\r\n\t\t *\r\n\t\t *   Note there is no reason monitors have to be the same size or in a grid.\r\n\t\t */\r\n\t\tsetViewOffset: function ( fullWidth, fullHeight, x, y, width, height ) {\r\n\r\n\t\t\tthis.aspect = fullWidth / fullHeight;\r\n\r\n\t\t\tif ( this.view === null ) {\r\n\r\n\t\t\t\tthis.view = {\r\n\t\t\t\t\tenabled: true,\r\n\t\t\t\t\tfullWidth: 1,\r\n\t\t\t\t\tfullHeight: 1,\r\n\t\t\t\t\toffsetX: 0,\r\n\t\t\t\t\toffsetY: 0,\r\n\t\t\t\t\twidth: 1,\r\n\t\t\t\t\theight: 1\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.view.enabled = true;\r\n\t\t\tthis.view.fullWidth = fullWidth;\r\n\t\t\tthis.view.fullHeight = fullHeight;\r\n\t\t\tthis.view.offsetX = x;\r\n\t\t\tthis.view.offsetY = y;\r\n\t\t\tthis.view.width = width;\r\n\t\t\tthis.view.height = height;\r\n\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\tclearViewOffset: function () {\r\n\r\n\t\t\tif ( this.view !== null ) {\r\n\r\n\t\t\t\tthis.view.enabled = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\tupdateProjectionMatrix: function () {\r\n\r\n\t\t\tvar near = this.near,\r\n\t\t\t\ttop = near * Math.tan( MathUtils.DEG2RAD * 0.5 * this.fov ) / this.zoom,\r\n\t\t\t\theight = 2 * top,\r\n\t\t\t\twidth = this.aspect * height,\r\n\t\t\t\tleft = - 0.5 * width,\r\n\t\t\t\tview = this.view;\r\n\r\n\t\t\tif ( this.view !== null && this.view.enabled ) {\r\n\r\n\t\t\t\tvar fullWidth = view.fullWidth,\r\n\t\t\t\t\tfullHeight = view.fullHeight;\r\n\r\n\t\t\t\tleft += view.offsetX * width / fullWidth;\r\n\t\t\t\ttop -= view.offsetY * height / fullHeight;\r\n\t\t\t\twidth *= view.width / fullWidth;\r\n\t\t\t\theight *= view.height / fullHeight;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar skew = this.filmOffset;\r\n\t\t\tif ( skew !== 0 ) { left += near * skew / this.getFilmWidth(); }\r\n\r\n\t\t\tthis.projectionMatrix.makePerspective( left, left + width, top, top - height, near, this.far );\r\n\r\n\t\t\tthis.projectionMatrixInverse.getInverse( this.projectionMatrix );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tdata.object.fov = this.fov;\r\n\t\t\tdata.object.zoom = this.zoom;\r\n\r\n\t\t\tdata.object.near = this.near;\r\n\t\t\tdata.object.far = this.far;\r\n\t\t\tdata.object.focus = this.focus;\r\n\r\n\t\t\tdata.object.aspect = this.aspect;\r\n\r\n\t\t\tif ( this.view !== null ) { data.object.view = Object.assign( {}, this.view ); }\r\n\r\n\t\t\tdata.object.filmGauge = this.filmGauge;\r\n\t\t\tdata.object.filmOffset = this.filmOffset;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * Camera for rendering cube maps\r\n\t *\t- renders scene into axis-aligned cube\r\n\t *\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tvar fov = 90, aspect = 1;\r\n\r\n\tfunction CubeCamera( near, far, cubeResolution, options ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'CubeCamera';\r\n\r\n\t\tvar cameraPX = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraPX.up.set( 0, - 1, 0 );\r\n\t\tcameraPX.lookAt( new Vector3( 1, 0, 0 ) );\r\n\t\tthis.add( cameraPX );\r\n\r\n\t\tvar cameraNX = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraNX.up.set( 0, - 1, 0 );\r\n\t\tcameraNX.lookAt( new Vector3( - 1, 0, 0 ) );\r\n\t\tthis.add( cameraNX );\r\n\r\n\t\tvar cameraPY = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraPY.up.set( 0, 0, 1 );\r\n\t\tcameraPY.lookAt( new Vector3( 0, 1, 0 ) );\r\n\t\tthis.add( cameraPY );\r\n\r\n\t\tvar cameraNY = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraNY.up.set( 0, 0, - 1 );\r\n\t\tcameraNY.lookAt( new Vector3( 0, - 1, 0 ) );\r\n\t\tthis.add( cameraNY );\r\n\r\n\t\tvar cameraPZ = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraPZ.up.set( 0, - 1, 0 );\r\n\t\tcameraPZ.lookAt( new Vector3( 0, 0, 1 ) );\r\n\t\tthis.add( cameraPZ );\r\n\r\n\t\tvar cameraNZ = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tcameraNZ.up.set( 0, - 1, 0 );\r\n\t\tcameraNZ.lookAt( new Vector3( 0, 0, - 1 ) );\r\n\t\tthis.add( cameraNZ );\r\n\r\n\t\toptions = options || { format: RGBFormat, magFilter: LinearFilter, minFilter: LinearFilter };\r\n\r\n\t\tthis.renderTarget = new WebGLCubeRenderTarget( cubeResolution, options );\r\n\t\tthis.renderTarget.texture.name = \"CubeCamera\";\r\n\r\n\t\tthis.update = function ( renderer, scene ) {\r\n\r\n\t\t\tif ( this.parent === null ) { this.updateMatrixWorld(); }\r\n\r\n\t\t\tvar currentRenderTarget = renderer.getRenderTarget();\r\n\r\n\t\t\tvar renderTarget = this.renderTarget;\r\n\t\t\tvar generateMipmaps = renderTarget.texture.generateMipmaps;\r\n\r\n\t\t\trenderTarget.texture.generateMipmaps = false;\r\n\r\n\t\t\trenderer.setRenderTarget( renderTarget, 0 );\r\n\t\t\trenderer.render( scene, cameraPX );\r\n\r\n\t\t\trenderer.setRenderTarget( renderTarget, 1 );\r\n\t\t\trenderer.render( scene, cameraNX );\r\n\r\n\t\t\trenderer.setRenderTarget( renderTarget, 2 );\r\n\t\t\trenderer.render( scene, cameraPY );\r\n\r\n\t\t\trenderer.setRenderTarget( renderTarget, 3 );\r\n\t\t\trenderer.render( scene, cameraNY );\r\n\r\n\t\t\trenderer.setRenderTarget( renderTarget, 4 );\r\n\t\t\trenderer.render( scene, cameraPZ );\r\n\r\n\t\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\r\n\r\n\t\t\trenderer.setRenderTarget( renderTarget, 5 );\r\n\t\t\trenderer.render( scene, cameraNZ );\r\n\r\n\t\t\trenderer.setRenderTarget( currentRenderTarget );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clear = function ( renderer, color, depth, stencil ) {\r\n\r\n\t\t\tvar currentRenderTarget = renderer.getRenderTarget();\r\n\r\n\t\t\tvar renderTarget = this.renderTarget;\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\trenderer.setRenderTarget( renderTarget, i );\r\n\r\n\t\t\t\trenderer.clear( color, depth, stencil );\r\n\r\n\t\t\t}\r\n\r\n\t\t\trenderer.setRenderTarget( currentRenderTarget );\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tCubeCamera.prototype = Object.create( Object3D.prototype );\r\n\tCubeCamera.prototype.constructor = CubeCamera;\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction WebGLCubeRenderTarget( size, options, dummy ) {\r\n\r\n\t\tif ( Number.isInteger( options ) ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )' );\r\n\r\n\t\t\toptions = dummy;\r\n\r\n\t\t}\r\n\r\n\t\tWebGLRenderTarget.call( this, size, size, options );\r\n\r\n\t}\r\n\r\n\tWebGLCubeRenderTarget.prototype = Object.create( WebGLRenderTarget.prototype );\r\n\tWebGLCubeRenderTarget.prototype.constructor = WebGLCubeRenderTarget;\r\n\r\n\tWebGLCubeRenderTarget.prototype.isWebGLCubeRenderTarget = true;\r\n\r\n\tWebGLCubeRenderTarget.prototype.fromEquirectangularTexture = function ( renderer, texture ) {\r\n\r\n\t\tthis.texture.type = texture.type;\r\n\t\tthis.texture.format = texture.format;\r\n\t\tthis.texture.encoding = texture.encoding;\r\n\r\n\t\tvar scene = new Scene();\r\n\r\n\t\tvar shader = {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\ttEquirect: { value: null },\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: [\r\n\r\n\t\t\t\t\"varying vec3 vWorldDirection;\",\r\n\r\n\t\t\t\t\"vec3 transformDirection( in vec3 dir, in mat4 matrix ) {\",\r\n\r\n\t\t\t\t\"\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\",\r\n\r\n\t\t\t\t\"}\",\r\n\r\n\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\"\tvWorldDirection = transformDirection( position, modelMatrix );\",\r\n\r\n\t\t\t\t\"\t#include <begin_vertex>\",\r\n\t\t\t\t\"\t#include <project_vertex>\",\r\n\r\n\t\t\t\t\"}\"\r\n\r\n\t\t\t].join( '\\n' ),\r\n\r\n\t\t\tfragmentShader: [\r\n\r\n\t\t\t\t\"uniform sampler2D tEquirect;\",\r\n\r\n\t\t\t\t\"varying vec3 vWorldDirection;\",\r\n\r\n\t\t\t\t\"#define RECIPROCAL_PI 0.31830988618\",\r\n\t\t\t\t\"#define RECIPROCAL_PI2 0.15915494\",\r\n\r\n\t\t\t\t\"void main() {\",\r\n\r\n\t\t\t\t\"\tvec3 direction = normalize( vWorldDirection );\",\r\n\r\n\t\t\t\t\"\tvec2 sampleUV;\",\r\n\r\n\t\t\t\t\"\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\",\r\n\r\n\t\t\t\t\"\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\",\r\n\r\n\t\t\t\t\"\tgl_FragColor = texture2D( tEquirect, sampleUV );\",\r\n\r\n\t\t\t\t\"}\"\r\n\r\n\t\t\t].join( '\\n' ),\r\n\t\t};\r\n\r\n\t\tvar material = new ShaderMaterial( {\r\n\r\n\t\t\ttype: 'CubemapFromEquirect',\r\n\r\n\t\t\tuniforms: cloneUniforms( shader.uniforms ),\r\n\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\tfragmentShader: shader.fragmentShader,\r\n\t\t\tside: BackSide,\r\n\t\t\tblending: NoBlending\r\n\r\n\t\t} );\r\n\r\n\t\tmaterial.uniforms.tEquirect.value = texture;\r\n\r\n\t\tvar mesh = new Mesh( new BoxBufferGeometry( 5, 5, 5 ), material );\r\n\r\n\t\tscene.add( mesh );\r\n\r\n\t\tvar camera = new CubeCamera( 1, 10, 1 );\r\n\r\n\t\tcamera.renderTarget = this;\r\n\t\tcamera.renderTarget.texture.name = 'CubeCameraTexture';\r\n\r\n\t\tcamera.update( renderer, scene );\r\n\r\n\t\tmesh.geometry.dispose();\r\n\t\tmesh.material.dispose();\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction DataTexture( data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\r\n\r\n\t\tTexture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\t\tthis.image = { data: data || null, width: width || 1, height: height || 1 };\r\n\r\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\r\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\r\n\r\n\t\tthis.generateMipmaps = false;\r\n\t\tthis.flipY = false;\r\n\t\tthis.unpackAlignment = 1;\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\tDataTexture.prototype = Object.create( Texture.prototype );\r\n\tDataTexture.prototype.constructor = DataTexture;\r\n\r\n\tDataTexture.prototype.isDataTexture = true;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tvar _sphere$1 = new Sphere();\r\n\tvar _vector$5 = new Vector3();\r\n\r\n\tfunction Frustum( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\t\tthis.planes = [\r\n\r\n\t\t\t( p0 !== undefined ) ? p0 : new Plane(),\r\n\t\t\t( p1 !== undefined ) ? p1 : new Plane(),\r\n\t\t\t( p2 !== undefined ) ? p2 : new Plane(),\r\n\t\t\t( p3 !== undefined ) ? p3 : new Plane(),\r\n\t\t\t( p4 !== undefined ) ? p4 : new Plane(),\r\n\t\t\t( p5 !== undefined ) ? p5 : new Plane()\r\n\r\n\t\t];\r\n\r\n\t}\r\n\r\n\tObject.assign( Frustum.prototype, {\r\n\r\n\t\tset: function ( p0, p1, p2, p3, p4, p5 ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tplanes[ 0 ].copy( p0 );\r\n\t\t\tplanes[ 1 ].copy( p1 );\r\n\t\t\tplanes[ 2 ].copy( p2 );\r\n\t\t\tplanes[ 3 ].copy( p3 );\r\n\t\t\tplanes[ 4 ].copy( p4 );\r\n\t\t\tplanes[ 5 ].copy( p5 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( frustum ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromProjectionMatrix: function ( m ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\t\t\tvar me = m.elements;\r\n\t\t\tvar me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\r\n\t\t\tvar me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\r\n\t\t\tvar me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\r\n\t\t\tvar me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\r\n\r\n\t\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\r\n\t\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\r\n\t\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\r\n\t\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\r\n\t\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\r\n\t\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tintersectsObject: function ( object ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) { geometry.computeBoundingSphere(); }\r\n\r\n\t\t\t_sphere$1.copy( geometry.boundingSphere ).applyMatrix4( object.matrixWorld );\r\n\r\n\t\t\treturn this.intersectsSphere( _sphere$1 );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsSprite: function ( sprite ) {\r\n\r\n\t\t\t_sphere$1.center.set( 0, 0, 0 );\r\n\t\t\t_sphere$1.radius = 0.7071067811865476;\r\n\t\t\t_sphere$1.applyMatrix4( sprite.matrixWorld );\r\n\r\n\t\t\treturn this.intersectsSphere( _sphere$1 );\r\n\r\n\t\t},\r\n\r\n\t\tintersectsSphere: function ( sphere ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\t\t\tvar center = sphere.center;\r\n\t\t\tvar negRadius = - sphere.radius;\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tvar distance = planes[ i ].distanceToPoint( center );\r\n\r\n\t\t\t\tif ( distance < negRadius ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tvar plane = planes[ i ];\r\n\r\n\t\t\t\t// corner at max distance\r\n\r\n\t\t\t\t_vector$5.x = plane.normal.x > 0 ? box.max.x : box.min.x;\r\n\t\t\t\t_vector$5.y = plane.normal.y > 0 ? box.max.y : box.min.y;\r\n\t\t\t\t_vector$5.z = plane.normal.z > 0 ? box.max.z : box.min.z;\r\n\r\n\t\t\t\tif ( plane.distanceToPoint( _vector$5 ) < 0 ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\tvar planes = this.planes;\r\n\r\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * Uniforms library for shared webgl shaders\r\n\t */\r\n\r\n\tvar UniformsLib = {\r\n\r\n\t\tcommon: {\r\n\r\n\t\t\tdiffuse: { value: new Color( 0xeeeeee ) },\r\n\t\t\topacity: { value: 1.0 },\r\n\r\n\t\t\tmap: { value: null },\r\n\t\t\tuvTransform: { value: new Matrix3() },\r\n\t\t\tuv2Transform: { value: new Matrix3() },\r\n\r\n\t\t\talphaMap: { value: null },\r\n\r\n\t\t},\r\n\r\n\t\tspecularmap: {\r\n\r\n\t\t\tspecularMap: { value: null },\r\n\r\n\t\t},\r\n\r\n\t\tenvmap: {\r\n\r\n\t\t\tenvMap: { value: null },\r\n\t\t\tflipEnvMap: { value: - 1 },\r\n\t\t\treflectivity: { value: 1.0 },\r\n\t\t\trefractionRatio: { value: 0.98 },\r\n\t\t\tmaxMipLevel: { value: 0 }\r\n\r\n\t\t},\r\n\r\n\t\taomap: {\r\n\r\n\t\t\taoMap: { value: null },\r\n\t\t\taoMapIntensity: { value: 1 }\r\n\r\n\t\t},\r\n\r\n\t\tlightmap: {\r\n\r\n\t\t\tlightMap: { value: null },\r\n\t\t\tlightMapIntensity: { value: 1 }\r\n\r\n\t\t},\r\n\r\n\t\temissivemap: {\r\n\r\n\t\t\temissiveMap: { value: null }\r\n\r\n\t\t},\r\n\r\n\t\tbumpmap: {\r\n\r\n\t\t\tbumpMap: { value: null },\r\n\t\t\tbumpScale: { value: 1 }\r\n\r\n\t\t},\r\n\r\n\t\tnormalmap: {\r\n\r\n\t\t\tnormalMap: { value: null },\r\n\t\t\tnormalScale: { value: new Vector2( 1, 1 ) }\r\n\r\n\t\t},\r\n\r\n\t\tdisplacementmap: {\r\n\r\n\t\t\tdisplacementMap: { value: null },\r\n\t\t\tdisplacementScale: { value: 1 },\r\n\t\t\tdisplacementBias: { value: 0 }\r\n\r\n\t\t},\r\n\r\n\t\troughnessmap: {\r\n\r\n\t\t\troughnessMap: { value: null }\r\n\r\n\t\t},\r\n\r\n\t\tmetalnessmap: {\r\n\r\n\t\t\tmetalnessMap: { value: null }\r\n\r\n\t\t},\r\n\r\n\t\tgradientmap: {\r\n\r\n\t\t\tgradientMap: { value: null }\r\n\r\n\t\t},\r\n\r\n\t\tfog: {\r\n\r\n\t\t\tfogDensity: { value: 0.00025 },\r\n\t\t\tfogNear: { value: 1 },\r\n\t\t\tfogFar: { value: 2000 },\r\n\t\t\tfogColor: { value: new Color( 0xffffff ) }\r\n\r\n\t\t},\r\n\r\n\t\tlights: {\r\n\r\n\t\t\tambientLightColor: { value: [] },\r\n\r\n\t\t\tlightProbe: { value: [] },\r\n\r\n\t\t\tdirectionalLights: { value: [], properties: {\r\n\t\t\t\tdirection: {},\r\n\t\t\t\tcolor: {}\r\n\t\t\t} },\r\n\r\n\t\t\tdirectionalLightShadows: { value: [], properties: {\r\n\t\t\t\tshadowBias: {},\r\n\t\t\t\tshadowRadius: {},\r\n\t\t\t\tshadowMapSize: {}\r\n\t\t\t} },\r\n\r\n\t\t\tdirectionalShadowMap: { value: [] },\r\n\t\t\tdirectionalShadowMatrix: { value: [] },\r\n\r\n\t\t\tspotLights: { value: [], properties: {\r\n\t\t\t\tcolor: {},\r\n\t\t\t\tposition: {},\r\n\t\t\t\tdirection: {},\r\n\t\t\t\tdistance: {},\r\n\t\t\t\tconeCos: {},\r\n\t\t\t\tpenumbraCos: {},\r\n\t\t\t\tdecay: {}\r\n\t\t\t} },\r\n\r\n\t\t\tspotLightShadows: { value: [], properties: {\r\n\t\t\t\tshadowBias: {},\r\n\t\t\t\tshadowRadius: {},\r\n\t\t\t\tshadowMapSize: {}\r\n\t\t\t} },\r\n\r\n\t\t\tspotShadowMap: { value: [] },\r\n\t\t\tspotShadowMatrix: { value: [] },\r\n\r\n\t\t\tpointLights: { value: [], properties: {\r\n\t\t\t\tcolor: {},\r\n\t\t\t\tposition: {},\r\n\t\t\t\tdecay: {},\r\n\t\t\t\tdistance: {}\r\n\t\t\t} },\r\n\r\n\t\t\tpointLightShadows: { value: [], properties: {\r\n\t\t\t\tshadowBias: {},\r\n\t\t\t\tshadowRadius: {},\r\n\t\t\t\tshadowMapSize: {},\r\n\t\t\t\tshadowCameraNear: {},\r\n\t\t\t\tshadowCameraFar: {}\r\n\t\t\t} },\r\n\r\n\t\t\tpointShadowMap: { value: [] },\r\n\t\t\tpointShadowMatrix: { value: [] },\r\n\r\n\t\t\themisphereLights: { value: [], properties: {\r\n\t\t\t\tdirection: {},\r\n\t\t\t\tskyColor: {},\r\n\t\t\t\tgroundColor: {}\r\n\t\t\t} },\r\n\r\n\t\t\t// TODO (abelnation): RectAreaLight BRDF data needs to be moved from example to main src\r\n\t\t\trectAreaLights: { value: [], properties: {\r\n\t\t\t\tcolor: {},\r\n\t\t\t\tposition: {},\r\n\t\t\t\twidth: {},\r\n\t\t\t\theight: {}\r\n\t\t\t} }\r\n\r\n\t\t},\r\n\r\n\t\tpoints: {\r\n\r\n\t\t\tdiffuse: { value: new Color( 0xeeeeee ) },\r\n\t\t\topacity: { value: 1.0 },\r\n\t\t\tsize: { value: 1.0 },\r\n\t\t\tscale: { value: 1.0 },\r\n\t\t\tmap: { value: null },\r\n\t\t\talphaMap: { value: null },\r\n\t\t\tuvTransform: { value: new Matrix3() }\r\n\r\n\t\t},\r\n\r\n\t\tsprite: {\r\n\r\n\t\t\tdiffuse: { value: new Color( 0xeeeeee ) },\r\n\t\t\topacity: { value: 1.0 },\r\n\t\t\tcenter: { value: new Vector2( 0.5, 0.5 ) },\r\n\t\t\trotation: { value: 0.0 },\r\n\t\t\tmap: { value: null },\r\n\t\t\talphaMap: { value: null },\r\n\t\t\tuvTransform: { value: new Matrix3() }\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLAnimation() {\r\n\r\n\t\tvar context = null;\r\n\t\tvar isAnimating = false;\r\n\t\tvar animationLoop = null;\r\n\r\n\t\tfunction onAnimationFrame( time, frame ) {\r\n\r\n\t\t\tif ( isAnimating === false ) { return; }\r\n\r\n\t\t\tanimationLoop( time, frame );\r\n\r\n\t\t\tcontext.requestAnimationFrame( onAnimationFrame );\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tstart: function () {\r\n\r\n\t\t\t\tif ( isAnimating === true ) { return; }\r\n\t\t\t\tif ( animationLoop === null ) { return; }\r\n\r\n\t\t\t\tcontext.requestAnimationFrame( onAnimationFrame );\r\n\r\n\t\t\t\tisAnimating = true;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tstop: function () {\r\n\r\n\t\t\t\tisAnimating = false;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tsetAnimationLoop: function ( callback ) {\r\n\r\n\t\t\t\tanimationLoop = callback;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tsetContext: function ( value ) {\r\n\r\n\t\t\t\tcontext = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLAttributes( gl, capabilities ) {\r\n\r\n\t\tvar isWebGL2 = capabilities.isWebGL2;\r\n\r\n\t\tvar buffers = new WeakMap();\r\n\r\n\t\tfunction createBuffer( attribute, bufferType ) {\r\n\r\n\t\t\tvar array = attribute.array;\r\n\t\t\tvar usage = attribute.usage;\r\n\r\n\t\t\tvar buffer = gl.createBuffer();\r\n\r\n\t\t\tgl.bindBuffer( bufferType, buffer );\r\n\t\t\tgl.bufferData( bufferType, array, usage );\r\n\r\n\t\t\tattribute.onUploadCallback();\r\n\r\n\t\t\tvar type = 5126;\r\n\r\n\t\t\tif ( array instanceof Float32Array ) {\r\n\r\n\t\t\t\ttype = 5126;\r\n\r\n\t\t\t} else if ( array instanceof Float64Array ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.' );\r\n\r\n\t\t\t} else if ( array instanceof Uint16Array ) {\r\n\r\n\t\t\t\ttype = 5123;\r\n\r\n\t\t\t} else if ( array instanceof Int16Array ) {\r\n\r\n\t\t\t\ttype = 5122;\r\n\r\n\t\t\t} else if ( array instanceof Uint32Array ) {\r\n\r\n\t\t\t\ttype = 5125;\r\n\r\n\t\t\t} else if ( array instanceof Int32Array ) {\r\n\r\n\t\t\t\ttype = 5124;\r\n\r\n\t\t\t} else if ( array instanceof Int8Array ) {\r\n\r\n\t\t\t\ttype = 5120;\r\n\r\n\t\t\t} else if ( array instanceof Uint8Array ) {\r\n\r\n\t\t\t\ttype = 5121;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tbuffer: buffer,\r\n\t\t\t\ttype: type,\r\n\t\t\t\tbytesPerElement: array.BYTES_PER_ELEMENT,\r\n\t\t\t\tversion: attribute.version\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateBuffer( buffer, attribute, bufferType ) {\r\n\r\n\t\t\tvar array = attribute.array;\r\n\t\t\tvar updateRange = attribute.updateRange;\r\n\r\n\t\t\tgl.bindBuffer( bufferType, buffer );\r\n\r\n\t\t\tif ( updateRange.count === - 1 ) {\r\n\r\n\t\t\t\t// Not using update ranges\r\n\r\n\t\t\t\tgl.bufferSubData( bufferType, 0, array );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( isWebGL2 ) {\r\n\r\n\t\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\r\n\t\t\t\t\t\tarray, updateRange.offset, updateRange.count );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.bufferSubData( bufferType, updateRange.offset * array.BYTES_PER_ELEMENT,\r\n\t\t\t\t\t\tarray.subarray( updateRange.offset, updateRange.offset + updateRange.count ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tupdateRange.count = - 1; // reset range\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction get( attribute ) {\r\n\r\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) { attribute = attribute.data; }\r\n\r\n\t\t\treturn buffers.get( attribute );\r\n\r\n\t\t}\r\n\r\n\t\tfunction remove( attribute ) {\r\n\r\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) { attribute = attribute.data; }\r\n\r\n\t\t\tvar data = buffers.get( attribute );\r\n\r\n\t\t\tif ( data ) {\r\n\r\n\t\t\t\tgl.deleteBuffer( data.buffer );\r\n\r\n\t\t\t\tbuffers.delete( attribute );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction update( attribute, bufferType ) {\r\n\r\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) { attribute = attribute.data; }\r\n\r\n\t\t\tvar data = buffers.get( attribute );\r\n\r\n\t\t\tif ( data === undefined ) {\r\n\r\n\t\t\t\tbuffers.set( attribute, createBuffer( attribute, bufferType ) );\r\n\r\n\t\t\t} else if ( data.version < attribute.version ) {\r\n\r\n\t\t\t\tupdateBuffer( data.buffer, attribute, bufferType );\r\n\r\n\t\t\t\tdata.version = attribute.version;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tget: get,\r\n\t\t\tremove: remove,\r\n\t\t\tupdate: update\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// PlaneGeometry\r\n\r\n\tfunction PlaneGeometry( width, height, widthSegments, heightSegments ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'PlaneGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new PlaneBufferGeometry( width, height, widthSegments, heightSegments ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tPlaneGeometry.prototype = Object.create( Geometry.prototype );\r\n\tPlaneGeometry.prototype.constructor = PlaneGeometry;\r\n\r\n\t// PlaneBufferGeometry\r\n\r\n\tfunction PlaneBufferGeometry( width, height, widthSegments, heightSegments ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'PlaneBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments\r\n\t\t};\r\n\r\n\t\twidth = width || 1;\r\n\t\theight = height || 1;\r\n\r\n\t\tvar width_half = width / 2;\r\n\t\tvar height_half = height / 2;\r\n\r\n\t\tvar gridX = Math.floor( widthSegments ) || 1;\r\n\t\tvar gridY = Math.floor( heightSegments ) || 1;\r\n\r\n\t\tvar gridX1 = gridX + 1;\r\n\t\tvar gridY1 = gridY + 1;\r\n\r\n\t\tvar segment_width = width / gridX;\r\n\t\tvar segment_height = height / gridY;\r\n\r\n\t\tvar ix, iy;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( iy = 0; iy < gridY1; iy ++ ) {\r\n\r\n\t\t\tvar y = iy * segment_height - height_half;\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX1; ix ++ ) {\r\n\r\n\t\t\t\tvar x = ix * segment_width - width_half;\r\n\r\n\t\t\t\tvertices.push( x, - y, 0 );\r\n\r\n\t\t\t\tnormals.push( 0, 0, 1 );\r\n\r\n\t\t\t\tuvs.push( ix / gridX );\r\n\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\r\n\r\n\t\t\t\tvar a = ix + gridX1 * iy;\r\n\t\t\t\tvar b = ix + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\r\n\t\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tPlaneBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tPlaneBufferGeometry.prototype.constructor = PlaneBufferGeometry;\r\n\r\n\tvar alphamap_fragment = \"#ifdef USE_ALPHAMAP\\n\\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n#endif\";\r\n\r\n\tvar alphamap_pars_fragment = \"#ifdef USE_ALPHAMAP\\n\\tuniform sampler2D alphaMap;\\n#endif\";\r\n\r\n\tvar alphatest_fragment = \"#ifdef ALPHATEST\\n\\tif ( diffuseColor.a < ALPHATEST ) discard;\\n#endif\";\r\n\r\n\tvar aomap_fragment = \"#ifdef USE_AOMAP\\n\\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\treflectedLight.indirectDiffuse *= ambientOcclusion;\\n\\t#if defined( USE_ENVMAP ) && defined( STANDARD )\\n\\t\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\t\\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\\n\\t#endif\\n#endif\";\r\n\r\n\tvar aomap_pars_fragment = \"#ifdef USE_AOMAP\\n\\tuniform sampler2D aoMap;\\n\\tuniform float aoMapIntensity;\\n#endif\";\r\n\r\n\tvar begin_vertex = \"vec3 transformed = vec3( position );\";\r\n\r\n\tvar beginnormal_vertex = \"vec3 objectNormal = vec3( normal );\\n#ifdef USE_TANGENT\\n\\tvec3 objectTangent = vec3( tangent.xyz );\\n#endif\";\r\n\r\n\tvar bsdfs = \"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\\n\\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\\n\\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\\n\\tvec4 r = roughness * c0 + c1;\\n\\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\\n\\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\\n}\\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\\n\\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\\n\\tif( cutoffDistance > 0.0 ) {\\n\\t\\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\\n\\t}\\n\\treturn distanceFalloff;\\n#else\\n\\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\\n\\t\\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n\\t}\\n\\treturn 1.0;\\n#endif\\n}\\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\\n\\treturn RECIPROCAL_PI * diffuseColor;\\n}\\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\\n\\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\\n\\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n}\\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\\n\\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\\n\\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\\n\\treturn Fr * fresnel + F0;\\n}\\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\treturn 1.0 / ( gl * gv );\\n}\\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\\n\\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\\n\\treturn 0.5 / max( gv + gl, EPSILON );\\n}\\nfloat D_GGX( const in float alpha, const in float dotNH ) {\\n\\tfloat a2 = pow2( alpha );\\n\\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\\n\\treturn RECIPROCAL_PI * a2 / pow2( denom );\\n}\\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\\n\\tfloat alpha = pow2( roughness );\\n\\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\\n\\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\\n\\tfloat D = D_GGX( alpha, dotNH );\\n\\treturn F * ( G * D );\\n}\\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\\n\\tconst float LUT_SIZE  = 64.0;\\n\\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\\n\\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\\n\\tfloat dotNV = saturate( dot( N, V ) );\\n\\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\\n\\tuv = uv * LUT_SCALE + LUT_BIAS;\\n\\treturn uv;\\n}\\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\\n\\tfloat l = length( f );\\n\\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\\n}\\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\\n\\tfloat x = dot( v1, v2 );\\n\\tfloat y = abs( x );\\n\\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\\n\\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\\n\\tfloat v = a / b;\\n\\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\\n\\treturn cross( v1, v2 ) * theta_sintheta;\\n}\\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\\n\\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\\n\\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\\n\\tvec3 lightNormal = cross( v1, v2 );\\n\\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\\n\\tvec3 T1, T2;\\n\\tT1 = normalize( V - N * dot( V, N ) );\\n\\tT2 = - cross( N, T1 );\\n\\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\\n\\tvec3 coords[ 4 ];\\n\\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\\n\\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\\n\\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\\n\\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\\n\\tcoords[ 0 ] = normalize( coords[ 0 ] );\\n\\tcoords[ 1 ] = normalize( coords[ 1 ] );\\n\\tcoords[ 2 ] = normalize( coords[ 2 ] );\\n\\tcoords[ 3 ] = normalize( coords[ 3 ] );\\n\\tvec3 vectorFormFactor = vec3( 0.0 );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\\n\\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\\n\\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\\n\\treturn vec3( result );\\n}\\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\\n\\tfloat dotNV = saturate( dot( normal, viewDir ) );\\n\\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\\n\\treturn specularColor * brdf.x + brdf.y;\\n}\\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\\n\\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\\n\\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\\n\\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\\n\\tvec3 FssEss = F * brdf.x + brdf.y;\\n\\tfloat Ess = brdf.x + brdf.y;\\n\\tfloat Ems = 1.0 - Ess;\\n\\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\\n\\tsingleScatter += FssEss;\\n\\tmultiScatter += Fms * Ems;\\n}\\nfloat G_BlinnPhong_Implicit( ) {\\n\\treturn 0.25;\\n}\\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\\n\\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n}\\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\\n\\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\\n\\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\\n\\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\\n\\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\tfloat G = G_BlinnPhong_Implicit( );\\n\\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\treturn F * ( G * D );\\n}\\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\\n\\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\\n}\\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\\n\\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\\n}\\n#if defined( USE_SHEEN )\\nfloat D_Charlie(float roughness, float NoH) {\\n\\tfloat invAlpha  = 1.0 / roughness;\\n\\tfloat cos2h = NoH * NoH;\\n\\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\\n}\\nfloat V_Neubelt(float NoV, float NoL) {\\n\\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\\n}\\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\\n\\tvec3 N = geometry.normal;\\n\\tvec3 V = geometry.viewDir;\\n\\tvec3 H = normalize( V + L );\\n\\tfloat dotNH = saturate( dot( N, H ) );\\n\\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\\n}\\n#endif\";\r\n\r\n\tvar bumpmap_pars_fragment = \"#ifdef USE_BUMPMAP\\n\\tuniform sampler2D bumpMap;\\n\\tuniform float bumpScale;\\n\\tvec2 dHdxy_fwd() {\\n\\t\\tvec2 dSTdx = dFdx( vUv );\\n\\t\\tvec2 dSTdy = dFdy( vUv );\\n\\t\\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\\t\\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\\t\\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\t\\treturn vec2( dBx, dBy );\\n\\t}\\n\\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\t\\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\\n\\t\\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\\n\\t\\tvec3 vN = surf_norm;\\n\\t\\tvec3 R1 = cross( vSigmaY, vN );\\n\\t\\tvec3 R2 = cross( vN, vSigmaX );\\n\\t\\tfloat fDet = dot( vSigmaX, R1 );\\n\\t\\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\\t\\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\t}\\n#endif\";\r\n\r\n\tvar clipping_planes_fragment = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvec4 plane;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\\n\\t\\tplane = clippingPlanes[ i ];\\n\\t\\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\\n\\t\\tbool clipped = true;\\n\\t\\t#pragma unroll_loop_start\\n\\t\\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\\n\\t\\t\\tplane = clippingPlanes[ i ];\\n\\t\\t\\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\\n\\t\\t}\\n\\t\\t#pragma unroll_loop_end\\n\\t\\tif ( clipped ) discard;\\n\\t#endif\\n#endif\";\r\n\r\n\tvar clipping_planes_pars_fragment = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvarying vec3 vClipPosition;\\n\\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\\n#endif\";\r\n\r\n\tvar clipping_planes_pars_vertex = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvarying vec3 vClipPosition;\\n#endif\";\r\n\r\n\tvar clipping_planes_vertex = \"#if NUM_CLIPPING_PLANES > 0\\n\\tvClipPosition = - mvPosition.xyz;\\n#endif\";\r\n\r\n\tvar color_fragment = \"#ifdef USE_COLOR\\n\\tdiffuseColor.rgb *= vColor;\\n#endif\";\r\n\r\n\tvar color_pars_fragment = \"#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\";\r\n\r\n\tvar color_pars_vertex = \"#ifdef USE_COLOR\\n\\tvarying vec3 vColor;\\n#endif\";\r\n\r\n\tvar color_vertex = \"#ifdef USE_COLOR\\n\\tvColor.xyz = color.xyz;\\n#endif\";\r\n\r\n\tvar common = \"#define PI 3.14159265359\\n#define PI2 6.28318530718\\n#define PI_HALF 1.5707963267949\\n#define RECIPROCAL_PI 0.31830988618\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n#ifndef saturate\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#endif\\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\\nfloat pow2( const in float x ) { return x*x; }\\nfloat pow3( const in float x ) { return x*x*x; }\\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\\nhighp float rand( const in vec2 uv ) {\\n\\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\\n\\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\\n\\treturn fract(sin(sn) * c);\\n}\\n#ifdef HIGH_PRECISION\\n\\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\\n#else\\n\\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\\n\\tfloat precisionSafeLength( vec3 v ) {\\n\\t\\tfloat maxComponent = max3( abs( v ) );\\n\\t\\treturn length( v / maxComponent ) * maxComponent;\\n\\t}\\n#endif\\nstruct IncidentLight {\\n\\tvec3 color;\\n\\tvec3 direction;\\n\\tbool visible;\\n};\\nstruct ReflectedLight {\\n\\tvec3 directDiffuse;\\n\\tvec3 directSpecular;\\n\\tvec3 indirectDiffuse;\\n\\tvec3 indirectSpecular;\\n};\\nstruct GeometricContext {\\n\\tvec3 position;\\n\\tvec3 normal;\\n\\tvec3 viewDir;\\n#ifdef CLEARCOAT\\n\\tvec3 clearcoatNormal;\\n#endif\\n};\\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\\n}\\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\\n\\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\\n}\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\\treturn - distance * planeNormal + point;\\n}\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n}\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n}\\nmat3 transposeMat3( const in mat3 m ) {\\n\\tmat3 tmp;\\n\\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\\n\\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\\n\\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\\n\\treturn tmp;\\n}\\nfloat linearToRelativeLuminance( const in vec3 color ) {\\n\\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\\n\\treturn dot( weights, color.rgb );\\n}\\nbool isPerspectiveMatrix( mat4 m ) {\\n  return m[ 2 ][ 3 ] == - 1.0;\\n}\";\r\n\r\n\tvar cube_uv_reflection_fragment = \"#ifdef ENVMAP_TYPE_CUBE_UV\\n#define cubeUV_maxMipLevel 8.0\\n#define cubeUV_minMipLevel 4.0\\n#define cubeUV_maxTileSize 256.0\\n#define cubeUV_minTileSize 16.0\\nfloat getFace(vec3 direction) {\\n    vec3 absDirection = abs(direction);\\n    float face = -1.0;\\n    if (absDirection.x > absDirection.z) {\\n      if (absDirection.x > absDirection.y)\\n        face = direction.x > 0.0 ? 0.0 : 3.0;\\n      else\\n        face = direction.y > 0.0 ? 1.0 : 4.0;\\n    } else {\\n      if (absDirection.z > absDirection.y)\\n        face = direction.z > 0.0 ? 2.0 : 5.0;\\n      else\\n        face = direction.y > 0.0 ? 1.0 : 4.0;\\n    }\\n    return face;\\n}\\nvec2 getUV(vec3 direction, float face) {\\n    vec2 uv;\\n    if (face == 0.0) {\\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\\n    } else if (face == 1.0) {\\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\\n    } else if (face == 2.0) {\\n      uv = direction.xy / abs(direction.z);\\n    } else if (face == 3.0) {\\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\\n    } else if (face == 4.0) {\\n      uv = direction.xz / abs(direction.y);\\n    } else {\\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\\n    }\\n    return 0.5 * (uv + 1.0);\\n}\\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\\n  float face = getFace(direction);\\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\\n  mipInt = max(mipInt, cubeUV_minMipLevel);\\n  float faceSize = exp2(mipInt);\\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\\n  vec2 f = fract(uv);\\n  uv += 0.5 - f;\\n  if (face > 2.0) {\\n    uv.y += faceSize;\\n    face -= 3.0;\\n  }\\n  uv.x += face * faceSize;\\n  if(mipInt < cubeUV_maxMipLevel){\\n    uv.y += 2.0 * cubeUV_maxTileSize;\\n  }\\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\\n  uv *= texelSize;\\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\\n  uv.x += texelSize;\\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\\n  uv.y += texelSize;\\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\\n  uv.x -= texelSize;\\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\\n  vec3 tm = mix(tl, tr, f.x);\\n  vec3 bm = mix(bl, br, f.x);\\n  return mix(tm, bm, f.y);\\n}\\n#define r0 1.0\\n#define v0 0.339\\n#define m0 -2.0\\n#define r1 0.8\\n#define v1 0.276\\n#define m1 -1.0\\n#define r4 0.4\\n#define v4 0.046\\n#define m4 2.0\\n#define r5 0.305\\n#define v5 0.016\\n#define m5 3.0\\n#define r6 0.21\\n#define v6 0.0038\\n#define m6 4.0\\nfloat roughnessToMip(float roughness) {\\n  float mip = 0.0;\\n  if (roughness >= r1) {\\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\\n  } else if (roughness >= r4) {\\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\\n  } else if (roughness >= r5) {\\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\\n  } else if (roughness >= r6) {\\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\\n  } else {\\n    mip = -2.0 * log2(1.16 * roughness);  }\\n  return mip;\\n}\\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\\n  float mipF = fract(mip);\\n  float mipInt = floor(mip);\\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\\n  if (mipF == 0.0) {\\n    return vec4(color0, 1.0);\\n  } else {\\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\\n    return vec4(mix(color0, color1, mipF), 1.0);\\n  }\\n}\\n#endif\";\r\n\r\n\tvar defaultnormal_vertex = \"vec3 transformedNormal = objectNormal;\\n#ifdef USE_INSTANCING\\n\\tmat3 m = mat3( instanceMatrix );\\n\\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\\n\\ttransformedNormal = m * transformedNormal;\\n#endif\\ntransformedNormal = normalMatrix * transformedNormal;\\n#ifdef FLIP_SIDED\\n\\ttransformedNormal = - transformedNormal;\\n#endif\\n#ifdef USE_TANGENT\\n\\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\\n\\t#ifdef FLIP_SIDED\\n\\t\\ttransformedTangent = - transformedTangent;\\n\\t#endif\\n#endif\";\r\n\r\n\tvar displacementmap_pars_vertex = \"#ifdef USE_DISPLACEMENTMAP\\n\\tuniform sampler2D displacementMap;\\n\\tuniform float displacementScale;\\n\\tuniform float displacementBias;\\n#endif\";\r\n\r\n\tvar displacementmap_vertex = \"#ifdef USE_DISPLACEMENTMAP\\n\\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\\n#endif\";\r\n\r\n\tvar emissivemap_fragment = \"#ifdef USE_EMISSIVEMAP\\n\\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\\n\\ttotalEmissiveRadiance *= emissiveColor.rgb;\\n#endif\";\r\n\r\n\tvar emissivemap_pars_fragment = \"#ifdef USE_EMISSIVEMAP\\n\\tuniform sampler2D emissiveMap;\\n#endif\";\r\n\r\n\tvar encodings_fragment = \"gl_FragColor = linearToOutputTexel( gl_FragColor );\";\r\n\r\n\tvar encodings_pars_fragment = \"\\nvec4 LinearToLinear( in vec4 value ) {\\n\\treturn value;\\n}\\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\\n\\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\\n}\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\n\\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\\n}\\nvec4 sRGBToLinear( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\\n}\\nvec4 LinearTosRGB( in vec4 value ) {\\n\\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\\n}\\nvec4 RGBEToLinear( in vec4 value ) {\\n\\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\\n}\\nvec4 LinearToRGBE( in vec4 value ) {\\n\\tfloat maxComponent = max( max( value.r, value.g ), value.b );\\n\\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\\n\\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\\n}\\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\\n\\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\\n}\\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\\n\\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\\n\\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\\n\\tM = ceil( M * 255.0 ) / 255.0;\\n\\treturn vec4( value.rgb / ( M * maxRange ), M );\\n}\\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\\n\\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\\n}\\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\\n\\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\\n\\tfloat D = max( maxRange / maxRGB, 1.0 );\\n\\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\\n\\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\\n}\\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\\nvec4 LinearToLogLuv( in vec4 value )  {\\n\\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\\n\\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\\n\\tvec4 vResult;\\n\\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\\n\\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\\n\\tvResult.w = fract( Le );\\n\\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\\n\\treturn vResult;\\n}\\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\\nvec4 LogLuvToLinear( in vec4 value ) {\\n\\tfloat Le = value.z * 255.0 + value.w;\\n\\tvec3 Xp_Y_XYZp;\\n\\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\\n\\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\\n\\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\\n\\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\\n\\treturn vec4( max( vRGB, 0.0 ), 1.0 );\\n}\";\r\n\r\n\tvar envmap_fragment = \"#ifdef USE_ENVMAP\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvec3 cameraToFrag;\\n\\t\\t\\n\\t\\tif ( isOrthographic ) {\\n\\t\\t\\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\\n\\t\\t}  else {\\n\\t\\t\\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\\n\\t\\t}\\n\\t\\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#else\\n\\t\\tvec3 reflectVec = vReflect;\\n\\t#endif\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\\n\\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\\t\\tvec2 sampleUV;\\n\\t\\treflectVec = normalize( reflectVec );\\n\\t\\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\t\\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\\t\\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\\t\\treflectVec = normalize( reflectVec );\\n\\t\\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\\n\\t\\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\\t#else\\n\\t\\tvec4 envColor = vec4( 0.0 );\\n\\t#endif\\n\\t#ifndef ENVMAP_TYPE_CUBE_UV\\n\\t\\tenvColor = envMapTexelToLinear( envColor );\\n\\t#endif\\n\\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\t\\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\t\\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\t\\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\t#endif\\n#endif\";\r\n\r\n\tvar envmap_common_pars_fragment = \"#ifdef USE_ENVMAP\\n\\tuniform float envMapIntensity;\\n\\tuniform float flipEnvMap;\\n\\tuniform int maxMipLevel;\\n\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\tuniform samplerCube envMap;\\n\\t#else\\n\\t\\tuniform sampler2D envMap;\\n\\t#endif\\n\\t\\n#endif\";\r\n\r\n\tvar envmap_pars_fragment = \"#ifdef USE_ENVMAP\\n\\tuniform float reflectivity;\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\t\\t#define ENV_WORLDPOS\\n\\t#endif\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t\\tuniform float refractionRatio;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t#endif\\n#endif\";\r\n\r\n\tvar envmap_pars_vertex = \"#ifdef USE_ENVMAP\\n\\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\\n\\t\\t#define ENV_WORLDPOS\\n\\t#endif\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\t\\n\\t\\tvarying vec3 vWorldPosition;\\n\\t#else\\n\\t\\tvarying vec3 vReflect;\\n\\t\\tuniform float refractionRatio;\\n\\t#endif\\n#endif\";\r\n\r\n\tvar envmap_vertex = \"#ifdef USE_ENVMAP\\n\\t#ifdef ENV_WORLDPOS\\n\\t\\tvWorldPosition = worldPosition.xyz;\\n\\t#else\\n\\t\\tvec3 cameraToVertex;\\n\\t\\tif ( isOrthographic ) { \\n\\t\\t\\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\\n\\t\\t} else {\\n\\t\\t\\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\t\\t}\\n\\t\\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t\\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\t\\t#else\\n\\t\\t\\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\t\\t#endif\\n\\t#endif\\n#endif\";\r\n\r\n\tvar fog_vertex = \"#ifdef USE_FOG\\n\\tfogDepth = -mvPosition.z;\\n#endif\";\r\n\r\n\tvar fog_pars_vertex = \"#ifdef USE_FOG\\n\\tvarying float fogDepth;\\n#endif\";\r\n\r\n\tvar fog_fragment = \"#ifdef USE_FOG\\n\\t#ifdef FOG_EXP2\\n\\t\\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\\n\\t#else\\n\\t\\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\\n\\t#endif\\n\\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\\n#endif\";\r\n\r\n\tvar fog_pars_fragment = \"#ifdef USE_FOG\\n\\tuniform vec3 fogColor;\\n\\tvarying float fogDepth;\\n\\t#ifdef FOG_EXP2\\n\\t\\tuniform float fogDensity;\\n\\t#else\\n\\t\\tuniform float fogNear;\\n\\t\\tuniform float fogFar;\\n\\t#endif\\n#endif\";\r\n\r\n\tvar gradientmap_pars_fragment = \"#ifdef USE_GRADIENTMAP\\n\\tuniform sampler2D gradientMap;\\n#endif\\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\\n\\tfloat dotNL = dot( normal, lightDirection );\\n\\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\\n\\t#ifdef USE_GRADIENTMAP\\n\\t\\treturn texture2D( gradientMap, coord ).rgb;\\n\\t#else\\n\\t\\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\\n\\t#endif\\n}\";\r\n\r\n\tvar lightmap_fragment = \"#ifdef USE_LIGHTMAP\\n\\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\\n\\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\\n#endif\";\r\n\r\n\tvar lightmap_pars_fragment = \"#ifdef USE_LIGHTMAP\\n\\tuniform sampler2D lightMap;\\n\\tuniform float lightMapIntensity;\\n#endif\";\r\n\r\n\tvar lights_lambert_vertex = \"vec3 diffuse = vec3( 1.0 );\\nGeometricContext geometry;\\ngeometry.position = mvPosition.xyz;\\ngeometry.normal = normalize( transformedNormal );\\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\\nGeometricContext backGeometry;\\nbackGeometry.position = geometry.position;\\nbackGeometry.normal = -geometry.normal;\\nbackGeometry.viewDir = geometry.viewDir;\\nvLightFront = vec3( 0.0 );\\nvIndirectFront = vec3( 0.0 );\\n#ifdef DOUBLE_SIDED\\n\\tvLightBack = vec3( 0.0 );\\n\\tvIndirectBack = vec3( 0.0 );\\n#endif\\nIncidentLight directLight;\\nfloat dotNL;\\nvec3 directLightColor_Diffuse;\\n#if NUM_POINT_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if NUM_DIR_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\\n\\t\\tdotNL = dot( geometry.normal, directLight.direction );\\n\\t\\tdirectLightColor_Diffuse = PI * directLight.color;\\n\\t\\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\\n\\t\\t#endif\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\";\r\n\r\n\tvar lights_pars_begin = \"uniform bool receiveShadow;\\nuniform vec3 ambientLightColor;\\nuniform vec3 lightProbe[ 9 ];\\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\\n\\tfloat x = normal.x, y = normal.y, z = normal.z;\\n\\tvec3 result = shCoefficients[ 0 ] * 0.886227;\\n\\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\\n\\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\\n\\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\\n\\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\\n\\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\\n\\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\\n\\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\\n\\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\\n\\treturn result;\\n}\\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\\n\\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\\n\\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\\n\\treturn irradiance;\\n}\\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\\n\\tvec3 irradiance = ambientLightColor;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treturn irradiance;\\n}\\n#if NUM_DIR_LIGHTS > 0\\n\\tstruct DirectionalLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t};\\n\\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\\n\\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\\n\\t\\tstruct DirectionalLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t#endif\\n\\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tdirectLight.color = directionalLight.color;\\n\\t\\tdirectLight.direction = directionalLight.direction;\\n\\t\\tdirectLight.visible = true;\\n\\t}\\n#endif\\n#if NUM_POINT_LIGHTS > 0\\n\\tstruct PointLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t};\\n\\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\\n\\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tstruct PointLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t\\tfloat shadowCameraNear;\\n\\t\\t\\tfloat shadowCameraFar;\\n\\t\\t};\\n\\t\\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\\n\\t\\tvec3 lVector = pointLight.position - geometry.position;\\n\\t\\tdirectLight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tdirectLight.color = pointLight.color;\\n\\t\\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\\n\\t\\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\\n\\t}\\n#endif\\n#if NUM_SPOT_LIGHTS > 0\\n\\tstruct SpotLight {\\n\\t\\tvec3 position;\\n\\t\\tvec3 direction;\\n\\t\\tvec3 color;\\n\\t\\tfloat distance;\\n\\t\\tfloat decay;\\n\\t\\tfloat coneCos;\\n\\t\\tfloat penumbraCos;\\n\\t};\\n\\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\\n\\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t\\tstruct SpotLightShadow {\\n\\t\\t\\tfloat shadowBias;\\n\\t\\t\\tfloat shadowRadius;\\n\\t\\t\\tvec2 shadowMapSize;\\n\\t\\t};\\n\\t\\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\\n\\t\\tvec3 lVector = spotLight.position - geometry.position;\\n\\t\\tdirectLight.direction = normalize( lVector );\\n\\t\\tfloat lightDistance = length( lVector );\\n\\t\\tfloat angleCos = dot( directLight.direction, spotLight.direction );\\n\\t\\tif ( angleCos > spotLight.coneCos ) {\\n\\t\\t\\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\\n\\t\\t\\tdirectLight.color = spotLight.color;\\n\\t\\t\\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\\n\\t\\t\\tdirectLight.visible = true;\\n\\t\\t} else {\\n\\t\\t\\tdirectLight.color = vec3( 0.0 );\\n\\t\\t\\tdirectLight.visible = false;\\n\\t\\t}\\n\\t}\\n#endif\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tstruct RectAreaLight {\\n\\t\\tvec3 color;\\n\\t\\tvec3 position;\\n\\t\\tvec3 halfWidth;\\n\\t\\tvec3 halfHeight;\\n\\t};\\n\\tuniform sampler2D ltc_1;\\tuniform sampler2D ltc_2;\\n\\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\\n#endif\\n#if NUM_HEMI_LIGHTS > 0\\n\\tstruct HemisphereLight {\\n\\t\\tvec3 direction;\\n\\t\\tvec3 skyColor;\\n\\t\\tvec3 groundColor;\\n\\t};\\n\\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\\n\\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\\n\\t\\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\\n\\t\\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\\n\\t\\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tirradiance *= PI;\\n\\t\\t#endif\\n\\t\\treturn irradiance;\\n\\t}\\n#endif\";\r\n\r\n\tvar envmap_physical_pars_fragment = \"#if defined( USE_ENVMAP )\\n\\t#ifdef ENVMAP_MODE_REFRACTION\\n\\t\\tuniform float refractionRatio;\\n\\t#endif\\n\\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\\n\\t\\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\t\\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\\n\\t\\t#else\\n\\t\\t\\tvec4 envMapColor = vec4( 0.0 );\\n\\t\\t#endif\\n\\t\\treturn PI * envMapColor.rgb * envMapIntensity;\\n\\t}\\n\\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\\n\\t\\tfloat maxMIPLevelScalar = float( maxMIPLevel );\\n\\t\\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\\n\\t\\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\\n\\t\\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\\n\\t}\\n\\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\\n\\t\\t#ifdef ENVMAP_MODE_REFLECTION\\n\\t\\t  vec3 reflectVec = reflect( -viewDir, normal );\\n\\t\\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\\n\\t\\t#else\\n\\t\\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\\n\\t\\t#endif\\n\\t\\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\\n\\t\\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\\n\\t\\t#ifdef ENVMAP_TYPE_CUBE\\n\\t\\t\\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\t\\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\\n\\t\\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\\t\\t\\tvec2 sampleUV;\\n\\t\\t\\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\t\\t\\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\\t\\t\\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\\n\\t\\t\\t#ifdef TEXTURE_LOD_EXT\\n\\t\\t\\t\\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\\t\\t\\t#else\\n\\t\\t\\t\\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\\n\\t\\t\\t#endif\\n\\t\\t\\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\\n\\t\\t#endif\\n\\t\\treturn envMapColor.rgb * envMapIntensity;\\n\\t}\\n#endif\";\r\n\r\n\tvar lights_toon_fragment = \"ToonMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularColor = specular;\\nmaterial.specularShininess = shininess;\\nmaterial.specularStrength = specularStrength;\";\r\n\r\n\tvar lights_toon_pars_fragment = \"varying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\nstruct ToonMaterial {\\n\\tvec3\\tdiffuseColor;\\n\\tvec3\\tspecularColor;\\n\\tfloat\\tspecularShininess;\\n\\tfloat\\tspecularStrength;\\n};\\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\\n}\\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Toon\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Toon\\n#define Material_LightProbeLOD( material )\\t(0)\";\r\n\r\n\tvar lights_phong_fragment = \"BlinnPhongMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb;\\nmaterial.specularColor = specular;\\nmaterial.specularShininess = shininess;\\nmaterial.specularStrength = specularStrength;\";\r\n\r\n\tvar lights_phong_pars_fragment = \"varying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\nstruct BlinnPhongMaterial {\\n\\tvec3\\tdiffuseColor;\\n\\tvec3\\tspecularColor;\\n\\tfloat\\tspecularShininess;\\n\\tfloat\\tspecularStrength;\\n};\\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n\\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\\n}\\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_BlinnPhong\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_BlinnPhong\\n#define Material_LightProbeLOD( material )\\t(0)\";\r\n\r\n\tvar lights_physical_fragment = \"PhysicalMaterial material;\\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\\n#ifdef REFLECTIVITY\\n\\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\\n#else\\n\\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\\n#endif\\n#ifdef CLEARCOAT\\n\\tmaterial.clearcoat = clearcoat;\\n\\tmaterial.clearcoatRoughness = clearcoatRoughness;\\n\\t#ifdef USE_CLEARCOATMAP\\n\\t\\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\\n\\t#endif\\n\\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\\n\\t\\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\\n\\t#endif\\n\\tmaterial.clearcoat = saturate( material.clearcoat );\\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\\n\\tmaterial.clearcoatRoughness += geometryRoughness;\\n\\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\\n#endif\\n#ifdef USE_SHEEN\\n\\tmaterial.sheenColor = sheen;\\n#endif\";\r\n\r\n\tvar lights_physical_pars_fragment = \"struct PhysicalMaterial {\\n\\tvec3\\tdiffuseColor;\\n\\tfloat\\tspecularRoughness;\\n\\tvec3\\tspecularColor;\\n#ifdef CLEARCOAT\\n\\tfloat clearcoat;\\n\\tfloat clearcoatRoughness;\\n#endif\\n#ifdef USE_SHEEN\\n\\tvec3 sheenColor;\\n#endif\\n};\\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\\n\\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\\n}\\n#if NUM_RECT_AREA_LIGHTS > 0\\n\\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\t\\tvec3 normal = geometry.normal;\\n\\t\\tvec3 viewDir = geometry.viewDir;\\n\\t\\tvec3 position = geometry.position;\\n\\t\\tvec3 lightPos = rectAreaLight.position;\\n\\t\\tvec3 halfWidth = rectAreaLight.halfWidth;\\n\\t\\tvec3 halfHeight = rectAreaLight.halfHeight;\\n\\t\\tvec3 lightColor = rectAreaLight.color;\\n\\t\\tfloat roughness = material.specularRoughness;\\n\\t\\tvec3 rectCoords[ 4 ];\\n\\t\\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\\t\\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\\n\\t\\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\\n\\t\\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\\n\\t\\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\\n\\t\\tvec4 t1 = texture2D( ltc_1, uv );\\n\\t\\tvec4 t2 = texture2D( ltc_2, uv );\\n\\t\\tmat3 mInv = mat3(\\n\\t\\t\\tvec3( t1.x, 0, t1.y ),\\n\\t\\t\\tvec3(    0, 1,    0 ),\\n\\t\\t\\tvec3( t1.z, 0, t1.w )\\n\\t\\t);\\n\\t\\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\\n\\t\\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\\n\\t\\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\\n\\t}\\n#endif\\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\\n\\tvec3 irradiance = dotNL * directLight.color;\\n\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\tirradiance *= PI;\\n\\t#endif\\n\\t#ifdef CLEARCOAT\\n\\t\\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\\n\\t\\tvec3 ccIrradiance = ccDotNL * directLight.color;\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tccIrradiance *= PI;\\n\\t\\t#endif\\n\\t\\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\\n\\t\\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\\n\\t#else\\n\\t\\tfloat clearcoatDHR = 0.0;\\n\\t#endif\\n\\t#ifdef USE_SHEEN\\n\\t\\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\\n\\t\\t\\tmaterial.specularRoughness,\\n\\t\\t\\tdirectLight.direction,\\n\\t\\t\\tgeometry,\\n\\t\\t\\tmaterial.sheenColor\\n\\t\\t);\\n\\t#else\\n\\t\\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\\n\\t#endif\\n\\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\\n\\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\\n}\\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\\n\\t#ifdef CLEARCOAT\\n\\t\\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\\n\\t\\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\\n\\t\\tfloat ccDotNL = ccDotNV;\\n\\t\\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\\n\\t#else\\n\\t\\tfloat clearcoatDHR = 0.0;\\n\\t#endif\\n\\tfloat clearcoatInv = 1.0 - clearcoatDHR;\\n\\tvec3 singleScattering = vec3( 0.0 );\\n\\tvec3 multiScattering = vec3( 0.0 );\\n\\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\\n\\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\\n\\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\\n\\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\\n\\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\\n\\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\\n}\\n#define RE_Direct\\t\\t\\t\\tRE_Direct_Physical\\n#define RE_Direct_RectArea\\t\\tRE_Direct_RectArea_Physical\\n#define RE_IndirectDiffuse\\t\\tRE_IndirectDiffuse_Physical\\n#define RE_IndirectSpecular\\t\\tRE_IndirectSpecular_Physical\\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\\n\\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\\n}\";\r\n\r\n\tvar lights_fragment_begin = \"\\nGeometricContext geometry;\\ngeometry.position = - vViewPosition;\\ngeometry.normal = normal;\\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\\n#ifdef CLEARCOAT\\n\\tgeometry.clearcoatNormal = clearcoatNormal;\\n#endif\\nIncidentLight directLight;\\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tPointLight pointLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\\n\\tPointLightShadow pointLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n\\t\\tpointLight = pointLights[ i ];\\n\\t\\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\\n\\t\\tpointLightShadow = pointLightShadows[ i ];\\n\\t\\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tSpotLight spotLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\\n\\tSpotLightShadow spotLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n\\t\\tspotLight = spotLights[ i ];\\n\\t\\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\\n\\t\\tspotLightShadow = spotLightShadows[ i ];\\n\\t\\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\\n\\tDirectionalLight directionalLight;\\n\\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\\n\\tDirectionalLightShadow directionalLightShadow;\\n\\t#endif\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLights[ i ];\\n\\t\\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\\n\\t\\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\\n\\t\\tdirectionalLightShadow = directionalLightShadows[ i ];\\n\\t\\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t\\t#endif\\n\\t\\tRE_Direct( directLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\\n\\tRectAreaLight rectAreaLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\\n\\t\\trectAreaLight = rectAreaLights[ i ];\\n\\t\\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\\n\\t}\\n\\t#pragma unroll_loop_end\\n#endif\\n#if defined( RE_IndirectDiffuse )\\n\\tvec3 iblIrradiance = vec3( 0.0 );\\n\\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n\\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\\n\\t#if ( NUM_HEMI_LIGHTS > 0 )\\n\\t\\t#pragma unroll_loop_start\\n\\t\\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n\\t\\t\\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n\\t\\t}\\n\\t\\t#pragma unroll_loop_end\\n\\t#endif\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tvec3 radiance = vec3( 0.0 );\\n\\tvec3 clearcoatRadiance = vec3( 0.0 );\\n#endif\";\r\n\r\n\tvar lights_fragment_maps = \"#if defined( RE_IndirectDiffuse )\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\\n\\t\\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\\n\\t\\t#ifndef PHYSICALLY_CORRECT_LIGHTS\\n\\t\\t\\tlightMapIrradiance *= PI;\\n\\t\\t#endif\\n\\t\\tirradiance += lightMapIrradiance;\\n\\t#endif\\n\\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\\n\\t\\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\\n\\t#endif\\n#endif\\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\\n\\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\\n\\t#ifdef CLEARCOAT\\n\\t\\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\\n\\t#endif\\n#endif\";\r\n\r\n\tvar lights_fragment_end = \"#if defined( RE_IndirectDiffuse )\\n\\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\\n#endif\\n#if defined( RE_IndirectSpecular )\\n\\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\\n#endif\";\r\n\r\n\tvar logdepthbuf_fragment = \"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\\n#endif\";\r\n\r\n\tvar logdepthbuf_pars_fragment = \"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\\n\\tuniform float logDepthBufFC;\\n\\tvarying float vFragDepth;\\n\\tvarying float vIsPerspective;\\n#endif\";\r\n\r\n\tvar logdepthbuf_pars_vertex = \"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvarying float vFragDepth;\\n\\t\\tvarying float vIsPerspective;\\n\\t#else\\n\\t\\tuniform float logDepthBufFC;\\n\\t#endif\\n#endif\";\r\n\r\n\tvar logdepthbuf_vertex = \"#ifdef USE_LOGDEPTHBUF\\n\\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\t\\tvFragDepth = 1.0 + gl_Position.w;\\n\\t\\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\\n\\t#else\\n\\t\\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\\n\\t\\t\\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\\n\\t\\t\\tgl_Position.z *= gl_Position.w;\\n\\t\\t}\\n\\t#endif\\n#endif\";\r\n\r\n\tvar map_fragment = \"#ifdef USE_MAP\\n\\tvec4 texelColor = texture2D( map, vUv );\\n\\ttexelColor = mapTexelToLinear( texelColor );\\n\\tdiffuseColor *= texelColor;\\n#endif\";\r\n\r\n\tvar map_pars_fragment = \"#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\";\r\n\r\n\tvar map_particle_fragment = \"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\\n\\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\\n#endif\\n#ifdef USE_MAP\\n\\tvec4 mapTexel = texture2D( map, uv );\\n\\tdiffuseColor *= mapTexelToLinear( mapTexel );\\n#endif\\n#ifdef USE_ALPHAMAP\\n\\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\\n#endif\";\r\n\r\n\tvar map_particle_pars_fragment = \"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\\n\\tuniform mat3 uvTransform;\\n#endif\\n#ifdef USE_MAP\\n\\tuniform sampler2D map;\\n#endif\\n#ifdef USE_ALPHAMAP\\n\\tuniform sampler2D alphaMap;\\n#endif\";\r\n\r\n\tvar metalnessmap_fragment = \"float metalnessFactor = metalness;\\n#ifdef USE_METALNESSMAP\\n\\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\\n\\tmetalnessFactor *= texelMetalness.b;\\n#endif\";\r\n\r\n\tvar metalnessmap_pars_fragment = \"#ifdef USE_METALNESSMAP\\n\\tuniform sampler2D metalnessMap;\\n#endif\";\r\n\r\n\tvar morphnormal_vertex = \"#ifdef USE_MORPHNORMALS\\n\\tobjectNormal *= morphTargetBaseInfluence;\\n\\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\\n\\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\\n\\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\\n\\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\\n#endif\";\r\n\r\n\tvar morphtarget_pars_vertex = \"#ifdef USE_MORPHTARGETS\\n\\tuniform float morphTargetBaseInfluence;\\n\\t#ifndef USE_MORPHNORMALS\\n\\tuniform float morphTargetInfluences[ 8 ];\\n\\t#else\\n\\tuniform float morphTargetInfluences[ 4 ];\\n\\t#endif\\n#endif\";\r\n\r\n\tvar morphtarget_vertex = \"#ifdef USE_MORPHTARGETS\\n\\ttransformed *= morphTargetBaseInfluence;\\n\\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\\n\\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\\n\\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\\n\\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\\n\\t#ifndef USE_MORPHNORMALS\\n\\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\\n\\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\\n\\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\\n\\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\\n\\t#endif\\n#endif\";\r\n\r\n\tvar normal_fragment_begin = \"#ifdef FLAT_SHADED\\n\\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\\n\\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\\n\\tvec3 normal = normalize( cross( fdx, fdy ) );\\n#else\\n\\tvec3 normal = normalize( vNormal );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t#endif\\n\\t#ifdef USE_TANGENT\\n\\t\\tvec3 tangent = normalize( vTangent );\\n\\t\\tvec3 bitangent = normalize( vBitangent );\\n\\t\\t#ifdef DOUBLE_SIDED\\n\\t\\t\\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\t\\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\t#endif\\n\\t\\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\\n\\t\\t\\tmat3 vTBN = mat3( tangent, bitangent, normal );\\n\\t\\t#endif\\n\\t#endif\\n#endif\\nvec3 geometryNormal = normal;\";\r\n\r\n\tvar normal_fragment_maps = \"#ifdef OBJECTSPACE_NORMALMAP\\n\\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\t#ifdef FLIP_SIDED\\n\\t\\tnormal = - normal;\\n\\t#endif\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t#endif\\n\\tnormal = normalize( normalMatrix * normal );\\n#elif defined( TANGENTSPACE_NORMALMAP )\\n\\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\\tmapN.xy *= normalScale;\\n\\t#ifdef USE_TANGENT\\n\\t\\tnormal = normalize( vTBN * mapN );\\n\\t#else\\n\\t\\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\\n\\t#endif\\n#elif defined( USE_BUMPMAP )\\n\\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n#endif\";\r\n\r\n\tvar normalmap_pars_fragment = \"#ifdef USE_NORMALMAP\\n\\tuniform sampler2D normalMap;\\n\\tuniform vec2 normalScale;\\n#endif\\n#ifdef OBJECTSPACE_NORMALMAP\\n\\tuniform mat3 normalMatrix;\\n#endif\\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\\n\\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\\n\\t\\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\\n\\t\\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\\n\\t\\tvec2 st0 = dFdx( vUv.st );\\n\\t\\tvec2 st1 = dFdy( vUv.st );\\n\\t\\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\\n\\t\\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\\n\\t\\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\\n\\t\\tvec3 N = normalize( surf_norm );\\n\\t\\tmat3 tsn = mat3( S, T, N );\\n\\t\\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\\t\\treturn normalize( tsn * mapN );\\n\\t}\\n#endif\";\r\n\r\n\tvar clearcoat_normal_fragment_begin = \"#ifdef CLEARCOAT\\n\\tvec3 clearcoatNormal = geometryNormal;\\n#endif\";\r\n\r\n\tvar clearcoat_normal_fragment_maps = \"#ifdef USE_CLEARCOAT_NORMALMAP\\n\\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\\n\\tclearcoatMapN.xy *= clearcoatNormalScale;\\n\\t#ifdef USE_TANGENT\\n\\t\\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\\n\\t#else\\n\\t\\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\\n\\t#endif\\n#endif\";\r\n\r\n\tvar clearcoat_pars_fragment = \"#ifdef USE_CLEARCOATMAP\\n\\tuniform sampler2D clearcoatMap;\\n#endif\\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\\n\\tuniform sampler2D clearcoatRoughnessMap;\\n#endif\\n#ifdef USE_CLEARCOAT_NORMALMAP\\n\\tuniform sampler2D clearcoatNormalMap;\\n\\tuniform vec2 clearcoatNormalScale;\\n#endif\";\r\n\r\n\tvar packing = \"vec3 packNormalToRGB( const in vec3 normal ) {\\n\\treturn normalize( normal ) * 0.5 + 0.5;\\n}\\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\\n\\treturn 2.0 * rgb.xyz - 1.0;\\n}\\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\\nconst float ShiftRight8 = 1. / 256.;\\nvec4 packDepthToRGBA( const in float v ) {\\n\\tvec4 r = vec4( fract( v * PackFactors ), v );\\n\\tr.yzw -= r.xyz * ShiftRight8;\\treturn r * PackUpscale;\\n}\\nfloat unpackRGBAToDepth( const in vec4 v ) {\\n\\treturn dot( v, UnpackFactors );\\n}\\nvec4 pack2HalfToRGBA( vec2 v ) {\\n\\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\\n\\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\\n}\\nvec2 unpackRGBATo2Half( vec4 v ) {\\n\\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\\n}\\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn ( viewZ + near ) / ( near - far );\\n}\\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\\n\\treturn linearClipZ * ( near - far ) - near;\\n}\\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\\n\\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\\n}\\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\\n\\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\\n}\";\r\n\r\n\tvar premultiplied_alpha_fragment = \"#ifdef PREMULTIPLIED_ALPHA\\n\\tgl_FragColor.rgb *= gl_FragColor.a;\\n#endif\";\r\n\r\n\tvar project_vertex = \"vec4 mvPosition = vec4( transformed, 1.0 );\\n#ifdef USE_INSTANCING\\n\\tmvPosition = instanceMatrix * mvPosition;\\n#endif\\nmvPosition = modelViewMatrix * mvPosition;\\ngl_Position = projectionMatrix * mvPosition;\";\r\n\r\n\tvar dithering_fragment = \"#ifdef DITHERING\\n\\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\\n#endif\";\r\n\r\n\tvar dithering_pars_fragment = \"#ifdef DITHERING\\n\\tvec3 dithering( vec3 color ) {\\n\\t\\tfloat grid_position = rand( gl_FragCoord.xy );\\n\\t\\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\\n\\t\\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\\n\\t\\treturn color + dither_shift_RGB;\\n\\t}\\n#endif\";\r\n\r\n\tvar roughnessmap_fragment = \"float roughnessFactor = roughness;\\n#ifdef USE_ROUGHNESSMAP\\n\\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\\n\\troughnessFactor *= texelRoughness.g;\\n#endif\";\r\n\r\n\tvar roughnessmap_pars_fragment = \"#ifdef USE_ROUGHNESSMAP\\n\\tuniform sampler2D roughnessMap;\\n#endif\";\r\n\r\n\tvar shadowmap_pars_fragment = \"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\\n\\t\\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\\n\\t}\\n\\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\\n\\t\\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\\n\\t}\\n\\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\\n\\t\\tfloat occlusion = 1.0;\\n\\t\\tvec2 distribution = texture2DDistribution( shadow, uv );\\n\\t\\tfloat hard_shadow = step( compare , distribution.x );\\n\\t\\tif (hard_shadow != 1.0 ) {\\n\\t\\t\\tfloat distance = compare - distribution.x ;\\n\\t\\t\\tfloat variance = max( 0.00000, distribution.y * distribution.y );\\n\\t\\t\\tfloat softness_probability = variance / (variance + distance * distance );\\t\\t\\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\\t\\t\\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\\n\\t\\t}\\n\\t\\treturn occlusion;\\n\\t}\\n\\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\\n\\t\\tfloat shadow = 1.0;\\n\\t\\tshadowCoord.xyz /= shadowCoord.w;\\n\\t\\tshadowCoord.z += shadowBias;\\n\\t\\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\\t\\tbool inFrustum = all( inFrustumVec );\\n\\t\\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\t\\tbool frustumTest = all( frustumTestVec );\\n\\t\\tif ( frustumTest ) {\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx0 = - texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy0 = - texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx1 = + texelSize.x * shadowRadius;\\n\\t\\t\\tfloat dy1 = + texelSize.y * shadowRadius;\\n\\t\\t\\tfloat dx2 = dx0 / 2.0;\\n\\t\\t\\tfloat dy2 = dy0 / 2.0;\\n\\t\\t\\tfloat dx3 = dx1 / 2.0;\\n\\t\\t\\tfloat dy3 = dy1 / 2.0;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\\n\\t\\t\\t) * ( 1.0 / 17.0 );\\n\\t\\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\t\\t\\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\\n\\t\\t\\tfloat dx = texelSize.x;\\n\\t\\t\\tfloat dy = texelSize.y;\\n\\t\\t\\tvec2 uv = shadowCoord.xy;\\n\\t\\t\\tvec2 f = fract( uv * shadowMapSize + 0.5 );\\n\\t\\t\\tuv -= f * texelSize;\\n\\t\\t\\tshadow = (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.x ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.x ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.y ) +\\n\\t\\t\\t\\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t f.y ) +\\n\\t\\t\\t\\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t\\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  f.x ),\\n\\t\\t\\t\\t\\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \\n\\t\\t\\t\\t\\t\\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\\n\\t\\t\\t\\t\\t\\t  f.x ),\\n\\t\\t\\t\\t\\t f.y )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#elif defined( SHADOWMAP_TYPE_VSM )\\n\\t\\t\\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\\t\\t#else\\n\\t\\t\\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\\n\\t\\t#endif\\n\\t\\t}\\n\\t\\treturn shadow;\\n\\t}\\n\\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\\n\\t\\tvec3 absV = abs( v );\\n\\t\\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\\n\\t\\tabsV *= scaleToCube;\\n\\t\\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\\n\\t\\tvec2 planar = v.xy;\\n\\t\\tfloat almostATexel = 1.5 * texelSizeY;\\n\\t\\tfloat almostOne = 1.0 - almostATexel;\\n\\t\\tif ( absV.z >= almostOne ) {\\n\\t\\t\\tif ( v.z > 0.0 )\\n\\t\\t\\t\\tplanar.x = 4.0 - v.x;\\n\\t\\t} else if ( absV.x >= almostOne ) {\\n\\t\\t\\tfloat signX = sign( v.x );\\n\\t\\t\\tplanar.x = v.z * signX + 2.0 * signX;\\n\\t\\t} else if ( absV.y >= almostOne ) {\\n\\t\\t\\tfloat signY = sign( v.y );\\n\\t\\t\\tplanar.x = v.x + 2.0 * signY + 2.0;\\n\\t\\t\\tplanar.y = v.z * signY - 2.0;\\n\\t\\t}\\n\\t\\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\\n\\t}\\n\\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\\n\\t\\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\\n\\t\\tvec3 lightToPosition = shadowCoord.xyz;\\n\\t\\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\\t\\tdp += shadowBias;\\n\\t\\tvec3 bd3D = normalize( lightToPosition );\\n\\t\\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\\n\\t\\t\\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\\n\\t\\t\\treturn (\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\\n\\t\\t\\t\\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\\n\\t\\t\\t) * ( 1.0 / 9.0 );\\n\\t\\t#else\\n\\t\\t\\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\\n\\t\\t#endif\\n\\t}\\n#endif\";\r\n\r\n\tvar shadowmap_pars_vertex = \"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t\\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t\\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\\n\\t#endif\\n#endif\";\r\n\r\n\tvar shadowmap_vertex = \"#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n#endif\";\r\n\r\n\tvar shadowmask_pars_fragment = \"float getShadowMask() {\\n\\tfloat shadow = 1.0;\\n\\t#ifdef USE_SHADOWMAP\\n\\t#if NUM_DIR_LIGHT_SHADOWS > 0\\n\\tDirectionalLightShadow directionalLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tdirectionalLight = directionalLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_SPOT_LIGHT_SHADOWS > 0\\n\\tSpotLightShadow spotLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tspotLight = spotLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#if NUM_POINT_LIGHT_SHADOWS > 0\\n\\tPointLightShadow pointLight;\\n\\t#pragma unroll_loop_start\\n\\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\\n\\t\\tpointLight = pointLightShadows[ i ];\\n\\t\\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n\\t}\\n\\t#pragma unroll_loop_end\\n\\t#endif\\n\\t#endif\\n\\treturn shadow;\\n}\";\r\n\r\n\tvar skinbase_vertex = \"#ifdef USE_SKINNING\\n\\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n#endif\";\r\n\r\n\tvar skinning_pars_vertex = \"#ifdef USE_SKINNING\\n\\tuniform mat4 bindMatrix;\\n\\tuniform mat4 bindMatrixInverse;\\n\\t#ifdef BONE_TEXTURE\\n\\t\\tuniform highp sampler2D boneTexture;\\n\\t\\tuniform int boneTextureSize;\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tfloat j = i * 4.0;\\n\\t\\t\\tfloat x = mod( j, float( boneTextureSize ) );\\n\\t\\t\\tfloat y = floor( j / float( boneTextureSize ) );\\n\\t\\t\\tfloat dx = 1.0 / float( boneTextureSize );\\n\\t\\t\\tfloat dy = 1.0 / float( boneTextureSize );\\n\\t\\t\\ty = dy * ( y + 0.5 );\\n\\t\\t\\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\\t\\t\\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\\t\\t\\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\\t\\t\\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\t\\t\\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#else\\n\\t\\tuniform mat4 boneMatrices[ MAX_BONES ];\\n\\t\\tmat4 getBoneMatrix( const in float i ) {\\n\\t\\t\\tmat4 bone = boneMatrices[ int(i) ];\\n\\t\\t\\treturn bone;\\n\\t\\t}\\n\\t#endif\\n#endif\";\r\n\r\n\tvar skinning_vertex = \"#ifdef USE_SKINNING\\n\\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\tvec4 skinned = vec4( 0.0 );\\n\\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\\ttransformed = ( bindMatrixInverse * skinned ).xyz;\\n#endif\";\r\n\r\n\tvar skinnormal_vertex = \"#ifdef USE_SKINNING\\n\\tmat4 skinMatrix = mat4( 0.0 );\\n\\tskinMatrix += skinWeight.x * boneMatX;\\n\\tskinMatrix += skinWeight.y * boneMatY;\\n\\tskinMatrix += skinWeight.z * boneMatZ;\\n\\tskinMatrix += skinWeight.w * boneMatW;\\n\\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n\\t#ifdef USE_TANGENT\\n\\t\\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\\n\\t#endif\\n#endif\";\r\n\r\n\tvar specularmap_fragment = \"float specularStrength;\\n#ifdef USE_SPECULARMAP\\n\\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\\tspecularStrength = texelSpecular.r;\\n#else\\n\\tspecularStrength = 1.0;\\n#endif\";\r\n\r\n\tvar specularmap_pars_fragment = \"#ifdef USE_SPECULARMAP\\n\\tuniform sampler2D specularMap;\\n#endif\";\r\n\r\n\tvar tonemapping_fragment = \"#if defined( TONE_MAPPING )\\n\\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\\n#endif\";\r\n\r\n\tvar tonemapping_pars_fragment = \"#ifndef saturate\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#endif\\nuniform float toneMappingExposure;\\nuniform float toneMappingWhitePoint;\\nvec3 LinearToneMapping( vec3 color ) {\\n\\treturn toneMappingExposure * color;\\n}\\nvec3 ReinhardToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( color / ( vec3( 1.0 ) + color ) );\\n}\\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\\nvec3 Uncharted2ToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\\n}\\nvec3 OptimizedCineonToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\tcolor = max( vec3( 0.0 ), color - 0.004 );\\n\\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\\n}\\nvec3 ACESFilmicToneMapping( vec3 color ) {\\n\\tcolor *= toneMappingExposure;\\n\\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\\n}\";\r\n\r\n\tvar uv_pars_fragment = \"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\\n\\tvarying vec2 vUv;\\n#endif\";\r\n\r\n\tvar uv_pars_vertex = \"#ifdef USE_UV\\n\\t#ifdef UVS_VERTEX_ONLY\\n\\t\\tvec2 vUv;\\n\\t#else\\n\\t\\tvarying vec2 vUv;\\n\\t#endif\\n\\tuniform mat3 uvTransform;\\n#endif\";\r\n\r\n\tvar uv_vertex = \"#ifdef USE_UV\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n#endif\";\r\n\r\n\tvar uv2_pars_fragment = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvarying vec2 vUv2;\\n#endif\";\r\n\r\n\tvar uv2_pars_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tattribute vec2 uv2;\\n\\tvarying vec2 vUv2;\\n\\tuniform mat3 uv2Transform;\\n#endif\";\r\n\r\n\tvar uv2_vertex = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\\n#endif\";\r\n\r\n\tvar worldpos_vertex = \"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\\n\\tvec4 worldPosition = vec4( transformed, 1.0 );\\n\\t#ifdef USE_INSTANCING\\n\\t\\tworldPosition = instanceMatrix * worldPosition;\\n\\t#endif\\n\\tworldPosition = modelMatrix * worldPosition;\\n#endif\";\r\n\r\n\tvar background_frag = \"uniform sampler2D t2D;\\nvarying vec2 vUv;\\nvoid main() {\\n\\tvec4 texColor = texture2D( t2D, vUv );\\n\\tgl_FragColor = mapTexelToLinear( texColor );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\r\n\r\n\tvar background_vert = \"varying vec2 vUv;\\nuniform mat3 uvTransform;\\nvoid main() {\\n\\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\\n\\tgl_Position = vec4( position.xy, 1.0, 1.0 );\\n}\";\r\n\r\n\tvar cube_frag = \"#include <envmap_common_pars_fragment>\\nuniform float opacity;\\nvarying vec3 vWorldDirection;\\n#include <cube_uv_reflection_fragment>\\nvoid main() {\\n\\tvec3 vReflect = vWorldDirection;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = envColor;\\n\\tgl_FragColor.a *= opacity;\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\r\n\r\n\tvar cube_vert = \"varying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\tgl_Position.z = gl_Position.w;\\n}\";\r\n\r\n\tvar depth_frag = \"#if DEPTH_PACKING == 3200\\n\\tuniform float opacity;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvarying vec2 vHighPrecisionZW;\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tdiffuseColor.a = opacity;\\n\\t#endif\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <logdepthbuf_fragment>\\n\\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\\n\\t#if DEPTH_PACKING == 3200\\n\\t\\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\\n\\t#elif DEPTH_PACKING == 3201\\n\\t\\tgl_FragColor = packDepthToRGBA( fragCoordZ );\\n\\t#endif\\n}\";\r\n\r\n\tvar depth_vert = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvarying vec2 vHighPrecisionZW;\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvHighPrecisionZW = gl_Position.zw;\\n}\";\r\n\r\n\tvar distanceRGBA_frag = \"#define DISTANCE\\nuniform vec3 referencePosition;\\nuniform float nearDistance;\\nuniform float farDistance;\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main () {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( 1.0 );\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\tfloat dist = length( vWorldPosition - referencePosition );\\n\\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\\n\\tdist = saturate( dist );\\n\\tgl_FragColor = packDepthToRGBA( dist );\\n}\";\r\n\r\n\tvar distanceRGBA_vert = \"#define DISTANCE\\nvarying vec3 vWorldPosition;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_DISPLACEMENTMAP\\n\\t\\t#include <beginnormal_vertex>\\n\\t\\t#include <morphnormal_vertex>\\n\\t\\t#include <skinnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvWorldPosition = worldPosition.xyz;\\n}\";\r\n\r\n\tvar equirect_frag = \"uniform sampler2D tEquirect;\\nvarying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvec3 direction = normalize( vWorldDirection );\\n\\tvec2 sampleUV;\\n\\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\\n\\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\\n\\tvec4 texColor = texture2D( tEquirect, sampleUV );\\n\\tgl_FragColor = mapTexelToLinear( texColor );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n}\";\r\n\r\n\tvar equirect_vert = \"varying vec3 vWorldDirection;\\n#include <common>\\nvoid main() {\\n\\tvWorldDirection = transformDirection( position, modelMatrix );\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n}\";\r\n\r\n\tvar linedashed_frag = \"uniform vec3 diffuse;\\nuniform float opacity;\\nuniform float dashSize;\\nuniform float totalSize;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\\n\\t\\tdiscard;\\n\\t}\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <color_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\";\r\n\r\n\tvar linedashed_vert = \"uniform float scale;\\nattribute float lineDistance;\\nvarying float vLineDistance;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\tvLineDistance = scale * lineDistance;\\n\\t#include <color_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\";\r\n\r\n\tvar meshbasic_frag = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <fog_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\t#ifdef USE_LIGHTMAP\\n\\t\\n\\t\\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\\n\\t\\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\\n\\t#else\\n\\t\\treflectedLight.indirectDiffuse += vec3( 1.0 );\\n\\t#endif\\n\\t#include <aomap_fragment>\\n\\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\\n\\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\";\r\n\r\n\tvar meshbasic_vert = \"#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#ifdef USE_ENVMAP\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\r\n\r\n\tvar meshlambert_frag = \"uniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float opacity;\\nvarying vec3 vLightFront;\\nvarying vec3 vIndirectFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n\\tvarying vec3 vIndirectBack;\\n#endif\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <fog_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <emissivemap_fragment>\\n\\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\\n\\t#else\\n\\t\\treflectedLight.indirectDiffuse += vIndirectFront;\\n\\t#endif\\n\\t#include <lightmap_fragment>\\n\\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\\n\\t#ifdef DOUBLE_SIDED\\n\\t\\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\\n\\t#else\\n\\t\\treflectedLight.directDiffuse = vLightFront;\\n\\t#endif\\n\\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\r\n\r\n\tvar meshlambert_vert = \"#define LAMBERT\\nvarying vec3 vLightFront;\\nvarying vec3 vIndirectFront;\\n#ifdef DOUBLE_SIDED\\n\\tvarying vec3 vLightBack;\\n\\tvarying vec3 vIndirectBack;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <lights_lambert_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\r\n\r\n\tvar meshmatcap_frag = \"#define MATCAP\\nuniform vec3 diffuse;\\nuniform float opacity;\\nuniform sampler2D matcap;\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\tvec3 viewDir = normalize( vViewPosition );\\n\\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\\n\\tvec3 y = cross( viewDir, x );\\n\\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\\n\\t#ifdef USE_MATCAP\\n\\t\\tvec4 matcapColor = texture2D( matcap, uv );\\n\\t\\tmatcapColor = matcapTexelToLinear( matcapColor );\\n\\t#else\\n\\t\\tvec4 matcapColor = vec4( 1.0 );\\n\\t#endif\\n\\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\";\r\n\r\n\tvar meshmatcap_vert = \"#define MATCAP\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <color_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n\\t#ifndef FLAT_SHADED\\n\\t\\tvNormal = normalize( transformedNormal );\\n\\t#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n}\";\r\n\r\n\tvar meshtoon_frag = \"#define TOON\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <gradientmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <lights_toon_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_toon_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\r\n\r\n\tvar meshtoon_vert = \"#define TOON\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\r\n\r\n\tvar meshphong_frag = \"#define PHONG\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform vec3 specular;\\nuniform float shininess;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_pars_fragment>\\n#include <cube_uv_reflection_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <lights_phong_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <specularmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_phong_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\t#include <envmap_fragment>\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\r\n\r\n\tvar meshphong_vert = \"#define PHONG\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <envmap_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\r\n\r\n\tvar meshphysical_frag = \"#define STANDARD\\n#ifdef PHYSICAL\\n\\t#define REFLECTIVITY\\n\\t#define CLEARCOAT\\n\\t#define TRANSPARENCY\\n#endif\\nuniform vec3 diffuse;\\nuniform vec3 emissive;\\nuniform float roughness;\\nuniform float metalness;\\nuniform float opacity;\\n#ifdef TRANSPARENCY\\n\\tuniform float transparency;\\n#endif\\n#ifdef REFLECTIVITY\\n\\tuniform float reflectivity;\\n#endif\\n#ifdef CLEARCOAT\\n\\tuniform float clearcoat;\\n\\tuniform float clearcoatRoughness;\\n#endif\\n#ifdef USE_SHEEN\\n\\tuniform vec3 sheen;\\n#endif\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n#include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n#include <bsdfs>\\n#include <cube_uv_reflection_fragment>\\n#include <envmap_common_pars_fragment>\\n#include <envmap_physical_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <lights_pars_begin>\\n#include <lights_physical_pars_fragment>\\n#include <shadowmap_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <clearcoat_pars_fragment>\\n#include <roughnessmap_pars_fragment>\\n#include <metalnessmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\tvec3 totalEmissiveRadiance = emissive;\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\t#include <roughnessmap_fragment>\\n\\t#include <metalnessmap_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\t#include <clearcoat_normal_fragment_begin>\\n\\t#include <clearcoat_normal_fragment_maps>\\n\\t#include <emissivemap_fragment>\\n\\t#include <lights_physical_fragment>\\n\\t#include <lights_fragment_begin>\\n\\t#include <lights_fragment_maps>\\n\\t#include <lights_fragment_end>\\n\\t#include <aomap_fragment>\\n\\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\\n\\t#ifdef TRANSPARENCY\\n\\t\\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\\n\\t#endif\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n\\t#include <dithering_fragment>\\n}\";\r\n\r\n\tvar meshphysical_vert = \"#define STANDARD\\nvarying vec3 vViewPosition;\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <uv2_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <uv2_vertex>\\n\\t#include <color_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n\\t#ifdef USE_TANGENT\\n\\t\\tvTangent = normalize( transformedTangent );\\n\\t\\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\\n\\t#endif\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\tvViewPosition = - mvPosition.xyz;\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\r\n\r\n\tvar normal_frag = \"#define NORMAL\\nuniform float opacity;\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\\n#include <packing>\\n#include <uv_pars_fragment>\\n#include <bumpmap_pars_fragment>\\n#include <normalmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <normal_fragment_begin>\\n\\t#include <normal_fragment_maps>\\n\\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\\n}\";\r\n\r\n\tvar normal_vert = \"#define NORMAL\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvarying vec3 vViewPosition;\\n#endif\\n#ifndef FLAT_SHADED\\n\\tvarying vec3 vNormal;\\n\\t#ifdef USE_TANGENT\\n\\t\\tvarying vec3 vTangent;\\n\\t\\tvarying vec3 vBitangent;\\n\\t#endif\\n#endif\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <displacementmap_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\t#include <beginnormal_vertex>\\n\\t#include <morphnormal_vertex>\\n\\t#include <skinbase_vertex>\\n\\t#include <skinnormal_vertex>\\n\\t#include <defaultnormal_vertex>\\n#ifndef FLAT_SHADED\\n\\tvNormal = normalize( transformedNormal );\\n\\t#ifdef USE_TANGENT\\n\\t\\tvTangent = normalize( transformedTangent );\\n\\t\\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\\n\\t#endif\\n#endif\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <skinning_vertex>\\n\\t#include <displacementmap_vertex>\\n\\t#include <project_vertex>\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\\n\\tvViewPosition = - mvPosition.xyz;\\n#endif\\n}\";\r\n\r\n\tvar points_frag = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <color_pars_fragment>\\n#include <map_particle_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_particle_fragment>\\n\\t#include <color_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n\\t#include <premultiplied_alpha_fragment>\\n}\";\r\n\r\n\tvar points_vert = \"uniform float size;\\nuniform float scale;\\n#include <common>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <color_vertex>\\n\\t#include <begin_vertex>\\n\\t#include <morphtarget_vertex>\\n\\t#include <project_vertex>\\n\\tgl_PointSize = size;\\n\\t#ifdef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\\n\\t\\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\\n\\t#endif\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <fog_vertex>\\n}\";\r\n\r\n\tvar shadow_frag = \"uniform vec3 color;\\nuniform float opacity;\\n#include <common>\\n#include <packing>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n#include <shadowmap_pars_fragment>\\n#include <shadowmask_pars_fragment>\\nvoid main() {\\n\\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\";\r\n\r\n\tvar shadow_vert = \"#include <fog_pars_vertex>\\n#include <shadowmap_pars_vertex>\\nvoid main() {\\n\\t#include <begin_vertex>\\n\\t#include <project_vertex>\\n\\t#include <worldpos_vertex>\\n\\t#include <shadowmap_vertex>\\n\\t#include <fog_vertex>\\n}\";\r\n\r\n\tvar sprite_frag = \"uniform vec3 diffuse;\\nuniform float opacity;\\n#include <common>\\n#include <uv_pars_fragment>\\n#include <map_pars_fragment>\\n#include <alphamap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\nvoid main() {\\n\\t#include <clipping_planes_fragment>\\n\\tvec3 outgoingLight = vec3( 0.0 );\\n\\tvec4 diffuseColor = vec4( diffuse, opacity );\\n\\t#include <logdepthbuf_fragment>\\n\\t#include <map_fragment>\\n\\t#include <alphamap_fragment>\\n\\t#include <alphatest_fragment>\\n\\toutgoingLight = diffuseColor.rgb;\\n\\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\t#include <tonemapping_fragment>\\n\\t#include <encodings_fragment>\\n\\t#include <fog_fragment>\\n}\";\r\n\r\n\tvar sprite_vert = \"uniform float rotation;\\nuniform vec2 center;\\n#include <common>\\n#include <uv_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\nvoid main() {\\n\\t#include <uv_vertex>\\n\\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\\n\\tvec2 scale;\\n\\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\\n\\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\\n\\t#ifndef USE_SIZEATTENUATION\\n\\t\\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\\n\\t\\tif ( isPerspective ) scale *= - mvPosition.z;\\n\\t#endif\\n\\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\\n\\tvec2 rotatedPosition;\\n\\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\\n\\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\\n\\tmvPosition.xy += rotatedPosition;\\n\\tgl_Position = projectionMatrix * mvPosition;\\n\\t#include <logdepthbuf_vertex>\\n\\t#include <clipping_planes_vertex>\\n\\t#include <fog_vertex>\\n}\";\r\n\r\n\tvar ShaderChunk = {\r\n\t\talphamap_fragment: alphamap_fragment,\r\n\t\talphamap_pars_fragment: alphamap_pars_fragment,\r\n\t\talphatest_fragment: alphatest_fragment,\r\n\t\taomap_fragment: aomap_fragment,\r\n\t\taomap_pars_fragment: aomap_pars_fragment,\r\n\t\tbegin_vertex: begin_vertex,\r\n\t\tbeginnormal_vertex: beginnormal_vertex,\r\n\t\tbsdfs: bsdfs,\r\n\t\tbumpmap_pars_fragment: bumpmap_pars_fragment,\r\n\t\tclipping_planes_fragment: clipping_planes_fragment,\r\n\t\tclipping_planes_pars_fragment: clipping_planes_pars_fragment,\r\n\t\tclipping_planes_pars_vertex: clipping_planes_pars_vertex,\r\n\t\tclipping_planes_vertex: clipping_planes_vertex,\r\n\t\tcolor_fragment: color_fragment,\r\n\t\tcolor_pars_fragment: color_pars_fragment,\r\n\t\tcolor_pars_vertex: color_pars_vertex,\r\n\t\tcolor_vertex: color_vertex,\r\n\t\tcommon: common,\r\n\t\tcube_uv_reflection_fragment: cube_uv_reflection_fragment,\r\n\t\tdefaultnormal_vertex: defaultnormal_vertex,\r\n\t\tdisplacementmap_pars_vertex: displacementmap_pars_vertex,\r\n\t\tdisplacementmap_vertex: displacementmap_vertex,\r\n\t\temissivemap_fragment: emissivemap_fragment,\r\n\t\temissivemap_pars_fragment: emissivemap_pars_fragment,\r\n\t\tencodings_fragment: encodings_fragment,\r\n\t\tencodings_pars_fragment: encodings_pars_fragment,\r\n\t\tenvmap_fragment: envmap_fragment,\r\n\t\tenvmap_common_pars_fragment: envmap_common_pars_fragment,\r\n\t\tenvmap_pars_fragment: envmap_pars_fragment,\r\n\t\tenvmap_pars_vertex: envmap_pars_vertex,\r\n\t\tenvmap_physical_pars_fragment: envmap_physical_pars_fragment,\r\n\t\tenvmap_vertex: envmap_vertex,\r\n\t\tfog_vertex: fog_vertex,\r\n\t\tfog_pars_vertex: fog_pars_vertex,\r\n\t\tfog_fragment: fog_fragment,\r\n\t\tfog_pars_fragment: fog_pars_fragment,\r\n\t\tgradientmap_pars_fragment: gradientmap_pars_fragment,\r\n\t\tlightmap_fragment: lightmap_fragment,\r\n\t\tlightmap_pars_fragment: lightmap_pars_fragment,\r\n\t\tlights_lambert_vertex: lights_lambert_vertex,\r\n\t\tlights_pars_begin: lights_pars_begin,\r\n\t\tlights_toon_fragment: lights_toon_fragment,\r\n\t\tlights_toon_pars_fragment: lights_toon_pars_fragment,\r\n\t\tlights_phong_fragment: lights_phong_fragment,\r\n\t\tlights_phong_pars_fragment: lights_phong_pars_fragment,\r\n\t\tlights_physical_fragment: lights_physical_fragment,\r\n\t\tlights_physical_pars_fragment: lights_physical_pars_fragment,\r\n\t\tlights_fragment_begin: lights_fragment_begin,\r\n\t\tlights_fragment_maps: lights_fragment_maps,\r\n\t\tlights_fragment_end: lights_fragment_end,\r\n\t\tlogdepthbuf_fragment: logdepthbuf_fragment,\r\n\t\tlogdepthbuf_pars_fragment: logdepthbuf_pars_fragment,\r\n\t\tlogdepthbuf_pars_vertex: logdepthbuf_pars_vertex,\r\n\t\tlogdepthbuf_vertex: logdepthbuf_vertex,\r\n\t\tmap_fragment: map_fragment,\r\n\t\tmap_pars_fragment: map_pars_fragment,\r\n\t\tmap_particle_fragment: map_particle_fragment,\r\n\t\tmap_particle_pars_fragment: map_particle_pars_fragment,\r\n\t\tmetalnessmap_fragment: metalnessmap_fragment,\r\n\t\tmetalnessmap_pars_fragment: metalnessmap_pars_fragment,\r\n\t\tmorphnormal_vertex: morphnormal_vertex,\r\n\t\tmorphtarget_pars_vertex: morphtarget_pars_vertex,\r\n\t\tmorphtarget_vertex: morphtarget_vertex,\r\n\t\tnormal_fragment_begin: normal_fragment_begin,\r\n\t\tnormal_fragment_maps: normal_fragment_maps,\r\n\t\tnormalmap_pars_fragment: normalmap_pars_fragment,\r\n\t\tclearcoat_normal_fragment_begin: clearcoat_normal_fragment_begin,\r\n\t\tclearcoat_normal_fragment_maps: clearcoat_normal_fragment_maps,\r\n\t\tclearcoat_pars_fragment: clearcoat_pars_fragment,\r\n\t\tpacking: packing,\r\n\t\tpremultiplied_alpha_fragment: premultiplied_alpha_fragment,\r\n\t\tproject_vertex: project_vertex,\r\n\t\tdithering_fragment: dithering_fragment,\r\n\t\tdithering_pars_fragment: dithering_pars_fragment,\r\n\t\troughnessmap_fragment: roughnessmap_fragment,\r\n\t\troughnessmap_pars_fragment: roughnessmap_pars_fragment,\r\n\t\tshadowmap_pars_fragment: shadowmap_pars_fragment,\r\n\t\tshadowmap_pars_vertex: shadowmap_pars_vertex,\r\n\t\tshadowmap_vertex: shadowmap_vertex,\r\n\t\tshadowmask_pars_fragment: shadowmask_pars_fragment,\r\n\t\tskinbase_vertex: skinbase_vertex,\r\n\t\tskinning_pars_vertex: skinning_pars_vertex,\r\n\t\tskinning_vertex: skinning_vertex,\r\n\t\tskinnormal_vertex: skinnormal_vertex,\r\n\t\tspecularmap_fragment: specularmap_fragment,\r\n\t\tspecularmap_pars_fragment: specularmap_pars_fragment,\r\n\t\ttonemapping_fragment: tonemapping_fragment,\r\n\t\ttonemapping_pars_fragment: tonemapping_pars_fragment,\r\n\t\tuv_pars_fragment: uv_pars_fragment,\r\n\t\tuv_pars_vertex: uv_pars_vertex,\r\n\t\tuv_vertex: uv_vertex,\r\n\t\tuv2_pars_fragment: uv2_pars_fragment,\r\n\t\tuv2_pars_vertex: uv2_pars_vertex,\r\n\t\tuv2_vertex: uv2_vertex,\r\n\t\tworldpos_vertex: worldpos_vertex,\r\n\r\n\t\tbackground_frag: background_frag,\r\n\t\tbackground_vert: background_vert,\r\n\t\tcube_frag: cube_frag,\r\n\t\tcube_vert: cube_vert,\r\n\t\tdepth_frag: depth_frag,\r\n\t\tdepth_vert: depth_vert,\r\n\t\tdistanceRGBA_frag: distanceRGBA_frag,\r\n\t\tdistanceRGBA_vert: distanceRGBA_vert,\r\n\t\tequirect_frag: equirect_frag,\r\n\t\tequirect_vert: equirect_vert,\r\n\t\tlinedashed_frag: linedashed_frag,\r\n\t\tlinedashed_vert: linedashed_vert,\r\n\t\tmeshbasic_frag: meshbasic_frag,\r\n\t\tmeshbasic_vert: meshbasic_vert,\r\n\t\tmeshlambert_frag: meshlambert_frag,\r\n\t\tmeshlambert_vert: meshlambert_vert,\r\n\t\tmeshmatcap_frag: meshmatcap_frag,\r\n\t\tmeshmatcap_vert: meshmatcap_vert,\r\n\t\tmeshtoon_frag: meshtoon_frag,\r\n\t\tmeshtoon_vert: meshtoon_vert,\r\n\t\tmeshphong_frag: meshphong_frag,\r\n\t\tmeshphong_vert: meshphong_vert,\r\n\t\tmeshphysical_frag: meshphysical_frag,\r\n\t\tmeshphysical_vert: meshphysical_vert,\r\n\t\tnormal_frag: normal_frag,\r\n\t\tnormal_vert: normal_vert,\r\n\t\tpoints_frag: points_frag,\r\n\t\tpoints_vert: points_vert,\r\n\t\tshadow_frag: shadow_frag,\r\n\t\tshadow_vert: shadow_vert,\r\n\t\tsprite_frag: sprite_frag,\r\n\t\tsprite_vert: sprite_vert\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t */\r\n\r\n\tvar ShaderLib = {\r\n\r\n\t\tbasic: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.specularmap,\r\n\t\t\t\tUniformsLib.envmap,\r\n\t\t\t\tUniformsLib.aomap,\r\n\t\t\t\tUniformsLib.lightmap,\r\n\t\t\t\tUniformsLib.fog\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshbasic_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshbasic_frag\r\n\r\n\t\t},\r\n\r\n\t\tlambert: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.specularmap,\r\n\t\t\t\tUniformsLib.envmap,\r\n\t\t\t\tUniformsLib.aomap,\r\n\t\t\t\tUniformsLib.lightmap,\r\n\t\t\t\tUniformsLib.emissivemap,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\tUniformsLib.lights,\r\n\t\t\t\t{\r\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshlambert_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshlambert_frag\r\n\r\n\t\t},\r\n\r\n\t\tphong: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.specularmap,\r\n\t\t\t\tUniformsLib.envmap,\r\n\t\t\t\tUniformsLib.aomap,\r\n\t\t\t\tUniformsLib.lightmap,\r\n\t\t\t\tUniformsLib.emissivemap,\r\n\t\t\t\tUniformsLib.bumpmap,\r\n\t\t\t\tUniformsLib.normalmap,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\tUniformsLib.lights,\r\n\t\t\t\t{\r\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) },\r\n\t\t\t\t\tspecular: { value: new Color( 0x111111 ) },\r\n\t\t\t\t\tshininess: { value: 30 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshphong_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshphong_frag\r\n\r\n\t\t},\r\n\r\n\t\tstandard: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.envmap,\r\n\t\t\t\tUniformsLib.aomap,\r\n\t\t\t\tUniformsLib.lightmap,\r\n\t\t\t\tUniformsLib.emissivemap,\r\n\t\t\t\tUniformsLib.bumpmap,\r\n\t\t\t\tUniformsLib.normalmap,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\tUniformsLib.roughnessmap,\r\n\t\t\t\tUniformsLib.metalnessmap,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\tUniformsLib.lights,\r\n\t\t\t\t{\r\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) },\r\n\t\t\t\t\troughness: { value: 0.5 },\r\n\t\t\t\t\tmetalness: { value: 0.5 },\r\n\t\t\t\t\tenvMapIntensity: { value: 1 } // temporary\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshphysical_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshphysical_frag\r\n\r\n\t\t},\r\n\r\n\t\ttoon: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.specularmap,\r\n\t\t\t\tUniformsLib.aomap,\r\n\t\t\t\tUniformsLib.lightmap,\r\n\t\t\t\tUniformsLib.emissivemap,\r\n\t\t\t\tUniformsLib.bumpmap,\r\n\t\t\t\tUniformsLib.normalmap,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\tUniformsLib.gradientmap,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\tUniformsLib.lights,\r\n\t\t\t\t{\r\n\t\t\t\t\temissive: { value: new Color( 0x000000 ) },\r\n\t\t\t\t\tspecular: { value: new Color( 0x111111 ) },\r\n\t\t\t\t\tshininess: { value: 30 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshtoon_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshtoon_frag\r\n\r\n\t\t},\r\n\r\n\t\tmatcap: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.bumpmap,\r\n\t\t\t\tUniformsLib.normalmap,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\t{\r\n\t\t\t\t\tmatcap: { value: null }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.meshmatcap_vert,\r\n\t\t\tfragmentShader: ShaderChunk.meshmatcap_frag\r\n\r\n\t\t},\r\n\r\n\t\tpoints: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.points,\r\n\t\t\t\tUniformsLib.fog\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.points_vert,\r\n\t\t\tfragmentShader: ShaderChunk.points_frag\r\n\r\n\t\t},\r\n\r\n\t\tdashed: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\t{\r\n\t\t\t\t\tscale: { value: 1 },\r\n\t\t\t\t\tdashSize: { value: 1 },\r\n\t\t\t\t\ttotalSize: { value: 2 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.linedashed_vert,\r\n\t\t\tfragmentShader: ShaderChunk.linedashed_frag\r\n\r\n\t\t},\r\n\r\n\t\tdepth: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.displacementmap\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.depth_vert,\r\n\t\t\tfragmentShader: ShaderChunk.depth_frag\r\n\r\n\t\t},\r\n\r\n\t\tnormal: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.bumpmap,\r\n\t\t\t\tUniformsLib.normalmap,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\t{\r\n\t\t\t\t\topacity: { value: 1.0 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.normal_vert,\r\n\t\t\tfragmentShader: ShaderChunk.normal_frag\r\n\r\n\t\t},\r\n\r\n\t\tsprite: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.sprite,\r\n\t\t\t\tUniformsLib.fog\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.sprite_vert,\r\n\t\t\tfragmentShader: ShaderChunk.sprite_frag\r\n\r\n\t\t},\r\n\r\n\t\tbackground: {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tuvTransform: { value: new Matrix3() },\r\n\t\t\t\tt2D: { value: null },\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: ShaderChunk.background_vert,\r\n\t\t\tfragmentShader: ShaderChunk.background_frag\r\n\r\n\t\t},\r\n\t\t/* -------------------------------------------------------------------------\r\n\t\t//\tCube map shader\r\n\t\t ------------------------------------------------------------------------- */\r\n\r\n\t\tcube: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.envmap,\r\n\t\t\t\t{\r\n\t\t\t\t\topacity: { value: 1.0 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.cube_vert,\r\n\t\t\tfragmentShader: ShaderChunk.cube_frag\r\n\r\n\t\t},\r\n\r\n\t\tequirect: {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\ttEquirect: { value: null },\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: ShaderChunk.equirect_vert,\r\n\t\t\tfragmentShader: ShaderChunk.equirect_frag\r\n\r\n\t\t},\r\n\r\n\t\tdistanceRGBA: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.common,\r\n\t\t\t\tUniformsLib.displacementmap,\r\n\t\t\t\t{\r\n\t\t\t\t\treferencePosition: { value: new Vector3() },\r\n\t\t\t\t\tnearDistance: { value: 1 },\r\n\t\t\t\t\tfarDistance: { value: 1000 }\r\n\t\t\t\t}\r\n\t\t\t] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.distanceRGBA_vert,\r\n\t\t\tfragmentShader: ShaderChunk.distanceRGBA_frag\r\n\r\n\t\t},\r\n\r\n\t\tshadow: {\r\n\r\n\t\t\tuniforms: mergeUniforms( [\r\n\t\t\t\tUniformsLib.lights,\r\n\t\t\t\tUniformsLib.fog,\r\n\t\t\t\t{\r\n\t\t\t\t\tcolor: { value: new Color( 0x00000 ) },\r\n\t\t\t\t\topacity: { value: 1.0 }\r\n\t\t\t\t} ] ),\r\n\r\n\t\t\tvertexShader: ShaderChunk.shadow_vert,\r\n\t\t\tfragmentShader: ShaderChunk.shadow_frag\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tShaderLib.physical = {\r\n\r\n\t\tuniforms: mergeUniforms( [\r\n\t\t\tShaderLib.standard.uniforms,\r\n\t\t\t{\r\n\t\t\t\tclearcoat: { value: 0 },\r\n\t\t\t\tclearcoatMap: { value: null },\r\n\t\t\t\tclearcoatRoughness: { value: 0 },\r\n\t\t\t\tclearcoatRoughnessMap: { value: null },\r\n\t\t\t\tclearcoatNormalScale: { value: new Vector2( 1, 1 ) },\r\n\t\t\t\tclearcoatNormalMap: { value: null },\r\n\t\t\t\tsheen: { value: new Color( 0x000000 ) },\r\n\t\t\t\ttransparency: { value: 0 },\r\n\t\t\t}\r\n\t\t] ),\r\n\r\n\t\tvertexShader: ShaderChunk.meshphysical_vert,\r\n\t\tfragmentShader: ShaderChunk.meshphysical_frag\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLBackground( renderer, state, objects, premultipliedAlpha ) {\r\n\r\n\t\tvar clearColor = new Color( 0x000000 );\r\n\t\tvar clearAlpha = 0;\r\n\r\n\t\tvar planeMesh;\r\n\t\tvar boxMesh;\r\n\r\n\t\tvar currentBackground = null;\r\n\t\tvar currentBackgroundVersion = 0;\r\n\t\tvar currentTonemapping = null;\r\n\r\n\t\tfunction render( renderList, scene, camera, forceClear ) {\r\n\r\n\t\t\tvar background = scene.background;\r\n\r\n\t\t\t// Ignore background in AR\r\n\t\t\t// TODO: Reconsider this.\r\n\r\n\t\t\tvar xr = renderer.xr;\r\n\t\t\tvar session = xr.getSession && xr.getSession();\r\n\r\n\t\t\tif ( session && session.environmentBlendMode === 'additive' ) {\r\n\r\n\t\t\t\tbackground = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( background === null ) {\r\n\r\n\t\t\t\tsetClear( clearColor, clearAlpha );\r\n\r\n\t\t\t} else if ( background && background.isColor ) {\r\n\r\n\t\t\t\tsetClear( background, 1 );\r\n\t\t\t\tforceClear = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( renderer.autoClear || forceClear ) {\r\n\r\n\t\t\t\trenderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( background && ( background.isCubeTexture || background.isWebGLCubeRenderTarget || background.mapping === CubeUVReflectionMapping ) ) {\r\n\r\n\t\t\t\tif ( boxMesh === undefined ) {\r\n\r\n\t\t\t\t\tboxMesh = new Mesh(\r\n\t\t\t\t\t\tnew BoxBufferGeometry( 1, 1, 1 ),\r\n\t\t\t\t\t\tnew ShaderMaterial( {\r\n\t\t\t\t\t\t\ttype: 'BackgroundCubeMaterial',\r\n\t\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.cube.uniforms ),\r\n\t\t\t\t\t\t\tvertexShader: ShaderLib.cube.vertexShader,\r\n\t\t\t\t\t\t\tfragmentShader: ShaderLib.cube.fragmentShader,\r\n\t\t\t\t\t\t\tside: BackSide,\r\n\t\t\t\t\t\t\tdepthTest: false,\r\n\t\t\t\t\t\t\tdepthWrite: false,\r\n\t\t\t\t\t\t\tfog: false\r\n\t\t\t\t\t\t} )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tboxMesh.geometry.deleteAttribute( 'normal' );\r\n\t\t\t\t\tboxMesh.geometry.deleteAttribute( 'uv' );\r\n\r\n\t\t\t\t\tboxMesh.onBeforeRender = function ( renderer, scene, camera ) {\r\n\r\n\t\t\t\t\t\tthis.matrixWorld.copyPosition( camera.matrixWorld );\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t// enable code injection for non-built-in material\r\n\t\t\t\t\tObject.defineProperty( boxMesh.material, 'envMap', {\r\n\r\n\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\treturn this.uniforms.envMap.value;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tobjects.update( boxMesh );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar texture = background.isWebGLCubeRenderTarget ? background.texture : background;\r\n\r\n\t\t\t\tboxMesh.material.uniforms.envMap.value = texture;\r\n\t\t\t\tboxMesh.material.uniforms.flipEnvMap.value = texture.isCubeTexture ? - 1 : 1;\r\n\r\n\t\t\t\tif ( currentBackground !== background ||\r\n\t\t\t\t\tcurrentBackgroundVersion !== texture.version ||\r\n\t\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\r\n\r\n\t\t\t\t\tboxMesh.material.needsUpdate = true;\r\n\r\n\t\t\t\t\tcurrentBackground = background;\r\n\t\t\t\t\tcurrentBackgroundVersion = texture.version;\r\n\t\t\t\t\tcurrentTonemapping = renderer.toneMapping;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// push to the pre-sorted opaque render list\r\n\t\t\t\trenderList.unshift( boxMesh, boxMesh.geometry, boxMesh.material, 0, 0, null );\r\n\r\n\t\t\t} else if ( background && background.isTexture ) {\r\n\r\n\t\t\t\tif ( planeMesh === undefined ) {\r\n\r\n\t\t\t\t\tplaneMesh = new Mesh(\r\n\t\t\t\t\t\tnew PlaneBufferGeometry( 2, 2 ),\r\n\t\t\t\t\t\tnew ShaderMaterial( {\r\n\t\t\t\t\t\t\ttype: 'BackgroundMaterial',\r\n\t\t\t\t\t\t\tuniforms: cloneUniforms( ShaderLib.background.uniforms ),\r\n\t\t\t\t\t\t\tvertexShader: ShaderLib.background.vertexShader,\r\n\t\t\t\t\t\t\tfragmentShader: ShaderLib.background.fragmentShader,\r\n\t\t\t\t\t\t\tside: FrontSide,\r\n\t\t\t\t\t\t\tdepthTest: false,\r\n\t\t\t\t\t\t\tdepthWrite: false,\r\n\t\t\t\t\t\t\tfog: false\r\n\t\t\t\t\t\t} )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tplaneMesh.geometry.deleteAttribute( 'normal' );\r\n\r\n\t\t\t\t\t// enable code injection for non-built-in material\r\n\t\t\t\t\tObject.defineProperty( planeMesh.material, 'map', {\r\n\r\n\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\treturn this.uniforms.t2D.value;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tobjects.update( planeMesh );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tplaneMesh.material.uniforms.t2D.value = background;\r\n\r\n\t\t\t\tif ( background.matrixAutoUpdate === true ) {\r\n\r\n\t\t\t\t\tbackground.updateMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tplaneMesh.material.uniforms.uvTransform.value.copy( background.matrix );\r\n\r\n\t\t\t\tif ( currentBackground !== background ||\r\n\t\t\t\t\tcurrentBackgroundVersion !== background.version ||\r\n\t\t\t\t\tcurrentTonemapping !== renderer.toneMapping ) {\r\n\r\n\t\t\t\t\tplaneMesh.material.needsUpdate = true;\r\n\r\n\t\t\t\t\tcurrentBackground = background;\r\n\t\t\t\t\tcurrentBackgroundVersion = background.version;\r\n\t\t\t\t\tcurrentTonemapping = renderer.toneMapping;\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\t// push to the pre-sorted opaque render list\r\n\t\t\t\trenderList.unshift( planeMesh, planeMesh.geometry, planeMesh.material, 0, 0, null );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setClear( color, alpha ) {\r\n\r\n\t\t\tstate.buffers.color.setClear( color.r, color.g, color.b, alpha, premultipliedAlpha );\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tgetClearColor: function () {\r\n\r\n\t\t\t\treturn clearColor;\r\n\r\n\t\t\t},\r\n\t\t\tsetClearColor: function ( color, alpha ) {\r\n\r\n\t\t\t\tclearColor.set( color );\r\n\t\t\t\tclearAlpha = alpha !== undefined ? alpha : 1;\r\n\t\t\t\tsetClear( clearColor, clearAlpha );\r\n\r\n\t\t\t},\r\n\t\t\tgetClearAlpha: function () {\r\n\r\n\t\t\t\treturn clearAlpha;\r\n\r\n\t\t\t},\r\n\t\t\tsetClearAlpha: function ( alpha ) {\r\n\r\n\t\t\t\tclearAlpha = alpha;\r\n\t\t\t\tsetClear( clearColor, clearAlpha );\r\n\r\n\t\t\t},\r\n\t\t\trender: render\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLBufferRenderer( gl, extensions, info, capabilities ) {\r\n\r\n\t\tvar isWebGL2 = capabilities.isWebGL2;\r\n\r\n\t\tvar mode;\r\n\r\n\t\tfunction setMode( value ) {\r\n\r\n\t\t\tmode = value;\r\n\r\n\t\t}\r\n\r\n\t\tfunction render( start, count ) {\r\n\r\n\t\t\tgl.drawArrays( mode, start, count );\r\n\r\n\t\t\tinfo.update( count, mode );\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderInstances( geometry, start, count, primcount ) {\r\n\r\n\t\t\tif ( primcount === 0 ) { return; }\r\n\r\n\t\t\tvar extension, methodName;\r\n\r\n\t\t\tif ( isWebGL2 ) {\r\n\r\n\t\t\t\textension = gl;\r\n\t\t\t\tmethodName = 'drawArraysInstanced';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\t\t\t\tmethodName = 'drawArraysInstancedANGLE';\r\n\r\n\t\t\t\tif ( extension === null ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\textension[ methodName ]( mode, start, count, primcount );\r\n\r\n\t\t\tinfo.update( count, mode, primcount );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tthis.setMode = setMode;\r\n\t\tthis.render = render;\r\n\t\tthis.renderInstances = renderInstances;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLCapabilities( gl, extensions, parameters ) {\r\n\r\n\t\tvar maxAnisotropy;\r\n\r\n\t\tfunction getMaxAnisotropy() {\r\n\r\n\t\t\tif ( maxAnisotropy !== undefined ) { return maxAnisotropy; }\r\n\r\n\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\tmaxAnisotropy = gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tmaxAnisotropy = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn maxAnisotropy;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getMaxPrecision( precision ) {\r\n\r\n\t\t\tif ( precision === 'highp' ) {\r\n\r\n\t\t\t\tif ( gl.getShaderPrecisionFormat( 35633, 36338 ).precision > 0 &&\r\n\t\t\t\t\tgl.getShaderPrecisionFormat( 35632, 36338 ).precision > 0 ) {\r\n\r\n\t\t\t\t\treturn 'highp';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tprecision = 'mediump';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( precision === 'mediump' ) {\r\n\r\n\t\t\t\tif ( gl.getShaderPrecisionFormat( 35633, 36337 ).precision > 0 &&\r\n\t\t\t\t\tgl.getShaderPrecisionFormat( 35632, 36337 ).precision > 0 ) {\r\n\r\n\t\t\t\t\treturn 'mediump';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn 'lowp';\r\n\r\n\t\t}\r\n\r\n\t\t/* eslint-disable no-undef */\r\n\t\tvar isWebGL2 = ( typeof WebGL2RenderingContext !== 'undefined' && gl instanceof WebGL2RenderingContext ) ||\r\n\t\t\t( typeof WebGL2ComputeRenderingContext !== 'undefined' && gl instanceof WebGL2ComputeRenderingContext );\r\n\t\t/* eslint-enable no-undef */\r\n\r\n\t\tvar precision = parameters.precision !== undefined ? parameters.precision : 'highp';\r\n\t\tvar maxPrecision = getMaxPrecision( precision );\r\n\r\n\t\tif ( maxPrecision !== precision ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer:', precision, 'not supported, using', maxPrecision, 'instead.' );\r\n\t\t\tprecision = maxPrecision;\r\n\r\n\t\t}\r\n\r\n\t\tvar logarithmicDepthBuffer = parameters.logarithmicDepthBuffer === true;\r\n\r\n\t\tvar maxTextures = gl.getParameter( 34930 );\r\n\t\tvar maxVertexTextures = gl.getParameter( 35660 );\r\n\t\tvar maxTextureSize = gl.getParameter( 3379 );\r\n\t\tvar maxCubemapSize = gl.getParameter( 34076 );\r\n\r\n\t\tvar maxAttributes = gl.getParameter( 34921 );\r\n\t\tvar maxVertexUniforms = gl.getParameter( 36347 );\r\n\t\tvar maxVaryings = gl.getParameter( 36348 );\r\n\t\tvar maxFragmentUniforms = gl.getParameter( 36349 );\r\n\r\n\t\tvar vertexTextures = maxVertexTextures > 0;\r\n\t\tvar floatFragmentTextures = isWebGL2 || !! extensions.get( 'OES_texture_float' );\r\n\t\tvar floatVertexTextures = vertexTextures && floatFragmentTextures;\r\n\r\n\t\tvar maxSamples = isWebGL2 ? gl.getParameter( 36183 ) : 0;\r\n\r\n\t\treturn {\r\n\r\n\t\t\tisWebGL2: isWebGL2,\r\n\r\n\t\t\tgetMaxAnisotropy: getMaxAnisotropy,\r\n\t\t\tgetMaxPrecision: getMaxPrecision,\r\n\r\n\t\t\tprecision: precision,\r\n\t\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\r\n\r\n\t\t\tmaxTextures: maxTextures,\r\n\t\t\tmaxVertexTextures: maxVertexTextures,\r\n\t\t\tmaxTextureSize: maxTextureSize,\r\n\t\t\tmaxCubemapSize: maxCubemapSize,\r\n\r\n\t\t\tmaxAttributes: maxAttributes,\r\n\t\t\tmaxVertexUniforms: maxVertexUniforms,\r\n\t\t\tmaxVaryings: maxVaryings,\r\n\t\t\tmaxFragmentUniforms: maxFragmentUniforms,\r\n\r\n\t\t\tvertexTextures: vertexTextures,\r\n\t\t\tfloatFragmentTextures: floatFragmentTextures,\r\n\t\t\tfloatVertexTextures: floatVertexTextures,\r\n\r\n\t\t\tmaxSamples: maxSamples\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction WebGLClipping() {\r\n\r\n\t\tvar scope = this,\r\n\r\n\t\t\tglobalState = null,\r\n\t\t\tnumGlobalPlanes = 0,\r\n\t\t\tlocalClippingEnabled = false,\r\n\t\t\trenderingShadows = false,\r\n\r\n\t\t\tplane = new Plane(),\r\n\t\t\tviewNormalMatrix = new Matrix3(),\r\n\r\n\t\t\tuniform = { value: null, needsUpdate: false };\r\n\r\n\t\tthis.uniform = uniform;\r\n\t\tthis.numPlanes = 0;\r\n\t\tthis.numIntersection = 0;\r\n\r\n\t\tthis.init = function ( planes, enableLocalClipping, camera ) {\r\n\r\n\t\t\tvar enabled =\r\n\t\t\t\tplanes.length !== 0 ||\r\n\t\t\t\tenableLocalClipping ||\r\n\t\t\t\t// enable state of previous frame - the clipping code has to\r\n\t\t\t\t// run another frame in order to reset the state:\r\n\t\t\t\tnumGlobalPlanes !== 0 ||\r\n\t\t\t\tlocalClippingEnabled;\r\n\r\n\t\t\tlocalClippingEnabled = enableLocalClipping;\r\n\r\n\t\t\tglobalState = projectPlanes( planes, camera, 0 );\r\n\t\t\tnumGlobalPlanes = planes.length;\r\n\r\n\t\t\treturn enabled;\r\n\r\n\t\t};\r\n\r\n\t\tthis.beginShadows = function () {\r\n\r\n\t\t\trenderingShadows = true;\r\n\t\t\tprojectPlanes( null );\r\n\r\n\t\t};\r\n\r\n\t\tthis.endShadows = function () {\r\n\r\n\t\t\trenderingShadows = false;\r\n\t\t\tresetGlobalState();\r\n\r\n\t\t};\r\n\r\n\t\tthis.setState = function ( planes, clipIntersection, clipShadows, camera, cache, fromCache ) {\r\n\r\n\t\t\tif ( ! localClippingEnabled || planes === null || planes.length === 0 || renderingShadows && ! clipShadows ) {\r\n\r\n\t\t\t\t// there's no local clipping\r\n\r\n\t\t\t\tif ( renderingShadows ) {\r\n\r\n\t\t\t\t\t// there's no global clipping\r\n\r\n\t\t\t\t\tprojectPlanes( null );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tresetGlobalState();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar nGlobal = renderingShadows ? 0 : numGlobalPlanes,\r\n\t\t\t\t\tlGlobal = nGlobal * 4,\r\n\r\n\t\t\t\t\tdstArray = cache.clippingState || null;\r\n\r\n\t\t\t\tuniform.value = dstArray; // ensure unique state\r\n\r\n\t\t\t\tdstArray = projectPlanes( planes, camera, lGlobal, fromCache );\r\n\r\n\t\t\t\tfor ( var i = 0; i !== lGlobal; ++ i ) {\r\n\r\n\t\t\t\t\tdstArray[ i ] = globalState[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcache.clippingState = dstArray;\r\n\t\t\t\tthis.numIntersection = clipIntersection ? this.numPlanes : 0;\r\n\t\t\t\tthis.numPlanes += nGlobal;\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t};\r\n\r\n\t\tfunction resetGlobalState() {\r\n\r\n\t\t\tif ( uniform.value !== globalState ) {\r\n\r\n\t\t\t\tuniform.value = globalState;\r\n\t\t\t\tuniform.needsUpdate = numGlobalPlanes > 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.numPlanes = numGlobalPlanes;\r\n\t\t\tscope.numIntersection = 0;\r\n\r\n\t\t}\r\n\r\n\t\tfunction projectPlanes( planes, camera, dstOffset, skipTransform ) {\r\n\r\n\t\t\tvar nPlanes = planes !== null ? planes.length : 0,\r\n\t\t\t\tdstArray = null;\r\n\r\n\t\t\tif ( nPlanes !== 0 ) {\r\n\r\n\t\t\t\tdstArray = uniform.value;\r\n\r\n\t\t\t\tif ( skipTransform !== true || dstArray === null ) {\r\n\r\n\t\t\t\t\tvar flatSize = dstOffset + nPlanes * 4,\r\n\t\t\t\t\t\tviewMatrix = camera.matrixWorldInverse;\r\n\r\n\t\t\t\t\tviewNormalMatrix.getNormalMatrix( viewMatrix );\r\n\r\n\t\t\t\t\tif ( dstArray === null || dstArray.length < flatSize ) {\r\n\r\n\t\t\t\t\t\tdstArray = new Float32Array( flatSize );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor ( var i = 0, i4 = dstOffset; i !== nPlanes; ++ i, i4 += 4 ) {\r\n\r\n\t\t\t\t\t\tplane.copy( planes[ i ] ).applyMatrix4( viewMatrix, viewNormalMatrix );\r\n\r\n\t\t\t\t\t\tplane.normal.toArray( dstArray, i4 );\r\n\t\t\t\t\t\tdstArray[ i4 + 3 ] = plane.constant;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniform.value = dstArray;\r\n\t\t\t\tuniform.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.numPlanes = nPlanes;\r\n\t\t\tscope.numIntersection = 0;\r\n\r\n\t\t\treturn dstArray;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLExtensions( gl ) {\r\n\r\n\t\tvar extensions = {};\r\n\r\n\t\treturn {\r\n\r\n\t\t\tget: function ( name ) {\r\n\r\n\t\t\t\tif ( extensions[ name ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn extensions[ name ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar extension;\r\n\r\n\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\tcase 'WEBGL_depth_texture':\r\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_depth_texture' ) || gl.getExtension( 'MOZ_WEBGL_depth_texture' ) || gl.getExtension( 'WEBKIT_WEBGL_depth_texture' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'EXT_texture_filter_anisotropic':\r\n\t\t\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'WEBGL_compressed_texture_s3tc':\r\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\r\n\t\t\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\textension = gl.getExtension( name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( extension === null ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\textensions[ name ] = extension;\r\n\r\n\t\t\t\treturn extension;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLGeometries( gl, attributes, info ) {\r\n\r\n\t\tvar geometries = new WeakMap();\r\n\t\tvar wireframeAttributes = new WeakMap();\r\n\r\n\t\tfunction onGeometryDispose( event ) {\r\n\r\n\t\t\tvar geometry = event.target;\r\n\t\t\tvar buffergeometry = geometries.get( geometry );\r\n\r\n\t\t\tif ( buffergeometry.index !== null ) {\r\n\r\n\t\t\t\tattributes.remove( buffergeometry.index );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var name in buffergeometry.attributes ) {\r\n\r\n\t\t\t\tattributes.remove( buffergeometry.attributes[ name ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\t\tgeometries.delete( geometry );\r\n\r\n\t\t\tvar attribute = wireframeAttributes.get( buffergeometry );\r\n\r\n\t\t\tif ( attribute ) {\r\n\r\n\t\t\t\tattributes.remove( attribute );\r\n\t\t\t\twireframeAttributes.delete( buffergeometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tinfo.memory.geometries --;\r\n\r\n\t\t}\r\n\r\n\t\tfunction get( object, geometry ) {\r\n\r\n\t\t\tvar buffergeometry = geometries.get( geometry );\r\n\r\n\t\t\tif ( buffergeometry ) { return buffergeometry; }\r\n\r\n\t\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tbuffergeometry = geometry;\r\n\r\n\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\tif ( geometry._bufferGeometry === undefined ) {\r\n\r\n\t\t\t\t\tgeometry._bufferGeometry = new BufferGeometry().setFromObject( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbuffergeometry = geometry._bufferGeometry;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometries.set( geometry, buffergeometry );\r\n\r\n\t\t\tinfo.memory.geometries ++;\r\n\r\n\t\t\treturn buffergeometry;\r\n\r\n\t\t}\r\n\r\n\t\tfunction update( geometry ) {\r\n\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar geometryAttributes = geometry.attributes;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tattributes.update( index, 34963 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var name in geometryAttributes ) {\r\n\r\n\t\t\t\tattributes.update( geometryAttributes[ name ], 34962 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// morph targets\r\n\r\n\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\r\n\t\t\tfor ( var name in morphAttributes ) {\r\n\r\n\t\t\t\tvar array = morphAttributes[ name ];\r\n\r\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tattributes.update( array[ i ], 34962 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateWireframeAttribute( geometry ) {\r\n\r\n\t\t\tvar indices = [];\r\n\r\n\t\t\tvar geometryIndex = geometry.index;\r\n\t\t\tvar geometryPosition = geometry.attributes.position;\r\n\t\t\tvar version = 0;\r\n\r\n\t\t\tif ( geometryIndex !== null ) {\r\n\r\n\t\t\t\tvar array = geometryIndex.array;\r\n\t\t\t\tversion = geometryIndex.version;\r\n\r\n\t\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\r\n\r\n\t\t\t\t\tvar a = array[ i + 0 ];\r\n\t\t\t\t\tvar b = array[ i + 1 ];\r\n\t\t\t\t\tvar c = array[ i + 2 ];\r\n\r\n\t\t\t\t\tindices.push( a, b, b, c, c, a );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar array = geometryPosition.array;\r\n\t\t\t\tversion = geometryPosition.version;\r\n\r\n\t\t\t\tfor ( var i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\r\n\r\n\t\t\t\t\tvar a = i + 0;\r\n\t\t\t\t\tvar b = i + 1;\r\n\t\t\t\t\tvar c = i + 2;\r\n\r\n\t\t\t\t\tindices.push( a, b, b, c, c, a );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attribute = new ( arrayMax( indices ) > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 );\r\n\t\t\tattribute.version = version;\r\n\r\n\t\t\tattributes.update( attribute, 34963 );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar previousAttribute = wireframeAttributes.get( geometry );\r\n\r\n\t\t\tif ( previousAttribute ) { attributes.remove( previousAttribute ); }\r\n\r\n\t\t\t//\r\n\r\n\t\t\twireframeAttributes.set( geometry, attribute );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getWireframeAttribute( geometry ) {\r\n\r\n\t\t\tvar currentAttribute = wireframeAttributes.get( geometry );\r\n\r\n\t\t\tif ( currentAttribute ) {\r\n\r\n\t\t\t\tvar geometryIndex = geometry.index;\r\n\r\n\t\t\t\tif ( geometryIndex !== null ) {\r\n\r\n\t\t\t\t\t// if the attribute is obsolete, create a new one\r\n\r\n\t\t\t\t\tif ( currentAttribute.version < geometryIndex.version ) {\r\n\r\n\t\t\t\t\t\tupdateWireframeAttribute( geometry );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tupdateWireframeAttribute( geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn wireframeAttributes.get( geometry );\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tget: get,\r\n\t\t\tupdate: update,\r\n\r\n\t\t\tgetWireframeAttribute: getWireframeAttribute\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLIndexedBufferRenderer( gl, extensions, info, capabilities ) {\r\n\r\n\t\tvar isWebGL2 = capabilities.isWebGL2;\r\n\r\n\t\tvar mode;\r\n\r\n\t\tfunction setMode( value ) {\r\n\r\n\t\t\tmode = value;\r\n\r\n\t\t}\r\n\r\n\t\tvar type, bytesPerElement;\r\n\r\n\t\tfunction setIndex( value ) {\r\n\r\n\t\t\ttype = value.type;\r\n\t\t\tbytesPerElement = value.bytesPerElement;\r\n\r\n\t\t}\r\n\r\n\t\tfunction render( start, count ) {\r\n\r\n\t\t\tgl.drawElements( mode, count, type, start * bytesPerElement );\r\n\r\n\t\t\tinfo.update( count, mode );\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderInstances( geometry, start, count, primcount ) {\r\n\r\n\t\t\tif ( primcount === 0 ) { return; }\r\n\r\n\t\t\tvar extension, methodName;\r\n\r\n\t\t\tif ( isWebGL2 ) {\r\n\r\n\t\t\t\textension = gl;\r\n\t\t\t\tmethodName = 'drawElementsInstanced';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\r\n\t\t\t\tmethodName = 'drawElementsInstancedANGLE';\r\n\r\n\t\t\t\tif ( extension === null ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\textension[ methodName ]( mode, count, type, start * bytesPerElement, primcount );\r\n\r\n\t\t\tinfo.update( count, mode, primcount );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tthis.setMode = setMode;\r\n\t\tthis.setIndex = setIndex;\r\n\t\tthis.render = render;\r\n\t\tthis.renderInstances = renderInstances;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction WebGLInfo( gl ) {\r\n\r\n\t\tvar memory = {\r\n\t\t\tgeometries: 0,\r\n\t\t\ttextures: 0\r\n\t\t};\r\n\r\n\t\tvar render = {\r\n\t\t\tframe: 0,\r\n\t\t\tcalls: 0,\r\n\t\t\ttriangles: 0,\r\n\t\t\tpoints: 0,\r\n\t\t\tlines: 0\r\n\t\t};\r\n\r\n\t\tfunction update( count, mode, instanceCount ) {\r\n\r\n\t\t\tinstanceCount = instanceCount || 1;\r\n\r\n\t\t\trender.calls ++;\r\n\r\n\t\t\tswitch ( mode ) {\r\n\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\trender.triangles += instanceCount * ( count / 3 );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\trender.lines += instanceCount * ( count / 2 );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\trender.lines += instanceCount * ( count - 1 );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\trender.lines += instanceCount * count;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\trender.points += instanceCount * count;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.error( 'THREE.WebGLInfo: Unknown draw mode:', mode );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction reset() {\r\n\r\n\t\t\trender.frame ++;\r\n\t\t\trender.calls = 0;\r\n\t\t\trender.triangles = 0;\r\n\t\t\trender.points = 0;\r\n\t\t\trender.lines = 0;\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tmemory: memory,\r\n\t\t\trender: render,\r\n\t\t\tprograms: null,\r\n\t\t\tautoReset: true,\r\n\t\t\treset: reset,\r\n\t\t\tupdate: update\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction absNumericalSort( a, b ) {\r\n\r\n\t\treturn Math.abs( b[ 1 ] ) - Math.abs( a[ 1 ] );\r\n\r\n\t}\r\n\r\n\tfunction WebGLMorphtargets( gl ) {\r\n\r\n\t\tvar influencesList = {};\r\n\t\tvar morphInfluences = new Float32Array( 8 );\r\n\r\n\t\tfunction update( object, geometry, material, program ) {\r\n\r\n\t\t\tvar objectInfluences = object.morphTargetInfluences;\r\n\r\n\t\t\t// When object doesn't have morph target influences defined, we treat it as a 0-length array\r\n\t\t\t// This is important to make sure we set up morphTargetBaseInfluence / morphTargetInfluences\r\n\r\n\t\t\tvar length = objectInfluences === undefined ? 0 : objectInfluences.length;\r\n\r\n\t\t\tvar influences = influencesList[ geometry.id ];\r\n\r\n\t\t\tif ( influences === undefined ) {\r\n\r\n\t\t\t\t// initialise list\r\n\r\n\t\t\t\tinfluences = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\t\tinfluences[ i ] = [ i, 0 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tinfluencesList[ geometry.id ] = influences;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphTargets = material.morphTargets && geometry.morphAttributes.position;\r\n\t\t\tvar morphNormals = material.morphNormals && geometry.morphAttributes.normal;\r\n\r\n\t\t\t// Remove current morphAttributes\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tvar influence = influences[ i ];\r\n\r\n\t\t\t\tif ( influence[ 1 ] !== 0 ) {\r\n\r\n\t\t\t\t\tif ( morphTargets ) { geometry.deleteAttribute( 'morphTarget' + i ); }\r\n\t\t\t\t\tif ( morphNormals ) { geometry.deleteAttribute( 'morphNormal' + i ); }\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Collect influences\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\r\n\t\t\t\tvar influence = influences[ i ];\r\n\r\n\t\t\t\tinfluence[ 0 ] = i;\r\n\t\t\t\tinfluence[ 1 ] = objectInfluences[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tinfluences.sort( absNumericalSort );\r\n\r\n\t\t\t// Add morphAttributes\r\n\r\n\t\t\tvar morphInfluencesSum = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < 8; i ++ ) {\r\n\r\n\t\t\t\tvar influence = influences[ i ];\r\n\r\n\t\t\t\tif ( influence ) {\r\n\r\n\t\t\t\t\tvar index = influence[ 0 ];\r\n\t\t\t\t\tvar value = influence[ 1 ];\r\n\r\n\t\t\t\t\tif ( value ) {\r\n\r\n\t\t\t\t\t\tif ( morphTargets ) { geometry.setAttribute( 'morphTarget' + i, morphTargets[ index ] ); }\r\n\t\t\t\t\t\tif ( morphNormals ) { geometry.setAttribute( 'morphNormal' + i, morphNormals[ index ] ); }\r\n\r\n\t\t\t\t\t\tmorphInfluences[ i ] = value;\r\n\t\t\t\t\t\tmorphInfluencesSum += value;\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmorphInfluences[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// GLSL shader uses formula baseinfluence * base + sum(target * influence)\r\n\t\t\t// This allows us to switch between absolute morphs and relative morphs without changing shader code\r\n\t\t\t// When baseinfluence = 1 - sum(influence), the above is equivalent to sum((target - base) * influence)\r\n\t\t\tvar morphBaseInfluence = geometry.morphTargetsRelative ? 1 : 1 - morphInfluencesSum;\r\n\r\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetBaseInfluence', morphBaseInfluence );\r\n\t\t\tprogram.getUniforms().setValue( gl, 'morphTargetInfluences', morphInfluences );\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tupdate: update\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLObjects( gl, geometries, attributes, info ) {\r\n\r\n\t\tvar updateMap = new WeakMap();\r\n\r\n\t\tfunction update( object ) {\r\n\r\n\t\t\tvar frame = info.render.frame;\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\t\t\tvar buffergeometry = geometries.get( object, geometry );\r\n\r\n\t\t\t// Update once per frame\r\n\r\n\t\t\tif ( updateMap.get( buffergeometry ) !== frame ) {\r\n\r\n\t\t\t\tif ( geometry.isGeometry ) {\r\n\r\n\t\t\t\t\tbuffergeometry.updateFromObject( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometries.update( buffergeometry );\r\n\r\n\t\t\t\tupdateMap.set( buffergeometry, frame );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.isInstancedMesh ) {\r\n\r\n\t\t\t\tattributes.update( object.instanceMatrix, 34962 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn buffergeometry;\r\n\r\n\t\t}\r\n\r\n\t\tfunction dispose() {\r\n\r\n\t\t\tupdateMap = new WeakMap();\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tupdate: update,\r\n\t\t\tdispose: dispose\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction CubeTexture( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding ) {\r\n\r\n\t\timages = images !== undefined ? images : [];\r\n\t\tmapping = mapping !== undefined ? mapping : CubeReflectionMapping;\r\n\t\tformat = format !== undefined ? format : RGBFormat;\r\n\r\n\t\tTexture.call( this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\t\tthis.flipY = false;\r\n\r\n\t}\r\n\r\n\tCubeTexture.prototype = Object.create( Texture.prototype );\r\n\tCubeTexture.prototype.constructor = CubeTexture;\r\n\r\n\tCubeTexture.prototype.isCubeTexture = true;\r\n\r\n\tObject.defineProperty( CubeTexture.prototype, 'images', {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\treturn this.image;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tthis.image = value;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author Takahiro https://github.com/takahirox\r\n\t */\r\n\r\n\tfunction DataTexture2DArray( data, width, height, depth ) {\r\n\r\n\t\tTexture.call( this, null );\r\n\r\n\t\tthis.image = { data: data || null, width: width || 1, height: height || 1, depth: depth || 1 };\r\n\r\n\t\tthis.magFilter = NearestFilter;\r\n\t\tthis.minFilter = NearestFilter;\r\n\r\n\t\tthis.wrapR = ClampToEdgeWrapping;\r\n\r\n\t\tthis.generateMipmaps = false;\r\n\t\tthis.flipY = false;\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\tDataTexture2DArray.prototype = Object.create( Texture.prototype );\r\n\tDataTexture2DArray.prototype.constructor = DataTexture2DArray;\r\n\tDataTexture2DArray.prototype.isDataTexture2DArray = true;\r\n\r\n\t/**\r\n\t * @author Artur Trzesiok\r\n\t */\r\n\r\n\tfunction DataTexture3D( data, width, height, depth ) {\r\n\r\n\t\t// We're going to add .setXXX() methods for setting properties later.\r\n\t\t// Users can still set in DataTexture3D directly.\r\n\t\t//\r\n\t\t//\tvar texture = new THREE.DataTexture3D( data, width, height, depth );\r\n\t\t// \ttexture.anisotropy = 16;\r\n\t\t//\r\n\t\t// See #14839\r\n\r\n\t\tTexture.call( this, null );\r\n\r\n\t\tthis.image = { data: data || null, width: width || 1, height: height || 1, depth: depth || 1 };\r\n\r\n\t\tthis.magFilter = NearestFilter;\r\n\t\tthis.minFilter = NearestFilter;\r\n\r\n\t\tthis.wrapR = ClampToEdgeWrapping;\r\n\r\n\t\tthis.generateMipmaps = false;\r\n\t\tthis.flipY = false;\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\r\n\t}\r\n\r\n\tDataTexture3D.prototype = Object.create( Texture.prototype );\r\n\tDataTexture3D.prototype.constructor = DataTexture3D;\r\n\tDataTexture3D.prototype.isDataTexture3D = true;\r\n\r\n\t/**\r\n\t * @author tschw\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t *\r\n\t * Uniforms of a program.\r\n\t * Those form a tree structure with a special top-level container for the root,\r\n\t * which you get by calling 'new WebGLUniforms( gl, program )'.\r\n\t *\r\n\t *\r\n\t * Properties of inner nodes including the top-level container:\r\n\t *\r\n\t * .seq - array of nested uniforms\r\n\t * .map - nested uniforms by name\r\n\t *\r\n\t *\r\n\t * Methods of all nodes except the top-level container:\r\n\t *\r\n\t * .setValue( gl, value, [textures] )\r\n\t *\r\n\t * \t\tuploads a uniform value(s)\r\n\t *  \tthe 'textures' parameter is needed for sampler uniforms\r\n\t *\r\n\t *\r\n\t * Static methods of the top-level container (textures factorizations):\r\n\t *\r\n\t * .upload( gl, seq, values, textures )\r\n\t *\r\n\t * \t\tsets uniforms in 'seq' to 'values[id].value'\r\n\t *\r\n\t * .seqWithValue( seq, values ) : filteredSeq\r\n\t *\r\n\t * \t\tfilters 'seq' entries with corresponding entry in values\r\n\t *\r\n\t *\r\n\t * Methods of the top-level container (textures factorizations):\r\n\t *\r\n\t * .setValue( gl, name, value, textures )\r\n\t *\r\n\t * \t\tsets uniform with  name 'name' to 'value'\r\n\t *\r\n\t * .setOptional( gl, obj, prop )\r\n\t *\r\n\t * \t\tlike .set for an optional property of the object\r\n\t *\r\n\t */\r\n\r\n\tvar emptyTexture = new Texture();\r\n\tvar emptyTexture2dArray = new DataTexture2DArray();\r\n\tvar emptyTexture3d = new DataTexture3D();\r\n\tvar emptyCubeTexture = new CubeTexture();\r\n\r\n\t// --- Utilities ---\r\n\r\n\t// Array Caches (provide typed arrays for temporary by size)\r\n\r\n\tvar arrayCacheF32 = [];\r\n\tvar arrayCacheI32 = [];\r\n\r\n\t// Float32Array caches used for uploading Matrix uniforms\r\n\r\n\tvar mat4array = new Float32Array( 16 );\r\n\tvar mat3array = new Float32Array( 9 );\r\n\tvar mat2array = new Float32Array( 4 );\r\n\r\n\t// Flattening for arrays of vectors and matrices\r\n\r\n\tfunction flatten( array, nBlocks, blockSize ) {\r\n\r\n\t\tvar firstElem = array[ 0 ];\r\n\r\n\t\tif ( firstElem <= 0 || firstElem > 0 ) { return array; }\r\n\t\t// unoptimized: ! isNaN( firstElem )\r\n\t\t// see http://jacksondunstan.com/articles/983\r\n\r\n\t\tvar n = nBlocks * blockSize,\r\n\t\t\tr = arrayCacheF32[ n ];\r\n\r\n\t\tif ( r === undefined ) {\r\n\r\n\t\t\tr = new Float32Array( n );\r\n\t\t\tarrayCacheF32[ n ] = r;\r\n\r\n\t\t}\r\n\r\n\t\tif ( nBlocks !== 0 ) {\r\n\r\n\t\t\tfirstElem.toArray( r, 0 );\r\n\r\n\t\t\tfor ( var i = 1, offset = 0; i !== nBlocks; ++ i ) {\r\n\r\n\t\t\t\toffset += blockSize;\r\n\t\t\t\tarray[ i ].toArray( r, offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn r;\r\n\r\n\t}\r\n\r\n\tfunction arraysEqual( a, b ) {\r\n\r\n\t\tif ( a.length !== b.length ) { return false; }\r\n\r\n\t\tfor ( var i = 0, l = a.length; i < l; i ++ ) {\r\n\r\n\t\t\tif ( a[ i ] !== b[ i ] ) { return false; }\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\tfunction copyArray( a, b ) {\r\n\r\n\t\tfor ( var i = 0, l = b.length; i < l; i ++ ) {\r\n\r\n\t\t\ta[ i ] = b[ i ];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Texture unit allocation\r\n\r\n\tfunction allocTexUnits( textures, n ) {\r\n\r\n\t\tvar r = arrayCacheI32[ n ];\r\n\r\n\t\tif ( r === undefined ) {\r\n\r\n\t\t\tr = new Int32Array( n );\r\n\t\t\tarrayCacheI32[ n ] = r;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i !== n; ++ i )\r\n\t\t\t{ r[ i ] = textures.allocateTextureUnit(); }\r\n\r\n\t\treturn r;\r\n\r\n\t}\r\n\r\n\t// --- Setters ---\r\n\r\n\t// Note: Defining these methods externally, because they come in a bunch\r\n\t// and this way their names minify.\r\n\r\n\t// Single scalar\r\n\r\n\tfunction setValueV1f( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( cache[ 0 ] === v ) { return; }\r\n\r\n\t\tgl.uniform1f( this.addr, v );\r\n\r\n\t\tcache[ 0 ] = v;\r\n\r\n\t}\r\n\r\n\t// Single float vector (from flat array or THREE.VectorN)\r\n\r\n\tfunction setValueV2f( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( v.x !== undefined ) {\r\n\r\n\t\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y ) {\r\n\r\n\t\t\t\tgl.uniform2f( this.addr, v.x, v.y );\r\n\r\n\t\t\t\tcache[ 0 ] = v.x;\r\n\t\t\t\tcache[ 1 ] = v.y;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) { return; }\r\n\r\n\t\t\tgl.uniform2fv( this.addr, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValueV3f( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( v.x !== undefined ) {\r\n\r\n\t\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z ) {\r\n\r\n\t\t\t\tgl.uniform3f( this.addr, v.x, v.y, v.z );\r\n\r\n\t\t\t\tcache[ 0 ] = v.x;\r\n\t\t\t\tcache[ 1 ] = v.y;\r\n\t\t\t\tcache[ 2 ] = v.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( v.r !== undefined ) {\r\n\r\n\t\t\tif ( cache[ 0 ] !== v.r || cache[ 1 ] !== v.g || cache[ 2 ] !== v.b ) {\r\n\r\n\t\t\t\tgl.uniform3f( this.addr, v.r, v.g, v.b );\r\n\r\n\t\t\t\tcache[ 0 ] = v.r;\r\n\t\t\t\tcache[ 1 ] = v.g;\r\n\t\t\t\tcache[ 2 ] = v.b;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) { return; }\r\n\r\n\t\t\tgl.uniform3fv( this.addr, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValueV4f( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( v.x !== undefined ) {\r\n\r\n\t\t\tif ( cache[ 0 ] !== v.x || cache[ 1 ] !== v.y || cache[ 2 ] !== v.z || cache[ 3 ] !== v.w ) {\r\n\r\n\t\t\t\tgl.uniform4f( this.addr, v.x, v.y, v.z, v.w );\r\n\r\n\t\t\t\tcache[ 0 ] = v.x;\r\n\t\t\t\tcache[ 1 ] = v.y;\r\n\t\t\t\tcache[ 2 ] = v.z;\r\n\t\t\t\tcache[ 3 ] = v.w;\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) { return; }\r\n\r\n\t\t\tgl.uniform4fv( this.addr, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Single matrix (from flat array or MatrixN)\r\n\r\n\tfunction setValueM2( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar elements = v.elements;\r\n\r\n\t\tif ( elements === undefined ) {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) { return; }\r\n\r\n\t\t\tgl.uniformMatrix2fv( this.addr, false, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, elements ) ) { return; }\r\n\r\n\t\t\tmat2array.set( elements );\r\n\r\n\t\t\tgl.uniformMatrix2fv( this.addr, false, mat2array );\r\n\r\n\t\t\tcopyArray( cache, elements );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValueM3( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar elements = v.elements;\r\n\r\n\t\tif ( elements === undefined ) {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) { return; }\r\n\r\n\t\t\tgl.uniformMatrix3fv( this.addr, false, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, elements ) ) { return; }\r\n\r\n\t\t\tmat3array.set( elements );\r\n\r\n\t\t\tgl.uniformMatrix3fv( this.addr, false, mat3array );\r\n\r\n\t\t\tcopyArray( cache, elements );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValueM4( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar elements = v.elements;\r\n\r\n\t\tif ( elements === undefined ) {\r\n\r\n\t\t\tif ( arraysEqual( cache, v ) ) { return; }\r\n\r\n\t\t\tgl.uniformMatrix4fv( this.addr, false, v );\r\n\r\n\t\t\tcopyArray( cache, v );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( arraysEqual( cache, elements ) ) { return; }\r\n\r\n\t\t\tmat4array.set( elements );\r\n\r\n\t\t\tgl.uniformMatrix4fv( this.addr, false, mat4array );\r\n\r\n\t\t\tcopyArray( cache, elements );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Single texture (2D / Cube)\r\n\r\n\tfunction setValueT1( gl, v, textures ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar unit = textures.allocateTextureUnit();\r\n\r\n\t\tif ( cache[ 0 ] !== unit ) {\r\n\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tcache[ 0 ] = unit;\r\n\r\n\t\t}\r\n\r\n\t\ttextures.safeSetTexture2D( v || emptyTexture, unit );\r\n\r\n\t}\r\n\r\n\tfunction setValueT2DArray1( gl, v, textures ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar unit = textures.allocateTextureUnit();\r\n\r\n\t\tif ( cache[ 0 ] !== unit ) {\r\n\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tcache[ 0 ] = unit;\r\n\r\n\t\t}\r\n\r\n\t\ttextures.setTexture2DArray( v || emptyTexture2dArray, unit );\r\n\r\n\t}\r\n\r\n\tfunction setValueT3D1( gl, v, textures ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar unit = textures.allocateTextureUnit();\r\n\r\n\t\tif ( cache[ 0 ] !== unit ) {\r\n\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tcache[ 0 ] = unit;\r\n\r\n\t\t}\r\n\r\n\t\ttextures.setTexture3D( v || emptyTexture3d, unit );\r\n\r\n\t}\r\n\r\n\tfunction setValueT6( gl, v, textures ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\t\tvar unit = textures.allocateTextureUnit();\r\n\r\n\t\tif ( cache[ 0 ] !== unit ) {\r\n\r\n\t\t\tgl.uniform1i( this.addr, unit );\r\n\t\t\tcache[ 0 ] = unit;\r\n\r\n\t\t}\r\n\r\n\t\ttextures.safeSetTextureCube( v || emptyCubeTexture, unit );\r\n\r\n\t}\r\n\r\n\t// Integer / Boolean vectors or arrays thereof (always flat arrays)\r\n\r\n\tfunction setValueV1i( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( cache[ 0 ] === v ) { return; }\r\n\r\n\t\tgl.uniform1i( this.addr, v );\r\n\r\n\t\tcache[ 0 ] = v;\r\n\r\n\t}\r\n\r\n\tfunction setValueV2i( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( arraysEqual( cache, v ) ) { return; }\r\n\r\n\t\tgl.uniform2iv( this.addr, v );\r\n\r\n\t\tcopyArray( cache, v );\r\n\r\n\t}\r\n\r\n\tfunction setValueV3i( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( arraysEqual( cache, v ) ) { return; }\r\n\r\n\t\tgl.uniform3iv( this.addr, v );\r\n\r\n\t\tcopyArray( cache, v );\r\n\r\n\t}\r\n\r\n\tfunction setValueV4i( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( arraysEqual( cache, v ) ) { return; }\r\n\r\n\t\tgl.uniform4iv( this.addr, v );\r\n\r\n\t\tcopyArray( cache, v );\r\n\r\n\t}\r\n\r\n\t// uint\r\n\r\n\tfunction setValueV1ui( gl, v ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( cache[ 0 ] === v ) { return; }\r\n\r\n\t\tgl.uniform1ui( this.addr, v );\r\n\r\n\t\tcache[ 0 ] = v;\r\n\r\n\t}\r\n\r\n\t// Helper to pick the right setter for the singular case\r\n\r\n\tfunction getSingularSetter( type ) {\r\n\r\n\t\tswitch ( type ) {\r\n\r\n\t\t\tcase 0x1406: return setValueV1f; // FLOAT\r\n\t\t\tcase 0x8b50: return setValueV2f; // _VEC2\r\n\t\t\tcase 0x8b51: return setValueV3f; // _VEC3\r\n\t\t\tcase 0x8b52: return setValueV4f; // _VEC4\r\n\r\n\t\t\tcase 0x8b5a: return setValueM2; // _MAT2\r\n\t\t\tcase 0x8b5b: return setValueM3; // _MAT3\r\n\t\t\tcase 0x8b5c: return setValueM4; // _MAT4\r\n\r\n\t\t\tcase 0x1404: case 0x8b56: return setValueV1i; // INT, BOOL\r\n\t\t\tcase 0x8b53: case 0x8b57: return setValueV2i; // _VEC2\r\n\t\t\tcase 0x8b54: case 0x8b58: return setValueV3i; // _VEC3\r\n\t\t\tcase 0x8b55: case 0x8b59: return setValueV4i; // _VEC4\r\n\r\n\t\t\tcase 0x1405: return setValueV1ui; // UINT\r\n\r\n\t\t\tcase 0x8b5e: // SAMPLER_2D\r\n\t\t\tcase 0x8d66: // SAMPLER_EXTERNAL_OES\r\n\t\t\tcase 0x8dca: // INT_SAMPLER_2D\r\n\t\t\tcase 0x8dd2: // UNSIGNED_INT_SAMPLER_2D\r\n\t\t\tcase 0x8b62: // SAMPLER_2D_SHADOW\r\n\t\t\t\treturn setValueT1;\r\n\r\n\t\t\tcase 0x8b5f: // SAMPLER_3D\r\n\t\t\tcase 0x8dcb: // INT_SAMPLER_3D\r\n\t\t\tcase 0x8dd3: // UNSIGNED_INT_SAMPLER_3D\r\n\t\t\t\treturn setValueT3D1;\r\n\r\n\t\t\tcase 0x8b60: // SAMPLER_CUBE\r\n\t\t\tcase 0x8dcc: // INT_SAMPLER_CUBE\r\n\t\t\tcase 0x8dd4: // UNSIGNED_INT_SAMPLER_CUBE\r\n\t\t\tcase 0x8dc5: // SAMPLER_CUBE_SHADOW\r\n\t\t\t\treturn setValueT6;\r\n\r\n\t\t\tcase 0x8dc1: // SAMPLER_2D_ARRAY\r\n\t\t\tcase 0x8dcf: // INT_SAMPLER_2D_ARRAY\r\n\t\t\tcase 0x8dd7: // UNSIGNED_INT_SAMPLER_2D_ARRAY\r\n\t\t\tcase 0x8dc4: // SAMPLER_2D_ARRAY_SHADOW\r\n\t\t\t\treturn setValueT2DArray1;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Array of scalars\r\n\tfunction setValueV1fArray( gl, v ) {\r\n\r\n\t\tgl.uniform1fv( this.addr, v );\r\n\r\n\t}\r\n\r\n\t// Integer / Boolean vectors or arrays thereof (always flat arrays)\r\n\tfunction setValueV1iArray( gl, v ) {\r\n\r\n\t\tgl.uniform1iv( this.addr, v );\r\n\r\n\t}\r\n\r\n\tfunction setValueV2iArray( gl, v ) {\r\n\r\n\t\tgl.uniform2iv( this.addr, v );\r\n\r\n\t}\r\n\r\n\tfunction setValueV3iArray( gl, v ) {\r\n\r\n\t\tgl.uniform3iv( this.addr, v );\r\n\r\n\t}\r\n\r\n\tfunction setValueV4iArray( gl, v ) {\r\n\r\n\t\tgl.uniform4iv( this.addr, v );\r\n\r\n\t}\r\n\r\n\r\n\t// Array of vectors (flat or from THREE classes)\r\n\r\n\tfunction setValueV2fArray( gl, v ) {\r\n\r\n\t\tvar data = flatten( v, this.size, 2 );\r\n\r\n\t\tgl.uniform2fv( this.addr, data );\r\n\r\n\t}\r\n\r\n\tfunction setValueV3fArray( gl, v ) {\r\n\r\n\t\tvar data = flatten( v, this.size, 3 );\r\n\r\n\t\tgl.uniform3fv( this.addr, data );\r\n\r\n\t}\r\n\r\n\tfunction setValueV4fArray( gl, v ) {\r\n\r\n\t\tvar data = flatten( v, this.size, 4 );\r\n\r\n\t\tgl.uniform4fv( this.addr, data );\r\n\r\n\t}\r\n\r\n\t// Array of matrices (flat or from THREE clases)\r\n\r\n\tfunction setValueM2Array( gl, v ) {\r\n\r\n\t\tvar data = flatten( v, this.size, 4 );\r\n\r\n\t\tgl.uniformMatrix2fv( this.addr, false, data );\r\n\r\n\t}\r\n\r\n\tfunction setValueM3Array( gl, v ) {\r\n\r\n\t\tvar data = flatten( v, this.size, 9 );\r\n\r\n\t\tgl.uniformMatrix3fv( this.addr, false, data );\r\n\r\n\t}\r\n\r\n\tfunction setValueM4Array( gl, v ) {\r\n\r\n\t\tvar data = flatten( v, this.size, 16 );\r\n\r\n\t\tgl.uniformMatrix4fv( this.addr, false, data );\r\n\r\n\t}\r\n\r\n\t// Array of textures (2D / Cube)\r\n\r\n\tfunction setValueT1Array( gl, v, textures ) {\r\n\r\n\t\tvar n = v.length;\r\n\r\n\t\tvar units = allocTexUnits( textures, n );\r\n\r\n\t\tgl.uniform1iv( this.addr, units );\r\n\r\n\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\ttextures.safeSetTexture2D( v[ i ] || emptyTexture, units[ i ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction setValueT6Array( gl, v, textures ) {\r\n\r\n\t\tvar n = v.length;\r\n\r\n\t\tvar units = allocTexUnits( textures, n );\r\n\r\n\t\tgl.uniform1iv( this.addr, units );\r\n\r\n\t\tfor ( var i = 0; i !== n; ++ i ) {\r\n\r\n\t\t\ttextures.safeSetTextureCube( v[ i ] || emptyCubeTexture, units[ i ] );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Helper to pick the right setter for a pure (bottom-level) array\r\n\r\n\tfunction getPureArraySetter( type ) {\r\n\r\n\t\tswitch ( type ) {\r\n\r\n\t\t\tcase 0x1406: return setValueV1fArray; // FLOAT\r\n\t\t\tcase 0x8b50: return setValueV2fArray; // _VEC2\r\n\t\t\tcase 0x8b51: return setValueV3fArray; // _VEC3\r\n\t\t\tcase 0x8b52: return setValueV4fArray; // _VEC4\r\n\r\n\t\t\tcase 0x8b5a: return setValueM2Array; // _MAT2\r\n\t\t\tcase 0x8b5b: return setValueM3Array; // _MAT3\r\n\t\t\tcase 0x8b5c: return setValueM4Array; // _MAT4\r\n\r\n\t\t\tcase 0x1404: case 0x8b56: return setValueV1iArray; // INT, BOOL\r\n\t\t\tcase 0x8b53: case 0x8b57: return setValueV2iArray; // _VEC2\r\n\t\t\tcase 0x8b54: case 0x8b58: return setValueV3iArray; // _VEC3\r\n\t\t\tcase 0x8b55: case 0x8b59: return setValueV4iArray; // _VEC4\r\n\r\n\t\t\tcase 0x8b5e: // SAMPLER_2D\r\n\t\t\tcase 0x8d66: // SAMPLER_EXTERNAL_OES\r\n\t\t\tcase 0x8dca: // INT_SAMPLER_2D\r\n\t\t\tcase 0x8dd2: // UNSIGNED_INT_SAMPLER_2D\r\n\t\t\tcase 0x8b62: // SAMPLER_2D_SHADOW\r\n\t\t\t\treturn setValueT1Array;\r\n\r\n\t\t\tcase 0x8b60: // SAMPLER_CUBE\r\n\t\t\tcase 0x8dcc: // INT_SAMPLER_CUBE\r\n\t\t\tcase 0x8dd4: // UNSIGNED_INT_SAMPLER_CUBE\r\n\t\t\tcase 0x8dc5: // SAMPLER_CUBE_SHADOW\r\n\t\t\t\treturn setValueT6Array;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// --- Uniform Classes ---\r\n\r\n\tfunction SingleUniform( id, activeInfo, addr ) {\r\n\r\n\t\tthis.id = id;\r\n\t\tthis.addr = addr;\r\n\t\tthis.cache = [];\r\n\t\tthis.setValue = getSingularSetter( activeInfo.type );\r\n\r\n\t\t// this.path = activeInfo.name; // DEBUG\r\n\r\n\t}\r\n\r\n\tfunction PureArrayUniform( id, activeInfo, addr ) {\r\n\r\n\t\tthis.id = id;\r\n\t\tthis.addr = addr;\r\n\t\tthis.cache = [];\r\n\t\tthis.size = activeInfo.size;\r\n\t\tthis.setValue = getPureArraySetter( activeInfo.type );\r\n\r\n\t\t// this.path = activeInfo.name; // DEBUG\r\n\r\n\t}\r\n\r\n\tPureArrayUniform.prototype.updateCache = function ( data ) {\r\n\r\n\t\tvar cache = this.cache;\r\n\r\n\t\tif ( data instanceof Float32Array && cache.length !== data.length ) {\r\n\r\n\t\t\tthis.cache = new Float32Array( data.length );\r\n\r\n\t\t}\r\n\r\n\t\tcopyArray( cache, data );\r\n\r\n\t};\r\n\r\n\tfunction StructuredUniform( id ) {\r\n\r\n\t\tthis.id = id;\r\n\r\n\t\tthis.seq = [];\r\n\t\tthis.map = {};\r\n\r\n\t}\r\n\r\n\tStructuredUniform.prototype.setValue = function ( gl, value, textures ) {\r\n\r\n\t\tvar seq = this.seq;\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ];\r\n\t\t\tu.setValue( gl, value[ u.id ], textures );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// --- Top-level ---\r\n\r\n\t// Parser - builds up the property tree from the path strings\r\n\r\n\tvar RePathPart = /([\\w\\d_]+)(\\])?(\\[|\\.)?/g;\r\n\r\n\t// extracts\r\n\t// \t- the identifier (member name or array index)\r\n\t//  - followed by an optional right bracket (found when array index)\r\n\t//  - followed by an optional left bracket or dot (type of subscript)\r\n\t//\r\n\t// Note: These portions can be read in a non-overlapping fashion and\r\n\t// allow straightforward parsing of the hierarchy that WebGL encodes\r\n\t// in the uniform names.\r\n\r\n\tfunction addUniform( container, uniformObject ) {\r\n\r\n\t\tcontainer.seq.push( uniformObject );\r\n\t\tcontainer.map[ uniformObject.id ] = uniformObject;\r\n\r\n\t}\r\n\r\n\tfunction parseUniform( activeInfo, addr, container ) {\r\n\r\n\t\tvar path = activeInfo.name,\r\n\t\t\tpathLength = path.length;\r\n\r\n\t\t// reset RegExp object, because of the early exit of a previous run\r\n\t\tRePathPart.lastIndex = 0;\r\n\r\n\t\twhile ( true ) {\r\n\r\n\t\t\tvar match = RePathPart.exec( path ),\r\n\t\t\t\tmatchEnd = RePathPart.lastIndex,\r\n\r\n\t\t\t\tid = match[ 1 ],\r\n\t\t\t\tidIsIndex = match[ 2 ] === ']',\r\n\t\t\t\tsubscript = match[ 3 ];\r\n\r\n\t\t\tif ( idIsIndex ) { id = id | 0; } // convert to integer\r\n\r\n\t\t\tif ( subscript === undefined || subscript === '[' && matchEnd + 2 === pathLength ) {\r\n\r\n\t\t\t\t// bare name or \"pure\" bottom-level array \"[0]\" suffix\r\n\r\n\t\t\t\taddUniform( container, subscript === undefined ?\r\n\t\t\t\t\tnew SingleUniform( id, activeInfo, addr ) :\r\n\t\t\t\t\tnew PureArrayUniform( id, activeInfo, addr ) );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// step into inner node / create it in case it doesn't exist\r\n\r\n\t\t\t\tvar map = container.map, next = map[ id ];\r\n\r\n\t\t\t\tif ( next === undefined ) {\r\n\r\n\t\t\t\t\tnext = new StructuredUniform( id );\r\n\t\t\t\t\taddUniform( container, next );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontainer = next;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// Root Container\r\n\r\n\tfunction WebGLUniforms( gl, program ) {\r\n\r\n\t\tthis.seq = [];\r\n\t\tthis.map = {};\r\n\r\n\t\tvar n = gl.getProgramParameter( program, 35718 );\r\n\r\n\t\tfor ( var i = 0; i < n; ++ i ) {\r\n\r\n\t\t\tvar info = gl.getActiveUniform( program, i ),\r\n\t\t\t\taddr = gl.getUniformLocation( program, info.name );\r\n\r\n\t\t\tparseUniform( info, addr, this );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tWebGLUniforms.prototype.setValue = function ( gl, name, value, textures ) {\r\n\r\n\t\tvar u = this.map[ name ];\r\n\r\n\t\tif ( u !== undefined ) { u.setValue( gl, value, textures ); }\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.prototype.setOptional = function ( gl, object, name ) {\r\n\r\n\t\tvar v = object[ name ];\r\n\r\n\t\tif ( v !== undefined ) { this.setValue( gl, name, v ); }\r\n\r\n\t};\r\n\r\n\r\n\t// Static interface\r\n\r\n\tWebGLUniforms.upload = function ( gl, seq, values, textures ) {\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ],\r\n\t\t\t\tv = values[ u.id ];\r\n\r\n\t\t\tif ( v.needsUpdate !== false ) {\r\n\r\n\t\t\t\t// note: always updating when .needsUpdate is undefined\r\n\t\t\t\tu.setValue( gl, v.value, textures );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tWebGLUniforms.seqWithValue = function ( seq, values ) {\r\n\r\n\t\tvar r = [];\r\n\r\n\t\tfor ( var i = 0, n = seq.length; i !== n; ++ i ) {\r\n\r\n\t\t\tvar u = seq[ i ];\r\n\t\t\tif ( u.id in values ) { r.push( u ); }\r\n\r\n\t\t}\r\n\r\n\t\treturn r;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLShader( gl, type, string ) {\r\n\r\n\t\tvar shader = gl.createShader( type );\r\n\r\n\t\tgl.shaderSource( shader, string );\r\n\t\tgl.compileShader( shader );\r\n\r\n\t\treturn shader;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar programIdCount = 0;\r\n\r\n\tfunction addLineNumbers( string ) {\r\n\r\n\t\tvar lines = string.split( '\\n' );\r\n\r\n\t\tfor ( var i = 0; i < lines.length; i ++ ) {\r\n\r\n\t\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn lines.join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction getEncodingComponents( encoding ) {\r\n\r\n\t\tswitch ( encoding ) {\r\n\r\n\t\t\tcase LinearEncoding:\r\n\t\t\t\treturn [ 'Linear', '( value )' ];\r\n\t\t\tcase sRGBEncoding:\r\n\t\t\t\treturn [ 'sRGB', '( value )' ];\r\n\t\t\tcase RGBEEncoding:\r\n\t\t\t\treturn [ 'RGBE', '( value )' ];\r\n\t\t\tcase RGBM7Encoding:\r\n\t\t\t\treturn [ 'RGBM', '( value, 7.0 )' ];\r\n\t\t\tcase RGBM16Encoding:\r\n\t\t\t\treturn [ 'RGBM', '( value, 16.0 )' ];\r\n\t\t\tcase RGBDEncoding:\r\n\t\t\t\treturn [ 'RGBD', '( value, 256.0 )' ];\r\n\t\t\tcase GammaEncoding:\r\n\t\t\t\treturn [ 'Gamma', '( value, float( GAMMA_FACTOR ) )' ];\r\n\t\t\tcase LogLuvEncoding:\r\n\t\t\t\treturn [ 'LogLuv', '( value )' ];\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error( 'unsupported encoding: ' + encoding );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getShaderErrors( gl, shader, type ) {\r\n\r\n\t\tvar status = gl.getShaderParameter( shader, 35713 );\r\n\t\tvar log = gl.getShaderInfoLog( shader ).trim();\r\n\r\n\t\tif ( status && log === '' ) { return ''; }\r\n\r\n\t\t// --enable-privileged-webgl-extension\r\n\t\t// console.log( '**' + type + '**', gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\r\n\r\n\t\tvar source = gl.getShaderSource( shader );\r\n\r\n\t\treturn 'THREE.WebGLShader: gl.getShaderInfoLog() ' + type + '\\n' + log + addLineNumbers( source );\r\n\r\n\t}\r\n\r\n\tfunction getTexelDecodingFunction( functionName, encoding ) {\r\n\r\n\t\tvar components = getEncodingComponents( encoding );\r\n\t\treturn 'vec4 ' + functionName + '( vec4 value ) { return ' + components[ 0 ] + 'ToLinear' + components[ 1 ] + '; }';\r\n\r\n\t}\r\n\r\n\tfunction getTexelEncodingFunction( functionName, encoding ) {\r\n\r\n\t\tvar components = getEncodingComponents( encoding );\r\n\t\treturn 'vec4 ' + functionName + '( vec4 value ) { return LinearTo' + components[ 0 ] + components[ 1 ] + '; }';\r\n\r\n\t}\r\n\r\n\tfunction getToneMappingFunction( functionName, toneMapping ) {\r\n\r\n\t\tvar toneMappingName;\r\n\r\n\t\tswitch ( toneMapping ) {\r\n\r\n\t\t\tcase LinearToneMapping:\r\n\t\t\t\ttoneMappingName = 'Linear';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ReinhardToneMapping:\r\n\t\t\t\ttoneMappingName = 'Reinhard';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase Uncharted2ToneMapping:\r\n\t\t\t\ttoneMappingName = 'Uncharted2';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase CineonToneMapping:\r\n\t\t\t\ttoneMappingName = 'OptimizedCineon';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ACESFilmicToneMapping:\r\n\t\t\t\ttoneMappingName = 'ACESFilmic';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error( 'unsupported toneMapping: ' + toneMapping );\r\n\r\n\t\t}\r\n\r\n\t\treturn 'vec3 ' + functionName + '( vec3 color ) { return ' + toneMappingName + 'ToneMapping( color ); }';\r\n\r\n\t}\r\n\r\n\tfunction generateExtensions( parameters ) {\r\n\r\n\t\tvar chunks = [\r\n\t\t\t( parameters.extensionDerivatives || parameters.envMapCubeUV || parameters.bumpMap || parameters.tangentSpaceNormalMap || parameters.clearcoatNormalMap || parameters.flatShading || parameters.shaderID === 'physical' ) ? '#extension GL_OES_standard_derivatives : enable' : '',\r\n\t\t\t( parameters.extensionFragDepth || parameters.logarithmicDepthBuffer ) && parameters.rendererExtensionFragDepth ? '#extension GL_EXT_frag_depth : enable' : '',\r\n\t\t\t( parameters.extensionDrawBuffers && parameters.rendererExtensionDrawBuffers ) ? '#extension GL_EXT_draw_buffers : require' : '',\r\n\t\t\t( parameters.extensionShaderTextureLOD || parameters.envMap ) && parameters.rendererExtensionShaderTextureLod ? '#extension GL_EXT_shader_texture_lod : enable' : ''\r\n\t\t];\r\n\r\n\t\treturn chunks.filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction generateDefines( defines ) {\r\n\r\n\t\tvar chunks = [];\r\n\r\n\t\tfor ( var name in defines ) {\r\n\r\n\t\t\tvar value = defines[ name ];\r\n\r\n\t\t\tif ( value === false ) { continue; }\r\n\r\n\t\t\tchunks.push( '#define ' + name + ' ' + value );\r\n\r\n\t\t}\r\n\r\n\t\treturn chunks.join( '\\n' );\r\n\r\n\t}\r\n\r\n\tfunction fetchAttributeLocations( gl, program ) {\r\n\r\n\t\tvar attributes = {};\r\n\r\n\t\tvar n = gl.getProgramParameter( program, 35721 );\r\n\r\n\t\tfor ( var i = 0; i < n; i ++ ) {\r\n\r\n\t\t\tvar info = gl.getActiveAttrib( program, i );\r\n\t\t\tvar name = info.name;\r\n\r\n\t\t\t// console.log( 'THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:', name, i );\r\n\r\n\t\t\tattributes[ name ] = gl.getAttribLocation( program, name );\r\n\r\n\t\t}\r\n\r\n\t\treturn attributes;\r\n\r\n\t}\r\n\r\n\tfunction filterEmptyLine( string ) {\r\n\r\n\t\treturn string !== '';\r\n\r\n\t}\r\n\r\n\tfunction replaceLightNums( string, parameters ) {\r\n\r\n\t\treturn string\r\n\t\t\t.replace( /NUM_DIR_LIGHTS/g, parameters.numDirLights )\r\n\t\t\t.replace( /NUM_SPOT_LIGHTS/g, parameters.numSpotLights )\r\n\t\t\t.replace( /NUM_RECT_AREA_LIGHTS/g, parameters.numRectAreaLights )\r\n\t\t\t.replace( /NUM_POINT_LIGHTS/g, parameters.numPointLights )\r\n\t\t\t.replace( /NUM_HEMI_LIGHTS/g, parameters.numHemiLights )\r\n\t\t\t.replace( /NUM_DIR_LIGHT_SHADOWS/g, parameters.numDirLightShadows )\r\n\t\t\t.replace( /NUM_SPOT_LIGHT_SHADOWS/g, parameters.numSpotLightShadows )\r\n\t\t\t.replace( /NUM_POINT_LIGHT_SHADOWS/g, parameters.numPointLightShadows );\r\n\r\n\t}\r\n\r\n\tfunction replaceClippingPlaneNums( string, parameters ) {\r\n\r\n\t\treturn string\r\n\t\t\t.replace( /NUM_CLIPPING_PLANES/g, parameters.numClippingPlanes )\r\n\t\t\t.replace( /UNION_CLIPPING_PLANES/g, ( parameters.numClippingPlanes - parameters.numClipIntersection ) );\r\n\r\n\t}\r\n\r\n\t// Resolve Includes\r\n\r\n\tvar includePattern = /^[ \\t]*#include +<([\\w\\d./]+)>/gm;\r\n\r\n\tfunction resolveIncludes( string ) {\r\n\r\n\t\treturn string.replace( includePattern, includeReplacer );\r\n\r\n\t}\r\n\r\n\tfunction includeReplacer( match, include ) {\r\n\r\n\t\tvar string = ShaderChunk[ include ];\r\n\r\n\t\tif ( string === undefined ) {\r\n\r\n\t\t\tthrow new Error( 'Can not resolve #include <' + include + '>' );\r\n\r\n\t\t}\r\n\r\n\t\treturn resolveIncludes( string );\r\n\r\n\t}\r\n\r\n\t// Unroll Loops\r\n\r\n\tvar deprecatedUnrollLoopPattern = /#pragma unroll_loop[\\s]+?for \\( int i \\= (\\d+)\\; i < (\\d+)\\; i \\+\\+ \\) \\{([\\s\\S]+?)(?=\\})\\}/g;\r\n\tvar unrollLoopPattern = /#pragma unroll_loop_start[\\s]+?for \\( int i \\= (\\d+)\\; i < (\\d+)\\; i \\+\\+ \\) \\{([\\s\\S]+?)(?=\\})\\}[\\s]+?#pragma unroll_loop_end/g;\r\n\r\n\tfunction unrollLoops( string ) {\r\n\r\n\t\treturn string\r\n\t\t\t.replace( unrollLoopPattern, loopReplacer )\r\n\t\t\t.replace( deprecatedUnrollLoopPattern, deprecatedLoopReplacer );\r\n\r\n\t}\r\n\r\n\tfunction deprecatedLoopReplacer( match, start, end, snippet ) {\r\n\r\n\t\tconsole.warn( 'WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead.' );\r\n\t\treturn loopReplacer( match, start, end, snippet );\r\n\r\n\t}\r\n\r\n\tfunction loopReplacer( match, start, end, snippet ) {\r\n\r\n\t\tvar string = '';\r\n\r\n\t\tfor ( var i = parseInt( start ); i < parseInt( end ); i ++ ) {\r\n\r\n\t\t\tstring += snippet\r\n\t\t\t\t.replace( /\\[ i \\]/g, '[ ' + i + ' ]' )\r\n\t\t\t\t.replace( /UNROLLED_LOOP_INDEX/g, i );\r\n\r\n\t\t}\r\n\r\n\t\treturn string;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction generatePrecision( parameters ) {\r\n\r\n\t\tvar precisionstring = \"precision \" + parameters.precision + \" float;\\nprecision \" + parameters.precision + \" int;\";\r\n\r\n\t\tif ( parameters.precision === \"highp\" ) {\r\n\r\n\t\t\tprecisionstring += \"\\n#define HIGH_PRECISION\";\r\n\r\n\t\t} else if ( parameters.precision === \"mediump\" ) {\r\n\r\n\t\t\tprecisionstring += \"\\n#define MEDIUM_PRECISION\";\r\n\r\n\t\t} else if ( parameters.precision === \"lowp\" ) {\r\n\r\n\t\t\tprecisionstring += \"\\n#define LOW_PRECISION\";\r\n\r\n\t\t}\r\n\r\n\t\treturn precisionstring;\r\n\r\n\t}\r\n\r\n\tfunction generateShadowMapTypeDefine( parameters ) {\r\n\r\n\t\tvar shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\r\n\r\n\t\tif ( parameters.shadowMapType === PCFShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\r\n\r\n\t\t} else if ( parameters.shadowMapType === PCFSoftShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\r\n\r\n\t\t} else if ( parameters.shadowMapType === VSMShadowMap ) {\r\n\r\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_VSM';\r\n\r\n\t\t}\r\n\r\n\t\treturn shadowMapTypeDefine;\r\n\r\n\t}\r\n\r\n\tfunction generateEnvMapTypeDefine( parameters ) {\r\n\r\n\t\tvar envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\r\n\t\tif ( parameters.envMap ) {\r\n\r\n\t\t\tswitch ( parameters.envMapMode ) {\r\n\r\n\t\t\t\tcase CubeReflectionMapping:\r\n\t\t\t\tcase CubeRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase CubeUVReflectionMapping:\r\n\t\t\t\tcase CubeUVRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE_UV';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase EquirectangularReflectionMapping:\r\n\t\t\t\tcase EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase SphericalReflectionMapping:\r\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn envMapTypeDefine;\r\n\r\n\t}\r\n\r\n\tfunction generateEnvMapModeDefine( parameters ) {\r\n\r\n\t\tvar envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\r\n\r\n\t\tif ( parameters.envMap ) {\r\n\r\n\t\t\tswitch ( parameters.envMapMode ) {\r\n\r\n\t\t\t\tcase CubeRefractionMapping:\r\n\t\t\t\tcase EquirectangularRefractionMapping:\r\n\t\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn envMapModeDefine;\r\n\r\n\t}\r\n\r\n\tfunction generateEnvMapBlendingDefine( parameters ) {\r\n\r\n\t\tvar envMapBlendingDefine = 'ENVMAP_BLENDING_NONE';\r\n\r\n\t\tif ( parameters.envMap ) {\r\n\r\n\t\t\tswitch ( parameters.combine ) {\r\n\r\n\t\t\t\tcase MultiplyOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase MixOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase AddOperation:\r\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn envMapBlendingDefine;\r\n\r\n\t}\r\n\r\n\tfunction WebGLProgram( renderer, cacheKey, parameters ) {\r\n\r\n\t\tvar gl = renderer.getContext();\r\n\r\n\t\tvar defines = parameters.defines;\r\n\r\n\t\tvar vertexShader = parameters.vertexShader;\r\n\t\tvar fragmentShader = parameters.fragmentShader;\r\n\t\tvar shadowMapTypeDefine = generateShadowMapTypeDefine( parameters );\r\n\t\tvar envMapTypeDefine = generateEnvMapTypeDefine( parameters );\r\n\t\tvar envMapModeDefine = generateEnvMapModeDefine( parameters );\r\n\t\tvar envMapBlendingDefine = generateEnvMapBlendingDefine( parameters );\r\n\r\n\r\n\t\tvar gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\r\n\r\n\t\tvar customExtensions = parameters.isWebGL2 ? '' : generateExtensions( parameters );\r\n\r\n\t\tvar customDefines = generateDefines( defines );\r\n\r\n\t\tvar program = gl.createProgram();\r\n\r\n\t\tvar prefixVertex, prefixFragment;\r\n\r\n\t\tif ( parameters.isRawShaderMaterial ) {\r\n\r\n\t\t\tprefixVertex = [\r\n\r\n\t\t\t\tcustomDefines\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t\tif ( prefixVertex.length > 0 ) {\r\n\r\n\t\t\t\tprefixVertex += '\\n';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprefixFragment = [\r\n\r\n\t\t\t\tcustomExtensions,\r\n\t\t\t\tcustomDefines\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t\tif ( prefixFragment.length > 0 ) {\r\n\r\n\t\t\t\tprefixFragment += '\\n';\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tprefixVertex = [\r\n\r\n\t\t\t\tgeneratePrecision( parameters ),\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + parameters.shaderName,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.instancing ? '#define USE_INSTANCING' : '',\r\n\t\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\r\n\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t'#define MAX_BONES ' + parameters.maxBones,\r\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\r\n\t\t\t\t( parameters.useFog && parameters.fogExp2 ) ? '#define FOG_EXP2' : '',\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\r\n\t\t\t\t( parameters.normalMap && parameters.tangentSpaceNormalMap ) ? '#define TANGENTSPACE_NORMALMAP' : '',\r\n\r\n\t\t\t\tparameters.clearcoatMap ? '#define USE_CLEARCOATMAP' : '',\r\n\t\t\t\tparameters.clearcoatRoughnessMap ? '#define USE_CLEARCOAT_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.clearcoatNormalMap ? '#define USE_CLEARCOAT_NORMALMAP' : '',\r\n\t\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\r\n\t\t\t\tparameters.vertexTangents ? '#define USE_TANGENT' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\t\t\t\tparameters.vertexUvs ? '#define USE_UV' : '',\r\n\t\t\t\tparameters.uvsVertexOnly ? '#define UVS_VERTEX_ONLY' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\r\n\t\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\r\n\r\n\t\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\r\n\t\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\r\n\t\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\t( parameters.logarithmicDepthBuffer && parameters.rendererExtensionFragDepth ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 modelMatrix;',\r\n\t\t\t\t'uniform mat4 modelViewMatrix;',\r\n\t\t\t\t'uniform mat4 projectionMatrix;',\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform mat3 normalMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\t\t\t\t'uniform bool isOrthographic;',\r\n\r\n\t\t\t\t'#ifdef USE_INSTANCING',\r\n\r\n\t\t\t\t' attribute mat4 instanceMatrix;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'attribute vec3 position;',\r\n\t\t\t\t'attribute vec3 normal;',\r\n\t\t\t\t'attribute vec2 uv;',\r\n\r\n\t\t\t\t'#ifdef USE_TANGENT',\r\n\r\n\t\t\t\t'\tattribute vec4 tangent;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_COLOR',\r\n\r\n\t\t\t\t'\tattribute vec3 color;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_MORPHTARGETS',\r\n\r\n\t\t\t\t'\tattribute vec3 morphTarget0;',\r\n\t\t\t\t'\tattribute vec3 morphTarget1;',\r\n\t\t\t\t'\tattribute vec3 morphTarget2;',\r\n\t\t\t\t'\tattribute vec3 morphTarget3;',\r\n\r\n\t\t\t\t'\t#ifdef USE_MORPHNORMALS',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphNormal0;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal1;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal2;',\r\n\t\t\t\t'\t\tattribute vec3 morphNormal3;',\r\n\r\n\t\t\t\t'\t#else',\r\n\r\n\t\t\t\t'\t\tattribute vec3 morphTarget4;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget5;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget6;',\r\n\t\t\t\t'\t\tattribute vec3 morphTarget7;',\r\n\r\n\t\t\t\t'\t#endif',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'#ifdef USE_SKINNING',\r\n\r\n\t\t\t\t'\tattribute vec4 skinIndex;',\r\n\t\t\t\t'\tattribute vec4 skinWeight;',\r\n\r\n\t\t\t\t'#endif',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t\tprefixFragment = [\r\n\r\n\t\t\t\tcustomExtensions,\r\n\r\n\t\t\t\tgeneratePrecision( parameters ),\r\n\r\n\t\t\t\t'#define SHADER_NAME ' + parameters.shaderName,\r\n\r\n\t\t\t\tcustomDefines,\r\n\r\n\t\t\t\tparameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest + ( parameters.alphaTest % 1 ? '' : '.0' ) : '', // add '.0' if integer\r\n\r\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\r\n\r\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\r\n\t\t\t\t( parameters.useFog && parameters.fogExp2 ) ? '#define FOG_EXP2' : '',\r\n\r\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\r\n\t\t\t\tparameters.matcap ? '#define USE_MATCAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\r\n\t\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\r\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\r\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\r\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\r\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\r\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\r\n\t\t\t\t( parameters.normalMap && parameters.objectSpaceNormalMap ) ? '#define OBJECTSPACE_NORMALMAP' : '',\r\n\t\t\t\t( parameters.normalMap && parameters.tangentSpaceNormalMap ) ? '#define TANGENTSPACE_NORMALMAP' : '',\r\n\t\t\t\tparameters.clearcoatMap ? '#define USE_CLEARCOATMAP' : '',\r\n\t\t\t\tparameters.clearcoatRoughnessMap ? '#define USE_CLEARCOAT_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.clearcoatNormalMap ? '#define USE_CLEARCOAT_NORMALMAP' : '',\r\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\r\n\t\t\t\tparameters.roughnessMap ? '#define USE_ROUGHNESSMAP' : '',\r\n\t\t\t\tparameters.metalnessMap ? '#define USE_METALNESSMAP' : '',\r\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\r\n\r\n\t\t\t\tparameters.sheen ? '#define USE_SHEEN' : '',\r\n\r\n\t\t\t\tparameters.vertexTangents ? '#define USE_TANGENT' : '',\r\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\r\n\t\t\t\tparameters.vertexUvs ? '#define USE_UV' : '',\r\n\t\t\t\tparameters.uvsVertexOnly ? '#define UVS_VERTEX_ONLY' : '',\r\n\r\n\t\t\t\tparameters.gradientMap ? '#define USE_GRADIENTMAP' : '',\r\n\r\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\r\n\r\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\r\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\r\n\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\r\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\r\n\r\n\t\t\t\tparameters.premultipliedAlpha ? '#define PREMULTIPLIED_ALPHA' : '',\r\n\r\n\t\t\t\tparameters.physicallyCorrectLights ? '#define PHYSICALLY_CORRECT_LIGHTS' : '',\r\n\r\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\r\n\t\t\t\t( parameters.logarithmicDepthBuffer && parameters.rendererExtensionFragDepth ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\r\n\r\n\t\t\t\t( ( parameters.extensionShaderTextureLOD || parameters.envMap ) && parameters.rendererExtensionShaderTextureLod ) ? '#define TEXTURE_LOD_EXT' : '',\r\n\r\n\t\t\t\t'uniform mat4 viewMatrix;',\r\n\t\t\t\t'uniform vec3 cameraPosition;',\r\n\t\t\t\t'uniform bool isOrthographic;',\r\n\r\n\t\t\t\t( parameters.toneMapping !== NoToneMapping ) ? '#define TONE_MAPPING' : '',\r\n\t\t\t\t( parameters.toneMapping !== NoToneMapping ) ? ShaderChunk[ 'tonemapping_pars_fragment' ] : '', // this code is required here because it is used by the toneMapping() function defined below\r\n\t\t\t\t( parameters.toneMapping !== NoToneMapping ) ? getToneMappingFunction( 'toneMapping', parameters.toneMapping ) : '',\r\n\r\n\t\t\t\tparameters.dithering ? '#define DITHERING' : '',\r\n\r\n\t\t\t\t( parameters.outputEncoding || parameters.mapEncoding || parameters.matcapEncoding || parameters.envMapEncoding || parameters.emissiveMapEncoding || parameters.lightMapEncoding ) ?\r\n\t\t\t\t\tShaderChunk[ 'encodings_pars_fragment' ] : '', // this code is required here because it is used by the various encoding/decoding function defined below\r\n\t\t\t\tparameters.mapEncoding ? getTexelDecodingFunction( 'mapTexelToLinear', parameters.mapEncoding ) : '',\r\n\t\t\t\tparameters.matcapEncoding ? getTexelDecodingFunction( 'matcapTexelToLinear', parameters.matcapEncoding ) : '',\r\n\t\t\t\tparameters.envMapEncoding ? getTexelDecodingFunction( 'envMapTexelToLinear', parameters.envMapEncoding ) : '',\r\n\t\t\t\tparameters.emissiveMapEncoding ? getTexelDecodingFunction( 'emissiveMapTexelToLinear', parameters.emissiveMapEncoding ) : '',\r\n\t\t\t\tparameters.lightMapEncoding ? getTexelDecodingFunction( 'lightMapTexelToLinear', parameters.lightMapEncoding ) : '',\r\n\t\t\t\tparameters.outputEncoding ? getTexelEncodingFunction( 'linearToOutputTexel', parameters.outputEncoding ) : '',\r\n\r\n\t\t\t\tparameters.depthPacking ? '#define DEPTH_PACKING ' + parameters.depthPacking : '',\r\n\r\n\t\t\t\t'\\n'\r\n\r\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\r\n\r\n\t\t}\r\n\r\n\t\tvertexShader = resolveIncludes( vertexShader );\r\n\t\tvertexShader = replaceLightNums( vertexShader, parameters );\r\n\t\tvertexShader = replaceClippingPlaneNums( vertexShader, parameters );\r\n\r\n\t\tfragmentShader = resolveIncludes( fragmentShader );\r\n\t\tfragmentShader = replaceLightNums( fragmentShader, parameters );\r\n\t\tfragmentShader = replaceClippingPlaneNums( fragmentShader, parameters );\r\n\r\n\t\tvertexShader = unrollLoops( vertexShader );\r\n\t\tfragmentShader = unrollLoops( fragmentShader );\r\n\r\n\t\tif ( parameters.isWebGL2 && ! parameters.isRawShaderMaterial ) {\r\n\r\n\t\t\tvar isGLSL3ShaderMaterial = false;\r\n\r\n\t\t\tvar versionRegex = /^\\s*#version\\s+300\\s+es\\s*\\n/;\r\n\r\n\t\t\tif ( parameters.isShaderMaterial &&\r\n\t\t\t\tvertexShader.match( versionRegex ) !== null &&\r\n\t\t\t\tfragmentShader.match( versionRegex ) !== null ) {\r\n\r\n\t\t\t\tisGLSL3ShaderMaterial = true;\r\n\r\n\t\t\t\tvertexShader = vertexShader.replace( versionRegex, '' );\r\n\t\t\t\tfragmentShader = fragmentShader.replace( versionRegex, '' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// GLSL 3.0 conversion\r\n\r\n\t\t\tprefixVertex = [\r\n\t\t\t\t'#version 300 es\\n',\r\n\t\t\t\t'#define attribute in',\r\n\t\t\t\t'#define varying out',\r\n\t\t\t\t'#define texture2D texture'\r\n\t\t\t].join( '\\n' ) + '\\n' + prefixVertex;\r\n\r\n\t\t\tprefixFragment = [\r\n\t\t\t\t'#version 300 es\\n',\r\n\t\t\t\t'#define varying in',\r\n\t\t\t\tisGLSL3ShaderMaterial ? '' : 'out highp vec4 pc_fragColor;',\r\n\t\t\t\tisGLSL3ShaderMaterial ? '' : '#define gl_FragColor pc_fragColor',\r\n\t\t\t\t'#define gl_FragDepthEXT gl_FragDepth',\r\n\t\t\t\t'#define texture2D texture',\r\n\t\t\t\t'#define textureCube texture',\r\n\t\t\t\t'#define texture2DProj textureProj',\r\n\t\t\t\t'#define texture2DLodEXT textureLod',\r\n\t\t\t\t'#define texture2DProjLodEXT textureProjLod',\r\n\t\t\t\t'#define textureCubeLodEXT textureLod',\r\n\t\t\t\t'#define texture2DGradEXT textureGrad',\r\n\t\t\t\t'#define texture2DProjGradEXT textureProjGrad',\r\n\t\t\t\t'#define textureCubeGradEXT textureGrad'\r\n\t\t\t].join( '\\n' ) + '\\n' + prefixFragment;\r\n\r\n\t\t}\r\n\r\n\t\tvar vertexGlsl = prefixVertex + vertexShader;\r\n\t\tvar fragmentGlsl = prefixFragment + fragmentShader;\r\n\r\n\t\t// console.log( '*VERTEX*', vertexGlsl );\r\n\t\t// console.log( '*FRAGMENT*', fragmentGlsl );\r\n\r\n\t\tvar glVertexShader = WebGLShader( gl, 35633, vertexGlsl );\r\n\t\tvar glFragmentShader = WebGLShader( gl, 35632, fragmentGlsl );\r\n\r\n\t\tgl.attachShader( program, glVertexShader );\r\n\t\tgl.attachShader( program, glFragmentShader );\r\n\r\n\t\t// Force a particular attribute to index 0.\r\n\r\n\t\tif ( parameters.index0AttributeName !== undefined ) {\r\n\r\n\t\t\tgl.bindAttribLocation( program, 0, parameters.index0AttributeName );\r\n\r\n\t\t} else if ( parameters.morphTargets === true ) {\r\n\r\n\t\t\t// programs with morphTargets displace position out of attribute 0\r\n\t\t\tgl.bindAttribLocation( program, 0, 'position' );\r\n\r\n\t\t}\r\n\r\n\t\tgl.linkProgram( program );\r\n\r\n\t\t// check for link errors\r\n\t\tif ( renderer.debug.checkShaderErrors ) {\r\n\r\n\t\t\tvar programLog = gl.getProgramInfoLog( program ).trim();\r\n\t\t\tvar vertexLog = gl.getShaderInfoLog( glVertexShader ).trim();\r\n\t\t\tvar fragmentLog = gl.getShaderInfoLog( glFragmentShader ).trim();\r\n\r\n\t\t\tvar runnable = true;\r\n\t\t\tvar haveDiagnostics = true;\r\n\r\n\t\t\tif ( gl.getProgramParameter( program, 35714 ) === false ) {\r\n\r\n\t\t\t\trunnable = false;\r\n\r\n\t\t\t\tvar vertexErrors = getShaderErrors( gl, glVertexShader, 'vertex' );\r\n\t\t\t\tvar fragmentErrors = getShaderErrors( gl, glFragmentShader, 'fragment' );\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLProgram: shader error: ', gl.getError(), '35715', gl.getProgramParameter( program, 35715 ), 'gl.getProgramInfoLog', programLog, vertexErrors, fragmentErrors );\r\n\r\n\t\t\t} else if ( programLog !== '' ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLProgram: gl.getProgramInfoLog()', programLog );\r\n\r\n\t\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\r\n\r\n\t\t\t\thaveDiagnostics = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( haveDiagnostics ) {\r\n\r\n\t\t\t\tthis.diagnostics = {\r\n\r\n\t\t\t\t\trunnable: runnable,\r\n\r\n\t\t\t\t\tprogramLog: programLog,\r\n\r\n\t\t\t\t\tvertexShader: {\r\n\r\n\t\t\t\t\t\tlog: vertexLog,\r\n\t\t\t\t\t\tprefix: prefixVertex\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tfragmentShader: {\r\n\r\n\t\t\t\t\t\tlog: fragmentLog,\r\n\t\t\t\t\t\tprefix: prefixFragment\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// clean up\r\n\r\n\t\tgl.detachShader( program, glVertexShader );\r\n\t\tgl.detachShader( program, glFragmentShader );\r\n\r\n\t\tgl.deleteShader( glVertexShader );\r\n\t\tgl.deleteShader( glFragmentShader );\r\n\r\n\t\t// set up caching for uniform locations\r\n\r\n\t\tvar cachedUniforms;\r\n\r\n\t\tthis.getUniforms = function () {\r\n\r\n\t\t\tif ( cachedUniforms === undefined ) {\r\n\r\n\t\t\t\tcachedUniforms = new WebGLUniforms( gl, program );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedUniforms;\r\n\r\n\t\t};\r\n\r\n\t\t// set up caching for attribute locations\r\n\r\n\t\tvar cachedAttributes;\r\n\r\n\t\tthis.getAttributes = function () {\r\n\r\n\t\t\tif ( cachedAttributes === undefined ) {\r\n\r\n\t\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn cachedAttributes;\r\n\r\n\t\t};\r\n\r\n\t\t// free resource\r\n\r\n\t\tthis.destroy = function () {\r\n\r\n\t\t\tgl.deleteProgram( program );\r\n\t\t\tthis.program = undefined;\r\n\r\n\t\t};\r\n\r\n\t\t//\r\n\r\n\t\tthis.name = parameters.shaderName;\r\n\t\tthis.id = programIdCount ++;\r\n\t\tthis.cacheKey = cacheKey;\r\n\t\tthis.usedTimes = 1;\r\n\t\tthis.program = program;\r\n\t\tthis.vertexShader = glVertexShader;\r\n\t\tthis.fragmentShader = glFragmentShader;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLPrograms( renderer, extensions, capabilities ) {\r\n\r\n\t\tvar programs = [];\r\n\r\n\t\tvar isWebGL2 = capabilities.isWebGL2;\r\n\t\tvar logarithmicDepthBuffer = capabilities.logarithmicDepthBuffer;\r\n\t\tvar floatVertexTextures = capabilities.floatVertexTextures;\r\n\t\tvar precision = capabilities.precision;\r\n\t\tvar maxVertexUniforms = capabilities.maxVertexUniforms;\r\n\t\tvar vertexTextures = capabilities.vertexTextures;\r\n\r\n\t\tvar shaderIDs = {\r\n\t\t\tMeshDepthMaterial: 'depth',\r\n\t\t\tMeshDistanceMaterial: 'distanceRGBA',\r\n\t\t\tMeshNormalMaterial: 'normal',\r\n\t\t\tMeshBasicMaterial: 'basic',\r\n\t\t\tMeshLambertMaterial: 'lambert',\r\n\t\t\tMeshPhongMaterial: 'phong',\r\n\t\t\tMeshToonMaterial: 'toon',\r\n\t\t\tMeshStandardMaterial: 'physical',\r\n\t\t\tMeshPhysicalMaterial: 'physical',\r\n\t\t\tMeshMatcapMaterial: 'matcap',\r\n\t\t\tLineBasicMaterial: 'basic',\r\n\t\t\tLineDashedMaterial: 'dashed',\r\n\t\t\tPointsMaterial: 'points',\r\n\t\t\tShadowMaterial: 'shadow',\r\n\t\t\tSpriteMaterial: 'sprite'\r\n\t\t};\r\n\r\n\t\tvar parameterNames = [\r\n\t\t\t\"precision\", \"isWebGL2\", \"supportsVertexTextures\", \"outputEncoding\", \"instancing\",\r\n\t\t\t\"map\", \"mapEncoding\", \"matcap\", \"matcapEncoding\", \"envMap\", \"envMapMode\", \"envMapEncoding\", \"envMapCubeUV\",\r\n\t\t\t\"lightMap\", \"lightMapEncoding\", \"aoMap\", \"emissiveMap\", \"emissiveMapEncoding\", \"bumpMap\", \"normalMap\", \"objectSpaceNormalMap\", \"tangentSpaceNormalMap\", \"clearcoatMap\", \"clearcoatRoughnessMap\", \"clearcoatNormalMap\", \"displacementMap\", \"specularMap\",\r\n\t\t\t\"roughnessMap\", \"metalnessMap\", \"gradientMap\",\r\n\t\t\t\"alphaMap\", \"combine\", \"vertexColors\", \"vertexTangents\", \"vertexUvs\", \"uvsVertexOnly\", \"fog\", \"useFog\", \"fogExp2\",\r\n\t\t\t\"flatShading\", \"sizeAttenuation\", \"logarithmicDepthBuffer\", \"skinning\",\r\n\t\t\t\"maxBones\", \"useVertexTexture\", \"morphTargets\", \"morphNormals\",\r\n\t\t\t\"maxMorphTargets\", \"maxMorphNormals\", \"premultipliedAlpha\",\r\n\t\t\t\"numDirLights\", \"numPointLights\", \"numSpotLights\", \"numHemiLights\", \"numRectAreaLights\",\r\n\t\t\t\"numDirLightShadows\", \"numPointLightShadows\", \"numSpotLightShadows\",\r\n\t\t\t\"shadowMapEnabled\", \"shadowMapType\", \"toneMapping\", 'physicallyCorrectLights',\r\n\t\t\t\"alphaTest\", \"doubleSided\", \"flipSided\", \"numClippingPlanes\", \"numClipIntersection\", \"depthPacking\", \"dithering\",\r\n\t\t\t\"sheen\"\r\n\t\t];\r\n\r\n\t\tfunction getShaderObject( material, shaderID ) {\r\n\r\n\t\t\tvar shaderobject;\r\n\r\n\t\t\tif ( shaderID ) {\r\n\r\n\t\t\t\tvar shader = ShaderLib[ shaderID ];\r\n\r\n\t\t\t\tshaderobject = {\r\n\t\t\t\t\tname: material.type,\r\n\t\t\t\t\tuniforms: UniformsUtils.clone( shader.uniforms ),\r\n\t\t\t\t\tvertexShader: shader.vertexShader,\r\n\t\t\t\t\tfragmentShader: shader.fragmentShader\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tshaderobject = {\r\n\t\t\t\t\tname: material.type,\r\n\t\t\t\t\tuniforms: material.uniforms,\r\n\t\t\t\t\tvertexShader: material.vertexShader,\r\n\t\t\t\t\tfragmentShader: material.fragmentShader\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn shaderobject;\r\n\r\n\t\t}\r\n\r\n\t\tfunction allocateBones( object ) {\r\n\r\n\t\t\tvar skeleton = object.skeleton;\r\n\t\t\tvar bones = skeleton.bones;\r\n\r\n\t\t\tif ( floatVertexTextures ) {\r\n\r\n\t\t\t\treturn 1024;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// default for when object is not specified\r\n\t\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\r\n\t\t\t\t//\r\n\t\t\t\t//  - leave some extra space for other uniforms\r\n\t\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\r\n\t\t\t\t//    (up to 54 should be safe)\r\n\r\n\t\t\t\tvar nVertexUniforms = maxVertexUniforms;\r\n\t\t\t\tvar nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\r\n\r\n\t\t\t\tvar maxBones = Math.min( nVertexMatrices, bones.length );\r\n\r\n\t\t\t\tif ( maxBones < bones.length ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Skeleton has ' + bones.length + ' bones. This GPU supports ' + maxBones + '.' );\r\n\t\t\t\t\treturn 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn maxBones;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getTextureEncodingFromMap( map ) {\r\n\r\n\t\t\tvar encoding;\r\n\r\n\t\t\tif ( ! map ) {\r\n\r\n\t\t\t\tencoding = LinearEncoding;\r\n\r\n\t\t\t} else if ( map.isTexture ) {\r\n\r\n\t\t\t\tencoding = map.encoding;\r\n\r\n\t\t\t} else if ( map.isWebGLRenderTarget ) {\r\n\r\n\t\t\t\tconsole.warn( \"THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead.\" );\r\n\t\t\t\tencoding = map.texture.encoding;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn encoding;\r\n\r\n\t\t}\r\n\r\n\t\tthis.getParameters = function ( material, lights, shadows, scene, nClipPlanes, nClipIntersection, object ) {\r\n\r\n\t\t\tvar fog = scene.fog;\r\n\t\t\tvar environment = material.isMeshStandardMaterial ? scene.environment : null;\r\n\r\n\t\t\tvar envMap = material.envMap || environment;\r\n\r\n\t\t\tvar shaderID = shaderIDs[ material.type ];\r\n\r\n\t\t\t// heuristics to create shader parameters according to lights in the scene\r\n\t\t\t// (not to blow over maxLights budget)\r\n\r\n\t\t\tvar maxBones = object.isSkinnedMesh ? allocateBones( object ) : 0;\r\n\r\n\t\t\tif ( material.precision !== null ) {\r\n\r\n\t\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\r\n\r\n\t\t\t\tif ( precision !== material.precision ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram.getParameters:', material.precision, 'not supported, using', precision, 'instead.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar shaderobject = getShaderObject( material, shaderID );\r\n\t\t\tmaterial.onBeforeCompile( shaderobject, renderer );\r\n\r\n\t\t\tvar currentRenderTarget = renderer.getRenderTarget();\r\n\r\n\t\t\tvar parameters = {\r\n\r\n\t\t\t\tisWebGL2: isWebGL2,\r\n\r\n\t\t\t\tshaderID: shaderID,\r\n\t\t\t\tshaderName: shaderobject.name,\r\n\r\n\t\t\t\tuniforms: shaderobject.uniforms,\r\n\t\t\t\tvertexShader: shaderobject.vertexShader,\r\n\t\t\t\tfragmentShader: shaderobject.fragmentShader,\r\n\t\t\t\tdefines: material.defines,\r\n\r\n\t\t\t\tisRawShaderMaterial: material.isRawShaderMaterial,\r\n\t\t\t\tisShaderMaterial: material.isShaderMaterial,\r\n\r\n\t\t\t\tprecision: precision,\r\n\r\n\t\t\t\tinstancing: object.isInstancedMesh === true,\r\n\r\n\t\t\t\tsupportsVertexTextures: vertexTextures,\r\n\t\t\t\toutputEncoding: ( currentRenderTarget !== null ) ? getTextureEncodingFromMap( currentRenderTarget.texture ) : renderer.outputEncoding,\r\n\t\t\t\tmap: !! material.map,\r\n\t\t\t\tmapEncoding: getTextureEncodingFromMap( material.map ),\r\n\t\t\t\tmatcap: !! material.matcap,\r\n\t\t\t\tmatcapEncoding: getTextureEncodingFromMap( material.matcap ),\r\n\t\t\t\tenvMap: !! envMap,\r\n\t\t\t\tenvMapMode: envMap && envMap.mapping,\r\n\t\t\t\tenvMapEncoding: getTextureEncodingFromMap( envMap ),\r\n\t\t\t\tenvMapCubeUV: ( !! envMap ) && ( ( envMap.mapping === CubeUVReflectionMapping ) || ( envMap.mapping === CubeUVRefractionMapping ) ),\r\n\t\t\t\tlightMap: !! material.lightMap,\r\n\t\t\t\tlightMapEncoding: getTextureEncodingFromMap( material.lightMap ),\r\n\t\t\t\taoMap: !! material.aoMap,\r\n\t\t\t\temissiveMap: !! material.emissiveMap,\r\n\t\t\t\temissiveMapEncoding: getTextureEncodingFromMap( material.emissiveMap ),\r\n\t\t\t\tbumpMap: !! material.bumpMap,\r\n\t\t\t\tnormalMap: !! material.normalMap,\r\n\t\t\t\tobjectSpaceNormalMap: material.normalMapType === ObjectSpaceNormalMap,\r\n\t\t\t\ttangentSpaceNormalMap: material.normalMapType === TangentSpaceNormalMap,\r\n\t\t\t\tclearcoatMap: !! material.clearcoatMap,\r\n\t\t\t\tclearcoatRoughnessMap: !! material.clearcoatRoughnessMap,\r\n\t\t\t\tclearcoatNormalMap: !! material.clearcoatNormalMap,\r\n\t\t\t\tdisplacementMap: !! material.displacementMap,\r\n\t\t\t\troughnessMap: !! material.roughnessMap,\r\n\t\t\t\tmetalnessMap: !! material.metalnessMap,\r\n\t\t\t\tspecularMap: !! material.specularMap,\r\n\t\t\t\talphaMap: !! material.alphaMap,\r\n\r\n\t\t\t\tgradientMap: !! material.gradientMap,\r\n\r\n\t\t\t\tsheen: !! material.sheen,\r\n\r\n\t\t\t\tcombine: material.combine,\r\n\r\n\t\t\t\tvertexTangents: ( material.normalMap && material.vertexTangents ),\r\n\t\t\t\tvertexColors: material.vertexColors,\r\n\t\t\t\tvertexUvs: !! material.map || !! material.bumpMap || !! material.normalMap || !! material.specularMap || !! material.alphaMap || !! material.emissiveMap || !! material.roughnessMap || !! material.metalnessMap || !! material.clearcoatMap || !! material.clearcoatRoughnessMap || !! material.clearcoatNormalMap || !! material.displacementMap,\r\n\t\t\t\tuvsVertexOnly: ! ( !! material.map || !! material.bumpMap || !! material.normalMap || !! material.specularMap || !! material.alphaMap || !! material.emissiveMap || !! material.roughnessMap || !! material.metalnessMap || !! material.clearcoatNormalMap ) && !! material.displacementMap,\r\n\r\n\t\t\t\tfog: !! fog,\r\n\t\t\t\tuseFog: material.fog,\r\n\t\t\t\tfogExp2: ( fog && fog.isFogExp2 ),\r\n\r\n\t\t\t\tflatShading: material.flatShading,\r\n\r\n\t\t\t\tsizeAttenuation: material.sizeAttenuation,\r\n\t\t\t\tlogarithmicDepthBuffer: logarithmicDepthBuffer,\r\n\r\n\t\t\t\tskinning: material.skinning && maxBones > 0,\r\n\t\t\t\tmaxBones: maxBones,\r\n\t\t\t\tuseVertexTexture: floatVertexTextures,\r\n\r\n\t\t\t\tmorphTargets: material.morphTargets,\r\n\t\t\t\tmorphNormals: material.morphNormals,\r\n\t\t\t\tmaxMorphTargets: renderer.maxMorphTargets,\r\n\t\t\t\tmaxMorphNormals: renderer.maxMorphNormals,\r\n\r\n\t\t\t\tnumDirLights: lights.directional.length,\r\n\t\t\t\tnumPointLights: lights.point.length,\r\n\t\t\t\tnumSpotLights: lights.spot.length,\r\n\t\t\t\tnumRectAreaLights: lights.rectArea.length,\r\n\t\t\t\tnumHemiLights: lights.hemi.length,\r\n\r\n\t\t\t\tnumDirLightShadows: lights.directionalShadowMap.length,\r\n\t\t\t\tnumPointLightShadows: lights.pointShadowMap.length,\r\n\t\t\t\tnumSpotLightShadows: lights.spotShadowMap.length,\r\n\r\n\t\t\t\tnumClippingPlanes: nClipPlanes,\r\n\t\t\t\tnumClipIntersection: nClipIntersection,\r\n\r\n\t\t\t\tdithering: material.dithering,\r\n\r\n\t\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && shadows.length > 0,\r\n\t\t\t\tshadowMapType: renderer.shadowMap.type,\r\n\r\n\t\t\t\ttoneMapping: material.toneMapped ? renderer.toneMapping : NoToneMapping,\r\n\t\t\t\tphysicallyCorrectLights: renderer.physicallyCorrectLights,\r\n\r\n\t\t\t\tpremultipliedAlpha: material.premultipliedAlpha,\r\n\r\n\t\t\t\talphaTest: material.alphaTest,\r\n\t\t\t\tdoubleSided: material.side === DoubleSide,\r\n\t\t\t\tflipSided: material.side === BackSide,\r\n\r\n\t\t\t\tdepthPacking: ( material.depthPacking !== undefined ) ? material.depthPacking : false,\r\n\r\n\t\t\t\tindex0AttributeName: material.index0AttributeName,\r\n\r\n\t\t\t\textensionDerivatives: material.extensions && material.extensions.derivatives,\r\n\t\t\t\textensionFragDepth: material.extensions && material.extensions.fragDepth,\r\n\t\t\t\textensionDrawBuffers: material.extensions && material.extensions.drawBuffers,\r\n\t\t\t\textensionShaderTextureLOD: material.extensions && material.extensions.shaderTextureLOD,\r\n\r\n\t\t\t\trendererExtensionFragDepth: isWebGL2 || extensions.get( 'EXT_frag_depth' ) !== null,\r\n\t\t\t\trendererExtensionDrawBuffers: isWebGL2 || extensions.get( 'WEBGL_draw_buffers' ) !== null,\r\n\t\t\t\trendererExtensionShaderTextureLod: isWebGL2 || extensions.get( 'EXT_shader_texture_lod' ) !== null,\r\n\r\n\t\t\t\tonBeforeCompile: material.onBeforeCompile\r\n\r\n\t\t\t};\r\n\r\n\t\t\treturn parameters;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getProgramCacheKey = function ( parameters ) {\r\n\r\n\t\t\tvar array = [];\r\n\r\n\t\t\tif ( parameters.shaderID ) {\r\n\r\n\t\t\t\tarray.push( parameters.shaderID );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tarray.push( parameters.fragmentShader );\r\n\t\t\t\tarray.push( parameters.vertexShader );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( parameters.defines !== undefined ) {\r\n\r\n\t\t\t\tfor ( var name in parameters.defines ) {\r\n\r\n\t\t\t\t\tarray.push( name );\r\n\t\t\t\t\tarray.push( parameters.defines[ name ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( parameters.isRawShaderMaterial === undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < parameterNames.length; i ++ ) {\r\n\r\n\t\t\t\t\tarray.push( parameters[ parameterNames[ i ] ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarray.push( renderer.outputEncoding );\r\n\t\t\t\tarray.push( renderer.gammaFactor );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tarray.push( parameters.onBeforeCompile.toString() );\r\n\r\n\t\t\treturn array.join();\r\n\r\n\t\t};\r\n\r\n\t\tthis.acquireProgram = function ( parameters, cacheKey ) {\r\n\r\n\t\t\tvar program;\r\n\r\n\t\t\t// Check if code has been already compiled\r\n\t\t\tfor ( var p = 0, pl = programs.length; p < pl; p ++ ) {\r\n\r\n\t\t\t\tvar preexistingProgram = programs[ p ];\r\n\r\n\t\t\t\tif ( preexistingProgram.cacheKey === cacheKey ) {\r\n\r\n\t\t\t\t\tprogram = preexistingProgram;\r\n\t\t\t\t\t++ program.usedTimes;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( program === undefined ) {\r\n\r\n\t\t\t\tprogram = new WebGLProgram( renderer, cacheKey, parameters );\r\n\t\t\t\tprograms.push( program );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn program;\r\n\r\n\t\t};\r\n\r\n\t\tthis.releaseProgram = function ( program ) {\r\n\r\n\t\t\tif ( -- program.usedTimes === 0 ) {\r\n\r\n\t\t\t\t// Remove from unordered set\r\n\t\t\t\tvar i = programs.indexOf( program );\r\n\t\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\r\n\t\t\t\tprograms.pop();\r\n\r\n\t\t\t\t// Free WebGL resources\r\n\t\t\t\tprogram.destroy();\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\t// Exposed for resource monitoring & error feedback via renderer.info:\r\n\t\tthis.programs = programs;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author fordacious / fordacious.github.io\r\n\t */\r\n\r\n\tfunction WebGLProperties() {\r\n\r\n\t\tvar properties = new WeakMap();\r\n\r\n\t\tfunction get( object ) {\r\n\r\n\t\t\tvar map = properties.get( object );\r\n\r\n\t\t\tif ( map === undefined ) {\r\n\r\n\t\t\t\tmap = {};\r\n\t\t\t\tproperties.set( object, map );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn map;\r\n\r\n\t\t}\r\n\r\n\t\tfunction remove( object ) {\r\n\r\n\t\t\tproperties.delete( object );\r\n\r\n\t\t}\r\n\r\n\t\tfunction update( object, key, value ) {\r\n\r\n\t\t\tproperties.get( object )[ key ] = value;\r\n\r\n\t\t}\r\n\r\n\t\tfunction dispose() {\r\n\r\n\t\t\tproperties = new WeakMap();\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tget: get,\r\n\t\t\tremove: remove,\r\n\t\t\tupdate: update,\r\n\t\t\tdispose: dispose\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction painterSortStable( a, b ) {\r\n\r\n\t\tif ( a.groupOrder !== b.groupOrder ) {\r\n\r\n\t\t\treturn a.groupOrder - b.groupOrder;\r\n\r\n\t\t} else if ( a.renderOrder !== b.renderOrder ) {\r\n\r\n\t\t\treturn a.renderOrder - b.renderOrder;\r\n\r\n\t\t} else if ( a.program !== b.program ) {\r\n\r\n\t\t\treturn a.program.id - b.program.id;\r\n\r\n\t\t} else if ( a.material.id !== b.material.id ) {\r\n\r\n\t\t\treturn a.material.id - b.material.id;\r\n\r\n\t\t} else if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn a.z - b.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction reversePainterSortStable( a, b ) {\r\n\r\n\t\tif ( a.groupOrder !== b.groupOrder ) {\r\n\r\n\t\t\treturn a.groupOrder - b.groupOrder;\r\n\r\n\t\t} else if ( a.renderOrder !== b.renderOrder ) {\r\n\r\n\t\t\treturn a.renderOrder - b.renderOrder;\r\n\r\n\t\t} else if ( a.z !== b.z ) {\r\n\r\n\t\t\treturn b.z - a.z;\r\n\r\n\t\t} else {\r\n\r\n\t\t\treturn a.id - b.id;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tfunction WebGLRenderList() {\r\n\r\n\t\tvar renderItems = [];\r\n\t\tvar renderItemsIndex = 0;\r\n\r\n\t\tvar opaque = [];\r\n\t\tvar transparent = [];\r\n\r\n\t\tvar defaultProgram = { id: - 1 };\r\n\r\n\t\tfunction init() {\r\n\r\n\t\t\trenderItemsIndex = 0;\r\n\r\n\t\t\topaque.length = 0;\r\n\t\t\ttransparent.length = 0;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getNextRenderItem( object, geometry, material, groupOrder, z, group ) {\r\n\r\n\t\t\tvar renderItem = renderItems[ renderItemsIndex ];\r\n\r\n\t\t\tif ( renderItem === undefined ) {\r\n\r\n\t\t\t\trenderItem = {\r\n\t\t\t\t\tid: object.id,\r\n\t\t\t\t\tobject: object,\r\n\t\t\t\t\tgeometry: geometry,\r\n\t\t\t\t\tmaterial: material,\r\n\t\t\t\t\tprogram: material.program || defaultProgram,\r\n\t\t\t\t\tgroupOrder: groupOrder,\r\n\t\t\t\t\trenderOrder: object.renderOrder,\r\n\t\t\t\t\tz: z,\r\n\t\t\t\t\tgroup: group\r\n\t\t\t\t};\r\n\r\n\t\t\t\trenderItems[ renderItemsIndex ] = renderItem;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderItem.id = object.id;\r\n\t\t\t\trenderItem.object = object;\r\n\t\t\t\trenderItem.geometry = geometry;\r\n\t\t\t\trenderItem.material = material;\r\n\t\t\t\trenderItem.program = material.program || defaultProgram;\r\n\t\t\t\trenderItem.groupOrder = groupOrder;\r\n\t\t\t\trenderItem.renderOrder = object.renderOrder;\r\n\t\t\t\trenderItem.z = z;\r\n\t\t\t\trenderItem.group = group;\r\n\r\n\t\t\t}\r\n\r\n\t\t\trenderItemsIndex ++;\r\n\r\n\t\t\treturn renderItem;\r\n\r\n\t\t}\r\n\r\n\t\tfunction push( object, geometry, material, groupOrder, z, group ) {\r\n\r\n\t\t\tvar renderItem = getNextRenderItem( object, geometry, material, groupOrder, z, group );\r\n\r\n\t\t\t( material.transparent === true ? transparent : opaque ).push( renderItem );\r\n\r\n\t\t}\r\n\r\n\t\tfunction unshift( object, geometry, material, groupOrder, z, group ) {\r\n\r\n\t\t\tvar renderItem = getNextRenderItem( object, geometry, material, groupOrder, z, group );\r\n\r\n\t\t\t( material.transparent === true ? transparent : opaque ).unshift( renderItem );\r\n\r\n\t\t}\r\n\r\n\t\tfunction sort( customOpaqueSort, customTransparentSort ) {\r\n\r\n\t\t\tif ( opaque.length > 1 ) { opaque.sort( customOpaqueSort || painterSortStable ); }\r\n\t\t\tif ( transparent.length > 1 ) { transparent.sort( customTransparentSort || reversePainterSortStable ); }\r\n\r\n\t\t}\r\n\r\n\t\tfunction finish() {\r\n\r\n\t\t\t// Clear references from inactive renderItems in the list\r\n\r\n\t\t\tfor ( var i = renderItemsIndex, il = renderItems.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar renderItem = renderItems[ i ];\r\n\r\n\t\t\t\tif ( renderItem.id === null ) { break; }\r\n\r\n\t\t\t\trenderItem.id = null;\r\n\t\t\t\trenderItem.object = null;\r\n\t\t\t\trenderItem.geometry = null;\r\n\t\t\t\trenderItem.material = null;\r\n\t\t\t\trenderItem.program = null;\r\n\t\t\t\trenderItem.group = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\topaque: opaque,\r\n\t\t\ttransparent: transparent,\r\n\r\n\t\t\tinit: init,\r\n\t\t\tpush: push,\r\n\t\t\tunshift: unshift,\r\n\t\t\tfinish: finish,\r\n\r\n\t\t\tsort: sort\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tfunction WebGLRenderLists() {\r\n\r\n\t\tvar lists = new WeakMap();\r\n\r\n\t\tfunction onSceneDispose( event ) {\r\n\r\n\t\t\tvar scene = event.target;\r\n\r\n\t\t\tscene.removeEventListener( 'dispose', onSceneDispose );\r\n\r\n\t\t\tlists.delete( scene );\r\n\r\n\t\t}\r\n\r\n\t\tfunction get( scene, camera ) {\r\n\r\n\t\t\tvar cameras = lists.get( scene );\r\n\t\t\tvar list;\r\n\t\t\tif ( cameras === undefined ) {\r\n\r\n\t\t\t\tlist = new WebGLRenderList();\r\n\t\t\t\tlists.set( scene, new WeakMap() );\r\n\t\t\t\tlists.get( scene ).set( camera, list );\r\n\r\n\t\t\t\tscene.addEventListener( 'dispose', onSceneDispose );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlist = cameras.get( camera );\r\n\t\t\t\tif ( list === undefined ) {\r\n\r\n\t\t\t\t\tlist = new WebGLRenderList();\r\n\t\t\t\t\tcameras.set( camera, list );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn list;\r\n\r\n\t\t}\r\n\r\n\t\tfunction dispose() {\r\n\r\n\t\t\tlists = new WeakMap();\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tget: get,\r\n\t\t\tdispose: dispose\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction UniformsCache() {\r\n\r\n\t\tvar lights = {};\r\n\r\n\t\treturn {\r\n\r\n\t\t\tget: function ( light ) {\r\n\r\n\t\t\t\tif ( lights[ light.id ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn lights[ light.id ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar uniforms;\r\n\r\n\t\t\t\tswitch ( light.type ) {\r\n\r\n\t\t\t\t\tcase 'DirectionalLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tdirection: new Vector3(),\r\n\t\t\t\t\t\t\tcolor: new Color()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'SpotLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tposition: new Vector3(),\r\n\t\t\t\t\t\t\tdirection: new Vector3(),\r\n\t\t\t\t\t\t\tcolor: new Color(),\r\n\t\t\t\t\t\t\tdistance: 0,\r\n\t\t\t\t\t\t\tconeCos: 0,\r\n\t\t\t\t\t\t\tpenumbraCos: 0,\r\n\t\t\t\t\t\t\tdecay: 0\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'PointLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tposition: new Vector3(),\r\n\t\t\t\t\t\t\tcolor: new Color(),\r\n\t\t\t\t\t\t\tdistance: 0,\r\n\t\t\t\t\t\t\tdecay: 0\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'HemisphereLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tdirection: new Vector3(),\r\n\t\t\t\t\t\t\tskyColor: new Color(),\r\n\t\t\t\t\t\t\tgroundColor: new Color()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'RectAreaLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tcolor: new Color(),\r\n\t\t\t\t\t\t\tposition: new Vector3(),\r\n\t\t\t\t\t\t\thalfWidth: new Vector3(),\r\n\t\t\t\t\t\t\thalfHeight: new Vector3()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlights[ light.id ] = uniforms;\r\n\r\n\t\t\t\treturn uniforms;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tfunction ShadowUniformsCache() {\r\n\r\n\t\tvar lights = {};\r\n\r\n\t\treturn {\r\n\r\n\t\t\tget: function ( light ) {\r\n\r\n\t\t\t\tif ( lights[ light.id ] !== undefined ) {\r\n\r\n\t\t\t\t\treturn lights[ light.id ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar uniforms;\r\n\r\n\t\t\t\tswitch ( light.type ) {\r\n\r\n\t\t\t\t\tcase 'DirectionalLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\t\t\tshadowMapSize: new Vector2()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'SpotLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\t\t\tshadowMapSize: new Vector2()\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'PointLight':\r\n\t\t\t\t\t\tuniforms = {\r\n\t\t\t\t\t\t\tshadowBias: 0,\r\n\t\t\t\t\t\t\tshadowRadius: 1,\r\n\t\t\t\t\t\t\tshadowMapSize: new Vector2(),\r\n\t\t\t\t\t\t\tshadowCameraNear: 1,\r\n\t\t\t\t\t\t\tshadowCameraFar: 1000\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t// TODO (abelnation): set RectAreaLight shadow uniforms\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlights[ light.id ] = uniforms;\r\n\r\n\t\t\t\treturn uniforms;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\r\n\r\n\tvar nextVersion = 0;\r\n\r\n\tfunction shadowCastingLightsFirst( lightA, lightB ) {\r\n\r\n\t\treturn ( lightB.castShadow ? 1 : 0 ) - ( lightA.castShadow ? 1 : 0 );\r\n\r\n\t}\r\n\r\n\tfunction WebGLLights() {\r\n\r\n\t\tvar cache = new UniformsCache();\r\n\r\n\t\tvar shadowCache = ShadowUniformsCache();\r\n\r\n\t\tvar state = {\r\n\r\n\t\t\tversion: 0,\r\n\r\n\t\t\thash: {\r\n\t\t\t\tdirectionalLength: - 1,\r\n\t\t\t\tpointLength: - 1,\r\n\t\t\t\tspotLength: - 1,\r\n\t\t\t\trectAreaLength: - 1,\r\n\t\t\t\themiLength: - 1,\r\n\r\n\t\t\t\tnumDirectionalShadows: - 1,\r\n\t\t\t\tnumPointShadows: - 1,\r\n\t\t\t\tnumSpotShadows: - 1\r\n\t\t\t},\r\n\r\n\t\t\tambient: [ 0, 0, 0 ],\r\n\t\t\tprobe: [],\r\n\t\t\tdirectional: [],\r\n\t\t\tdirectionalShadow: [],\r\n\t\t\tdirectionalShadowMap: [],\r\n\t\t\tdirectionalShadowMatrix: [],\r\n\t\t\tspot: [],\r\n\t\t\tspotShadow: [],\r\n\t\t\tspotShadowMap: [],\r\n\t\t\tspotShadowMatrix: [],\r\n\t\t\trectArea: [],\r\n\t\t\tpoint: [],\r\n\t\t\tpointShadow: [],\r\n\t\t\tpointShadowMap: [],\r\n\t\t\tpointShadowMatrix: [],\r\n\t\t\themi: []\r\n\r\n\t\t};\r\n\r\n\t\tfor ( var i = 0; i < 9; i ++ ) { state.probe.push( new Vector3() ); }\r\n\r\n\t\tvar vector3 = new Vector3();\r\n\t\tvar matrix4 = new Matrix4();\r\n\t\tvar matrix42 = new Matrix4();\r\n\r\n\t\tfunction setup( lights, shadows, camera ) {\r\n\r\n\t\t\tvar r = 0, g = 0, b = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) { state.probe[ i ].set( 0, 0, 0 ); }\r\n\r\n\t\t\tvar directionalLength = 0;\r\n\t\t\tvar pointLength = 0;\r\n\t\t\tvar spotLength = 0;\r\n\t\t\tvar rectAreaLength = 0;\r\n\t\t\tvar hemiLength = 0;\r\n\r\n\t\t\tvar numDirectionalShadows = 0;\r\n\t\t\tvar numPointShadows = 0;\r\n\t\t\tvar numSpotShadows = 0;\r\n\r\n\t\t\tvar viewMatrix = camera.matrixWorldInverse;\r\n\r\n\t\t\tlights.sort( shadowCastingLightsFirst );\r\n\r\n\t\t\tfor ( var i = 0, l = lights.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar light = lights[ i ];\r\n\r\n\t\t\t\tvar color = light.color;\r\n\t\t\t\tvar intensity = light.intensity;\r\n\t\t\t\tvar distance = light.distance;\r\n\r\n\t\t\t\tvar shadowMap = ( light.shadow && light.shadow.map ) ? light.shadow.map.texture : null;\r\n\r\n\t\t\t\tif ( light.isAmbientLight ) {\r\n\r\n\t\t\t\t\tr += color.r * intensity;\r\n\t\t\t\t\tg += color.g * intensity;\r\n\t\t\t\t\tb += color.b * intensity;\r\n\r\n\t\t\t\t} else if ( light.isLightProbe ) {\r\n\r\n\t\t\t\t\tfor ( var j = 0; j < 9; j ++ ) {\r\n\r\n\t\t\t\t\t\tstate.probe[ j ].addScaledVector( light.sh.coefficients[ j ], intensity );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( light.isDirectionalLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\r\n\t\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\tuniforms.direction.sub( vector3 );\r\n\t\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\t\tvar shadow = light.shadow;\r\n\r\n\t\t\t\t\t\tvar shadowUniforms = shadowCache.get( light );\r\n\r\n\t\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\r\n\t\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\r\n\t\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\r\n\r\n\t\t\t\t\t\tstate.directionalShadow[ directionalLength ] = shadowUniforms;\r\n\t\t\t\t\t\tstate.directionalShadowMap[ directionalLength ] = shadowMap;\r\n\t\t\t\t\t\tstate.directionalShadowMatrix[ directionalLength ] = light.shadow.matrix;\r\n\r\n\t\t\t\t\t\tnumDirectionalShadows ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate.directional[ directionalLength ] = uniforms;\r\n\r\n\t\t\t\t\tdirectionalLength ++;\r\n\r\n\t\t\t\t} else if ( light.isSpotLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\r\n\t\t\t\t\tuniforms.distance = distance;\r\n\r\n\t\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tvector3.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\t\t\tuniforms.direction.sub( vector3 );\r\n\t\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\r\n\t\t\t\t\tuniforms.coneCos = Math.cos( light.angle );\r\n\t\t\t\t\tuniforms.penumbraCos = Math.cos( light.angle * ( 1 - light.penumbra ) );\r\n\t\t\t\t\tuniforms.decay = light.decay;\r\n\r\n\t\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\t\tvar shadow = light.shadow;\r\n\r\n\t\t\t\t\t\tvar shadowUniforms = shadowCache.get( light );\r\n\r\n\t\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\r\n\t\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\r\n\t\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\r\n\r\n\t\t\t\t\t\tstate.spotShadow[ spotLength ] = shadowUniforms;\r\n\t\t\t\t\t\tstate.spotShadowMap[ spotLength ] = shadowMap;\r\n\t\t\t\t\t\tstate.spotShadowMatrix[ spotLength ] = light.shadow.matrix;\r\n\r\n\t\t\t\t\t\tnumSpotShadows ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate.spot[ spotLength ] = uniforms;\r\n\r\n\t\t\t\t\tspotLength ++;\r\n\r\n\t\t\t\t} else if ( light.isRectAreaLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\t// (a) intensity is the total visible light emitted\r\n\t\t\t\t\t//uniforms.color.copy( color ).multiplyScalar( intensity / ( light.width * light.height * Math.PI ) );\r\n\r\n\t\t\t\t\t// (b) intensity is the brightness of the light\r\n\t\t\t\t\tuniforms.color.copy( color ).multiplyScalar( intensity );\r\n\r\n\t\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\t\t// extract local rotation of light to derive width/height half vectors\r\n\t\t\t\t\tmatrix42.identity();\r\n\t\t\t\t\tmatrix4.copy( light.matrixWorld );\r\n\t\t\t\t\tmatrix4.premultiply( viewMatrix );\r\n\t\t\t\t\tmatrix42.extractRotation( matrix4 );\r\n\r\n\t\t\t\t\tuniforms.halfWidth.set( light.width * 0.5, 0.0, 0.0 );\r\n\t\t\t\t\tuniforms.halfHeight.set( 0.0, light.height * 0.5, 0.0 );\r\n\r\n\t\t\t\t\tuniforms.halfWidth.applyMatrix4( matrix42 );\r\n\t\t\t\t\tuniforms.halfHeight.applyMatrix4( matrix42 );\r\n\r\n\t\t\t\t\t// TODO (abelnation): RectAreaLight distance?\r\n\t\t\t\t\t// uniforms.distance = distance;\r\n\r\n\t\t\t\t\tstate.rectArea[ rectAreaLength ] = uniforms;\r\n\r\n\t\t\t\t\trectAreaLength ++;\r\n\r\n\t\t\t\t} else if ( light.isPointLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\tuniforms.position.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tuniforms.position.applyMatrix4( viewMatrix );\r\n\r\n\t\t\t\t\tuniforms.color.copy( light.color ).multiplyScalar( light.intensity );\r\n\t\t\t\t\tuniforms.distance = light.distance;\r\n\t\t\t\t\tuniforms.decay = light.decay;\r\n\r\n\t\t\t\t\tif ( light.castShadow ) {\r\n\r\n\t\t\t\t\t\tvar shadow = light.shadow;\r\n\r\n\t\t\t\t\t\tvar shadowUniforms = shadowCache.get( light );\r\n\r\n\t\t\t\t\t\tshadowUniforms.shadowBias = shadow.bias;\r\n\t\t\t\t\t\tshadowUniforms.shadowRadius = shadow.radius;\r\n\t\t\t\t\t\tshadowUniforms.shadowMapSize = shadow.mapSize;\r\n\t\t\t\t\t\tshadowUniforms.shadowCameraNear = shadow.camera.near;\r\n\t\t\t\t\t\tshadowUniforms.shadowCameraFar = shadow.camera.far;\r\n\r\n\t\t\t\t\t\tstate.pointShadow[ pointLength ] = shadowUniforms;\r\n\t\t\t\t\t\tstate.pointShadowMap[ pointLength ] = shadowMap;\r\n\t\t\t\t\t\tstate.pointShadowMatrix[ pointLength ] = light.shadow.matrix;\r\n\r\n\t\t\t\t\t\tnumPointShadows ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tstate.point[ pointLength ] = uniforms;\r\n\r\n\t\t\t\t\tpointLength ++;\r\n\r\n\t\t\t\t} else if ( light.isHemisphereLight ) {\r\n\r\n\t\t\t\t\tvar uniforms = cache.get( light );\r\n\r\n\t\t\t\t\tuniforms.direction.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\t\tuniforms.direction.transformDirection( viewMatrix );\r\n\t\t\t\t\tuniforms.direction.normalize();\r\n\r\n\t\t\t\t\tuniforms.skyColor.copy( light.color ).multiplyScalar( intensity );\r\n\t\t\t\t\tuniforms.groundColor.copy( light.groundColor ).multiplyScalar( intensity );\r\n\r\n\t\t\t\t\tstate.hemi[ hemiLength ] = uniforms;\r\n\r\n\t\t\t\t\themiLength ++;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.ambient[ 0 ] = r;\r\n\t\t\tstate.ambient[ 1 ] = g;\r\n\t\t\tstate.ambient[ 2 ] = b;\r\n\r\n\t\t\tvar hash = state.hash;\r\n\r\n\t\t\tif ( hash.directionalLength !== directionalLength ||\r\n\t\t\t\thash.pointLength !== pointLength ||\r\n\t\t\t\thash.spotLength !== spotLength ||\r\n\t\t\t\thash.rectAreaLength !== rectAreaLength ||\r\n\t\t\t\thash.hemiLength !== hemiLength ||\r\n\t\t\t\thash.numDirectionalShadows !== numDirectionalShadows ||\r\n\t\t\t\thash.numPointShadows !== numPointShadows ||\r\n\t\t\t\thash.numSpotShadows !== numSpotShadows ) {\r\n\r\n\t\t\t\tstate.directional.length = directionalLength;\r\n\t\t\t\tstate.spot.length = spotLength;\r\n\t\t\t\tstate.rectArea.length = rectAreaLength;\r\n\t\t\t\tstate.point.length = pointLength;\r\n\t\t\t\tstate.hemi.length = hemiLength;\r\n\r\n\t\t\t\tstate.directionalShadow.length = numDirectionalShadows;\r\n\t\t\t\tstate.directionalShadowMap.length = numDirectionalShadows;\r\n\t\t\t\tstate.pointShadow.length = numPointShadows;\r\n\t\t\t\tstate.pointShadowMap.length = numPointShadows;\r\n\t\t\t\tstate.spotShadow.length = numSpotShadows;\r\n\t\t\t\tstate.spotShadowMap.length = numSpotShadows;\r\n\t\t\t\tstate.directionalShadowMatrix.length = numDirectionalShadows;\r\n\t\t\t\tstate.pointShadowMatrix.length = numPointShadows;\r\n\t\t\t\tstate.spotShadowMatrix.length = numSpotShadows;\r\n\r\n\t\t\t\thash.directionalLength = directionalLength;\r\n\t\t\t\thash.pointLength = pointLength;\r\n\t\t\t\thash.spotLength = spotLength;\r\n\t\t\t\thash.rectAreaLength = rectAreaLength;\r\n\t\t\t\thash.hemiLength = hemiLength;\r\n\r\n\t\t\t\thash.numDirectionalShadows = numDirectionalShadows;\r\n\t\t\t\thash.numPointShadows = numPointShadows;\r\n\t\t\t\thash.numSpotShadows = numSpotShadows;\r\n\r\n\t\t\t\tstate.version = nextVersion ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tsetup: setup,\r\n\t\t\tstate: state\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction WebGLRenderState() {\r\n\r\n\t\tvar lights = new WebGLLights();\r\n\r\n\t\tvar lightsArray = [];\r\n\t\tvar shadowsArray = [];\r\n\r\n\t\tfunction init() {\r\n\r\n\t\t\tlightsArray.length = 0;\r\n\t\t\tshadowsArray.length = 0;\r\n\r\n\t\t}\r\n\r\n\t\tfunction pushLight( light ) {\r\n\r\n\t\t\tlightsArray.push( light );\r\n\r\n\t\t}\r\n\r\n\t\tfunction pushShadow( shadowLight ) {\r\n\r\n\t\t\tshadowsArray.push( shadowLight );\r\n\r\n\t\t}\r\n\r\n\t\tfunction setupLights( camera ) {\r\n\r\n\t\t\tlights.setup( lightsArray, shadowsArray, camera );\r\n\r\n\t\t}\r\n\r\n\t\tvar state = {\r\n\t\t\tlightsArray: lightsArray,\r\n\t\t\tshadowsArray: shadowsArray,\r\n\r\n\t\t\tlights: lights\r\n\t\t};\r\n\r\n\t\treturn {\r\n\t\t\tinit: init,\r\n\t\t\tstate: state,\r\n\t\t\tsetupLights: setupLights,\r\n\r\n\t\t\tpushLight: pushLight,\r\n\t\t\tpushShadow: pushShadow\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tfunction WebGLRenderStates() {\r\n\r\n\t\tvar renderStates = new WeakMap();\r\n\r\n\t\tfunction onSceneDispose( event ) {\r\n\r\n\t\t\tvar scene = event.target;\r\n\r\n\t\t\tscene.removeEventListener( 'dispose', onSceneDispose );\r\n\r\n\t\t\trenderStates.delete( scene );\r\n\r\n\t\t}\r\n\r\n\t\tfunction get( scene, camera ) {\r\n\r\n\t\t\tvar renderState;\r\n\r\n\t\t\tif ( renderStates.has( scene ) === false ) {\r\n\r\n\t\t\t\trenderState = new WebGLRenderState();\r\n\t\t\t\trenderStates.set( scene, new WeakMap() );\r\n\t\t\t\trenderStates.get( scene ).set( camera, renderState );\r\n\r\n\t\t\t\tscene.addEventListener( 'dispose', onSceneDispose );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( renderStates.get( scene ).has( camera ) === false ) {\r\n\r\n\t\t\t\t\trenderState = new WebGLRenderState();\r\n\t\t\t\t\trenderStates.get( scene ).set( camera, renderState );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\trenderState = renderStates.get( scene ).get( camera );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn renderState;\r\n\r\n\t\t}\r\n\r\n\t\tfunction dispose() {\r\n\r\n\t\t\trenderStates = new WeakMap();\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tget: get,\r\n\t\t\tdispose: dispose\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author bhouston / https://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshDepthMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshDepthMaterial';\r\n\r\n\t\tthis.depthPacking = BasicDepthPacking;\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\r\n\t\tthis.fog = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshDepthMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshDepthMaterial.prototype.constructor = MeshDepthMaterial;\r\n\r\n\tMeshDepthMaterial.prototype.isMeshDepthMaterial = true;\r\n\r\n\tMeshDepthMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.depthPacking = source.depthPacking;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *\r\n\t *  referencePosition: <float>,\r\n\t *  nearDistance: <float>,\r\n\t *  farDistance: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>\r\n\t *\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshDistanceMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshDistanceMaterial';\r\n\r\n\t\tthis.referencePosition = new Vector3();\r\n\t\tthis.nearDistance = 1;\r\n\t\tthis.farDistance = 1000;\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.fog = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshDistanceMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshDistanceMaterial.prototype.constructor = MeshDistanceMaterial;\r\n\r\n\tMeshDistanceMaterial.prototype.isMeshDistanceMaterial = true;\r\n\r\n\tMeshDistanceMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.referencePosition.copy( source.referencePosition );\r\n\t\tthis.nearDistance = source.nearDistance;\r\n\t\tthis.farDistance = source.farDistance;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tvar vsm_frag = \"uniform sampler2D shadow_pass;\\nuniform vec2 resolution;\\nuniform float radius;\\n#include <packing>\\nvoid main() {\\n  float mean = 0.0;\\n  float squared_mean = 0.0;\\n\\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\\n    #ifdef HORIZONAL_PASS\\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\\n      mean += distribution.x;\\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\\n    #else\\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\\n      mean += depth;\\n      squared_mean += depth * depth;\\n    #endif\\n  }\\n  mean = mean * HALF_SAMPLE_RATE;\\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\\n  float std_dev = sqrt( squared_mean - mean * mean );\\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\\n}\";\r\n\r\n\tvar vsm_vert = \"void main() {\\n\\tgl_Position = vec4( position, 1.0 );\\n}\";\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLShadowMap( _renderer, _objects, maxTextureSize ) {\r\n\r\n\t\tvar _frustum = new Frustum(),\r\n\r\n\t\t\t_shadowMapSize = new Vector2(),\r\n\t\t\t_viewportSize = new Vector2(),\r\n\r\n\t\t\t_viewport = new Vector4(),\r\n\r\n\t\t\t_depthMaterials = [],\r\n\t\t\t_distanceMaterials = [],\r\n\r\n\t\t\t_materialCache = {};\r\n\r\n\t\tvar shadowSide = { 0: BackSide, 1: FrontSide, 2: DoubleSide };\r\n\r\n\t\tvar shadowMaterialVertical = new ShaderMaterial( {\r\n\r\n\t\t\tdefines: {\r\n\t\t\t\tSAMPLE_RATE: 2.0 / 8.0,\r\n\t\t\t\tHALF_SAMPLE_RATE: 1.0 / 8.0\r\n\t\t\t},\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\tshadow_pass: { value: null },\r\n\t\t\t\tresolution: { value: new Vector2() },\r\n\t\t\t\tradius: { value: 4.0 }\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: vsm_vert,\r\n\r\n\t\t\tfragmentShader: vsm_frag\r\n\r\n\t\t} );\r\n\r\n\t\tvar shadowMaterialHorizonal = shadowMaterialVertical.clone();\r\n\t\tshadowMaterialHorizonal.defines.HORIZONAL_PASS = 1;\r\n\r\n\t\tvar fullScreenTri = new BufferGeometry();\r\n\t\tfullScreenTri.setAttribute(\r\n\t\t\t\"position\",\r\n\t\t\tnew BufferAttribute(\r\n\t\t\t\tnew Float32Array( [ - 1, - 1, 0.5, 3, - 1, 0.5, - 1, 3, 0.5 ] ),\r\n\t\t\t\t3\r\n\t\t\t)\r\n\t\t);\r\n\r\n\t\tvar fullScreenMesh = new Mesh( fullScreenTri, shadowMaterialVertical );\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tthis.enabled = false;\r\n\r\n\t\tthis.autoUpdate = true;\r\n\t\tthis.needsUpdate = false;\r\n\r\n\t\tthis.type = PCFShadowMap;\r\n\r\n\t\tthis.render = function ( lights, scene, camera ) {\r\n\r\n\t\t\tif ( scope.enabled === false ) { return; }\r\n\t\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) { return; }\r\n\r\n\t\t\tif ( lights.length === 0 ) { return; }\r\n\r\n\t\t\tvar currentRenderTarget = _renderer.getRenderTarget();\r\n\t\t\tvar activeCubeFace = _renderer.getActiveCubeFace();\r\n\t\t\tvar activeMipmapLevel = _renderer.getActiveMipmapLevel();\r\n\r\n\t\t\tvar _state = _renderer.state;\r\n\r\n\t\t\t// Set GL state for depth map.\r\n\t\t\t_state.setBlending( NoBlending );\r\n\t\t\t_state.buffers.color.setClear( 1, 1, 1, 1 );\r\n\t\t\t_state.buffers.depth.setTest( true );\r\n\t\t\t_state.setScissorTest( false );\r\n\r\n\t\t\t// render depth map\r\n\r\n\t\t\tfor ( var i = 0, il = lights.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar light = lights[ i ];\r\n\t\t\t\tvar shadow = light.shadow;\r\n\r\n\t\t\t\tif ( shadow === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap:', light, 'has no shadow.' );\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_shadowMapSize.copy( shadow.mapSize );\r\n\r\n\t\t\t\tvar shadowFrameExtents = shadow.getFrameExtents();\r\n\r\n\t\t\t\t_shadowMapSize.multiply( shadowFrameExtents );\r\n\r\n\t\t\t\t_viewportSize.copy( shadow.mapSize );\r\n\r\n\t\t\t\tif ( _shadowMapSize.x > maxTextureSize || _shadowMapSize.y > maxTextureSize ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap:', light, 'has shadow exceeding max texture size, reducing' );\r\n\r\n\t\t\t\t\tif ( _shadowMapSize.x > maxTextureSize ) {\r\n\r\n\t\t\t\t\t\t_viewportSize.x = Math.floor( maxTextureSize / shadowFrameExtents.x );\r\n\t\t\t\t\t\t_shadowMapSize.x = _viewportSize.x * shadowFrameExtents.x;\r\n\t\t\t\t\t\tshadow.mapSize.x = _viewportSize.x;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( _shadowMapSize.y > maxTextureSize ) {\r\n\r\n\t\t\t\t\t\t_viewportSize.y = Math.floor( maxTextureSize / shadowFrameExtents.y );\r\n\t\t\t\t\t\t_shadowMapSize.y = _viewportSize.y * shadowFrameExtents.y;\r\n\t\t\t\t\t\tshadow.mapSize.y = _viewportSize.y;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( shadow.map === null && ! shadow.isPointLightShadow && this.type === VSMShadowMap ) {\r\n\r\n\t\t\t\t\tvar pars = { minFilter: LinearFilter, magFilter: LinearFilter, format: RGBAFormat };\r\n\r\n\t\t\t\t\tshadow.map = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\r\n\t\t\t\t\tshadow.map.texture.name = light.name + \".shadowMap\";\r\n\r\n\t\t\t\t\tshadow.mapPass = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\r\n\r\n\t\t\t\t\tshadow.camera.updateProjectionMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( shadow.map === null ) {\r\n\r\n\t\t\t\t\tvar pars = { minFilter: NearestFilter, magFilter: NearestFilter, format: RGBAFormat };\r\n\r\n\t\t\t\t\tshadow.map = new WebGLRenderTarget( _shadowMapSize.x, _shadowMapSize.y, pars );\r\n\t\t\t\t\tshadow.map.texture.name = light.name + \".shadowMap\";\r\n\r\n\t\t\t\t\tshadow.camera.updateProjectionMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_renderer.setRenderTarget( shadow.map );\r\n\t\t\t\t_renderer.clear();\r\n\r\n\t\t\t\tvar viewportCount = shadow.getViewportCount();\r\n\r\n\t\t\t\tfor ( var vp = 0; vp < viewportCount; vp ++ ) {\r\n\r\n\t\t\t\t\tvar viewport = shadow.getViewport( vp );\r\n\r\n\t\t\t\t\t_viewport.set(\r\n\t\t\t\t\t\t_viewportSize.x * viewport.x,\r\n\t\t\t\t\t\t_viewportSize.y * viewport.y,\r\n\t\t\t\t\t\t_viewportSize.x * viewport.z,\r\n\t\t\t\t\t\t_viewportSize.y * viewport.w\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t_state.viewport( _viewport );\r\n\r\n\t\t\t\t\tshadow.updateMatrices( light, vp );\r\n\r\n\t\t\t\t\t_frustum = shadow.getFrustum();\r\n\r\n\t\t\t\t\trenderObject( scene, camera, shadow.camera, light, this.type );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// do blur pass for VSM\r\n\r\n\t\t\t\tif ( ! shadow.isPointLightShadow && this.type === VSMShadowMap ) {\r\n\r\n\t\t\t\t\tVSMPass( shadow, camera );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.needsUpdate = false;\r\n\r\n\t\t\t_renderer.setRenderTarget( currentRenderTarget, activeCubeFace, activeMipmapLevel );\r\n\r\n\t\t};\r\n\r\n\t\tfunction VSMPass( shadow, camera ) {\r\n\r\n\t\t\tvar geometry = _objects.update( fullScreenMesh );\r\n\r\n\t\t\t// vertical pass\r\n\r\n\t\t\tshadowMaterialVertical.uniforms.shadow_pass.value = shadow.map.texture;\r\n\t\t\tshadowMaterialVertical.uniforms.resolution.value = shadow.mapSize;\r\n\t\t\tshadowMaterialVertical.uniforms.radius.value = shadow.radius;\r\n\t\t\t_renderer.setRenderTarget( shadow.mapPass );\r\n\t\t\t_renderer.clear();\r\n\t\t\t_renderer.renderBufferDirect( camera, null, geometry, shadowMaterialVertical, fullScreenMesh, null );\r\n\r\n\t\t\t// horizonal pass\r\n\r\n\t\t\tshadowMaterialHorizonal.uniforms.shadow_pass.value = shadow.mapPass.texture;\r\n\t\t\tshadowMaterialHorizonal.uniforms.resolution.value = shadow.mapSize;\r\n\t\t\tshadowMaterialHorizonal.uniforms.radius.value = shadow.radius;\r\n\t\t\t_renderer.setRenderTarget( shadow.map );\r\n\t\t\t_renderer.clear();\r\n\t\t\t_renderer.renderBufferDirect( camera, null, geometry, shadowMaterialHorizonal, fullScreenMesh, null );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getDepthMaterialVariant( useMorphing, useSkinning, useInstancing ) {\r\n\r\n\t\t\tvar index = useMorphing << 0 | useSkinning << 1 | useInstancing << 2;\r\n\r\n\t\t\tvar material = _depthMaterials[ index ];\r\n\r\n\t\t\tif ( material === undefined ) {\r\n\r\n\t\t\t\tmaterial = new MeshDepthMaterial( {\r\n\r\n\t\t\t\t\tdepthPacking: RGBADepthPacking,\r\n\r\n\t\t\t\t\tmorphTargets: useMorphing,\r\n\t\t\t\t\tskinning: useSkinning\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t_depthMaterials[ index ] = material;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn material;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getDistanceMaterialVariant( useMorphing, useSkinning, useInstancing ) {\r\n\r\n\t\t\tvar index = useMorphing << 0 | useSkinning << 1 | useInstancing << 2;\r\n\r\n\t\t\tvar material = _distanceMaterials[ index ];\r\n\r\n\t\t\tif ( material === undefined ) {\r\n\r\n\t\t\t\tmaterial = new MeshDistanceMaterial( {\r\n\r\n\t\t\t\t\tmorphTargets: useMorphing,\r\n\t\t\t\t\tskinning: useSkinning\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t_distanceMaterials[ index ] = material;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn material;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getDepthMaterial( object, material, light, shadowCameraNear, shadowCameraFar, type ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tvar result = null;\r\n\r\n\t\t\tvar getMaterialVariant = getDepthMaterialVariant;\r\n\t\t\tvar customMaterial = object.customDepthMaterial;\r\n\r\n\t\t\tif ( light.isPointLight === true ) {\r\n\r\n\t\t\t\tgetMaterialVariant = getDistanceMaterialVariant;\r\n\t\t\t\tcustomMaterial = object.customDistanceMaterial;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( customMaterial === undefined ) {\r\n\r\n\t\t\t\tvar useMorphing = false;\r\n\r\n\t\t\t\tif ( material.morphTargets === true ) {\r\n\r\n\t\t\t\t\tif ( geometry.isBufferGeometry === true ) {\r\n\r\n\t\t\t\t\t\tuseMorphing = geometry.morphAttributes && geometry.morphAttributes.position && geometry.morphAttributes.position.length > 0;\r\n\r\n\t\t\t\t\t} else if ( geometry.isGeometry === true ) {\r\n\r\n\t\t\t\t\t\tuseMorphing = geometry.morphTargets && geometry.morphTargets.length > 0;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar useSkinning = false;\r\n\r\n\t\t\t\tif ( object.isSkinnedMesh === true ) {\r\n\r\n\t\t\t\t\tif ( material.skinning === true ) {\r\n\r\n\t\t\t\t\t\tuseSkinning = true;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:', object );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar useInstancing = object.isInstancedMesh === true;\r\n\r\n\t\t\t\tresult = getMaterialVariant( useMorphing, useSkinning, useInstancing );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult = customMaterial;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _renderer.localClippingEnabled &&\r\n\t\t\t\t\tmaterial.clipShadows === true &&\r\n\t\t\t\t\tmaterial.clippingPlanes.length !== 0 ) {\r\n\r\n\t\t\t\t// in this case we need a unique material instance reflecting the\r\n\t\t\t\t// appropriate state\r\n\r\n\t\t\t\tvar keyA = result.uuid, keyB = material.uuid;\r\n\r\n\t\t\t\tvar materialsForVariant = _materialCache[ keyA ];\r\n\r\n\t\t\t\tif ( materialsForVariant === undefined ) {\r\n\r\n\t\t\t\t\tmaterialsForVariant = {};\r\n\t\t\t\t\t_materialCache[ keyA ] = materialsForVariant;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar cachedMaterial = materialsForVariant[ keyB ];\r\n\r\n\t\t\t\tif ( cachedMaterial === undefined ) {\r\n\r\n\t\t\t\t\tcachedMaterial = result.clone();\r\n\t\t\t\t\tmaterialsForVariant[ keyB ] = cachedMaterial;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresult = cachedMaterial;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tresult.visible = material.visible;\r\n\t\t\tresult.wireframe = material.wireframe;\r\n\r\n\t\t\tif ( type === VSMShadowMap ) {\r\n\r\n\t\t\t\tresult.side = ( material.shadowSide !== null ) ? material.shadowSide : material.side;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tresult.side = ( material.shadowSide !== null ) ? material.shadowSide : shadowSide[ material.side ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tresult.clipShadows = material.clipShadows;\r\n\t\t\tresult.clippingPlanes = material.clippingPlanes;\r\n\t\t\tresult.clipIntersection = material.clipIntersection;\r\n\r\n\t\t\tresult.wireframeLinewidth = material.wireframeLinewidth;\r\n\t\t\tresult.linewidth = material.linewidth;\r\n\r\n\t\t\tif ( light.isPointLight === true && result.isMeshDistanceMaterial === true ) {\r\n\r\n\t\t\t\tresult.referencePosition.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\t\tresult.nearDistance = shadowCameraNear;\r\n\t\t\t\tresult.farDistance = shadowCameraFar;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderObject( object, camera, shadowCamera, light, type ) {\r\n\r\n\t\t\tif ( object.visible === false ) { return; }\r\n\r\n\t\t\tvar visible = object.layers.test( camera.layers );\r\n\r\n\t\t\tif ( visible && ( object.isMesh || object.isLine || object.isPoints ) ) {\r\n\r\n\t\t\t\tif ( ( object.castShadow || ( object.receiveShadow && type === VSMShadowMap ) ) && ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) ) {\r\n\r\n\t\t\t\t\tobject.modelViewMatrix.multiplyMatrices( shadowCamera.matrixWorldInverse, object.matrixWorld );\r\n\r\n\t\t\t\t\tvar geometry = _objects.update( object );\r\n\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\t\t\t\tvar groups = geometry.groups;\r\n\r\n\t\t\t\t\t\tfor ( var k = 0, kl = groups.length; k < kl; k ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar group = groups[ k ];\r\n\t\t\t\t\t\t\tvar groupMaterial = material[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\r\n\r\n\t\t\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, groupMaterial, light, shadowCamera.near, shadowCamera.far, type );\r\n\r\n\t\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, group );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( material.visible ) {\r\n\r\n\t\t\t\t\t\tvar depthMaterial = getDepthMaterial( object, material, light, shadowCamera.near, shadowCamera.far, type );\r\n\r\n\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, null, geometry, depthMaterial, object, null );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\trenderObject( children[ i ], camera, shadowCamera, light, type );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLState( gl, extensions, capabilities ) {\r\n\r\n\t\tvar isWebGL2 = capabilities.isWebGL2;\r\n\r\n\t\tfunction ColorBuffer() {\r\n\r\n\t\t\tvar locked = false;\r\n\r\n\t\t\tvar color = new Vector4();\r\n\t\t\tvar currentColorMask = null;\r\n\t\t\tvar currentColorClear = new Vector4( 0, 0, 0, 0 );\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tsetMask: function ( colorMask ) {\r\n\r\n\t\t\t\t\tif ( currentColorMask !== colorMask && ! locked ) {\r\n\r\n\t\t\t\t\t\tgl.colorMask( colorMask, colorMask, colorMask, colorMask );\r\n\t\t\t\t\t\tcurrentColorMask = colorMask;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetLocked: function ( lock ) {\r\n\r\n\t\t\t\t\tlocked = lock;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetClear: function ( r, g, b, a, premultipliedAlpha ) {\r\n\r\n\t\t\t\t\tif ( premultipliedAlpha === true ) {\r\n\r\n\t\t\t\t\t\tr *= a; g *= a; b *= a;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcolor.set( r, g, b, a );\r\n\r\n\t\t\t\t\tif ( currentColorClear.equals( color ) === false ) {\r\n\r\n\t\t\t\t\t\tgl.clearColor( r, g, b, a );\r\n\t\t\t\t\t\tcurrentColorClear.copy( color );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\treset: function () {\r\n\r\n\t\t\t\t\tlocked = false;\r\n\r\n\t\t\t\t\tcurrentColorMask = null;\r\n\t\t\t\t\tcurrentColorClear.set( - 1, 0, 0, 0 ); // set to invalid state\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction DepthBuffer() {\r\n\r\n\t\t\tvar locked = false;\r\n\r\n\t\t\tvar currentDepthMask = null;\r\n\t\t\tvar currentDepthFunc = null;\r\n\t\t\tvar currentDepthClear = null;\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tsetTest: function ( depthTest ) {\r\n\r\n\t\t\t\t\tif ( depthTest ) {\r\n\r\n\t\t\t\t\t\tenable( 2929 );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tdisable( 2929 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetMask: function ( depthMask ) {\r\n\r\n\t\t\t\t\tif ( currentDepthMask !== depthMask && ! locked ) {\r\n\r\n\t\t\t\t\t\tgl.depthMask( depthMask );\r\n\t\t\t\t\t\tcurrentDepthMask = depthMask;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetFunc: function ( depthFunc ) {\r\n\r\n\t\t\t\t\tif ( currentDepthFunc !== depthFunc ) {\r\n\r\n\t\t\t\t\t\tif ( depthFunc ) {\r\n\r\n\t\t\t\t\t\t\tswitch ( depthFunc ) {\r\n\r\n\t\t\t\t\t\t\t\tcase NeverDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( 512 );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase AlwaysDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( 519 );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase LessDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( 513 );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase LessEqualDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( 515 );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase EqualDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( 514 );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase GreaterEqualDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( 518 );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase GreaterDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( 516 );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase NotEqualDepth:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( 517 );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\t\t\tgl.depthFunc( 515 );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tgl.depthFunc( 515 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcurrentDepthFunc = depthFunc;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetLocked: function ( lock ) {\r\n\r\n\t\t\t\t\tlocked = lock;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetClear: function ( depth ) {\r\n\r\n\t\t\t\t\tif ( currentDepthClear !== depth ) {\r\n\r\n\t\t\t\t\t\tgl.clearDepth( depth );\r\n\t\t\t\t\t\tcurrentDepthClear = depth;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\treset: function () {\r\n\r\n\t\t\t\t\tlocked = false;\r\n\r\n\t\t\t\t\tcurrentDepthMask = null;\r\n\t\t\t\t\tcurrentDepthFunc = null;\r\n\t\t\t\t\tcurrentDepthClear = null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\tfunction StencilBuffer() {\r\n\r\n\t\t\tvar locked = false;\r\n\r\n\t\t\tvar currentStencilMask = null;\r\n\t\t\tvar currentStencilFunc = null;\r\n\t\t\tvar currentStencilRef = null;\r\n\t\t\tvar currentStencilFuncMask = null;\r\n\t\t\tvar currentStencilFail = null;\r\n\t\t\tvar currentStencilZFail = null;\r\n\t\t\tvar currentStencilZPass = null;\r\n\t\t\tvar currentStencilClear = null;\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tsetTest: function ( stencilTest ) {\r\n\r\n\t\t\t\t\tif ( ! locked ) {\r\n\r\n\t\t\t\t\t\tif ( stencilTest ) {\r\n\r\n\t\t\t\t\t\t\tenable( 2960 );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tdisable( 2960 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetMask: function ( stencilMask ) {\r\n\r\n\t\t\t\t\tif ( currentStencilMask !== stencilMask && ! locked ) {\r\n\r\n\t\t\t\t\t\tgl.stencilMask( stencilMask );\r\n\t\t\t\t\t\tcurrentStencilMask = stencilMask;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetFunc: function ( stencilFunc, stencilRef, stencilMask ) {\r\n\r\n\t\t\t\t\tif ( currentStencilFunc !== stencilFunc ||\r\n\t\t\t\t\t     currentStencilRef \t!== stencilRef \t||\r\n\t\t\t\t\t     currentStencilFuncMask !== stencilMask ) {\r\n\r\n\t\t\t\t\t\tgl.stencilFunc( stencilFunc, stencilRef, stencilMask );\r\n\r\n\t\t\t\t\t\tcurrentStencilFunc = stencilFunc;\r\n\t\t\t\t\t\tcurrentStencilRef = stencilRef;\r\n\t\t\t\t\t\tcurrentStencilFuncMask = stencilMask;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetOp: function ( stencilFail, stencilZFail, stencilZPass ) {\r\n\r\n\t\t\t\t\tif ( currentStencilFail\t !== stencilFail \t||\r\n\t\t\t\t\t     currentStencilZFail !== stencilZFail ||\r\n\t\t\t\t\t     currentStencilZPass !== stencilZPass ) {\r\n\r\n\t\t\t\t\t\tgl.stencilOp( stencilFail, stencilZFail, stencilZPass );\r\n\r\n\t\t\t\t\t\tcurrentStencilFail = stencilFail;\r\n\t\t\t\t\t\tcurrentStencilZFail = stencilZFail;\r\n\t\t\t\t\t\tcurrentStencilZPass = stencilZPass;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetLocked: function ( lock ) {\r\n\r\n\t\t\t\t\tlocked = lock;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tsetClear: function ( stencil ) {\r\n\r\n\t\t\t\t\tif ( currentStencilClear !== stencil ) {\r\n\r\n\t\t\t\t\t\tgl.clearStencil( stencil );\r\n\t\t\t\t\t\tcurrentStencilClear = stencil;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\treset: function () {\r\n\r\n\t\t\t\t\tlocked = false;\r\n\r\n\t\t\t\t\tcurrentStencilMask = null;\r\n\t\t\t\t\tcurrentStencilFunc = null;\r\n\t\t\t\t\tcurrentStencilRef = null;\r\n\t\t\t\t\tcurrentStencilFuncMask = null;\r\n\t\t\t\t\tcurrentStencilFail = null;\r\n\t\t\t\t\tcurrentStencilZFail = null;\r\n\t\t\t\t\tcurrentStencilZPass = null;\r\n\t\t\t\t\tcurrentStencilClear = null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar colorBuffer = new ColorBuffer();\r\n\t\tvar depthBuffer = new DepthBuffer();\r\n\t\tvar stencilBuffer = new StencilBuffer();\r\n\r\n\t\tvar maxVertexAttributes = gl.getParameter( 34921 );\r\n\t\tvar newAttributes = new Uint8Array( maxVertexAttributes );\r\n\t\tvar enabledAttributes = new Uint8Array( maxVertexAttributes );\r\n\t\tvar attributeDivisors = new Uint8Array( maxVertexAttributes );\r\n\r\n\t\tvar enabledCapabilities = {};\r\n\r\n\t\tvar currentProgram = null;\r\n\r\n\t\tvar currentBlendingEnabled = null;\r\n\t\tvar currentBlending = null;\r\n\t\tvar currentBlendEquation = null;\r\n\t\tvar currentBlendSrc = null;\r\n\t\tvar currentBlendDst = null;\r\n\t\tvar currentBlendEquationAlpha = null;\r\n\t\tvar currentBlendSrcAlpha = null;\r\n\t\tvar currentBlendDstAlpha = null;\r\n\t\tvar currentPremultipledAlpha = false;\r\n\r\n\t\tvar currentFlipSided = null;\r\n\t\tvar currentCullFace = null;\r\n\r\n\t\tvar currentLineWidth = null;\r\n\r\n\t\tvar currentPolygonOffsetFactor = null;\r\n\t\tvar currentPolygonOffsetUnits = null;\r\n\r\n\t\tvar maxTextures = gl.getParameter( 35661 );\r\n\r\n\t\tvar lineWidthAvailable = false;\r\n\t\tvar version = 0;\r\n\t\tvar glVersion = gl.getParameter( 7938 );\r\n\r\n\t\tif ( glVersion.indexOf( 'WebGL' ) !== - 1 ) {\r\n\r\n\t\t\tversion = parseFloat( /^WebGL\\ ([0-9])/.exec( glVersion )[ 1 ] );\r\n\t\t\tlineWidthAvailable = ( version >= 1.0 );\r\n\r\n\t\t} else if ( glVersion.indexOf( 'OpenGL ES' ) !== - 1 ) {\r\n\r\n\t\t\tversion = parseFloat( /^OpenGL\\ ES\\ ([0-9])/.exec( glVersion )[ 1 ] );\r\n\t\t\tlineWidthAvailable = ( version >= 2.0 );\r\n\r\n\t\t}\r\n\r\n\t\tvar currentTextureSlot = null;\r\n\t\tvar currentBoundTextures = {};\r\n\r\n\t\tvar currentScissor = new Vector4();\r\n\t\tvar currentViewport = new Vector4();\r\n\r\n\t\tfunction createTexture( type, target, count ) {\r\n\r\n\t\t\tvar data = new Uint8Array( 4 ); // 4 is required to match default unpack alignment of 4.\r\n\t\t\tvar texture = gl.createTexture();\r\n\r\n\t\t\tgl.bindTexture( type, texture );\r\n\t\t\tgl.texParameteri( type, 10241, 9728 );\r\n\t\t\tgl.texParameteri( type, 10240, 9728 );\r\n\r\n\t\t\tfor ( var i = 0; i < count; i ++ ) {\r\n\r\n\t\t\t\tgl.texImage2D( target + i, 0, 6408, 1, 1, 0, 6408, 5121, data );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t}\r\n\r\n\t\tvar emptyTextures = {};\r\n\t\temptyTextures[ 3553 ] = createTexture( 3553, 3553, 1 );\r\n\t\temptyTextures[ 34067 ] = createTexture( 34067, 34069, 6 );\r\n\r\n\t\t// init\r\n\r\n\t\tcolorBuffer.setClear( 0, 0, 0, 1 );\r\n\t\tdepthBuffer.setClear( 1 );\r\n\t\tstencilBuffer.setClear( 0 );\r\n\r\n\t\tenable( 2929 );\r\n\t\tdepthBuffer.setFunc( LessEqualDepth );\r\n\r\n\t\tsetFlipSided( false );\r\n\t\tsetCullFace( CullFaceBack );\r\n\t\tenable( 2884 );\r\n\r\n\t\tsetBlending( NoBlending );\r\n\r\n\t\t//\r\n\r\n\t\tfunction initAttributes() {\r\n\r\n\t\t\tfor ( var i = 0, l = newAttributes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tnewAttributes[ i ] = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction enableAttribute( attribute ) {\r\n\r\n\t\t\tenableAttributeAndDivisor( attribute, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tfunction enableAttributeAndDivisor( attribute, meshPerAttribute ) {\r\n\r\n\t\t\tnewAttributes[ attribute ] = 1;\r\n\r\n\t\t\tif ( enabledAttributes[ attribute ] === 0 ) {\r\n\r\n\t\t\t\tgl.enableVertexAttribArray( attribute );\r\n\t\t\t\tenabledAttributes[ attribute ] = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( attributeDivisors[ attribute ] !== meshPerAttribute ) {\r\n\r\n\t\t\t\tvar extension = isWebGL2 ? gl : extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\t\textension[ isWebGL2 ? 'vertexAttribDivisor' : 'vertexAttribDivisorANGLE' ]( attribute, meshPerAttribute );\r\n\t\t\t\tattributeDivisors[ attribute ] = meshPerAttribute;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction disableUnusedAttributes() {\r\n\r\n\t\t\tfor ( var i = 0, l = enabledAttributes.length; i !== l; ++ i ) {\r\n\r\n\t\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\r\n\r\n\t\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction enable( id ) {\r\n\r\n\t\t\tif ( enabledCapabilities[ id ] !== true ) {\r\n\r\n\t\t\t\tgl.enable( id );\r\n\t\t\t\tenabledCapabilities[ id ] = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction disable( id ) {\r\n\r\n\t\t\tif ( enabledCapabilities[ id ] !== false ) {\r\n\r\n\t\t\t\tgl.disable( id );\r\n\t\t\t\tenabledCapabilities[ id ] = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction useProgram( program ) {\r\n\r\n\t\t\tif ( currentProgram !== program ) {\r\n\r\n\t\t\t\tgl.useProgram( program );\r\n\r\n\t\t\t\tcurrentProgram = program;\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t\tvar equationToGL = {};\r\n\t\tequationToGL[ AddEquation ] = 32774;\r\n\t\tequationToGL[ SubtractEquation ] = 32778;\r\n\t\tequationToGL[ ReverseSubtractEquation ] = 32779;\r\n\r\n\t\tif ( isWebGL2 ) {\r\n\r\n\t\t\tequationToGL[ MinEquation ] = 32775;\r\n\t\t\tequationToGL[ MaxEquation ] = 32776;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar extension = extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\tequationToGL[ MinEquation ] = extension.MIN_EXT;\r\n\t\t\t\tequationToGL[ MaxEquation ] = extension.MAX_EXT;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar factorToGL = {};\r\n\t\tfactorToGL[ ZeroFactor ] = 0;\r\n\t\tfactorToGL[ OneFactor ] = 1;\r\n\t\tfactorToGL[ SrcColorFactor ] = 768;\r\n\t\tfactorToGL[ SrcAlphaFactor ] = 770;\r\n\t\tfactorToGL[ SrcAlphaSaturateFactor ] = 776;\r\n\t\tfactorToGL[ DstColorFactor ] = 774;\r\n\t\tfactorToGL[ DstAlphaFactor ] = 772;\r\n\t\tfactorToGL[ OneMinusSrcColorFactor ] = 769;\r\n\t\tfactorToGL[ OneMinusSrcAlphaFactor ] = 771;\r\n\t\tfactorToGL[ OneMinusDstColorFactor ] = 775;\r\n\t\tfactorToGL[ OneMinusDstAlphaFactor ] = 773;\r\n\r\n\t\tfunction setBlending( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\r\n\r\n\t\t\tif ( blending === NoBlending ) {\r\n\r\n\t\t\t\tif ( currentBlendingEnabled ) {\r\n\r\n\t\t\t\t\tdisable( 3042 );\r\n\t\t\t\t\tcurrentBlendingEnabled = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! currentBlendingEnabled ) {\r\n\r\n\t\t\t\tenable( 3042 );\r\n\t\t\t\tcurrentBlendingEnabled = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( blending !== CustomBlending ) {\r\n\r\n\t\t\t\tif ( blending !== currentBlending || premultipliedAlpha !== currentPremultipledAlpha ) {\r\n\r\n\t\t\t\t\tif ( currentBlendEquation !== AddEquation || currentBlendEquationAlpha !== AddEquation ) {\r\n\r\n\t\t\t\t\t\tgl.blendEquation( 32774 );\r\n\r\n\t\t\t\t\t\tcurrentBlendEquation = AddEquation;\r\n\t\t\t\t\t\tcurrentBlendEquationAlpha = AddEquation;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( premultipliedAlpha ) {\r\n\r\n\t\t\t\t\t\tswitch ( blending ) {\r\n\r\n\t\t\t\t\t\t\tcase NormalBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFuncSeparate( 1, 771, 1, 771 );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase AdditiveBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFunc( 1, 1 );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase SubtractiveBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFuncSeparate( 0, 0, 769, 771 );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase MultiplyBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFuncSeparate( 0, 768, 0, 770 );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tswitch ( blending ) {\r\n\r\n\t\t\t\t\t\t\tcase NormalBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFuncSeparate( 770, 771, 1, 771 );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase AdditiveBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFunc( 770, 1 );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase SubtractiveBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFunc( 0, 769 );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase MultiplyBlending:\r\n\t\t\t\t\t\t\t\tgl.blendFunc( 0, 768 );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcurrentBlendSrc = null;\r\n\t\t\t\t\tcurrentBlendDst = null;\r\n\t\t\t\t\tcurrentBlendSrcAlpha = null;\r\n\t\t\t\t\tcurrentBlendDstAlpha = null;\r\n\r\n\t\t\t\t\tcurrentBlending = blending;\r\n\t\t\t\t\tcurrentPremultipledAlpha = premultipliedAlpha;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// custom blending\r\n\r\n\t\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\r\n\t\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\r\n\t\t\tblendDstAlpha = blendDstAlpha || blendDst;\r\n\r\n\t\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\r\n\r\n\t\t\t\tgl.blendEquationSeparate( equationToGL[ blendEquation ], equationToGL[ blendEquationAlpha ] );\r\n\r\n\t\t\t\tcurrentBlendEquation = blendEquation;\r\n\t\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\r\n\r\n\t\t\t\tgl.blendFuncSeparate( factorToGL[ blendSrc ], factorToGL[ blendDst ], factorToGL[ blendSrcAlpha ], factorToGL[ blendDstAlpha ] );\r\n\r\n\t\t\t\tcurrentBlendSrc = blendSrc;\r\n\t\t\t\tcurrentBlendDst = blendDst;\r\n\t\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\r\n\t\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentBlending = blending;\r\n\t\t\tcurrentPremultipledAlpha = null;\r\n\r\n\t\t}\r\n\r\n\t\tfunction setMaterial( material, frontFaceCW ) {\r\n\r\n\t\t\tmaterial.side === DoubleSide\r\n\t\t\t\t? disable( 2884 )\r\n\t\t\t\t: enable( 2884 );\r\n\r\n\t\t\tvar flipSided = ( material.side === BackSide );\r\n\t\t\tif ( frontFaceCW ) { flipSided = ! flipSided; }\r\n\r\n\t\t\tsetFlipSided( flipSided );\r\n\r\n\t\t\t( material.blending === NormalBlending && material.transparent === false )\r\n\t\t\t\t? setBlending( NoBlending )\r\n\t\t\t\t: setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha );\r\n\r\n\t\t\tdepthBuffer.setFunc( material.depthFunc );\r\n\t\t\tdepthBuffer.setTest( material.depthTest );\r\n\t\t\tdepthBuffer.setMask( material.depthWrite );\r\n\t\t\tcolorBuffer.setMask( material.colorWrite );\r\n\r\n\t\t\tvar stencilWrite = material.stencilWrite;\r\n\t\t\tstencilBuffer.setTest( stencilWrite );\r\n\t\t\tif ( stencilWrite ) {\r\n\r\n\t\t\t\tstencilBuffer.setMask( material.stencilWriteMask );\r\n\t\t\t\tstencilBuffer.setFunc( material.stencilFunc, material.stencilRef, material.stencilFuncMask );\r\n\t\t\t\tstencilBuffer.setOp( material.stencilFail, material.stencilZFail, material.stencilZPass );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction setFlipSided( flipSided ) {\r\n\r\n\t\t\tif ( currentFlipSided !== flipSided ) {\r\n\r\n\t\t\t\tif ( flipSided ) {\r\n\r\n\t\t\t\t\tgl.frontFace( 2304 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgl.frontFace( 2305 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurrentFlipSided = flipSided;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setCullFace( cullFace ) {\r\n\r\n\t\t\tif ( cullFace !== CullFaceNone ) {\r\n\r\n\t\t\t\tenable( 2884 );\r\n\r\n\t\t\t\tif ( cullFace !== currentCullFace ) {\r\n\r\n\t\t\t\t\tif ( cullFace === CullFaceBack ) {\r\n\r\n\t\t\t\t\t\tgl.cullFace( 1029 );\r\n\r\n\t\t\t\t\t} else if ( cullFace === CullFaceFront ) {\r\n\r\n\t\t\t\t\t\tgl.cullFace( 1028 );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tgl.cullFace( 1032 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdisable( 2884 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcurrentCullFace = cullFace;\r\n\r\n\t\t}\r\n\r\n\t\tfunction setLineWidth( width ) {\r\n\r\n\t\t\tif ( width !== currentLineWidth ) {\r\n\r\n\t\t\t\tif ( lineWidthAvailable ) { gl.lineWidth( width ); }\r\n\r\n\t\t\t\tcurrentLineWidth = width;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setPolygonOffset( polygonOffset, factor, units ) {\r\n\r\n\t\t\tif ( polygonOffset ) {\r\n\r\n\t\t\t\tenable( 32823 );\r\n\r\n\t\t\t\tif ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) {\r\n\r\n\t\t\t\t\tgl.polygonOffset( factor, units );\r\n\r\n\t\t\t\t\tcurrentPolygonOffsetFactor = factor;\r\n\t\t\t\t\tcurrentPolygonOffsetUnits = units;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdisable( 32823 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setScissorTest( scissorTest ) {\r\n\r\n\t\t\tif ( scissorTest ) {\r\n\r\n\t\t\t\tenable( 3089 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdisable( 3089 );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// texture\r\n\r\n\t\tfunction activeTexture( webglSlot ) {\r\n\r\n\t\t\tif ( webglSlot === undefined ) { webglSlot = 33984 + maxTextures - 1; }\r\n\r\n\t\t\tif ( currentTextureSlot !== webglSlot ) {\r\n\r\n\t\t\t\tgl.activeTexture( webglSlot );\r\n\t\t\t\tcurrentTextureSlot = webglSlot;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction bindTexture( webglType, webglTexture ) {\r\n\r\n\t\t\tif ( currentTextureSlot === null ) {\r\n\r\n\t\t\t\tactiveTexture();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar boundTexture = currentBoundTextures[ currentTextureSlot ];\r\n\r\n\t\t\tif ( boundTexture === undefined ) {\r\n\r\n\t\t\t\tboundTexture = { type: undefined, texture: undefined };\r\n\t\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\r\n\r\n\t\t\t\tgl.bindTexture( webglType, webglTexture || emptyTextures[ webglType ] );\r\n\r\n\t\t\t\tboundTexture.type = webglType;\r\n\t\t\t\tboundTexture.texture = webglTexture;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction unbindTexture() {\r\n\r\n\t\t\tvar boundTexture = currentBoundTextures[ currentTextureSlot ];\r\n\r\n\t\t\tif ( boundTexture !== undefined && boundTexture.type !== undefined ) {\r\n\r\n\t\t\t\tgl.bindTexture( boundTexture.type, null );\r\n\r\n\t\t\t\tboundTexture.type = undefined;\r\n\t\t\t\tboundTexture.texture = undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction compressedTexImage2D() {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\r\n\r\n\t\t\t} catch ( error ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLState:', error );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction texImage2D() {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tgl.texImage2D.apply( gl, arguments );\r\n\r\n\t\t\t} catch ( error ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLState:', error );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction texImage3D() {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tgl.texImage3D.apply( gl, arguments );\r\n\r\n\t\t\t} catch ( error ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLState:', error );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction scissor( scissor ) {\r\n\r\n\t\t\tif ( currentScissor.equals( scissor ) === false ) {\r\n\r\n\t\t\t\tgl.scissor( scissor.x, scissor.y, scissor.z, scissor.w );\r\n\t\t\t\tcurrentScissor.copy( scissor );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction viewport( viewport ) {\r\n\r\n\t\t\tif ( currentViewport.equals( viewport ) === false ) {\r\n\r\n\t\t\t\tgl.viewport( viewport.x, viewport.y, viewport.z, viewport.w );\r\n\t\t\t\tcurrentViewport.copy( viewport );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction reset() {\r\n\r\n\t\t\tfor ( var i = 0; i < enabledAttributes.length; i ++ ) {\r\n\r\n\t\t\t\tif ( enabledAttributes[ i ] === 1 ) {\r\n\r\n\t\t\t\t\tgl.disableVertexAttribArray( i );\r\n\t\t\t\t\tenabledAttributes[ i ] = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tenabledCapabilities = {};\r\n\r\n\t\t\tcurrentTextureSlot = null;\r\n\t\t\tcurrentBoundTextures = {};\r\n\r\n\t\t\tcurrentProgram = null;\r\n\r\n\t\t\tcurrentBlending = null;\r\n\r\n\t\t\tcurrentFlipSided = null;\r\n\t\t\tcurrentCullFace = null;\r\n\r\n\t\t\tcolorBuffer.reset();\r\n\t\t\tdepthBuffer.reset();\r\n\t\t\tstencilBuffer.reset();\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tbuffers: {\r\n\t\t\t\tcolor: colorBuffer,\r\n\t\t\t\tdepth: depthBuffer,\r\n\t\t\t\tstencil: stencilBuffer\r\n\t\t\t},\r\n\r\n\t\t\tinitAttributes: initAttributes,\r\n\t\t\tenableAttribute: enableAttribute,\r\n\t\t\tenableAttributeAndDivisor: enableAttributeAndDivisor,\r\n\t\t\tdisableUnusedAttributes: disableUnusedAttributes,\r\n\t\t\tenable: enable,\r\n\t\t\tdisable: disable,\r\n\r\n\t\t\tuseProgram: useProgram,\r\n\r\n\t\t\tsetBlending: setBlending,\r\n\t\t\tsetMaterial: setMaterial,\r\n\r\n\t\t\tsetFlipSided: setFlipSided,\r\n\t\t\tsetCullFace: setCullFace,\r\n\r\n\t\t\tsetLineWidth: setLineWidth,\r\n\t\t\tsetPolygonOffset: setPolygonOffset,\r\n\r\n\t\t\tsetScissorTest: setScissorTest,\r\n\r\n\t\t\tactiveTexture: activeTexture,\r\n\t\t\tbindTexture: bindTexture,\r\n\t\t\tunbindTexture: unbindTexture,\r\n\t\t\tcompressedTexImage2D: compressedTexImage2D,\r\n\t\t\ttexImage2D: texImage2D,\r\n\t\t\ttexImage3D: texImage3D,\r\n\r\n\t\t\tscissor: scissor,\r\n\t\t\tviewport: viewport,\r\n\r\n\t\t\treset: reset\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info ) {\r\n\r\n\t\tvar isWebGL2 = capabilities.isWebGL2;\r\n\t\tvar maxTextures = capabilities.maxTextures;\r\n\t\tvar maxCubemapSize = capabilities.maxCubemapSize;\r\n\t\tvar maxTextureSize = capabilities.maxTextureSize;\r\n\t\tvar maxSamples = capabilities.maxSamples;\r\n\r\n\t\tvar _videoTextures = new WeakMap();\r\n\t\tvar _canvas;\r\n\r\n\t\t// cordova iOS (as of 5.0) still uses UIWebView, which provides OffscreenCanvas,\r\n\t\t// also OffscreenCanvas.getContext(\"webgl\"), but not OffscreenCanvas.getContext(\"2d\")!\r\n\t\t// Some implementations may only implement OffscreenCanvas partially (e.g. lacking 2d).\r\n\r\n\t\tvar useOffscreenCanvas = false;\r\n\r\n\t\ttry {\r\n\r\n\t\t\tuseOffscreenCanvas = typeof OffscreenCanvas !== 'undefined'\r\n\t\t\t\t&& ( new OffscreenCanvas( 1, 1 ).getContext( \"2d\" ) ) !== null;\r\n\r\n\t\t} catch ( err ) {\r\n\r\n\t\t\t// Ignore any errors\r\n\r\n\t\t}\r\n\r\n\t\tfunction createCanvas( width, height ) {\r\n\r\n\t\t\t// Use OffscreenCanvas when available. Specially needed in web workers\r\n\r\n\t\t\treturn useOffscreenCanvas ?\r\n\t\t\t\tnew OffscreenCanvas( width, height ) :\r\n\t\t\t\tdocument.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' );\r\n\r\n\t\t}\r\n\r\n\t\tfunction resizeImage( image, needsPowerOfTwo, needsNewCanvas, maxSize ) {\r\n\r\n\t\t\tvar scale = 1;\r\n\r\n\t\t\t// handle case if texture exceeds max size\r\n\r\n\t\t\tif ( image.width > maxSize || image.height > maxSize ) {\r\n\r\n\t\t\t\tscale = maxSize / Math.max( image.width, image.height );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// only perform resize if necessary\r\n\r\n\t\t\tif ( scale < 1 || needsPowerOfTwo === true ) {\r\n\r\n\t\t\t\t// only perform resize for certain image types\r\n\r\n\t\t\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\r\n\t\t\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\r\n\t\t\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\r\n\r\n\t\t\t\t\tvar floor = needsPowerOfTwo ? MathUtils.floorPowerOfTwo : Math.floor;\r\n\r\n\t\t\t\t\tvar width = floor( scale * image.width );\r\n\t\t\t\t\tvar height = floor( scale * image.height );\r\n\r\n\t\t\t\t\tif ( _canvas === undefined ) { _canvas = createCanvas( width, height ); }\r\n\r\n\t\t\t\t\t// cube textures can't reuse the same canvas\r\n\r\n\t\t\t\t\tvar canvas = needsNewCanvas ? createCanvas( width, height ) : _canvas;\r\n\r\n\t\t\t\t\tcanvas.width = width;\r\n\t\t\t\t\tcanvas.height = height;\r\n\r\n\t\t\t\t\tvar context = canvas.getContext( '2d' );\r\n\t\t\t\t\tcontext.drawImage( image, 0, 0, width, height );\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture has been resized from (' + image.width + 'x' + image.height + ') to (' + width + 'x' + height + ').' );\r\n\r\n\t\t\t\t\treturn canvas;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( 'data' in image ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Image in DataTexture is too big (' + image.width + 'x' + image.height + ').' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn image;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn image;\r\n\r\n\t\t}\r\n\r\n\t\tfunction isPowerOfTwo( image ) {\r\n\r\n\t\t\treturn MathUtils.isPowerOfTwo( image.width ) && MathUtils.isPowerOfTwo( image.height );\r\n\r\n\t\t}\r\n\r\n\t\tfunction textureNeedsPowerOfTwo( texture ) {\r\n\r\n\t\t\tif ( isWebGL2 ) { return false; }\r\n\r\n\t\t\treturn ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) ||\r\n\t\t\t\t( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter );\r\n\r\n\t\t}\r\n\r\n\t\tfunction textureNeedsGenerateMipmaps( texture, supportsMips ) {\r\n\r\n\t\t\treturn texture.generateMipmaps && supportsMips &&\r\n\t\t\t\ttexture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter;\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateMipmap( target, texture, width, height ) {\r\n\r\n\t\t\t_gl.generateMipmap( target );\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\t// Note: Math.log( x ) * Math.LOG2E used instead of Math.log2( x ) which is not supported by IE11\r\n\t\t\ttextureProperties.__maxMipLevel = Math.log( Math.max( width, height ) ) * Math.LOG2E;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getInternalFormat( internalFormatName, glFormat, glType ) {\r\n\r\n\t\t\tif ( isWebGL2 === false ) { return glFormat; }\r\n\r\n\t\t\tif ( internalFormatName !== null ) {\r\n\r\n\t\t\t\tif ( _gl[ internalFormatName ] !== undefined ) { return _gl[ internalFormatName ]; }\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format \\'' + internalFormatName + '\\'' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar internalFormat = glFormat;\r\n\r\n\t\t\tif ( glFormat === 6403 ) {\r\n\r\n\t\t\t\tif ( glType === 5126 ) { internalFormat = 33326; }\r\n\t\t\t\tif ( glType === 5131 ) { internalFormat = 33325; }\r\n\t\t\t\tif ( glType === 5121 ) { internalFormat = 33321; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( glFormat === 6407 ) {\r\n\r\n\t\t\t\tif ( glType === 5126 ) { internalFormat = 34837; }\r\n\t\t\t\tif ( glType === 5131 ) { internalFormat = 34843; }\r\n\t\t\t\tif ( glType === 5121 ) { internalFormat = 32849; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( glFormat === 6408 ) {\r\n\r\n\t\t\t\tif ( glType === 5126 ) { internalFormat = 34836; }\r\n\t\t\t\tif ( glType === 5131 ) { internalFormat = 34842; }\r\n\t\t\t\tif ( glType === 5121 ) { internalFormat = 32856; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( internalFormat === 33325 || internalFormat === 33326 ||\r\n\t\t\t\tinternalFormat === 34842 || internalFormat === 34836 ) {\r\n\r\n\t\t\t\textensions.get( 'EXT_color_buffer_float' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn internalFormat;\r\n\r\n\t\t}\r\n\r\n\t\t// Fallback filters for non-power-of-2 textures\r\n\r\n\t\tfunction filterFallback( f ) {\r\n\r\n\t\t\tif ( f === NearestFilter || f === NearestMipmapNearestFilter || f === NearestMipmapLinearFilter ) {\r\n\r\n\t\t\t\treturn 9728;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn 9729;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction onTextureDispose( event ) {\r\n\r\n\t\t\tvar texture = event.target;\r\n\r\n\t\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\tdeallocateTexture( texture );\r\n\r\n\t\t\tif ( texture.isVideoTexture ) {\r\n\r\n\t\t\t\t_videoTextures.delete( texture );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tinfo.memory.textures --;\r\n\r\n\t\t}\r\n\r\n\t\tfunction onRenderTargetDispose( event ) {\r\n\r\n\t\t\tvar renderTarget = event.target;\r\n\r\n\t\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\t\tdeallocateRenderTarget( renderTarget );\r\n\r\n\t\t\tinfo.memory.textures --;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction deallocateTexture( texture ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\tif ( textureProperties.__webglInit === undefined ) { return; }\r\n\r\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\t\tproperties.remove( texture );\r\n\r\n\t\t}\r\n\r\n\t\tfunction deallocateRenderTarget( renderTarget ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\t\tif ( ! renderTarget ) { return; }\r\n\r\n\t\t\tif ( textureProperties.__webglTexture !== undefined ) {\r\n\r\n\t\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( renderTarget.depthTexture ) {\r\n\r\n\t\t\t\trenderTarget.depthTexture.dispose();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( renderTarget.isWebGLCubeRenderTarget ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) { _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer[ i ] ); }\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\r\n\t\t\t\tif ( renderTargetProperties.__webglDepthbuffer ) { _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthbuffer ); }\r\n\t\t\t\tif ( renderTargetProperties.__webglMultisampledFramebuffer ) { _gl.deleteFramebuffer( renderTargetProperties.__webglMultisampledFramebuffer ); }\r\n\t\t\t\tif ( renderTargetProperties.__webglColorRenderbuffer ) { _gl.deleteRenderbuffer( renderTargetProperties.__webglColorRenderbuffer ); }\r\n\t\t\t\tif ( renderTargetProperties.__webglDepthRenderbuffer ) { _gl.deleteRenderbuffer( renderTargetProperties.__webglDepthRenderbuffer ); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tproperties.remove( renderTarget.texture );\r\n\t\t\tproperties.remove( renderTarget );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar textureUnits = 0;\r\n\r\n\t\tfunction resetTextureUnits() {\r\n\r\n\t\t\ttextureUnits = 0;\r\n\r\n\t\t}\r\n\r\n\t\tfunction allocateTextureUnit() {\r\n\r\n\t\t\tvar textureUnit = textureUnits;\r\n\r\n\t\t\tif ( textureUnit >= maxTextures ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLTextures: Trying to use ' + textureUnit + ' texture units while this GPU supports only ' + maxTextures );\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttextureUnits += 1;\r\n\r\n\t\t\treturn textureUnit;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tfunction setTexture2D( texture, slot ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\tif ( texture.isVideoTexture ) { updateVideoTexture( texture ); }\r\n\r\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\t\tvar image = texture.image;\r\n\r\n\t\t\t\tif ( image === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is undefined' );\r\n\r\n\t\t\t\t} else if ( image.complete === false ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete' );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tuploadTexture( textureProperties, texture, slot );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.activeTexture( 33984 + slot );\r\n\t\t\tstate.bindTexture( 3553, textureProperties.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\tfunction setTexture2DArray( texture, slot ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\t\tuploadTexture( textureProperties, texture, slot );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.activeTexture( 33984 + slot );\r\n\t\t\tstate.bindTexture( 35866, textureProperties.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\tfunction setTexture3D( texture, slot ) {\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\t\tuploadTexture( textureProperties, texture, slot );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.activeTexture( 33984 + slot );\r\n\t\t\tstate.bindTexture( 32879, textureProperties.__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\tfunction setTextureCube( texture, slot ) {\r\n\r\n\t\t\tif ( texture.image.length !== 6 ) { return; }\r\n\r\n\t\t\tvar textureProperties = properties.get( texture );\r\n\r\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\r\n\r\n\t\t\t\tinitTexture( textureProperties, texture );\r\n\r\n\t\t\t\tstate.activeTexture( 33984 + slot );\r\n\t\t\t\tstate.bindTexture( 34067, textureProperties.__webglTexture );\r\n\r\n\t\t\t\t_gl.pixelStorei( 37440, texture.flipY );\r\n\r\n\t\t\t\tvar isCompressed = ( texture && ( texture.isCompressedTexture || texture.image[ 0 ].isCompressedTexture ) );\r\n\t\t\t\tvar isDataTexture = ( texture.image[ 0 ] && texture.image[ 0 ].isDataTexture );\r\n\r\n\t\t\t\tvar cubeImage = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tif ( ! isCompressed && ! isDataTexture ) {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = resizeImage( texture.image[ i ], false, true, maxCubemapSize );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar image = cubeImage[ 0 ],\r\n\t\t\t\t\tsupportsMips = isPowerOfTwo( image ) || isWebGL2,\r\n\t\t\t\t\tglFormat = utils.convert( texture.format ),\r\n\t\t\t\t\tglType = utils.convert( texture.type ),\r\n\t\t\t\t\tglInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType );\r\n\r\n\t\t\t\tsetTextureParameters( 34067, texture, supportsMips );\r\n\r\n\t\t\t\tvar mipmaps;\r\n\r\n\t\t\t\tif ( isCompressed ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t\tmipmaps = cubeImage[ i ].mipmaps;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0; j < mipmaps.length; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar mipmap = mipmaps[ j ];\r\n\r\n\t\t\t\t\t\t\tif ( texture.format !== RGBAFormat && texture.format !== RGBFormat ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( glFormat !== null ) {\r\n\r\n\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( 34069 + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()' );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, j, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmipmaps = texture.mipmaps;\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t\tif ( isDataTexture ) {\r\n\r\n\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, 0, glInternalFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\r\n\r\n\t\t\t\t\t\t\tfor ( var j = 0; j < mipmaps.length; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar mipmap = mipmaps[ j ];\r\n\t\t\t\t\t\t\t\tvar mipmapImage = mipmap.image[ i ].image;\r\n\r\n\t\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, j + 1, glInternalFormat, mipmapImage.width, mipmapImage.height, 0, glFormat, glType, mipmapImage.data );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, 0, glInternalFormat, glFormat, glType, cubeImage[ i ] );\r\n\r\n\t\t\t\t\t\t\tfor ( var j = 0; j < mipmaps.length; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar mipmap = mipmaps[ j ];\r\n\r\n\t\t\t\t\t\t\t\tstate.texImage2D( 34069 + i, j + 1, glInternalFormat, glFormat, glType, mipmap.image[ i ] );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\r\n\r\n\t\t\t\t\t// We assume images for cube map have the same size.\r\n\t\t\t\t\tgenerateMipmap( 34067, texture, image.width, image.height );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\t\t\tif ( texture.onUpdate ) { texture.onUpdate( texture ); }\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.activeTexture( 33984 + slot );\r\n\t\t\t\tstate.bindTexture( 34067, textureProperties.__webglTexture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction setTextureCubeDynamic( texture, slot ) {\r\n\r\n\t\t\tstate.activeTexture( 33984 + slot );\r\n\t\t\tstate.bindTexture( 34067, properties.get( texture ).__webglTexture );\r\n\r\n\t\t}\r\n\r\n\t\tvar wrappingToGL = {};\r\n\t\twrappingToGL[ RepeatWrapping ] = 10497;\r\n\t\twrappingToGL[ ClampToEdgeWrapping ] = 33071;\r\n\t\twrappingToGL[ MirroredRepeatWrapping ] = 33648;\r\n\r\n\t\tvar filterToGL = {};\r\n\t\tfilterToGL[ NearestFilter ] = 9728;\r\n\t\tfilterToGL[ NearestMipmapNearestFilter ] = 9984;\r\n\t\tfilterToGL[ NearestMipmapLinearFilter ] = 9986;\r\n\t\tfilterToGL[ LinearFilter ] = 9729;\r\n\t\tfilterToGL[ LinearMipmapNearestFilter ] = 9985;\r\n\t\tfilterToGL[ LinearMipmapLinearFilter ] = 9987;\r\n\r\n\t\tfunction setTextureParameters( textureType, texture, supportsMips ) {\r\n\r\n\t\t\tif ( supportsMips ) {\r\n\r\n\t\t\t\t_gl.texParameteri( textureType, 10242, wrappingToGL[ texture.wrapS ] );\r\n\t\t\t\t_gl.texParameteri( textureType, 10243, wrappingToGL[ texture.wrapT ] );\r\n\r\n\t\t\t\tif ( textureType === 32879 || textureType === 35866 ) {\r\n\r\n\t\t\t\t\t_gl.texParameteri( textureType, 32882, wrappingToGL[ texture.wrapR ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_gl.texParameteri( textureType, 10240, filterToGL[ texture.magFilter ] );\r\n\t\t\t\t_gl.texParameteri( textureType, 10241, filterToGL[ texture.minFilter ] );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.texParameteri( textureType, 10242, 33071 );\r\n\t\t\t\t_gl.texParameteri( textureType, 10243, 33071 );\r\n\r\n\t\t\t\tif ( textureType === 32879 || textureType === 35866 ) {\r\n\r\n\t\t\t\t\t_gl.texParameteri( textureType, 32882, 33071 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.wrapS !== ClampToEdgeWrapping || texture.wrapT !== ClampToEdgeWrapping ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_gl.texParameteri( textureType, 10240, filterFallback( texture.magFilter ) );\r\n\t\t\t\t_gl.texParameteri( textureType, 10241, filterFallback( texture.minFilter ) );\r\n\r\n\t\t\t\tif ( texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\r\n\r\n\t\t\tif ( extension ) {\r\n\r\n\t\t\t\tif ( texture.type === FloatType && extensions.get( 'OES_texture_float_linear' ) === null ) { return; }\r\n\t\t\t\tif ( texture.type === HalfFloatType && ( isWebGL2 || extensions.get( 'OES_texture_half_float_linear' ) ) === null ) { return; }\r\n\r\n\t\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\r\n\r\n\t\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, capabilities.getMaxAnisotropy() ) );\r\n\t\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction initTexture( textureProperties, texture ) {\r\n\r\n\t\t\tif ( textureProperties.__webglInit === undefined ) {\r\n\r\n\t\t\t\ttextureProperties.__webglInit = true;\r\n\r\n\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\r\n\r\n\t\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\t\tinfo.memory.textures ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction uploadTexture( textureProperties, texture, slot ) {\r\n\r\n\t\t\tvar textureType = 3553;\r\n\r\n\t\t\tif ( texture.isDataTexture2DArray ) { textureType = 35866; }\r\n\t\t\tif ( texture.isDataTexture3D ) { textureType = 32879; }\r\n\r\n\t\t\tinitTexture( textureProperties, texture );\r\n\r\n\t\t\tstate.activeTexture( 33984 + slot );\r\n\t\t\tstate.bindTexture( textureType, textureProperties.__webglTexture );\r\n\r\n\t\t\t_gl.pixelStorei( 37440, texture.flipY );\r\n\t\t\t_gl.pixelStorei( 37441, texture.premultiplyAlpha );\r\n\t\t\t_gl.pixelStorei( 3317, texture.unpackAlignment );\r\n\r\n\t\t\tvar needsPowerOfTwo = textureNeedsPowerOfTwo( texture ) && isPowerOfTwo( texture.image ) === false;\r\n\t\t\tvar image = resizeImage( texture.image, needsPowerOfTwo, false, maxTextureSize );\r\n\r\n\t\t\tvar supportsMips = isPowerOfTwo( image ) || isWebGL2,\r\n\t\t\t\tglFormat = utils.convert( texture.format ),\r\n\t\t\t\tglType = utils.convert( texture.type ),\r\n\t\t\t\tglInternalFormat = getInternalFormat( texture.internalFormat, glFormat, glType );\r\n\r\n\t\t\tsetTextureParameters( textureType, texture, supportsMips );\r\n\r\n\t\t\tvar mipmap, mipmaps = texture.mipmaps;\r\n\r\n\t\t\tif ( texture.isDepthTexture ) {\r\n\r\n\t\t\t\t// populate depth texture with dummy data\r\n\r\n\t\t\t\tglInternalFormat = 6402;\r\n\r\n\t\t\t\tif ( isWebGL2 ) {\r\n\r\n\t\t\t\t\tif ( texture.type === FloatType ) {\r\n\r\n\t\t\t\t\t\tglInternalFormat = 36012;\r\n\r\n\t\t\t\t\t} else if ( texture.type === UnsignedIntType ) {\r\n\r\n\t\t\t\t\t\tglInternalFormat = 33190;\r\n\r\n\t\t\t\t\t} else if ( texture.type === UnsignedInt248Type ) {\r\n\r\n\t\t\t\t\t\tglInternalFormat = 35056;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tglInternalFormat = 33189; // WebGL2 requires sized internalformat for glTexImage2D\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( texture.type === FloatType ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'WebGLRenderer: Floating point depth texture requires WebGL2.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// validation checks for WebGL 1\r\n\r\n\t\t\t\tif ( texture.format === DepthFormat && glInternalFormat === 6402 ) {\r\n\r\n\t\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\r\n\t\t\t\t\t// DEPTH_COMPONENT and type is not UNSIGNED_SHORT or UNSIGNED_INT\r\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\r\n\t\t\t\t\tif ( texture.type !== UnsignedShortType && texture.type !== UnsignedIntType ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.' );\r\n\r\n\t\t\t\t\t\ttexture.type = UnsignedShortType;\r\n\t\t\t\t\t\tglType = utils.convert( texture.type );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texture.format === DepthStencilFormat && glInternalFormat === 6402 ) {\r\n\r\n\t\t\t\t\t// Depth stencil textures need the DEPTH_STENCIL internal format\r\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\r\n\t\t\t\t\tglInternalFormat = 34041;\r\n\r\n\t\t\t\t\t// The error INVALID_OPERATION is generated by texImage2D if format and internalformat are\r\n\t\t\t\t\t// DEPTH_STENCIL and type is not UNSIGNED_INT_24_8_WEBGL.\r\n\t\t\t\t\t// (https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/)\r\n\t\t\t\t\tif ( texture.type !== UnsignedInt248Type ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.' );\r\n\r\n\t\t\t\t\t\ttexture.type = UnsignedInt248Type;\r\n\t\t\t\t\t\tglType = utils.convert( texture.type );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, null );\r\n\r\n\t\t\t} else if ( texture.isDataTexture ) {\r\n\r\n\t\t\t\t// use manually created mipmaps if available\r\n\t\t\t\t// if there are no manual mipmaps\r\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\t\tif ( mipmaps.length > 0 && supportsMips ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture.generateMipmaps = false;\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, image.width, image.height, 0, glFormat, glType, image.data );\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( texture.isCompressedTexture ) {\r\n\r\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\r\n\t\t\t\t\tif ( texture.format !== RGBAFormat && texture.format !== RGBFormat ) {\r\n\r\n\t\t\t\t\t\tif ( glFormat !== null ) {\r\n\r\n\t\t\t\t\t\t\tstate.compressedTexImage2D( 3553, i, glInternalFormat, mipmap.width, mipmap.height, 0, mipmap.data );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()' );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\r\n\r\n\t\t\t} else if ( texture.isDataTexture2DArray ) {\r\n\r\n\t\t\t\tstate.texImage3D( 35866, 0, glInternalFormat, image.width, image.height, image.depth, 0, glFormat, glType, image.data );\r\n\t\t\t\ttextureProperties.__maxMipLevel = 0;\r\n\r\n\t\t\t} else if ( texture.isDataTexture3D ) {\r\n\r\n\t\t\t\tstate.texImage3D( 32879, 0, glInternalFormat, image.width, image.height, image.depth, 0, glFormat, glType, image.data );\r\n\t\t\t\ttextureProperties.__maxMipLevel = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// regular Texture (image, video, canvas)\r\n\r\n\t\t\t\t// use manually created mipmaps if available\r\n\t\t\t\t// if there are no manual mipmaps\r\n\t\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\r\n\r\n\t\t\t\tif ( mipmaps.length > 0 && supportsMips ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tmipmap = mipmaps[ i ];\r\n\t\t\t\t\t\tstate.texImage2D( 3553, i, glInternalFormat, glFormat, glType, mipmap );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture.generateMipmaps = false;\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = mipmaps.length - 1;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tstate.texImage2D( 3553, 0, glInternalFormat, glFormat, glType, image );\r\n\t\t\t\t\ttextureProperties.__maxMipLevel = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\r\n\r\n\t\t\t\tgenerateMipmap( textureType, texture, image.width, image.height );\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttextureProperties.__version = texture.version;\r\n\r\n\t\t\tif ( texture.onUpdate ) { texture.onUpdate( texture ); }\r\n\r\n\t\t}\r\n\r\n\t\t// Render targets\r\n\r\n\t\t// Setup storage for target texture and bind it to correct framebuffer\r\n\t\tfunction setupFrameBufferTexture( framebuffer, renderTarget, attachment, textureTarget ) {\r\n\r\n\t\t\tvar glFormat = utils.convert( renderTarget.texture.format );\r\n\t\t\tvar glType = utils.convert( renderTarget.texture.type );\r\n\t\t\tvar glInternalFormat = getInternalFormat( renderTarget.texture.internalFormat, glFormat, glType );\r\n\t\t\tstate.texImage2D( textureTarget, 0, glInternalFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\r\n\t\t\t_gl.bindFramebuffer( 36160, framebuffer );\r\n\t\t\t_gl.framebufferTexture2D( 36160, attachment, textureTarget, properties.get( renderTarget.texture ).__webglTexture, 0 );\r\n\t\t\t_gl.bindFramebuffer( 36160, null );\r\n\r\n\t\t}\r\n\r\n\t\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\r\n\t\tfunction setupRenderBufferStorage( renderbuffer, renderTarget, isMultisample ) {\r\n\r\n\t\t\t_gl.bindRenderbuffer( 36161, renderbuffer );\r\n\r\n\t\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t\tvar glInternalFormat = 33189;\r\n\r\n\t\t\t\tif ( isMultisample ) {\r\n\r\n\t\t\t\t\tvar depthTexture = renderTarget.depthTexture;\r\n\r\n\t\t\t\t\tif ( depthTexture && depthTexture.isDepthTexture ) {\r\n\r\n\t\t\t\t\t\tif ( depthTexture.type === FloatType ) {\r\n\r\n\t\t\t\t\t\t\tglInternalFormat = 36012;\r\n\r\n\t\t\t\t\t\t} else if ( depthTexture.type === UnsignedIntType ) {\r\n\r\n\t\t\t\t\t\t\tglInternalFormat = 33190;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar samples = getRenderTargetSamples( renderTarget );\r\n\r\n\t\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_gl.renderbufferStorage( 36161, glInternalFormat, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_gl.framebufferRenderbuffer( 36160, 36096, 36161, renderbuffer );\r\n\r\n\t\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\r\n\r\n\t\t\t\tif ( isMultisample ) {\r\n\r\n\t\t\t\t\tvar samples = getRenderTargetSamples( renderTarget );\r\n\r\n\t\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, 35056, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_gl.renderbufferStorage( 36161, 34041, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\t_gl.framebufferRenderbuffer( 36160, 33306, 36161, renderbuffer );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar glFormat = utils.convert( renderTarget.texture.format );\r\n\t\t\t\tvar glType = utils.convert( renderTarget.texture.type );\r\n\t\t\t\tvar glInternalFormat = getInternalFormat( renderTarget.texture.internalFormat, glFormat, glType );\r\n\r\n\t\t\t\tif ( isMultisample ) {\r\n\r\n\t\t\t\t\tvar samples = getRenderTargetSamples( renderTarget );\r\n\r\n\t\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_gl.renderbufferStorage( 36161, glInternalFormat, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindRenderbuffer( 36161, null );\r\n\r\n\t\t}\r\n\r\n\t\t// Setup resources for a Depth Texture for a FBO (needs an extension)\r\n\t\tfunction setupDepthTexture( framebuffer, renderTarget ) {\r\n\r\n\t\t\tvar isCube = ( renderTarget && renderTarget.isWebGLCubeRenderTarget );\r\n\t\t\tif ( isCube ) { throw new Error( 'Depth Texture with cube render targets is not supported' ); }\r\n\r\n\t\t\t_gl.bindFramebuffer( 36160, framebuffer );\r\n\r\n\t\t\tif ( ! ( renderTarget.depthTexture && renderTarget.depthTexture.isDepthTexture ) ) {\r\n\r\n\t\t\t\tthrow new Error( 'renderTarget.depthTexture must be an instance of THREE.DepthTexture' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// upload an empty depth texture with framebuffer size\r\n\t\t\tif ( ! properties.get( renderTarget.depthTexture ).__webglTexture ||\r\n\t\t\t\t\trenderTarget.depthTexture.image.width !== renderTarget.width ||\r\n\t\t\t\t\trenderTarget.depthTexture.image.height !== renderTarget.height ) {\r\n\r\n\t\t\t\trenderTarget.depthTexture.image.width = renderTarget.width;\r\n\t\t\t\trenderTarget.depthTexture.image.height = renderTarget.height;\r\n\t\t\t\trenderTarget.depthTexture.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetTexture2D( renderTarget.depthTexture, 0 );\r\n\r\n\t\t\tvar webglDepthTexture = properties.get( renderTarget.depthTexture ).__webglTexture;\r\n\r\n\t\t\tif ( renderTarget.depthTexture.format === DepthFormat ) {\r\n\r\n\t\t\t\t_gl.framebufferTexture2D( 36160, 36096, 3553, webglDepthTexture, 0 );\r\n\r\n\t\t\t} else if ( renderTarget.depthTexture.format === DepthStencilFormat ) {\r\n\r\n\t\t\t\t_gl.framebufferTexture2D( 36160, 33306, 3553, webglDepthTexture, 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthrow new Error( 'Unknown depthTexture format' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Setup GL resources for a non-texture depth buffer\r\n\t\tfunction setupDepthRenderbuffer( renderTarget ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\r\n\t\t\tvar isCube = ( renderTarget.isWebGLCubeRenderTarget === true );\r\n\r\n\t\t\tif ( renderTarget.depthTexture ) {\r\n\r\n\t\t\t\tif ( isCube ) { throw new Error( 'target.depthTexture not supported in Cube render targets' ); }\r\n\r\n\t\t\t\tsetupDepthTexture( renderTargetProperties.__webglFramebuffer, renderTarget );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer = [];\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\t\t_gl.bindFramebuffer( 36160, renderTargetProperties.__webglFramebuffer[ i ] );\r\n\t\t\t\t\t\trenderTargetProperties.__webglDepthbuffer[ i ] = _gl.createRenderbuffer();\r\n\t\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer[ i ], renderTarget, false );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( 36160, renderTargetProperties.__webglFramebuffer );\r\n\t\t\t\t\trenderTargetProperties.__webglDepthbuffer = _gl.createRenderbuffer();\r\n\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthbuffer, renderTarget, false );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gl.bindFramebuffer( 36160, null );\r\n\r\n\t\t}\r\n\r\n\t\t// Set up GL resources for the render target\r\n\t\tfunction setupRenderTarget( renderTarget ) {\r\n\r\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\r\n\t\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\r\n\r\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\r\n\r\n\t\t\tinfo.memory.textures ++;\r\n\r\n\t\t\tvar isCube = ( renderTarget.isWebGLCubeRenderTarget === true );\r\n\t\t\tvar isMultisample = ( renderTarget.isWebGLMultisampleRenderTarget === true );\r\n\t\t\tvar supportsMips = isPowerOfTwo( renderTarget ) || isWebGL2;\r\n\r\n\t\t\t// Handles WebGL2 RGBFormat fallback - #18858\r\n\r\n\t\t\tif ( isWebGL2 && renderTarget.texture.format === RGBFormat && ( renderTarget.texture.type === FloatType || renderTarget.texture.type === HalfFloatType ) ) {\r\n\r\n\t\t\t\trenderTarget.texture.format = RGBAFormat;\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Setup framebuffer\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\trenderTargetProperties.__webglFramebuffer = [];\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\r\n\r\n\t\t\t\tif ( isMultisample ) {\r\n\r\n\t\t\t\t\tif ( isWebGL2 ) {\r\n\r\n\t\t\t\t\t\trenderTargetProperties.__webglMultisampledFramebuffer = _gl.createFramebuffer();\r\n\t\t\t\t\t\trenderTargetProperties.__webglColorRenderbuffer = _gl.createRenderbuffer();\r\n\r\n\t\t\t\t\t\t_gl.bindRenderbuffer( 36161, renderTargetProperties.__webglColorRenderbuffer );\r\n\r\n\t\t\t\t\t\tvar glFormat = utils.convert( renderTarget.texture.format );\r\n\t\t\t\t\t\tvar glType = utils.convert( renderTarget.texture.type );\r\n\t\t\t\t\t\tvar glInternalFormat = getInternalFormat( renderTarget.texture.internalFormat, glFormat, glType );\r\n\t\t\t\t\t\tvar samples = getRenderTargetSamples( renderTarget );\r\n\t\t\t\t\t\t_gl.renderbufferStorageMultisample( 36161, samples, glInternalFormat, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t\t\t_gl.bindFramebuffer( 36160, renderTargetProperties.__webglMultisampledFramebuffer );\r\n\t\t\t\t\t\t_gl.framebufferRenderbuffer( 36160, 36064, 36161, renderTargetProperties.__webglColorRenderbuffer );\r\n\t\t\t\t\t\t_gl.bindRenderbuffer( 36161, null );\r\n\r\n\t\t\t\t\t\tif ( renderTarget.depthBuffer ) {\r\n\r\n\t\t\t\t\t\t\trenderTargetProperties.__webglDepthRenderbuffer = _gl.createRenderbuffer();\r\n\t\t\t\t\t\t\tsetupRenderBufferStorage( renderTargetProperties.__webglDepthRenderbuffer, renderTarget, true );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_gl.bindFramebuffer( 36160, null );\r\n\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Setup color buffer\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\tstate.bindTexture( 34067, textureProperties.__webglTexture );\r\n\t\t\t\tsetTextureParameters( 34067, renderTarget.texture, supportsMips );\r\n\r\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, 36064, 34069 + i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( textureNeedsGenerateMipmaps( renderTarget.texture, supportsMips ) ) {\r\n\r\n\t\t\t\t\tgenerateMipmap( 34067, renderTarget.texture, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.bindTexture( 34067, null );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tstate.bindTexture( 3553, textureProperties.__webglTexture );\r\n\t\t\t\tsetTextureParameters( 3553, renderTarget.texture, supportsMips );\r\n\t\t\t\tsetupFrameBufferTexture( renderTargetProperties.__webglFramebuffer, renderTarget, 36064, 3553 );\r\n\r\n\t\t\t\tif ( textureNeedsGenerateMipmaps( renderTarget.texture, supportsMips ) ) {\r\n\r\n\t\t\t\t\tgenerateMipmap( 3553, renderTarget.texture, renderTarget.width, renderTarget.height );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstate.bindTexture( 3553, null );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Setup depth and stencil buffers\r\n\r\n\t\t\tif ( renderTarget.depthBuffer ) {\r\n\r\n\t\t\t\tsetupDepthRenderbuffer( renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateRenderTargetMipmap( renderTarget ) {\r\n\r\n\t\t\tvar texture = renderTarget.texture;\r\n\t\t\tvar supportsMips = isPowerOfTwo( renderTarget ) || isWebGL2;\r\n\r\n\t\t\tif ( textureNeedsGenerateMipmaps( texture, supportsMips ) ) {\r\n\r\n\t\t\t\tvar target = renderTarget.isWebGLCubeRenderTarget ? 34067 : 3553;\r\n\t\t\t\tvar webglTexture = properties.get( texture ).__webglTexture;\r\n\r\n\t\t\t\tstate.bindTexture( target, webglTexture );\r\n\t\t\t\tgenerateMipmap( target, texture, renderTarget.width, renderTarget.height );\r\n\t\t\t\tstate.bindTexture( target, null );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateMultisampleRenderTarget( renderTarget ) {\r\n\r\n\t\t\tif ( renderTarget.isWebGLMultisampleRenderTarget ) {\r\n\r\n\t\t\t\tif ( isWebGL2 ) {\r\n\r\n\t\t\t\t\tvar renderTargetProperties = properties.get( renderTarget );\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( 36008, renderTargetProperties.__webglMultisampledFramebuffer );\r\n\t\t\t\t\t_gl.bindFramebuffer( 36009, renderTargetProperties.__webglFramebuffer );\r\n\r\n\t\t\t\t\tvar width = renderTarget.width;\r\n\t\t\t\t\tvar height = renderTarget.height;\r\n\t\t\t\t\tvar mask = 16384;\r\n\r\n\t\t\t\t\tif ( renderTarget.depthBuffer ) { mask |= 256; }\r\n\t\t\t\t\tif ( renderTarget.stencilBuffer ) { mask |= 1024; }\r\n\r\n\t\t\t\t\t_gl.blitFramebuffer( 0, 0, width, height, 0, 0, width, height, mask, 9728 );\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( 36160, renderTargetProperties.__webglMultisampledFramebuffer ); // see #18905\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction getRenderTargetSamples( renderTarget ) {\r\n\r\n\t\t\treturn ( isWebGL2 && renderTarget.isWebGLMultisampleRenderTarget ) ?\r\n\t\t\t\tMath.min( maxSamples, renderTarget.samples ) : 0;\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateVideoTexture( texture ) {\r\n\r\n\t\t\tvar frame = info.render.frame;\r\n\r\n\t\t\t// Check the last frame we updated the VideoTexture\r\n\r\n\t\t\tif ( _videoTextures.get( texture ) !== frame ) {\r\n\r\n\t\t\t\t_videoTextures.set( texture, frame );\r\n\t\t\t\ttexture.update();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// backwards compatibility\r\n\r\n\t\tvar warnedTexture2D = false;\r\n\t\tvar warnedTextureCube = false;\r\n\r\n\t\tfunction safeSetTexture2D( texture, slot ) {\r\n\r\n\t\t\tif ( texture && texture.isWebGLRenderTarget ) {\r\n\r\n\t\t\t\tif ( warnedTexture2D === false ) {\r\n\r\n\t\t\t\t\tconsole.warn( \"THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead.\" );\r\n\t\t\t\t\twarnedTexture2D = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture = texture.texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetTexture2D( texture, slot );\r\n\r\n\t\t}\r\n\r\n\t\tfunction safeSetTextureCube( texture, slot ) {\r\n\r\n\t\t\tif ( texture && texture.isWebGLCubeRenderTarget ) {\r\n\r\n\t\t\t\tif ( warnedTextureCube === false ) {\r\n\r\n\t\t\t\t\tconsole.warn( \"THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead.\" );\r\n\t\t\t\t\twarnedTextureCube = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture = texture.texture;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// currently relying on the fact that WebGLCubeRenderTarget.texture is a Texture and NOT a CubeTexture\r\n\t\t\t// TODO: unify these code paths\r\n\t\t\tif ( ( texture && texture.isCubeTexture ) ||\r\n\t\t\t\t( Array.isArray( texture.image ) && texture.image.length === 6 ) ) {\r\n\r\n\t\t\t\t// CompressedTexture can have Array in image :/\r\n\r\n\t\t\t\t// this function alone should take care of cube textures\r\n\t\t\t\tsetTextureCube( texture, slot );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// assumed: texture property of THREE.WebGLCubeRenderTarget\r\n\t\t\t\tsetTextureCubeDynamic( texture, slot );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tthis.allocateTextureUnit = allocateTextureUnit;\r\n\t\tthis.resetTextureUnits = resetTextureUnits;\r\n\r\n\t\tthis.setTexture2D = setTexture2D;\r\n\t\tthis.setTexture2DArray = setTexture2DArray;\r\n\t\tthis.setTexture3D = setTexture3D;\r\n\t\tthis.setTextureCube = setTextureCube;\r\n\t\tthis.setTextureCubeDynamic = setTextureCubeDynamic;\r\n\t\tthis.setupRenderTarget = setupRenderTarget;\r\n\t\tthis.updateRenderTargetMipmap = updateRenderTargetMipmap;\r\n\t\tthis.updateMultisampleRenderTarget = updateMultisampleRenderTarget;\r\n\r\n\t\tthis.safeSetTexture2D = safeSetTexture2D;\r\n\t\tthis.safeSetTextureCube = safeSetTextureCube;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author thespite / http://www.twitter.com/thespite\r\n\t */\r\n\r\n\tfunction WebGLUtils( gl, extensions, capabilities ) {\r\n\r\n\t\tvar isWebGL2 = capabilities.isWebGL2;\r\n\r\n\t\tfunction convert( p ) {\r\n\r\n\t\t\tvar extension;\r\n\r\n\t\t\tif ( p === UnsignedByteType ) { return 5121; }\r\n\t\t\tif ( p === UnsignedShort4444Type ) { return 32819; }\r\n\t\t\tif ( p === UnsignedShort5551Type ) { return 32820; }\r\n\t\t\tif ( p === UnsignedShort565Type ) { return 33635; }\r\n\r\n\t\t\tif ( p === ByteType ) { return 5120; }\r\n\t\t\tif ( p === ShortType ) { return 5122; }\r\n\t\t\tif ( p === UnsignedShortType ) { return 5123; }\r\n\t\t\tif ( p === IntType ) { return 5124; }\r\n\t\t\tif ( p === UnsignedIntType ) { return 5125; }\r\n\t\t\tif ( p === FloatType ) { return 5126; }\r\n\r\n\t\t\tif ( p === HalfFloatType ) {\r\n\r\n\t\t\t\tif ( isWebGL2 ) { return 5131; }\r\n\r\n\t\t\t\textension = extensions.get( 'OES_texture_half_float' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\treturn extension.HALF_FLOAT_OES;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === AlphaFormat ) { return 6406; }\r\n\t\t\tif ( p === RGBFormat ) { return 6407; }\r\n\t\t\tif ( p === RGBAFormat ) { return 6408; }\r\n\t\t\tif ( p === LuminanceFormat ) { return 6409; }\r\n\t\t\tif ( p === LuminanceAlphaFormat ) { return 6410; }\r\n\t\t\tif ( p === DepthFormat ) { return 6402; }\r\n\t\t\tif ( p === DepthStencilFormat ) { return 34041; }\r\n\t\t\tif ( p === RedFormat ) { return 6403; }\r\n\r\n\t\t\t// WebGL2 formats.\r\n\r\n\t\t\tif ( p === RedIntegerFormat ) { return 36244; }\r\n\t\t\tif ( p === RGFormat ) { return 33319; }\r\n\t\t\tif ( p === RGIntegerFormat ) { return 33320; }\r\n\t\t\tif ( p === RGBIntegerFormat ) { return 36248; }\r\n\t\t\tif ( p === RGBAIntegerFormat ) { return 36249; }\r\n\r\n\t\t\tif ( p === RGB_S3TC_DXT1_Format || p === RGBA_S3TC_DXT1_Format ||\r\n\t\t\t\tp === RGBA_S3TC_DXT3_Format || p === RGBA_S3TC_DXT5_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) { return extension.COMPRESSED_RGB_S3TC_DXT1_EXT; }\r\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) { return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT; }\r\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) { return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT; }\r\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) { return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT; }\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format || p === RGB_PVRTC_2BPPV1_Format ||\r\n\t\t\t\tp === RGBA_PVRTC_4BPPV1_Format || p === RGBA_PVRTC_2BPPV1_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format ) { return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG; }\r\n\t\t\t\t\tif ( p === RGB_PVRTC_2BPPV1_Format ) { return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG; }\r\n\t\t\t\t\tif ( p === RGBA_PVRTC_4BPPV1_Format ) { return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG; }\r\n\t\t\t\t\tif ( p === RGBA_PVRTC_2BPPV1_Format ) { return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG; }\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === RGB_ETC1_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc1' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\treturn extension.COMPRESSED_RGB_ETC1_WEBGL;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === RGB_ETC2_Format || p === RGBA_ETC2_EAC_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\tif ( p === RGB_ETC2_Format ) { return extension.COMPRESSED_RGB8_ETC2; }\r\n\t\t\t\t\tif ( p === RGBA_ETC2_EAC_Format ) { return extension.COMPRESSED_RGBA8_ETC2_EAC; }\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === RGBA_ASTC_4x4_Format || p === RGBA_ASTC_5x4_Format || p === RGBA_ASTC_5x5_Format ||\r\n\t\t\t\tp === RGBA_ASTC_6x5_Format || p === RGBA_ASTC_6x6_Format || p === RGBA_ASTC_8x5_Format ||\r\n\t\t\t\tp === RGBA_ASTC_8x6_Format || p === RGBA_ASTC_8x8_Format || p === RGBA_ASTC_10x5_Format ||\r\n\t\t\t\tp === RGBA_ASTC_10x6_Format || p === RGBA_ASTC_10x8_Format || p === RGBA_ASTC_10x10_Format ||\r\n\t\t\t\tp === RGBA_ASTC_12x10_Format || p === RGBA_ASTC_12x12_Format ||\r\n\t\t\t\tp === SRGB8_ALPHA8_ASTC_4x4_Format || p === SRGB8_ALPHA8_ASTC_5x4_Format || p === SRGB8_ALPHA8_ASTC_5x5_Format ||\r\n\t\t\t\tp === SRGB8_ALPHA8_ASTC_6x5_Format || p === SRGB8_ALPHA8_ASTC_6x6_Format || p === SRGB8_ALPHA8_ASTC_8x5_Format ||\r\n\t\t\t\tp === SRGB8_ALPHA8_ASTC_8x6_Format || p === SRGB8_ALPHA8_ASTC_8x8_Format || p === SRGB8_ALPHA8_ASTC_10x5_Format ||\r\n\t\t\t\tp === SRGB8_ALPHA8_ASTC_10x6_Format || p === SRGB8_ALPHA8_ASTC_10x8_Format || p === SRGB8_ALPHA8_ASTC_10x10_Format ||\r\n\t\t\t\tp === SRGB8_ALPHA8_ASTC_12x10_Format || p === SRGB8_ALPHA8_ASTC_12x12_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_astc' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\t// TODO Complete?\r\n\r\n\t\t\t\t\treturn p;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === RGBA_BPTC_Format ) {\r\n\r\n\t\t\t\textension = extensions.get( 'EXT_texture_compression_bptc' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\t// TODO Complete?\r\n\r\n\t\t\t\t\treturn p;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( p === UnsignedInt248Type ) {\r\n\r\n\t\t\t\tif ( isWebGL2 ) { return 34042; }\r\n\r\n\t\t\t\textension = extensions.get( 'WEBGL_depth_texture' );\r\n\r\n\t\t\t\tif ( extension !== null ) {\r\n\r\n\t\t\t\t\treturn extension.UNSIGNED_INT_24_8_WEBGL;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn { convert: convert };\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction ArrayCamera( array ) {\r\n\r\n\t\tPerspectiveCamera.call( this );\r\n\r\n\t\tthis.cameras = array || [];\r\n\r\n\t}\r\n\r\n\tArrayCamera.prototype = Object.assign( Object.create( PerspectiveCamera.prototype ), {\r\n\r\n\t\tconstructor: ArrayCamera,\r\n\r\n\t\tisArrayCamera: true\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Group() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Group';\r\n\r\n\t}\r\n\r\n\tGroup.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Group,\r\n\r\n\t\tisGroup: true\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction WebXRManager( renderer, gl ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar session = null;\r\n\r\n\t\tvar framebufferScaleFactor = 1.0;\r\n\r\n\t\tvar referenceSpace = null;\r\n\t\tvar referenceSpaceType = 'local-floor';\r\n\r\n\t\tvar pose = null;\r\n\r\n\t\tvar controllers = [];\r\n\t\tvar inputSourcesMap = new Map();\r\n\r\n\t\t//\r\n\r\n\t\tvar cameraL = new PerspectiveCamera();\r\n\t\tcameraL.layers.enable( 1 );\r\n\t\tcameraL.viewport = new Vector4();\r\n\r\n\t\tvar cameraR = new PerspectiveCamera();\r\n\t\tcameraR.layers.enable( 2 );\r\n\t\tcameraR.viewport = new Vector4();\r\n\r\n\t\tvar cameraVR = new ArrayCamera( [ cameraL, cameraR ] );\r\n\t\tcameraVR.layers.enable( 1 );\r\n\t\tcameraVR.layers.enable( 2 );\r\n\r\n\t\tvar _currentDepthNear = null;\r\n\t\tvar _currentDepthFar = null;\r\n\r\n\t\t//\r\n\r\n\t\tthis.enabled = false;\r\n\r\n\t\tthis.isPresenting = false;\r\n\r\n\t\tthis.getController = function ( id ) {\r\n\r\n\t\t\tvar controller = controllers[ id ];\r\n\r\n\t\t\tif ( controller === undefined ) {\r\n\r\n\t\t\t\tcontroller = {};\r\n\t\t\t\tcontrollers[ id ] = controller;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( controller.targetRay === undefined ) {\r\n\r\n\t\t\t\tcontroller.targetRay = new Group();\r\n\t\t\t\tcontroller.targetRay.matrixAutoUpdate = false;\r\n\t\t\t\tcontroller.targetRay.visible = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn controller.targetRay;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getControllerGrip = function ( id ) {\r\n\r\n\t\t\tvar controller = controllers[ id ];\r\n\r\n\t\t\tif ( controller === undefined ) {\r\n\r\n\t\t\t\tcontroller = {};\r\n\t\t\t\tcontrollers[ id ] = controller;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( controller.grip === undefined ) {\r\n\r\n\t\t\t\tcontroller.grip = new Group();\r\n\t\t\t\tcontroller.grip.matrixAutoUpdate = false;\r\n\t\t\t\tcontroller.grip.visible = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn controller.grip;\r\n\r\n\t\t};\r\n\r\n\t\t//\r\n\r\n\t\tfunction onSessionEvent( event ) {\r\n\r\n\t\t\tvar controller = inputSourcesMap.get( event.inputSource );\r\n\r\n\t\t\tif ( controller ) {\r\n\r\n\t\t\t\tif ( controller.targetRay ) {\r\n\r\n\t\t\t\t\tcontroller.targetRay.dispatchEvent( { type: event.type } );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( controller.grip ) {\r\n\r\n\t\t\t\t\tcontroller.grip.dispatchEvent( { type: event.type } );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction onSessionEnd() {\r\n\r\n\t\t\tinputSourcesMap.forEach( function ( controller, inputSource ) {\r\n\r\n\t\t\t\tif ( controller.targetRay ) {\r\n\r\n\t\t\t\t\tcontroller.targetRay.dispatchEvent( { type: 'disconnected', data: inputSource } );\r\n\t\t\t\t\tcontroller.targetRay.visible = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( controller.grip ) {\r\n\r\n\t\t\t\t\tcontroller.grip.dispatchEvent( { type: 'disconnected', data: inputSource } );\r\n\t\t\t\t\tcontroller.grip.visible = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tinputSourcesMap.clear();\r\n\r\n\t\t\t//\r\n\r\n\t\t\trenderer.setFramebuffer( null );\r\n\t\t\trenderer.setRenderTarget( renderer.getRenderTarget() ); // Hack #15830\r\n\t\t\tanimation.stop();\r\n\r\n\t\t\tscope.isPresenting = false;\r\n\r\n\t\t\tscope.dispatchEvent( { type: 'sessionend' } );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onRequestReferenceSpace( value ) {\r\n\r\n\t\t\treferenceSpace = value;\r\n\r\n\t\t\tanimation.setContext( session );\r\n\t\t\tanimation.start();\r\n\r\n\t\t\tscope.isPresenting = true;\r\n\r\n\t\t\tscope.dispatchEvent( { type: 'sessionstart' } );\r\n\r\n\t\t}\r\n\r\n\t\tthis.setFramebufferScaleFactor = function ( value ) {\r\n\r\n\t\t\tframebufferScaleFactor = value;\r\n\r\n\t\t\t// Warn if function is used while presenting\r\n\t\t\tif ( scope.isPresenting == true ) {\r\n\r\n\t\t\t\tconsole.warn( \"WebXRManager: Cannot change framebuffer scale while presenting VR content\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.setReferenceSpaceType = function ( value ) {\r\n\r\n\t\t\treferenceSpaceType = value;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getReferenceSpace = function () {\r\n\r\n\t\t\treturn referenceSpace;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getSession = function () {\r\n\r\n\t\t\treturn session;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setSession = function ( value ) {\r\n\r\n\t\t\tsession = value;\r\n\r\n\t\t\tif ( session !== null ) {\r\n\r\n\t\t\t\tsession.addEventListener( 'select', onSessionEvent );\r\n\t\t\t\tsession.addEventListener( 'selectstart', onSessionEvent );\r\n\t\t\t\tsession.addEventListener( 'selectend', onSessionEvent );\r\n\t\t\t\tsession.addEventListener( 'squeeze', onSessionEvent );\r\n\t\t\t\tsession.addEventListener( 'squeezestart', onSessionEvent );\r\n\t\t\t\tsession.addEventListener( 'squeezeend', onSessionEvent );\r\n\t\t\t\tsession.addEventListener( 'end', onSessionEnd );\r\n\r\n\t\t\t\tvar attributes = gl.getContextAttributes();\r\n\r\n\t\t\t\tvar layerInit = {\r\n\t\t\t\t\tantialias: attributes.antialias,\r\n\t\t\t\t\talpha: attributes.alpha,\r\n\t\t\t\t\tdepth: attributes.depth,\r\n\t\t\t\t\tstencil: attributes.stencil,\r\n\t\t\t\t\tframebufferScaleFactor: framebufferScaleFactor\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// eslint-disable-next-line no-undef\r\n\t\t\t\tvar baseLayer = new XRWebGLLayer( session, gl, layerInit );\r\n\r\n\t\t\t\tsession.updateRenderState( { baseLayer: baseLayer } );\r\n\r\n\t\t\t\tsession.requestReferenceSpace( referenceSpaceType ).then( onRequestReferenceSpace );\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tsession.addEventListener( 'inputsourceschange', updateInputSources );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tfunction updateInputSources( event ) {\r\n\r\n\t\t\tvar inputSources = session.inputSources;\r\n\r\n\t\t\t// Assign inputSources to available controllers\r\n\r\n\t\t\tfor ( var i = 0; i < controllers.length; i ++ ) {\r\n\r\n\t\t\t\tinputSourcesMap.set( inputSources[ i ], controllers[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Notify disconnected\r\n\r\n\t\t\tfor ( var i = 0; i < event.removed.length; i ++ ) {\r\n\r\n\t\t\t\tvar inputSource = event.removed[ i ];\r\n\t\t\t\tvar controller = inputSourcesMap.get( inputSource );\r\n\r\n\t\t\t\tif ( controller ) {\r\n\r\n\t\t\t\t\tif ( controller.targetRay ) {\r\n\r\n\t\t\t\t\t\tcontroller.targetRay.dispatchEvent( { type: 'disconnected', data: inputSource } );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( controller.grip ) {\r\n\r\n\t\t\t\t\t\tcontroller.grip.dispatchEvent( { type: 'disconnected', data: inputSource } );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tinputSourcesMap.delete( inputSource );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Notify connected\r\n\r\n\t\t\tfor ( var i = 0; i < event.added.length; i ++ ) {\r\n\r\n\t\t\t\tvar inputSource = event.added[ i ];\r\n\t\t\t\tvar controller = inputSourcesMap.get( inputSource );\r\n\r\n\t\t\t\tif ( controller ) {\r\n\r\n\t\t\t\t\tif ( controller.targetRay ) {\r\n\r\n\t\t\t\t\t\tcontroller.targetRay.dispatchEvent( { type: 'connected', data: inputSource } );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( controller.grip ) {\r\n\r\n\t\t\t\t\t\tcontroller.grip.dispatchEvent( { type: 'connected', data: inputSource } );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tvar cameraLPos = new Vector3();\r\n\t\tvar cameraRPos = new Vector3();\r\n\r\n\t\t/**\r\n\t\t * @author jsantell / https://www.jsantell.com/\r\n\t\t *\r\n\t\t * Assumes 2 cameras that are parallel and share an X-axis, and that\r\n\t\t * the cameras' projection and world matrices have already been set.\r\n\t\t * And that near and far planes are identical for both cameras.\r\n\t\t * Visualization of this technique: https://computergraphics.stackexchange.com/a/4765\r\n\t\t */\r\n\t\tfunction setProjectionFromUnion( camera, cameraL, cameraR ) {\r\n\r\n\t\t\tcameraLPos.setFromMatrixPosition( cameraL.matrixWorld );\r\n\t\t\tcameraRPos.setFromMatrixPosition( cameraR.matrixWorld );\r\n\r\n\t\t\tvar ipd = cameraLPos.distanceTo( cameraRPos );\r\n\r\n\t\t\tvar projL = cameraL.projectionMatrix.elements;\r\n\t\t\tvar projR = cameraR.projectionMatrix.elements;\r\n\r\n\t\t\t// VR systems will have identical far and near planes, and\r\n\t\t\t// most likely identical top and bottom frustum extents.\r\n\t\t\t// Use the left camera for these values.\r\n\t\t\tvar near = projL[ 14 ] / ( projL[ 10 ] - 1 );\r\n\t\t\tvar far = projL[ 14 ] / ( projL[ 10 ] + 1 );\r\n\t\t\tvar topFov = ( projL[ 9 ] + 1 ) / projL[ 5 ];\r\n\t\t\tvar bottomFov = ( projL[ 9 ] - 1 ) / projL[ 5 ];\r\n\r\n\t\t\tvar leftFov = ( projL[ 8 ] - 1 ) / projL[ 0 ];\r\n\t\t\tvar rightFov = ( projR[ 8 ] + 1 ) / projR[ 0 ];\r\n\t\t\tvar left = near * leftFov;\r\n\t\t\tvar right = near * rightFov;\r\n\r\n\t\t\t// Calculate the new camera's position offset from the\r\n\t\t\t// left camera. xOffset should be roughly half `ipd`.\r\n\t\t\tvar zOffset = ipd / ( - leftFov + rightFov );\r\n\t\t\tvar xOffset = zOffset * - leftFov;\r\n\r\n\t\t\t// TODO: Better way to apply this offset?\r\n\t\t\tcameraL.matrixWorld.decompose( camera.position, camera.quaternion, camera.scale );\r\n\t\t\tcamera.translateX( xOffset );\r\n\t\t\tcamera.translateZ( zOffset );\r\n\t\t\tcamera.matrixWorld.compose( camera.position, camera.quaternion, camera.scale );\r\n\t\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\r\n\r\n\t\t\t// Find the union of the frustum values of the cameras and scale\r\n\t\t\t// the values so that the near plane's position does not change in world space,\r\n\t\t\t// although must now be relative to the new union camera.\r\n\t\t\tvar near2 = near + zOffset;\r\n\t\t\tvar far2 = far + zOffset;\r\n\t\t\tvar left2 = left - xOffset;\r\n\t\t\tvar right2 = right + ( ipd - xOffset );\r\n\t\t\tvar top2 = topFov * far / far2 * near2;\r\n\t\t\tvar bottom2 = bottomFov * far / far2 * near2;\r\n\r\n\t\t\tcamera.projectionMatrix.makePerspective( left2, right2, top2, bottom2, near2, far2 );\r\n\r\n\t\t}\r\n\r\n\t\tfunction updateCamera( camera, parent ) {\r\n\r\n\t\t\tif ( parent === null ) {\r\n\r\n\t\t\t\tcamera.matrixWorld.copy( camera.matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcamera.matrixWorld.multiplyMatrices( parent.matrixWorld, camera.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\r\n\r\n\t\t}\r\n\r\n\t\tthis.getCamera = function ( camera ) {\r\n\r\n\t\t\tcameraVR.near = cameraR.near = cameraL.near = camera.near;\r\n\t\t\tcameraVR.far = cameraR.far = cameraL.far = camera.far;\r\n\r\n\t\t\tif ( _currentDepthNear !== cameraVR.near || _currentDepthFar !== cameraVR.far ) {\r\n\r\n\t\t\t\t// Note that the new renderState won't apply until the next frame. See #18320\r\n\r\n\t\t\t\tsession.updateRenderState( {\r\n\t\t\t\t\tdepthNear: cameraVR.near,\r\n\t\t\t\t\tdepthFar: cameraVR.far\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t_currentDepthNear = cameraVR.near;\r\n\t\t\t\t_currentDepthFar = cameraVR.far;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar parent = camera.parent;\r\n\t\t\tvar cameras = cameraVR.cameras;\r\n\r\n\t\t\tupdateCamera( cameraVR, parent );\r\n\r\n\t\t\tfor ( var i = 0; i < cameras.length; i ++ ) {\r\n\r\n\t\t\t\tupdateCamera( cameras[ i ], parent );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update camera and its children\r\n\r\n\t\t\tcamera.matrixWorld.copy( cameraVR.matrixWorld );\r\n\r\n\t\t\tvar children = camera.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tchildren[ i ].updateMatrixWorld( true );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetProjectionFromUnion( cameraVR, cameraL, cameraR );\r\n\r\n\t\t\treturn cameraVR;\r\n\r\n\t\t};\r\n\r\n\t\t// Animation Loop\r\n\r\n\t\tvar onAnimationFrameCallback = null;\r\n\r\n\t\tfunction onAnimationFrame( time, frame ) {\r\n\r\n\t\t\tpose = frame.getViewerPose( referenceSpace );\r\n\r\n\t\t\tif ( pose !== null ) {\r\n\r\n\t\t\t\tvar views = pose.views;\r\n\t\t\t\tvar baseLayer = session.renderState.baseLayer;\r\n\r\n\t\t\t\trenderer.setFramebuffer( baseLayer.framebuffer );\r\n\r\n\t\t\t\tfor ( var i = 0; i < views.length; i ++ ) {\r\n\r\n\t\t\t\t\tvar view = views[ i ];\r\n\t\t\t\t\tvar viewport = baseLayer.getViewport( view );\r\n\r\n\t\t\t\t\tvar camera = cameraVR.cameras[ i ];\r\n\t\t\t\t\tcamera.matrix.fromArray( view.transform.matrix );\r\n\t\t\t\t\tcamera.projectionMatrix.fromArray( view.projectionMatrix );\r\n\t\t\t\t\tcamera.viewport.set( viewport.x, viewport.y, viewport.width, viewport.height );\r\n\r\n\t\t\t\t\tif ( i === 0 ) {\r\n\r\n\t\t\t\t\t\tcameraVR.matrix.copy( camera.matrix );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar inputSources = session.inputSources;\r\n\r\n\t\t\tfor ( var i = 0; i < controllers.length; i ++ ) {\r\n\r\n\t\t\t\tvar controller = controllers[ i ];\r\n\r\n\t\t\t\tvar inputSource = inputSources[ i ];\r\n\r\n\t\t\t\tvar inputPose = null;\r\n\t\t\t\tvar gripPose = null;\r\n\r\n\t\t\t\tif ( inputSource ) {\r\n\r\n\t\t\t\t\tif ( controller.targetRay ) {\r\n\r\n\t\t\t\t\t\tinputPose = frame.getPose( inputSource.targetRaySpace, referenceSpace );\r\n\r\n\t\t\t\t\t\tif ( inputPose !== null ) {\r\n\r\n\t\t\t\t\t\t\tcontroller.targetRay.matrix.fromArray( inputPose.transform.matrix );\r\n\t\t\t\t\t\t\tcontroller.targetRay.matrix.decompose( controller.targetRay.position, controller.targetRay.rotation, controller.targetRay.scale );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( controller.grip && inputSource.gripSpace ) {\r\n\r\n\t\t\t\t\t\tgripPose = frame.getPose( inputSource.gripSpace, referenceSpace );\r\n\r\n\t\t\t\t\t\tif ( gripPose !== null ) {\r\n\r\n\t\t\t\t\t\t\tcontroller.grip.matrix.fromArray( gripPose.transform.matrix );\r\n\t\t\t\t\t\t\tcontroller.grip.matrix.decompose( controller.grip.position, controller.grip.rotation, controller.grip.scale );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( controller.targetRay ) {\r\n\r\n\t\t\t\t\tcontroller.targetRay.visible = inputPose !== null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( controller.grip ) {\r\n\r\n\t\t\t\t\tcontroller.grip.visible = gripPose !== null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( onAnimationFrameCallback ) { onAnimationFrameCallback( time, frame ); }\r\n\r\n\t\t}\r\n\r\n\t\tvar animation = new WebGLAnimation();\r\n\t\tanimation.setAnimationLoop( onAnimationFrame );\r\n\r\n\t\tthis.setAnimationLoop = function ( callback ) {\r\n\r\n\t\t\tonAnimationFrameCallback = callback;\r\n\r\n\t\t};\r\n\r\n\t\tthis.dispose = function () {};\r\n\r\n\t}\r\n\r\n\tObject.assign( WebXRManager.prototype, EventDispatcher.prototype );\r\n\r\n\t/**\r\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author szimek / https://github.com/szimek/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction WebGLRenderer( parameters ) {\r\n\r\n\t\tparameters = parameters || {};\r\n\r\n\t\tvar _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElementNS( 'http://www.w3.org/1999/xhtml', 'canvas' ),\r\n\t\t\t_context = parameters.context !== undefined ? parameters.context : null,\r\n\r\n\t\t\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\r\n\t\t\t_depth = parameters.depth !== undefined ? parameters.depth : true,\r\n\t\t\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\r\n\t\t\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\r\n\t\t\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\r\n\t\t\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\r\n\t\t\t_powerPreference = parameters.powerPreference !== undefined ? parameters.powerPreference : 'default',\r\n\t\t\t_failIfMajorPerformanceCaveat = parameters.failIfMajorPerformanceCaveat !== undefined ? parameters.failIfMajorPerformanceCaveat : false;\r\n\r\n\t\tvar currentRenderList = null;\r\n\t\tvar currentRenderState = null;\r\n\r\n\t\t// public properties\r\n\r\n\t\tthis.domElement = _canvas;\r\n\r\n\t\t// Debug configuration container\r\n\t\tthis.debug = {\r\n\r\n\t\t\t/**\r\n\t\t\t * Enables error checking and reporting when shader programs are being compiled\r\n\t\t\t * @type {boolean}\r\n\t\t\t */\r\n\t\t\tcheckShaderErrors: true\r\n\t\t};\r\n\r\n\t\t// clearing\r\n\r\n\t\tthis.autoClear = true;\r\n\t\tthis.autoClearColor = true;\r\n\t\tthis.autoClearDepth = true;\r\n\t\tthis.autoClearStencil = true;\r\n\r\n\t\t// scene graph\r\n\r\n\t\tthis.sortObjects = true;\r\n\r\n\t\t// user-defined clipping\r\n\r\n\t\tthis.clippingPlanes = [];\r\n\t\tthis.localClippingEnabled = false;\r\n\r\n\t\t// physically based shading\r\n\r\n\t\tthis.gammaFactor = 2.0;\t// for backwards compatibility\r\n\t\tthis.outputEncoding = LinearEncoding;\r\n\r\n\t\t// physical lights\r\n\r\n\t\tthis.physicallyCorrectLights = false;\r\n\r\n\t\t// tone mapping\r\n\r\n\t\tthis.toneMapping = LinearToneMapping;\r\n\t\tthis.toneMappingExposure = 1.0;\r\n\t\tthis.toneMappingWhitePoint = 1.0;\r\n\r\n\t\t// morphs\r\n\r\n\t\tthis.maxMorphTargets = 8;\r\n\t\tthis.maxMorphNormals = 4;\r\n\r\n\t\t// internal properties\r\n\r\n\t\tvar _this = this,\r\n\r\n\t\t\t_isContextLost = false,\r\n\r\n\t\t\t// internal state cache\r\n\r\n\t\t\t_framebuffer = null,\r\n\r\n\t\t\t_currentActiveCubeFace = 0,\r\n\t\t\t_currentActiveMipmapLevel = 0,\r\n\t\t\t_currentRenderTarget = null,\r\n\t\t\t_currentFramebuffer = null,\r\n\t\t\t_currentMaterialId = - 1,\r\n\r\n\t\t\t// geometry and program caching\r\n\r\n\t\t\t_currentGeometryProgram = {\r\n\t\t\t\tgeometry: null,\r\n\t\t\t\tprogram: null,\r\n\t\t\t\twireframe: false\r\n\t\t\t},\r\n\r\n\t\t\t_currentCamera = null,\r\n\t\t\t_currentArrayCamera = null,\r\n\r\n\t\t\t_currentViewport = new Vector4(),\r\n\t\t\t_currentScissor = new Vector4(),\r\n\t\t\t_currentScissorTest = null,\r\n\r\n\t\t\t//\r\n\r\n\t\t\t_width = _canvas.width,\r\n\t\t\t_height = _canvas.height,\r\n\r\n\t\t\t_pixelRatio = 1,\r\n\t\t\t_opaqueSort = null,\r\n\t\t\t_transparentSort = null,\r\n\r\n\t\t\t_viewport = new Vector4( 0, 0, _width, _height ),\r\n\t\t\t_scissor = new Vector4( 0, 0, _width, _height ),\r\n\t\t\t_scissorTest = false,\r\n\r\n\t\t\t// frustum\r\n\r\n\t\t\t_frustum = new Frustum(),\r\n\r\n\t\t\t// clipping\r\n\r\n\t\t\t_clipping = new WebGLClipping(),\r\n\t\t\t_clippingEnabled = false,\r\n\t\t\t_localClippingEnabled = false,\r\n\r\n\t\t\t// camera matrices cache\r\n\r\n\t\t\t_projScreenMatrix = new Matrix4(),\r\n\r\n\t\t\t_vector3 = new Vector3();\r\n\r\n\t\tfunction getTargetPixelRatio() {\r\n\r\n\t\t\treturn _currentRenderTarget === null ? _pixelRatio : 1;\r\n\r\n\t\t}\r\n\r\n\t\t// initialize\r\n\r\n\t\tvar _gl;\r\n\r\n\t\ttry {\r\n\r\n\t\t\tvar contextAttributes = {\r\n\t\t\t\talpha: _alpha,\r\n\t\t\t\tdepth: _depth,\r\n\t\t\t\tstencil: _stencil,\r\n\t\t\t\tantialias: _antialias,\r\n\t\t\t\tpremultipliedAlpha: _premultipliedAlpha,\r\n\t\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer,\r\n\t\t\t\tpowerPreference: _powerPreference,\r\n\t\t\t\tfailIfMajorPerformanceCaveat: _failIfMajorPerformanceCaveat,\r\n\t\t\t\txrCompatible: true\r\n\t\t\t};\r\n\r\n\t\t\t// event listeners must be registered before WebGL context is created, see #12753\r\n\r\n\t\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\r\n\t\t\t_canvas.addEventListener( 'webglcontextrestored', onContextRestore, false );\r\n\r\n\t\t\t_gl = _context || _canvas.getContext( 'webgl', contextAttributes ) || _canvas.getContext( 'experimental-webgl', contextAttributes );\r\n\r\n\t\t\tif ( _gl === null ) {\r\n\r\n\t\t\t\tif ( _canvas.getContext( 'webgl' ) !== null ) {\r\n\r\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context with your selected attributes.' );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthrow new Error( 'Error creating WebGL context.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Some experimental-webgl implementations do not have getShaderPrecisionFormat\r\n\r\n\t\t\tif ( _gl.getShaderPrecisionFormat === undefined ) {\r\n\r\n\t\t\t\t_gl.getShaderPrecisionFormat = function () {\r\n\r\n\t\t\t\t\treturn { 'rangeMin': 1, 'rangeMax': 1, 'precision': 1 };\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tconsole.error( 'THREE.WebGLRenderer: ' + error.message );\r\n\t\t\tthrow error;\r\n\r\n\t\t}\r\n\r\n\t\tvar extensions, capabilities, state, info;\r\n\t\tvar properties, textures, attributes, geometries, objects;\r\n\t\tvar programCache, renderLists, renderStates;\r\n\r\n\t\tvar background, morphtargets, bufferRenderer, indexedBufferRenderer;\r\n\r\n\t\tvar utils;\r\n\r\n\t\tfunction initGLContext() {\r\n\r\n\t\t\textensions = new WebGLExtensions( _gl );\r\n\r\n\t\t\tcapabilities = new WebGLCapabilities( _gl, extensions, parameters );\r\n\r\n\t\t\tif ( capabilities.isWebGL2 === false ) {\r\n\r\n\t\t\t\textensions.get( 'WEBGL_depth_texture' );\r\n\t\t\t\textensions.get( 'OES_texture_float' );\r\n\t\t\t\textensions.get( 'OES_texture_half_float' );\r\n\t\t\t\textensions.get( 'OES_texture_half_float_linear' );\r\n\t\t\t\textensions.get( 'OES_standard_derivatives' );\r\n\t\t\t\textensions.get( 'OES_element_index_uint' );\r\n\t\t\t\textensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\textensions.get( 'OES_texture_float_linear' );\r\n\r\n\t\t\tutils = new WebGLUtils( _gl, extensions, capabilities );\r\n\r\n\t\t\tstate = new WebGLState( _gl, extensions, capabilities );\r\n\t\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ).floor() );\r\n\t\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ).floor() );\r\n\r\n\t\t\tinfo = new WebGLInfo( _gl );\r\n\t\t\tproperties = new WebGLProperties();\r\n\t\t\ttextures = new WebGLTextures( _gl, extensions, state, properties, capabilities, utils, info );\r\n\t\t\tattributes = new WebGLAttributes( _gl, capabilities );\r\n\t\t\tgeometries = new WebGLGeometries( _gl, attributes, info );\r\n\t\t\tobjects = new WebGLObjects( _gl, geometries, attributes, info );\r\n\t\t\tmorphtargets = new WebGLMorphtargets( _gl );\r\n\t\t\tprogramCache = new WebGLPrograms( _this, extensions, capabilities );\r\n\t\t\trenderLists = new WebGLRenderLists();\r\n\t\t\trenderStates = new WebGLRenderStates();\r\n\r\n\t\t\tbackground = new WebGLBackground( _this, state, objects, _premultipliedAlpha );\r\n\r\n\t\t\tbufferRenderer = new WebGLBufferRenderer( _gl, extensions, info, capabilities );\r\n\t\t\tindexedBufferRenderer = new WebGLIndexedBufferRenderer( _gl, extensions, info, capabilities );\r\n\r\n\t\t\tinfo.programs = programCache.programs;\r\n\r\n\t\t\t_this.capabilities = capabilities;\r\n\t\t\t_this.extensions = extensions;\r\n\t\t\t_this.properties = properties;\r\n\t\t\t_this.renderLists = renderLists;\r\n\t\t\t_this.state = state;\r\n\t\t\t_this.info = info;\r\n\r\n\t\t}\r\n\r\n\t\tinitGLContext();\r\n\r\n\t\t// xr\r\n\r\n\t\tvar xr = new WebXRManager( _this, _gl );\r\n\r\n\t\tthis.xr = xr;\r\n\r\n\t\t// shadow map\r\n\r\n\t\tvar shadowMap = new WebGLShadowMap( _this, objects, capabilities.maxTextureSize );\r\n\r\n\t\tthis.shadowMap = shadowMap;\r\n\r\n\t\t// API\r\n\r\n\t\tthis.getContext = function () {\r\n\r\n\t\t\treturn _gl;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getContextAttributes = function () {\r\n\r\n\t\t\treturn _gl.getContextAttributes();\r\n\r\n\t\t};\r\n\r\n\t\tthis.forceContextLoss = function () {\r\n\r\n\t\t\tvar extension = extensions.get( 'WEBGL_lose_context' );\r\n\t\t\tif ( extension ) { extension.loseContext(); }\r\n\r\n\t\t};\r\n\r\n\t\tthis.forceContextRestore = function () {\r\n\r\n\t\t\tvar extension = extensions.get( 'WEBGL_lose_context' );\r\n\t\t\tif ( extension ) { extension.restoreContext(); }\r\n\r\n\t\t};\r\n\r\n\t\tthis.getPixelRatio = function () {\r\n\r\n\t\t\treturn _pixelRatio;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setPixelRatio = function ( value ) {\r\n\r\n\t\t\tif ( value === undefined ) { return; }\r\n\r\n\t\t\t_pixelRatio = value;\r\n\r\n\t\t\tthis.setSize( _width, _height, false );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getSize = function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'WebGLRenderer: .getsize() now requires a Vector2 as an argument' );\r\n\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.set( _width, _height );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setSize = function ( width, height, updateStyle ) {\r\n\r\n\t\t\tif ( xr.isPresenting ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Can\\'t change size while VR device is presenting.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_width = width;\r\n\t\t\t_height = height;\r\n\r\n\t\t\t_canvas.width = Math.floor( width * _pixelRatio );\r\n\t\t\t_canvas.height = Math.floor( height * _pixelRatio );\r\n\r\n\t\t\tif ( updateStyle !== false ) {\r\n\r\n\t\t\t\t_canvas.style.width = width + 'px';\r\n\t\t\t\t_canvas.style.height = height + 'px';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setViewport( 0, 0, width, height );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getDrawingBufferSize = function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument' );\r\n\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.set( _width * _pixelRatio, _height * _pixelRatio ).floor();\r\n\r\n\t\t};\r\n\r\n\t\tthis.setDrawingBufferSize = function ( width, height, pixelRatio ) {\r\n\r\n\t\t\t_width = width;\r\n\t\t\t_height = height;\r\n\r\n\t\t\t_pixelRatio = pixelRatio;\r\n\r\n\t\t\t_canvas.width = Math.floor( width * pixelRatio );\r\n\t\t\t_canvas.height = Math.floor( height * pixelRatio );\r\n\r\n\t\t\tthis.setViewport( 0, 0, width, height );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getCurrentViewport = function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument' );\r\n\r\n\t\t\t\ttarget = new Vector4();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( _currentViewport );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getViewport = function ( target ) {\r\n\r\n\t\t\treturn target.copy( _viewport );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setViewport = function ( x, y, width, height ) {\r\n\r\n\t\t\tif ( x.isVector4 ) {\r\n\r\n\t\t\t\t_viewport.set( x.x, x.y, x.z, x.w );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_viewport.set( x, y, width, height );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.viewport( _currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ).floor() );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getScissor = function ( target ) {\r\n\r\n\t\t\treturn target.copy( _scissor );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setScissor = function ( x, y, width, height ) {\r\n\r\n\t\t\tif ( x.isVector4 ) {\r\n\r\n\t\t\t\t_scissor.set( x.x, x.y, x.z, x.w );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_scissor.set( x, y, width, height );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.scissor( _currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ).floor() );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getScissorTest = function () {\r\n\r\n\t\t\treturn _scissorTest;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setScissorTest = function ( boolean ) {\r\n\r\n\t\t\tstate.setScissorTest( _scissorTest = boolean );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setOpaqueSort = function ( method ) {\r\n\r\n\t\t\t_opaqueSort = method;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setTransparentSort = function ( method ) {\r\n\r\n\t\t\t_transparentSort = method;\r\n\r\n\t\t};\r\n\r\n\t\t// Clearing\r\n\r\n\t\tthis.getClearColor = function () {\r\n\r\n\t\t\treturn background.getClearColor();\r\n\r\n\t\t};\r\n\r\n\t\tthis.setClearColor = function () {\r\n\r\n\t\t\tbackground.setClearColor.apply( background, arguments );\r\n\r\n\t\t};\r\n\r\n\t\tthis.getClearAlpha = function () {\r\n\r\n\t\t\treturn background.getClearAlpha();\r\n\r\n\t\t};\r\n\r\n\t\tthis.setClearAlpha = function () {\r\n\r\n\t\t\tbackground.setClearAlpha.apply( background, arguments );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clear = function ( color, depth, stencil ) {\r\n\r\n\t\t\tvar bits = 0;\r\n\r\n\t\t\tif ( color === undefined || color ) { bits |= 16384; }\r\n\t\t\tif ( depth === undefined || depth ) { bits |= 256; }\r\n\t\t\tif ( stencil === undefined || stencil ) { bits |= 1024; }\r\n\r\n\t\t\t_gl.clear( bits );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clearColor = function () {\r\n\r\n\t\t\tthis.clear( true, false, false );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clearDepth = function () {\r\n\r\n\t\t\tthis.clear( false, true, false );\r\n\r\n\t\t};\r\n\r\n\t\tthis.clearStencil = function () {\r\n\r\n\t\t\tthis.clear( false, false, true );\r\n\r\n\t\t};\r\n\r\n\t\t//\r\n\r\n\t\tthis.dispose = function () {\r\n\r\n\t\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\r\n\t\t\t_canvas.removeEventListener( 'webglcontextrestored', onContextRestore, false );\r\n\r\n\t\t\trenderLists.dispose();\r\n\t\t\trenderStates.dispose();\r\n\t\t\tproperties.dispose();\r\n\t\t\tobjects.dispose();\r\n\r\n\t\t\txr.dispose();\r\n\r\n\t\t\tanimation.stop();\r\n\r\n\t\t\tthis.forceContextLoss();\r\n\r\n\t\t};\r\n\r\n\t\t// Events\r\n\r\n\t\tfunction onContextLost( event ) {\r\n\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tconsole.log( 'THREE.WebGLRenderer: Context Lost.' );\r\n\r\n\t\t\t_isContextLost = true;\r\n\r\n\t\t}\r\n\r\n\t\tfunction onContextRestore( /* event */ ) {\r\n\r\n\t\t\tconsole.log( 'THREE.WebGLRenderer: Context Restored.' );\r\n\r\n\t\t\t_isContextLost = false;\r\n\r\n\t\t\tinitGLContext();\r\n\r\n\t\t}\r\n\r\n\t\tfunction onMaterialDispose( event ) {\r\n\r\n\t\t\tvar material = event.target;\r\n\r\n\t\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\t\tdeallocateMaterial( material );\r\n\r\n\t\t}\r\n\r\n\t\t// Buffer deallocation\r\n\r\n\t\tfunction deallocateMaterial( material ) {\r\n\r\n\t\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\t\tproperties.remove( material );\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfunction releaseMaterialProgramReference( material ) {\r\n\r\n\t\t\tvar programInfo = properties.get( material ).program;\r\n\r\n\t\t\tmaterial.program = undefined;\r\n\r\n\t\t\tif ( programInfo !== undefined ) {\r\n\r\n\t\t\t\tprogramCache.releaseProgram( programInfo );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Buffer rendering\r\n\r\n\t\tfunction renderObjectImmediate( object, program ) {\r\n\r\n\t\t\tobject.render( function ( object ) {\r\n\r\n\t\t\t\t_this.renderBufferImmediate( object, program );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tthis.renderBufferImmediate = function ( object, program ) {\r\n\r\n\t\t\tstate.initAttributes();\r\n\r\n\t\t\tvar buffers = properties.get( object );\r\n\r\n\t\t\tif ( object.hasPositions && ! buffers.position ) { buffers.position = _gl.createBuffer(); }\r\n\t\t\tif ( object.hasNormals && ! buffers.normal ) { buffers.normal = _gl.createBuffer(); }\r\n\t\t\tif ( object.hasUvs && ! buffers.uv ) { buffers.uv = _gl.createBuffer(); }\r\n\t\t\tif ( object.hasColors && ! buffers.color ) { buffers.color = _gl.createBuffer(); }\r\n\r\n\t\t\tvar programAttributes = program.getAttributes();\r\n\r\n\t\t\tif ( object.hasPositions ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( 34962, buffers.position );\r\n\t\t\t\t_gl.bufferData( 34962, object.positionArray, 35048 );\r\n\r\n\t\t\t\tstate.enableAttribute( programAttributes.position );\r\n\t\t\t\t_gl.vertexAttribPointer( programAttributes.position, 3, 5126, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.hasNormals ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( 34962, buffers.normal );\r\n\t\t\t\t_gl.bufferData( 34962, object.normalArray, 35048 );\r\n\r\n\t\t\t\tstate.enableAttribute( programAttributes.normal );\r\n\t\t\t\t_gl.vertexAttribPointer( programAttributes.normal, 3, 5126, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.hasUvs ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( 34962, buffers.uv );\r\n\t\t\t\t_gl.bufferData( 34962, object.uvArray, 35048 );\r\n\r\n\t\t\t\tstate.enableAttribute( programAttributes.uv );\r\n\t\t\t\t_gl.vertexAttribPointer( programAttributes.uv, 2, 5126, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.hasColors ) {\r\n\r\n\t\t\t\t_gl.bindBuffer( 34962, buffers.color );\r\n\t\t\t\t_gl.bufferData( 34962, object.colorArray, 35048 );\r\n\r\n\t\t\t\tstate.enableAttribute( programAttributes.color );\r\n\t\t\t\t_gl.vertexAttribPointer( programAttributes.color, 3, 5126, false, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t\t_gl.drawArrays( 4, 0, object.count );\r\n\r\n\t\t\tobject.count = 0;\r\n\r\n\t\t};\r\n\r\n\t\tvar tempScene = new Scene();\r\n\r\n\t\tthis.renderBufferDirect = function ( camera, scene, geometry, material, object, group ) {\r\n\r\n\t\t\tif ( scene === null ) { scene = tempScene; } // renderBufferDirect second parameter used to be fog (could be null)\r\n\r\n\t\t\tvar frontFaceCW = ( object.isMesh && object.matrixWorld.determinant() < 0 );\r\n\r\n\t\t\tvar program = setProgram( camera, scene, material, object );\r\n\r\n\t\t\tstate.setMaterial( material, frontFaceCW );\r\n\r\n\t\t\tvar updateBuffers = false;\r\n\r\n\t\t\tif ( _currentGeometryProgram.geometry !== geometry.id ||\r\n\t\t\t\t_currentGeometryProgram.program !== program.id ||\r\n\t\t\t\t_currentGeometryProgram.wireframe !== ( material.wireframe === true ) ) {\r\n\r\n\t\t\t\t_currentGeometryProgram.geometry = geometry.id;\r\n\t\t\t\t_currentGeometryProgram.program = program.id;\r\n\t\t\t\t_currentGeometryProgram.wireframe = material.wireframe === true;\r\n\t\t\t\tupdateBuffers = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.morphTargets || material.morphNormals ) {\r\n\r\n\t\t\t\tmorphtargets.update( object, geometry, material, program );\r\n\r\n\t\t\t\tupdateBuffers = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar index = geometry.index;\r\n\t\t\tvar position = geometry.attributes.position;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( index === null ) {\r\n\r\n\t\t\t\tif ( position === undefined || position.count === 0 ) { return; }\r\n\r\n\t\t\t} else if ( index.count === 0 ) {\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar rangeFactor = 1;\r\n\r\n\t\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\t\tindex = geometries.getWireframeAttribute( geometry );\r\n\t\t\t\trangeFactor = 2;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attribute;\r\n\t\t\tvar renderer = bufferRenderer;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tattribute = attributes.get( index );\r\n\r\n\t\t\t\trenderer = indexedBufferRenderer;\r\n\t\t\t\trenderer.setIndex( attribute );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( updateBuffers ) {\r\n\r\n\t\t\t\tsetupVertexAttributes( object, geometry, material, program );\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\t_gl.bindBuffer( 34963, attribute.buffer );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar dataCount = ( index !== null ) ? index.count : position.count;\r\n\r\n\t\t\tvar rangeStart = geometry.drawRange.start * rangeFactor;\r\n\t\t\tvar rangeCount = geometry.drawRange.count * rangeFactor;\r\n\r\n\t\t\tvar groupStart = group !== null ? group.start * rangeFactor : 0;\r\n\t\t\tvar groupCount = group !== null ? group.count * rangeFactor : Infinity;\r\n\r\n\t\t\tvar drawStart = Math.max( rangeStart, groupStart );\r\n\t\t\tvar drawEnd = Math.min( dataCount, rangeStart + rangeCount, groupStart + groupCount ) - 1;\r\n\r\n\t\t\tvar drawCount = Math.max( 0, drawEnd - drawStart + 1 );\r\n\r\n\t\t\tif ( drawCount === 0 ) { return; }\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( object.isMesh ) {\r\n\r\n\t\t\t\tif ( material.wireframe === true ) {\r\n\r\n\t\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * getTargetPixelRatio() );\r\n\t\t\t\t\trenderer.setMode( 1 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\trenderer.setMode( 4 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object.isLine ) {\r\n\r\n\t\t\t\tvar lineWidth = material.linewidth;\r\n\r\n\t\t\t\tif ( lineWidth === undefined ) { lineWidth = 1; } // Not using Line*Material\r\n\r\n\t\t\t\tstate.setLineWidth( lineWidth * getTargetPixelRatio() );\r\n\r\n\t\t\t\tif ( object.isLineSegments ) {\r\n\r\n\t\t\t\t\trenderer.setMode( 1 );\r\n\r\n\t\t\t\t} else if ( object.isLineLoop ) {\r\n\r\n\t\t\t\t\trenderer.setMode( 2 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\trenderer.setMode( 3 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( object.isPoints ) {\r\n\r\n\t\t\t\trenderer.setMode( 0 );\r\n\r\n\t\t\t} else if ( object.isSprite ) {\r\n\r\n\t\t\t\trenderer.setMode( 4 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.isInstancedMesh ) {\r\n\r\n\t\t\t\trenderer.renderInstances( geometry, drawStart, drawCount, object.count );\r\n\r\n\t\t\t} else if ( geometry.isInstancedBufferGeometry ) {\r\n\r\n\t\t\t\trenderer.renderInstances( geometry, drawStart, drawCount, geometry.maxInstancedCount );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\trenderer.render( drawStart, drawCount );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tfunction setupVertexAttributes( object, geometry, material, program ) {\r\n\r\n\t\t\tif ( capabilities.isWebGL2 === false && ( object.isInstancedMesh || geometry.isInstancedBufferGeometry ) ) {\r\n\r\n\t\t\t\tif ( extensions.get( 'ANGLE_instanced_arrays' ) === null ) { return; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.initAttributes();\r\n\r\n\t\t\tvar geometryAttributes = geometry.attributes;\r\n\r\n\t\t\tvar programAttributes = program.getAttributes();\r\n\r\n\t\t\tvar materialDefaultAttributeValues = material.defaultAttributeValues;\r\n\r\n\t\t\tfor ( var name in programAttributes ) {\r\n\r\n\t\t\t\tvar programAttribute = programAttributes[ name ];\r\n\r\n\t\t\t\tif ( programAttribute >= 0 ) {\r\n\r\n\t\t\t\t\tvar geometryAttribute = geometryAttributes[ name ];\r\n\r\n\t\t\t\t\tif ( geometryAttribute !== undefined ) {\r\n\r\n\t\t\t\t\t\tvar normalized = geometryAttribute.normalized;\r\n\t\t\t\t\t\tvar size = geometryAttribute.itemSize;\r\n\r\n\t\t\t\t\t\tvar attribute = attributes.get( geometryAttribute );\r\n\r\n\t\t\t\t\t\t// TODO Attribute may not be available on context restore\r\n\r\n\t\t\t\t\t\tif ( attribute === undefined ) { continue; }\r\n\r\n\t\t\t\t\t\tvar buffer = attribute.buffer;\r\n\t\t\t\t\t\tvar type = attribute.type;\r\n\t\t\t\t\t\tvar bytesPerElement = attribute.bytesPerElement;\r\n\r\n\t\t\t\t\t\tif ( geometryAttribute.isInterleavedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\t\tvar data = geometryAttribute.data;\r\n\t\t\t\t\t\t\tvar stride = data.stride;\r\n\t\t\t\t\t\t\tvar offset = geometryAttribute.offset;\r\n\r\n\t\t\t\t\t\t\tif ( data && data.isInstancedInterleavedBuffer ) {\r\n\r\n\t\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, data.meshPerAttribute );\r\n\r\n\t\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = data.meshPerAttribute * data.count;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t_gl.bindBuffer( 34962, buffer );\r\n\t\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, stride * bytesPerElement, offset * bytesPerElement );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tif ( geometryAttribute.isInstancedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute, geometryAttribute.meshPerAttribute );\r\n\r\n\t\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tstate.enableAttribute( programAttribute );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t_gl.bindBuffer( 34962, buffer );\r\n\t\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, type, normalized, 0, 0 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( name === 'instanceMatrix' ) {\r\n\r\n\t\t\t\t\t\tvar attribute = attributes.get( object.instanceMatrix );\r\n\r\n\t\t\t\t\t\t// TODO Attribute may not be available on context restore\r\n\r\n\t\t\t\t\t\tif ( attribute === undefined ) { continue; }\r\n\r\n\t\t\t\t\t\tvar buffer = attribute.buffer;\r\n\t\t\t\t\t\tvar type = attribute.type;\r\n\r\n\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute + 0, 1 );\r\n\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute + 1, 1 );\r\n\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute + 2, 1 );\r\n\t\t\t\t\t\tstate.enableAttributeAndDivisor( programAttribute + 3, 1 );\r\n\r\n\t\t\t\t\t\t_gl.bindBuffer( 34962, buffer );\r\n\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute + 0, 4, type, false, 64, 0 );\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute + 1, 4, type, false, 64, 16 );\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute + 2, 4, type, false, 64, 32 );\r\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute + 3, 4, type, false, 64, 48 );\r\n\r\n\t\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\r\n\r\n\t\t\t\t\t\tvar value = materialDefaultAttributeValues[ name ];\r\n\r\n\t\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\t\tswitch ( value.length ) {\r\n\r\n\t\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib2fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib3fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib4fv( programAttribute, value );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t_gl.vertexAttrib1fv( programAttribute, value );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.disableUnusedAttributes();\r\n\r\n\t\t}\r\n\r\n\t\t// Compile\r\n\r\n\t\tthis.compile = function ( scene, camera ) {\r\n\r\n\t\t\tcurrentRenderState = renderStates.get( scene, camera );\r\n\t\t\tcurrentRenderState.init();\r\n\r\n\t\t\tscene.traverse( function ( object ) {\r\n\r\n\t\t\t\tif ( object.isLight ) {\r\n\r\n\t\t\t\t\tcurrentRenderState.pushLight( object );\r\n\r\n\t\t\t\t\tif ( object.castShadow ) {\r\n\r\n\t\t\t\t\t\tcurrentRenderState.pushShadow( object );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tcurrentRenderState.setupLights( camera );\r\n\r\n\t\t\tvar compiled = {};\r\n\r\n\t\t\tscene.traverse( function ( object ) {\r\n\r\n\t\t\t\tif ( object.material ) {\r\n\r\n\t\t\t\t\tif ( Array.isArray( object.material ) ) {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < object.material.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( object.material[ i ].uuid in compiled === false ) {\r\n\r\n\t\t\t\t\t\t\t\tinitMaterial( object.material[ i ], scene, object );\r\n\t\t\t\t\t\t\t\tcompiled[ object.material[ i ].uuid ] = true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else if ( object.material.uuid in compiled === false ) {\r\n\r\n\t\t\t\t\t\tinitMaterial( object.material, scene, object );\r\n\t\t\t\t\t\tcompiled[ object.material.uuid ] = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t};\r\n\r\n\t\t// Animation Loop\r\n\r\n\t\tvar onAnimationFrameCallback = null;\r\n\r\n\t\tfunction onAnimationFrame( time ) {\r\n\r\n\t\t\tif ( xr.isPresenting ) { return; }\r\n\t\t\tif ( onAnimationFrameCallback ) { onAnimationFrameCallback( time ); }\r\n\r\n\t\t}\r\n\r\n\t\tvar animation = new WebGLAnimation();\r\n\t\tanimation.setAnimationLoop( onAnimationFrame );\r\n\r\n\t\tif ( typeof window !== 'undefined' ) { animation.setContext( window ); }\r\n\r\n\t\tthis.setAnimationLoop = function ( callback ) {\r\n\r\n\t\t\tonAnimationFrameCallback = callback;\r\n\t\t\txr.setAnimationLoop( callback );\r\n\r\n\t\t\tanimation.start();\r\n\r\n\t\t};\r\n\r\n\t\t// Rendering\r\n\r\n\t\tthis.render = function ( scene, camera ) {\r\n\r\n\t\t\tvar renderTarget, forceClear;\r\n\r\n\t\t\tif ( arguments[ 2 ] !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.' );\r\n\t\t\t\trenderTarget = arguments[ 2 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( arguments[ 3 ] !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.' );\r\n\t\t\t\tforceClear = arguments[ 3 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ! ( camera && camera.isCamera ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _isContextLost ) { return; }\r\n\r\n\t\t\t// reset caching for this frame\r\n\r\n\t\t\t_currentGeometryProgram.geometry = null;\r\n\t\t\t_currentGeometryProgram.program = null;\r\n\t\t\t_currentGeometryProgram.wireframe = false;\r\n\t\t\t_currentMaterialId = - 1;\r\n\t\t\t_currentCamera = null;\r\n\r\n\t\t\t// update scene graph\r\n\r\n\t\t\tif ( scene.autoUpdate === true ) { scene.updateMatrixWorld(); }\r\n\r\n\t\t\t// update camera matrices and frustum\r\n\r\n\t\t\tif ( camera.parent === null ) { camera.updateMatrixWorld(); }\r\n\r\n\t\t\tif ( xr.enabled && xr.isPresenting ) {\r\n\r\n\t\t\t\tcamera = xr.getCamera( camera );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tcurrentRenderState = renderStates.get( scene, camera );\r\n\t\t\tcurrentRenderState.init();\r\n\r\n\t\t\tscene.onBeforeRender( _this, scene, camera, renderTarget || _currentRenderTarget );\r\n\r\n\t\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\r\n\t\t\t_frustum.setFromProjectionMatrix( _projScreenMatrix );\r\n\r\n\t\t\t_localClippingEnabled = this.localClippingEnabled;\r\n\t\t\t_clippingEnabled = _clipping.init( this.clippingPlanes, _localClippingEnabled, camera );\r\n\r\n\t\t\tcurrentRenderList = renderLists.get( scene, camera );\r\n\t\t\tcurrentRenderList.init();\r\n\r\n\t\t\tprojectObject( scene, camera, 0, _this.sortObjects );\r\n\r\n\t\t\tcurrentRenderList.finish();\r\n\r\n\t\t\tif ( _this.sortObjects === true ) {\r\n\r\n\t\t\t\tcurrentRenderList.sort( _opaqueSort, _transparentSort );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( _clippingEnabled ) { _clipping.beginShadows(); }\r\n\r\n\t\t\tvar shadowsArray = currentRenderState.state.shadowsArray;\r\n\r\n\t\t\tshadowMap.render( shadowsArray, scene, camera );\r\n\r\n\t\t\tcurrentRenderState.setupLights( camera );\r\n\r\n\t\t\tif ( _clippingEnabled ) { _clipping.endShadows(); }\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( this.info.autoReset ) { this.info.reset(); }\r\n\r\n\t\t\tif ( renderTarget !== undefined ) {\r\n\r\n\t\t\t\tthis.setRenderTarget( renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tbackground.render( currentRenderList, scene, camera, forceClear );\r\n\r\n\t\t\t// render scene\r\n\r\n\t\t\tvar opaqueObjects = currentRenderList.opaque;\r\n\t\t\tvar transparentObjects = currentRenderList.transparent;\r\n\r\n\t\t\tif ( scene.overrideMaterial ) {\r\n\r\n\t\t\t\tvar overrideMaterial = scene.overrideMaterial;\r\n\r\n\t\t\t\tif ( opaqueObjects.length ) { renderObjects( opaqueObjects, scene, camera, overrideMaterial ); }\r\n\t\t\t\tif ( transparentObjects.length ) { renderObjects( transparentObjects, scene, camera, overrideMaterial ); }\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// opaque pass (front-to-back order)\r\n\r\n\t\t\t\tif ( opaqueObjects.length ) { renderObjects( opaqueObjects, scene, camera ); }\r\n\r\n\t\t\t\t// transparent pass (back-to-front order)\r\n\r\n\t\t\t\tif ( transparentObjects.length ) { renderObjects( transparentObjects, scene, camera ); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tscene.onAfterRender( _this, scene, camera );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( _currentRenderTarget !== null ) {\r\n\r\n\t\t\t\t// Generate mipmap if we're using any kind of mipmap filtering\r\n\r\n\t\t\t\ttextures.updateRenderTargetMipmap( _currentRenderTarget );\r\n\r\n\t\t\t\t// resolve multisample renderbuffers to a single-sample texture if necessary\r\n\r\n\t\t\t\ttextures.updateMultisampleRenderTarget( _currentRenderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\r\n\r\n\t\t\tstate.buffers.depth.setTest( true );\r\n\t\t\tstate.buffers.depth.setMask( true );\r\n\t\t\tstate.buffers.color.setMask( true );\r\n\r\n\t\t\tstate.setPolygonOffset( false );\r\n\r\n\t\t\t// _gl.finish();\r\n\r\n\t\t\tcurrentRenderList = null;\r\n\t\t\tcurrentRenderState = null;\r\n\r\n\t\t};\r\n\r\n\t\tfunction projectObject( object, camera, groupOrder, sortObjects ) {\r\n\r\n\t\t\tif ( object.visible === false ) { return; }\r\n\r\n\t\t\tvar visible = object.layers.test( camera.layers );\r\n\r\n\t\t\tif ( visible ) {\r\n\r\n\t\t\t\tif ( object.isGroup ) {\r\n\r\n\t\t\t\t\tgroupOrder = object.renderOrder;\r\n\r\n\t\t\t\t} else if ( object.isLOD ) {\r\n\r\n\t\t\t\t\tif ( object.autoUpdate === true ) { object.update( camera ); }\r\n\r\n\t\t\t\t} else if ( object.isLight ) {\r\n\r\n\t\t\t\t\tcurrentRenderState.pushLight( object );\r\n\r\n\t\t\t\t\tif ( object.castShadow ) {\r\n\r\n\t\t\t\t\t\tcurrentRenderState.pushShadow( object );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( object.isSprite ) {\r\n\r\n\t\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsSprite( object ) ) {\r\n\r\n\t\t\t\t\t\tif ( sortObjects ) {\r\n\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\r\n\t\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar geometry = objects.update( object );\r\n\t\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\t\tif ( material.visible ) {\r\n\r\n\t\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, groupOrder, _vector3.z, null );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( object.isImmediateRenderObject ) {\r\n\r\n\t\t\t\t\tif ( sortObjects ) {\r\n\r\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\r\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcurrentRenderList.push( object, null, object.material, groupOrder, _vector3.z, null );\r\n\r\n\t\t\t\t} else if ( object.isMesh || object.isLine || object.isPoints ) {\r\n\r\n\t\t\t\t\tif ( object.isSkinnedMesh ) {\r\n\r\n\t\t\t\t\t\t// update skeleton only once in a frame\r\n\r\n\t\t\t\t\t\tif ( object.skeleton.frame !== info.render.frame ) {\r\n\r\n\t\t\t\t\t\t\tobject.skeleton.update();\r\n\t\t\t\t\t\t\tobject.skeleton.frame = info.render.frame;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) {\r\n\r\n\t\t\t\t\t\tif ( sortObjects ) {\r\n\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld )\r\n\t\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar geometry = objects.update( object );\r\n\t\t\t\t\t\tvar material = object.material;\r\n\r\n\t\t\t\t\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\t\t\t\t\tvar groups = geometry.groups;\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar group = groups[ i ];\r\n\t\t\t\t\t\t\t\tvar groupMaterial = material[ group.materialIndex ];\r\n\r\n\t\t\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\r\n\r\n\t\t\t\t\t\t\t\t\tcurrentRenderList.push( object, geometry, groupMaterial, groupOrder, _vector3.z, group );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else if ( material.visible ) {\r\n\r\n\t\t\t\t\t\t\tcurrentRenderList.push( object, geometry, material, groupOrder, _vector3.z, null );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tprojectObject( children[ i ], camera, groupOrder, sortObjects );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderObjects( renderList, scene, camera, overrideMaterial ) {\r\n\r\n\t\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar renderItem = renderList[ i ];\r\n\r\n\t\t\t\tvar object = renderItem.object;\r\n\t\t\t\tvar geometry = renderItem.geometry;\r\n\t\t\t\tvar material = overrideMaterial === undefined ? renderItem.material : overrideMaterial;\r\n\t\t\t\tvar group = renderItem.group;\r\n\r\n\t\t\t\tif ( camera.isArrayCamera ) {\r\n\r\n\t\t\t\t\t_currentArrayCamera = camera;\r\n\r\n\t\t\t\t\tvar cameras = camera.cameras;\r\n\r\n\t\t\t\t\tfor ( var j = 0, jl = cameras.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\tvar camera2 = cameras[ j ];\r\n\r\n\t\t\t\t\t\tif ( object.layers.test( camera2.layers ) ) {\r\n\r\n\t\t\t\t\t\t\tstate.viewport( _currentViewport.copy( camera2.viewport ) );\r\n\r\n\t\t\t\t\t\t\tcurrentRenderState.setupLights( camera2 );\r\n\r\n\t\t\t\t\t\t\trenderObject( object, scene, camera2, geometry, material, group );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_currentArrayCamera = null;\r\n\r\n\t\t\t\t\trenderObject( object, scene, camera, geometry, material, group );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction renderObject( object, scene, camera, geometry, material, group ) {\r\n\r\n\t\t\tobject.onBeforeRender( _this, scene, camera, geometry, material, group );\r\n\t\t\tcurrentRenderState = renderStates.get( scene, _currentArrayCamera || camera );\r\n\r\n\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\r\n\t\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\r\n\r\n\t\t\tif ( object.isImmediateRenderObject ) {\r\n\r\n\t\t\t\tvar program = setProgram( camera, scene, material, object );\r\n\r\n\t\t\t\tstate.setMaterial( material );\r\n\r\n\t\t\t\t_currentGeometryProgram.geometry = null;\r\n\t\t\t\t_currentGeometryProgram.program = null;\r\n\t\t\t\t_currentGeometryProgram.wireframe = false;\r\n\r\n\t\t\t\trenderObjectImmediate( object, program );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_this.renderBufferDirect( camera, scene, geometry, material, object, group );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.onAfterRender( _this, scene, camera, geometry, material, group );\r\n\t\t\tcurrentRenderState = renderStates.get( scene, _currentArrayCamera || camera );\r\n\r\n\t\t}\r\n\r\n\t\tfunction initMaterial( material, scene, object ) {\r\n\r\n\t\t\tvar materialProperties = properties.get( material );\r\n\r\n\t\t\tvar lights = currentRenderState.state.lights;\r\n\t\t\tvar shadowsArray = currentRenderState.state.shadowsArray;\r\n\r\n\t\t\tvar lightsStateVersion = lights.state.version;\r\n\r\n\t\t\tvar parameters = programCache.getParameters( material, lights.state, shadowsArray, scene, _clipping.numPlanes, _clipping.numIntersection, object );\r\n\t\t\tvar programCacheKey = programCache.getProgramCacheKey( parameters );\r\n\r\n\t\t\tvar program = materialProperties.program;\r\n\t\t\tvar programChange = true;\r\n\r\n\t\t\tif ( program === undefined ) {\r\n\r\n\t\t\t\t// new material\r\n\t\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\r\n\r\n\t\t\t} else if ( program.cacheKey !== programCacheKey ) {\r\n\r\n\t\t\t\t// changed glsl or parameters\r\n\t\t\t\treleaseMaterialProgramReference( material );\r\n\r\n\t\t\t} else if ( materialProperties.lightsStateVersion !== lightsStateVersion ) {\r\n\r\n\t\t\t\tmaterialProperties.lightsStateVersion = lightsStateVersion;\r\n\r\n\t\t\t\tprogramChange = false;\r\n\r\n\t\t\t} else if ( parameters.shaderID !== undefined ) {\r\n\r\n\t\t\t\t// same glsl and uniform list\r\n\t\t\t\treturn;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// only rebuild uniform list\r\n\t\t\t\tprogramChange = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( programChange ) {\r\n\r\n\t\t\t\tprogram = programCache.acquireProgram( parameters, programCacheKey );\r\n\r\n\t\t\t\tmaterialProperties.program = program;\r\n\t\t\t\tmaterialProperties.uniforms = parameters.uniforms;\r\n\t\t\t\tmaterialProperties.environment = material.isMeshStandardMaterial ? scene.environment : null;\r\n\t\t\t\tmaterialProperties.outputEncoding = _this.outputEncoding;\r\n\t\t\t\tmaterial.program = program;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar programAttributes = program.getAttributes();\r\n\r\n\t\t\tif ( material.morphTargets ) {\r\n\r\n\t\t\t\tmaterial.numSupportedMorphTargets = 0;\r\n\r\n\t\t\t\tfor ( var i = 0; i < _this.maxMorphTargets; i ++ ) {\r\n\r\n\t\t\t\t\tif ( programAttributes[ 'morphTarget' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\t\tmaterial.numSupportedMorphTargets ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.morphNormals ) {\r\n\r\n\t\t\t\tmaterial.numSupportedMorphNormals = 0;\r\n\r\n\t\t\t\tfor ( var i = 0; i < _this.maxMorphNormals; i ++ ) {\r\n\r\n\t\t\t\t\tif ( programAttributes[ 'morphNormal' + i ] >= 0 ) {\r\n\r\n\t\t\t\t\t\tmaterial.numSupportedMorphNormals ++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar uniforms = materialProperties.uniforms;\r\n\r\n\t\t\tif ( ! material.isShaderMaterial &&\r\n\t\t\t\t! material.isRawShaderMaterial ||\r\n\t\t\t\tmaterial.clipping === true ) {\r\n\r\n\t\t\t\tmaterialProperties.numClippingPlanes = _clipping.numPlanes;\r\n\t\t\t\tmaterialProperties.numIntersection = _clipping.numIntersection;\r\n\t\t\t\tuniforms.clippingPlanes = _clipping.uniform;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterialProperties.fog = scene.fog;\r\n\r\n\t\t\t// store the light setup it was created for\r\n\r\n\t\t\tmaterialProperties.needsLights = materialNeedsLights( material );\r\n\t\t\tmaterialProperties.lightsStateVersion = lightsStateVersion;\r\n\r\n\t\t\tif ( materialProperties.needsLights ) {\r\n\r\n\t\t\t\t// wire up the material to this renderer's lighting state\r\n\r\n\t\t\t\tuniforms.ambientLightColor.value = lights.state.ambient;\r\n\t\t\t\tuniforms.lightProbe.value = lights.state.probe;\r\n\t\t\t\tuniforms.directionalLights.value = lights.state.directional;\r\n\t\t\t\tuniforms.directionalLightShadows.value = lights.state.directionalShadow;\r\n\t\t\t\tuniforms.spotLights.value = lights.state.spot;\r\n\t\t\t\tuniforms.spotLightShadows.value = lights.state.spotShadow;\r\n\t\t\t\tuniforms.rectAreaLights.value = lights.state.rectArea;\r\n\t\t\t\tuniforms.pointLights.value = lights.state.point;\r\n\t\t\t\tuniforms.pointLightShadows.value = lights.state.pointShadow;\r\n\t\t\t\tuniforms.hemisphereLights.value = lights.state.hemi;\r\n\r\n\t\t\t\tuniforms.directionalShadowMap.value = lights.state.directionalShadowMap;\r\n\t\t\t\tuniforms.directionalShadowMatrix.value = lights.state.directionalShadowMatrix;\r\n\t\t\t\tuniforms.spotShadowMap.value = lights.state.spotShadowMap;\r\n\t\t\t\tuniforms.spotShadowMatrix.value = lights.state.spotShadowMatrix;\r\n\t\t\t\tuniforms.pointShadowMap.value = lights.state.pointShadowMap;\r\n\t\t\t\tuniforms.pointShadowMatrix.value = lights.state.pointShadowMatrix;\r\n\t\t\t\t// TODO (abelnation): add area lights shadow info to uniforms\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar progUniforms = materialProperties.program.getUniforms(),\r\n\t\t\t\tuniformsList =\r\n\t\t\t\t\tWebGLUniforms.seqWithValue( progUniforms.seq, uniforms );\r\n\r\n\t\t\tmaterialProperties.uniformsList = uniformsList;\r\n\r\n\t\t}\r\n\r\n\t\tfunction setProgram( camera, scene, material, object ) {\r\n\r\n\t\t\ttextures.resetTextureUnits();\r\n\r\n\t\t\tvar fog = scene.fog;\r\n\t\t\tvar environment = material.isMeshStandardMaterial ? scene.environment : null;\r\n\r\n\t\t\tvar materialProperties = properties.get( material );\r\n\t\t\tvar lights = currentRenderState.state.lights;\r\n\r\n\t\t\tif ( _clippingEnabled ) {\r\n\r\n\t\t\t\tif ( _localClippingEnabled || camera !== _currentCamera ) {\r\n\r\n\t\t\t\t\tvar useCache =\r\n\t\t\t\t\t\tcamera === _currentCamera &&\r\n\t\t\t\t\t\tmaterial.id === _currentMaterialId;\r\n\r\n\t\t\t\t\t// we might want to call this function with some ClippingGroup\r\n\t\t\t\t\t// object instead of the material, once it becomes feasible\r\n\t\t\t\t\t// (#8465, #8379)\r\n\t\t\t\t\t_clipping.setState(\r\n\t\t\t\t\t\tmaterial.clippingPlanes, material.clipIntersection, material.clipShadows,\r\n\t\t\t\t\t\tcamera, materialProperties, useCache );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.version === materialProperties.__version ) {\r\n\r\n\t\t\t\tif ( materialProperties.program === undefined ) {\r\n\r\n\t\t\t\t\tinitMaterial( material, scene, object );\r\n\r\n\t\t\t\t} else if ( material.fog && materialProperties.fog !== fog ) {\r\n\r\n\t\t\t\t\tinitMaterial( material, scene, object );\r\n\r\n\t\t\t\t} else if ( materialProperties.environment !== environment ) {\r\n\r\n\t\t\t\t\tinitMaterial( material, scene, object );\r\n\r\n\t\t\t\t} else if ( materialProperties.needsLights && ( materialProperties.lightsStateVersion !== lights.state.version ) ) {\r\n\r\n\t\t\t\t\tinitMaterial( material, scene, object );\r\n\r\n\t\t\t\t} else if ( materialProperties.numClippingPlanes !== undefined &&\r\n\t\t\t\t\t( materialProperties.numClippingPlanes !== _clipping.numPlanes ||\r\n\t\t\t\t\tmaterialProperties.numIntersection !== _clipping.numIntersection ) ) {\r\n\r\n\t\t\t\t\tinitMaterial( material, scene, object );\r\n\r\n\t\t\t\t} else if ( materialProperties.outputEncoding !== _this.outputEncoding ) {\r\n\r\n\t\t\t\t\tinitMaterial( material, scene, object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tinitMaterial( material, scene, object );\r\n\t\t\t\tmaterialProperties.__version = material.version;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar refreshProgram = false;\r\n\t\t\tvar refreshMaterial = false;\r\n\t\t\tvar refreshLights = false;\r\n\r\n\t\t\tvar program = materialProperties.program,\r\n\t\t\t\tp_uniforms = program.getUniforms(),\r\n\t\t\t\tm_uniforms = materialProperties.uniforms;\r\n\r\n\t\t\tif ( state.useProgram( program.program ) ) {\r\n\r\n\t\t\t\trefreshProgram = true;\r\n\t\t\t\trefreshMaterial = true;\r\n\t\t\t\trefreshLights = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.id !== _currentMaterialId ) {\r\n\r\n\t\t\t\t_currentMaterialId = material.id;\r\n\r\n\t\t\t\trefreshMaterial = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( refreshProgram || _currentCamera !== camera ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'projectionMatrix', camera.projectionMatrix );\r\n\r\n\t\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\r\n\r\n\t\t\t\t\tp_uniforms.setValue( _gl, 'logDepthBufFC',\r\n\t\t\t\t\t\t2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( _currentCamera !== camera ) {\r\n\r\n\t\t\t\t\t_currentCamera = camera;\r\n\r\n\t\t\t\t\t// lighting uniforms depend on the camera so enforce an update\r\n\t\t\t\t\t// now, in case this material supports lights - or later, when\r\n\t\t\t\t\t// the next material that does gets activated:\r\n\r\n\t\t\t\t\trefreshMaterial = true;\t\t// set to true on material change\r\n\t\t\t\t\trefreshLights = true;\t\t// remains set until update done\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// load material specific uniforms\r\n\t\t\t\t// (shader material also gets them for the sake of genericity)\r\n\r\n\t\t\t\tif ( material.isShaderMaterial ||\r\n\t\t\t\t\tmaterial.isMeshPhongMaterial ||\r\n\t\t\t\t\tmaterial.isMeshToonMaterial ||\r\n\t\t\t\t\tmaterial.isMeshStandardMaterial ||\r\n\t\t\t\t\tmaterial.envMap ) {\r\n\r\n\t\t\t\t\tvar uCamPos = p_uniforms.map.cameraPosition;\r\n\r\n\t\t\t\t\tif ( uCamPos !== undefined ) {\r\n\r\n\t\t\t\t\t\tuCamPos.setValue( _gl,\r\n\t\t\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( material.isMeshPhongMaterial ||\r\n\t\t\t\t\tmaterial.isMeshToonMaterial ||\r\n\t\t\t\t\tmaterial.isMeshLambertMaterial ||\r\n\t\t\t\t\tmaterial.isMeshBasicMaterial ||\r\n\t\t\t\t\tmaterial.isMeshStandardMaterial ||\r\n\t\t\t\t\tmaterial.isShaderMaterial ) {\r\n\r\n\t\t\t\t\tp_uniforms.setValue( _gl, 'isOrthographic', camera.isOrthographicCamera === true );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( material.isMeshPhongMaterial ||\r\n\t\t\t\t\tmaterial.isMeshToonMaterial ||\r\n\t\t\t\t\tmaterial.isMeshLambertMaterial ||\r\n\t\t\t\t\tmaterial.isMeshBasicMaterial ||\r\n\t\t\t\t\tmaterial.isMeshStandardMaterial ||\r\n\t\t\t\t\tmaterial.isShaderMaterial ||\r\n\t\t\t\t\tmaterial.skinning ) {\r\n\r\n\t\t\t\t\tp_uniforms.setValue( _gl, 'viewMatrix', camera.matrixWorldInverse );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// skinning uniforms must be set even if material didn't change\r\n\t\t\t// auto-setting of texture unit for bone texture must go before other textures\r\n\t\t\t// otherwise textures used for skinning can take over texture units reserved for other material textures\r\n\r\n\t\t\tif ( material.skinning ) {\r\n\r\n\t\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrix' );\r\n\t\t\t\tp_uniforms.setOptional( _gl, object, 'bindMatrixInverse' );\r\n\r\n\t\t\t\tvar skeleton = object.skeleton;\r\n\r\n\t\t\t\tif ( skeleton ) {\r\n\r\n\t\t\t\t\tvar bones = skeleton.bones;\r\n\r\n\t\t\t\t\tif ( capabilities.floatVertexTextures ) {\r\n\r\n\t\t\t\t\t\tif ( skeleton.boneTexture === undefined ) {\r\n\r\n\t\t\t\t\t\t\t// layout (1 matrix = 4 pixels)\r\n\t\t\t\t\t\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\r\n\t\t\t\t\t\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\r\n\t\t\t\t\t\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\r\n\t\t\t\t\t\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\r\n\t\t\t\t\t\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\r\n\r\n\r\n\t\t\t\t\t\t\tvar size = Math.sqrt( bones.length * 4 ); // 4 pixels needed for 1 matrix\r\n\t\t\t\t\t\t\tsize = MathUtils.ceilPowerOfTwo( size );\r\n\t\t\t\t\t\t\tsize = Math.max( size, 4 );\r\n\r\n\t\t\t\t\t\t\tvar boneMatrices = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\r\n\t\t\t\t\t\t\tboneMatrices.set( skeleton.boneMatrices ); // copy current values\r\n\r\n\t\t\t\t\t\t\tvar boneTexture = new DataTexture( boneMatrices, size, size, RGBAFormat, FloatType );\r\n\r\n\t\t\t\t\t\t\tskeleton.boneMatrices = boneMatrices;\r\n\t\t\t\t\t\t\tskeleton.boneTexture = boneTexture;\r\n\t\t\t\t\t\t\tskeleton.boneTextureSize = size;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTexture', skeleton.boneTexture, textures );\r\n\t\t\t\t\t\tp_uniforms.setValue( _gl, 'boneTextureSize', skeleton.boneTextureSize );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tp_uniforms.setOptional( _gl, skeleton, 'boneMatrices' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( refreshMaterial || materialProperties.receiveShadow !== object.receiveShadow ) {\r\n\r\n\t\t\t\tmaterialProperties.receiveShadow = object.receiveShadow;\r\n\t\t\t\tp_uniforms.setValue( _gl, 'receiveShadow', object.receiveShadow );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( refreshMaterial ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'toneMappingExposure', _this.toneMappingExposure );\r\n\t\t\t\tp_uniforms.setValue( _gl, 'toneMappingWhitePoint', _this.toneMappingWhitePoint );\r\n\r\n\t\t\t\tif ( materialProperties.needsLights ) {\r\n\r\n\t\t\t\t\t// the current material requires lighting info\r\n\r\n\t\t\t\t\t// note: all lighting uniforms are always set correctly\r\n\t\t\t\t\t// they simply reference the renderer's state for their\r\n\t\t\t\t\t// values\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// use the current material's .needsUpdate flags to set\r\n\t\t\t\t\t// the GL state when required\r\n\r\n\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, refreshLights );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// refresh uniforms common to several materials\r\n\r\n\t\t\t\tif ( fog && material.fog ) {\r\n\r\n\t\t\t\t\trefreshUniformsFog( m_uniforms, fog );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( material.isMeshBasicMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshLambertMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsLambert( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshToonMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsToon( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshPhongMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsPhong( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshStandardMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material, environment );\r\n\r\n\t\t\t\t\tif ( material.isMeshPhysicalMaterial ) {\r\n\r\n\t\t\t\t\t\trefreshUniformsPhysical( m_uniforms, material, environment );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\trefreshUniformsStandard( m_uniforms, material, environment );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( material.isMeshMatcapMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsMatcap( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshDepthMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsDepth( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshDistanceMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsDistance( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isMeshNormalMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsCommon( m_uniforms, material );\r\n\t\t\t\t\trefreshUniformsNormal( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isLineBasicMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsLine( m_uniforms, material );\r\n\r\n\t\t\t\t\tif ( material.isLineDashedMaterial ) {\r\n\r\n\t\t\t\t\t\trefreshUniformsDash( m_uniforms, material );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( material.isPointsMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsPoints( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isSpriteMaterial ) {\r\n\r\n\t\t\t\t\trefreshUniformsSprites( m_uniforms, material );\r\n\r\n\t\t\t\t} else if ( material.isShadowMaterial ) {\r\n\r\n\t\t\t\t\tm_uniforms.color.value.copy( material.color );\r\n\t\t\t\t\tm_uniforms.opacity.value = material.opacity;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// RectAreaLight Texture\r\n\t\t\t\t// TODO (mrdoob): Find a nicer implementation\r\n\r\n\t\t\t\tif ( m_uniforms.ltc_1 !== undefined ) { m_uniforms.ltc_1.value = UniformsLib.LTC_1; }\r\n\t\t\t\tif ( m_uniforms.ltc_2 !== undefined ) { m_uniforms.ltc_2.value = UniformsLib.LTC_2; }\r\n\r\n\t\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, textures );\r\n\r\n\t\t\t\tif ( material.isShaderMaterial ) {\r\n\r\n\t\t\t\t\tmaterial.uniformsNeedUpdate = false; // #15581\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.isShaderMaterial && material.uniformsNeedUpdate === true ) {\r\n\r\n\t\t\t\tWebGLUniforms.upload( _gl, materialProperties.uniformsList, m_uniforms, textures );\r\n\t\t\t\tmaterial.uniformsNeedUpdate = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.isSpriteMaterial ) {\r\n\r\n\t\t\t\tp_uniforms.setValue( _gl, 'center', object.center );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// common matrices\r\n\r\n\t\t\tp_uniforms.setValue( _gl, 'modelViewMatrix', object.modelViewMatrix );\r\n\t\t\tp_uniforms.setValue( _gl, 'normalMatrix', object.normalMatrix );\r\n\t\t\tp_uniforms.setValue( _gl, 'modelMatrix', object.matrixWorld );\r\n\r\n\t\t\treturn program;\r\n\r\n\t\t}\r\n\r\n\t\t// Uniforms (refresh uniforms objects)\r\n\r\n\t\tfunction refreshUniformsCommon( uniforms, material, environment ) {\r\n\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t\t\tif ( material.color ) {\r\n\r\n\t\t\t\tuniforms.diffuse.value.copy( material.color );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.emissive ) {\r\n\r\n\t\t\t\tuniforms.emissive.value.copy( material.emissive ).multiplyScalar( material.emissiveIntensity );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\tuniforms.map.value = material.map;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.alphaMap ) {\r\n\r\n\t\t\t\tuniforms.alphaMap.value = material.alphaMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.specularMap ) {\r\n\r\n\t\t\t\tuniforms.specularMap.value = material.specularMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar envMap = material.envMap || environment;\r\n\r\n\t\t\tif ( envMap ) {\r\n\r\n\t\t\t\tuniforms.envMap.value = envMap;\r\n\r\n\t\t\t\tuniforms.flipEnvMap.value = envMap.isCubeTexture ? - 1 : 1;\r\n\r\n\t\t\t\tuniforms.reflectivity.value = material.reflectivity;\r\n\t\t\t\tuniforms.refractionRatio.value = material.refractionRatio;\r\n\r\n\t\t\t\tuniforms.maxMipLevel.value = properties.get( envMap ).__maxMipLevel;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.lightMap ) {\r\n\r\n\t\t\t\tuniforms.lightMap.value = material.lightMap;\r\n\t\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.aoMap ) {\r\n\r\n\t\t\t\tuniforms.aoMap.value = material.aoMap;\r\n\t\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// uv repeat and offset setting priorities\r\n\t\t\t// 1. color map\r\n\t\t\t// 2. specular map\r\n\t\t\t// 3. normal map\r\n\t\t\t// 4. bump map\r\n\t\t\t// 5. alpha map\r\n\t\t\t// 6. emissive map\r\n\r\n\t\t\tvar uvScaleMap;\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\tuvScaleMap = material.map;\r\n\r\n\t\t\t} else if ( material.specularMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.specularMap;\r\n\r\n\t\t\t} else if ( material.displacementMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.displacementMap;\r\n\r\n\t\t\t} else if ( material.normalMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.normalMap;\r\n\r\n\t\t\t} else if ( material.bumpMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.bumpMap;\r\n\r\n\t\t\t} else if ( material.roughnessMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.roughnessMap;\r\n\r\n\t\t\t} else if ( material.metalnessMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.metalnessMap;\r\n\r\n\t\t\t} else if ( material.alphaMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.alphaMap;\r\n\r\n\t\t\t} else if ( material.emissiveMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.emissiveMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvScaleMap !== undefined ) {\r\n\r\n\t\t\t\t// backwards compatibility\r\n\t\t\t\tif ( uvScaleMap.isWebGLRenderTarget ) {\r\n\r\n\t\t\t\t\tuvScaleMap = uvScaleMap.texture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\r\n\r\n\t\t\t\t\tuvScaleMap.updateMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// uv repeat and offset setting priorities for uv2\r\n\t\t\t// 1. ao map\r\n\t\t\t// 2. light map\r\n\r\n\t\t\tvar uv2ScaleMap;\r\n\r\n\t\t\tif ( material.aoMap ) {\r\n\r\n\t\t\t\tuv2ScaleMap = material.aoMap;\r\n\r\n\t\t\t} else if ( material.lightMap ) {\r\n\r\n\t\t\t\tuv2ScaleMap = material.lightMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uv2ScaleMap !== undefined ) {\r\n\r\n\t\t\t\t// backwards compatibility\r\n\t\t\t\tif ( uv2ScaleMap.isWebGLRenderTarget ) {\r\n\r\n\t\t\t\t\tuv2ScaleMap = uv2ScaleMap.texture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( uv2ScaleMap.matrixAutoUpdate === true ) {\r\n\r\n\t\t\t\t\tuv2ScaleMap.updateMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniforms.uv2Transform.value.copy( uv2ScaleMap.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsLine( uniforms, material ) {\r\n\r\n\t\t\tuniforms.diffuse.value.copy( material.color );\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsDash( uniforms, material ) {\r\n\r\n\t\t\tuniforms.dashSize.value = material.dashSize;\r\n\t\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\r\n\t\t\tuniforms.scale.value = material.scale;\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsPoints( uniforms, material ) {\r\n\r\n\t\t\tuniforms.diffuse.value.copy( material.color );\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\t\t\tuniforms.size.value = material.size * _pixelRatio;\r\n\t\t\tuniforms.scale.value = _height * 0.5;\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\tuniforms.map.value = material.map;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.alphaMap ) {\r\n\r\n\t\t\t\tuniforms.alphaMap.value = material.alphaMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// uv repeat and offset setting priorities\r\n\t\t\t// 1. color map\r\n\t\t\t// 2. alpha map\r\n\r\n\t\t\tvar uvScaleMap;\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\tuvScaleMap = material.map;\r\n\r\n\t\t\t} else if ( material.alphaMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.alphaMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvScaleMap !== undefined ) {\r\n\r\n\t\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\r\n\r\n\t\t\t\t\tuvScaleMap.updateMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsSprites( uniforms, material ) {\r\n\r\n\t\t\tuniforms.diffuse.value.copy( material.color );\r\n\t\t\tuniforms.opacity.value = material.opacity;\r\n\t\t\tuniforms.rotation.value = material.rotation;\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\tuniforms.map.value = material.map;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.alphaMap ) {\r\n\r\n\t\t\t\tuniforms.alphaMap.value = material.alphaMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// uv repeat and offset setting priorities\r\n\t\t\t// 1. color map\r\n\t\t\t// 2. alpha map\r\n\r\n\t\t\tvar uvScaleMap;\r\n\r\n\t\t\tif ( material.map ) {\r\n\r\n\t\t\t\tuvScaleMap = material.map;\r\n\r\n\t\t\t} else if ( material.alphaMap ) {\r\n\r\n\t\t\t\tuvScaleMap = material.alphaMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( uvScaleMap !== undefined ) {\r\n\r\n\t\t\t\tif ( uvScaleMap.matrixAutoUpdate === true ) {\r\n\r\n\t\t\t\t\tuvScaleMap.updateMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuniforms.uvTransform.value.copy( uvScaleMap.matrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsFog( uniforms, fog ) {\r\n\r\n\t\t\tuniforms.fogColor.value.copy( fog.color );\r\n\r\n\t\t\tif ( fog.isFog ) {\r\n\r\n\t\t\t\tuniforms.fogNear.value = fog.near;\r\n\t\t\t\tuniforms.fogFar.value = fog.far;\r\n\r\n\t\t\t} else if ( fog.isFogExp2 ) {\r\n\r\n\t\t\t\tuniforms.fogDensity.value = fog.density;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsLambert( uniforms, material ) {\r\n\r\n\t\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsPhong( uniforms, material ) {\r\n\r\n\t\t\tuniforms.specular.value.copy( material.specular );\r\n\t\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\r\n\r\n\t\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.bumpScale.value *= - 1; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.normalMap ) {\r\n\r\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.normalScale.value.negate(); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsToon( uniforms, material ) {\r\n\r\n\t\t\tuniforms.specular.value.copy( material.specular );\r\n\t\t\tuniforms.shininess.value = Math.max( material.shininess, 1e-4 ); // to prevent pow( 0.0, 0.0 )\r\n\r\n\t\t\tif ( material.gradientMap ) {\r\n\r\n\t\t\t\tuniforms.gradientMap.value = material.gradientMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.bumpScale.value *= - 1; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.normalMap ) {\r\n\r\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.normalScale.value.negate(); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsStandard( uniforms, material, environment ) {\r\n\r\n\t\t\tuniforms.roughness.value = material.roughness;\r\n\t\t\tuniforms.metalness.value = material.metalness;\r\n\r\n\t\t\tif ( material.roughnessMap ) {\r\n\r\n\t\t\t\tuniforms.roughnessMap.value = material.roughnessMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.metalnessMap ) {\r\n\r\n\t\t\t\tuniforms.metalnessMap.value = material.metalnessMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.emissiveMap ) {\r\n\r\n\t\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.bumpScale.value *= - 1; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.normalMap ) {\r\n\r\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.normalScale.value.negate(); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.envMap || environment ) {\r\n\r\n\t\t\t\t//uniforms.envMap.value = material.envMap; // part of uniforms common\r\n\t\t\t\tuniforms.envMapIntensity.value = material.envMapIntensity;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsPhysical( uniforms, material, environment ) {\r\n\r\n\t\t\trefreshUniformsStandard( uniforms, material, environment );\r\n\r\n\t\t\tuniforms.reflectivity.value = material.reflectivity; // also part of uniforms common\r\n\r\n\t\t\tuniforms.clearcoat.value = material.clearcoat;\r\n\t\t\tuniforms.clearcoatRoughness.value = material.clearcoatRoughness;\r\n\t\t\tif ( material.sheen ) { uniforms.sheen.value.copy( material.sheen ); }\r\n\r\n\t\t\tif ( material.clearcoatMap ) {\r\n\r\n\t\t\t\tuniforms.clearcoatMap.value = material.clearcoatMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.clearcoatRoughnessMap ) {\r\n\r\n\t\t\t\tuniforms.clearcoatRoughnessMap.value = material.clearcoatRoughnessMap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.clearcoatNormalMap ) {\r\n\r\n\t\t\t\tuniforms.clearcoatNormalScale.value.copy( material.clearcoatNormalScale );\r\n\t\t\t\tuniforms.clearcoatNormalMap.value = material.clearcoatNormalMap;\r\n\r\n\t\t\t\tif ( material.side === BackSide ) {\r\n\r\n\t\t\t\t\tuniforms.clearcoatNormalScale.value.negate();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuniforms.transparency.value = material.transparency;\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsMatcap( uniforms, material ) {\r\n\r\n\t\t\tif ( material.matcap ) {\r\n\r\n\t\t\t\tuniforms.matcap.value = material.matcap;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.bumpScale.value *= - 1; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.normalMap ) {\r\n\r\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.normalScale.value.negate(); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsDepth( uniforms, material ) {\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsDistance( uniforms, material ) {\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tuniforms.referencePosition.value.copy( material.referencePosition );\r\n\t\t\tuniforms.nearDistance.value = material.nearDistance;\r\n\t\t\tuniforms.farDistance.value = material.farDistance;\r\n\r\n\t\t}\r\n\r\n\t\tfunction refreshUniformsNormal( uniforms, material ) {\r\n\r\n\t\t\tif ( material.bumpMap ) {\r\n\r\n\t\t\t\tuniforms.bumpMap.value = material.bumpMap;\r\n\t\t\t\tuniforms.bumpScale.value = material.bumpScale;\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.bumpScale.value *= - 1; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.normalMap ) {\r\n\r\n\t\t\t\tuniforms.normalMap.value = material.normalMap;\r\n\t\t\t\tuniforms.normalScale.value.copy( material.normalScale );\r\n\t\t\t\tif ( material.side === BackSide ) { uniforms.normalScale.value.negate(); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.displacementMap ) {\r\n\r\n\t\t\t\tuniforms.displacementMap.value = material.displacementMap;\r\n\t\t\t\tuniforms.displacementScale.value = material.displacementScale;\r\n\t\t\t\tuniforms.displacementBias.value = material.displacementBias;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\r\n\r\n\t\tfunction markUniformsLightsNeedsUpdate( uniforms, value ) {\r\n\r\n\t\t\tuniforms.ambientLightColor.needsUpdate = value;\r\n\t\t\tuniforms.lightProbe.needsUpdate = value;\r\n\r\n\t\t\tuniforms.directionalLights.needsUpdate = value;\r\n\t\t\tuniforms.directionalLightShadows.needsUpdate = value;\r\n\t\t\tuniforms.pointLights.needsUpdate = value;\r\n\t\t\tuniforms.pointLightShadows.needsUpdate = value;\r\n\t\t\tuniforms.spotLights.needsUpdate = value;\r\n\t\t\tuniforms.spotLightShadows.needsUpdate = value;\r\n\t\t\tuniforms.rectAreaLights.needsUpdate = value;\r\n\t\t\tuniforms.hemisphereLights.needsUpdate = value;\r\n\r\n\t\t}\r\n\r\n\t\tfunction materialNeedsLights( material ) {\r\n\r\n\t\t\treturn material.isMeshLambertMaterial || material.isMeshToonMaterial || material.isMeshPhongMaterial ||\r\n\t\t\t\tmaterial.isMeshStandardMaterial || material.isShadowMaterial ||\r\n\t\t\t\t( material.isShaderMaterial && material.lights === true );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\t\tthis.setFramebuffer = function ( value ) {\r\n\r\n\t\t\tif ( _framebuffer !== value && _currentRenderTarget === null ) { _gl.bindFramebuffer( 36160, value ); }\r\n\r\n\t\t\t_framebuffer = value;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getActiveCubeFace = function () {\r\n\r\n\t\t\treturn _currentActiveCubeFace;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getActiveMipmapLevel = function () {\r\n\r\n\t\t\treturn _currentActiveMipmapLevel;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getRenderTarget = function () {\r\n\r\n\t\t\treturn _currentRenderTarget;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setRenderTarget = function ( renderTarget, activeCubeFace, activeMipmapLevel ) {\r\n\r\n\t\t\t_currentRenderTarget = renderTarget;\r\n\t\t\t_currentActiveCubeFace = activeCubeFace;\r\n\t\t\t_currentActiveMipmapLevel = activeMipmapLevel;\r\n\r\n\t\t\tif ( renderTarget && properties.get( renderTarget ).__webglFramebuffer === undefined ) {\r\n\r\n\t\t\t\ttextures.setupRenderTarget( renderTarget );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar framebuffer = _framebuffer;\r\n\t\t\tvar isCube = false;\r\n\r\n\t\t\tif ( renderTarget ) {\r\n\r\n\t\t\t\tvar __webglFramebuffer = properties.get( renderTarget ).__webglFramebuffer;\r\n\r\n\t\t\t\tif ( renderTarget.isWebGLCubeRenderTarget ) {\r\n\r\n\t\t\t\t\tframebuffer = __webglFramebuffer[ activeCubeFace || 0 ];\r\n\t\t\t\t\tisCube = true;\r\n\r\n\t\t\t\t} else if ( renderTarget.isWebGLMultisampleRenderTarget ) {\r\n\r\n\t\t\t\t\tframebuffer = properties.get( renderTarget ).__webglMultisampledFramebuffer;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tframebuffer = __webglFramebuffer;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_currentViewport.copy( renderTarget.viewport );\r\n\t\t\t\t_currentScissor.copy( renderTarget.scissor );\r\n\t\t\t\t_currentScissorTest = renderTarget.scissorTest;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_currentViewport.copy( _viewport ).multiplyScalar( _pixelRatio ).floor();\r\n\t\t\t\t_currentScissor.copy( _scissor ).multiplyScalar( _pixelRatio ).floor();\r\n\t\t\t\t_currentScissorTest = _scissorTest;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( _currentFramebuffer !== framebuffer ) {\r\n\r\n\t\t\t\t_gl.bindFramebuffer( 36160, framebuffer );\r\n\t\t\t\t_currentFramebuffer = framebuffer;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.viewport( _currentViewport );\r\n\t\t\tstate.scissor( _currentScissor );\r\n\t\t\tstate.setScissorTest( _currentScissorTest );\r\n\r\n\t\t\tif ( isCube ) {\r\n\r\n\t\t\t\tvar textureProperties = properties.get( renderTarget.texture );\r\n\t\t\t\t_gl.framebufferTexture2D( 36160, 36064, 34069 + ( activeCubeFace || 0 ), textureProperties.__webglTexture, activeMipmapLevel || 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.readRenderTargetPixels = function ( renderTarget, x, y, width, height, buffer, activeCubeFaceIndex ) {\r\n\r\n\t\t\tif ( ! ( renderTarget && renderTarget.isWebGLRenderTarget ) ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar framebuffer = properties.get( renderTarget ).__webglFramebuffer;\r\n\r\n\t\t\tif ( renderTarget.isWebGLCubeRenderTarget && activeCubeFaceIndex !== undefined ) {\r\n\r\n\t\t\t\tframebuffer = framebuffer[ activeCubeFaceIndex ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( framebuffer ) {\r\n\r\n\t\t\t\tvar restore = false;\r\n\r\n\t\t\t\tif ( framebuffer !== _currentFramebuffer ) {\r\n\r\n\t\t\t\t\t_gl.bindFramebuffer( 36160, framebuffer );\r\n\r\n\t\t\t\t\trestore = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tvar texture = renderTarget.texture;\r\n\t\t\t\t\tvar textureFormat = texture.format;\r\n\t\t\t\t\tvar textureType = texture.type;\r\n\r\n\t\t\t\t\tif ( textureFormat !== RGBAFormat && utils.convert( textureFormat ) !== _gl.getParameter( 35739 ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( textureType !== UnsignedByteType && utils.convert( textureType ) !== _gl.getParameter( 35738 ) && // IE11, Edge and Chrome Mac < 52 (#9513)\r\n\t\t\t\t\t\t! ( textureType === FloatType && ( capabilities.isWebGL2 || extensions.get( 'OES_texture_float' ) || extensions.get( 'WEBGL_color_buffer_float' ) ) ) && // Chrome Mac >= 52 and Firefox\r\n\t\t\t\t\t\t! ( textureType === HalfFloatType && ( capabilities.isWebGL2 ? extensions.get( 'EXT_color_buffer_float' ) : extensions.get( 'EXT_color_buffer_half_float' ) ) ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( _gl.checkFramebufferStatus( 36160 ) === 36053 ) {\r\n\r\n\t\t\t\t\t\t// the following if statement ensures valid read requests (no out-of-bounds pixels, see #8604)\r\n\r\n\t\t\t\t\t\tif ( ( x >= 0 && x <= ( renderTarget.width - width ) ) && ( y >= 0 && y <= ( renderTarget.height - height ) ) ) {\r\n\r\n\t\t\t\t\t\t\t_gl.readPixels( x, y, width, height, utils.convert( textureFormat ), utils.convert( textureType ), buffer );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} finally {\r\n\r\n\t\t\t\t\tif ( restore ) {\r\n\r\n\t\t\t\t\t\t_gl.bindFramebuffer( 36160, _currentFramebuffer );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.copyFramebufferToTexture = function ( position, texture, level ) {\r\n\r\n\t\t\tif ( level === undefined ) { level = 0; }\r\n\r\n\t\t\tvar levelScale = Math.pow( 2, - level );\r\n\t\t\tvar width = Math.floor( texture.image.width * levelScale );\r\n\t\t\tvar height = Math.floor( texture.image.height * levelScale );\r\n\t\t\tvar glFormat = utils.convert( texture.format );\r\n\r\n\t\t\ttextures.setTexture2D( texture, 0 );\r\n\r\n\t\t\t_gl.copyTexImage2D( 3553, level, glFormat, position.x, position.y, width, height, 0 );\r\n\r\n\t\t\tstate.unbindTexture();\r\n\r\n\t\t};\r\n\r\n\t\tthis.copyTextureToTexture = function ( position, srcTexture, dstTexture, level ) {\r\n\r\n\t\t\tvar width = srcTexture.image.width;\r\n\t\t\tvar height = srcTexture.image.height;\r\n\t\t\tvar glFormat = utils.convert( dstTexture.format );\r\n\t\t\tvar glType = utils.convert( dstTexture.type );\r\n\r\n\t\t\ttextures.setTexture2D( dstTexture, 0 );\r\n\r\n\t\t\tif ( srcTexture.isDataTexture ) {\r\n\r\n\t\t\t\t_gl.texSubImage2D( 3553, level || 0, position.x, position.y, width, height, glFormat, glType, srcTexture.image.data );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_gl.texSubImage2D( 3553, level || 0, position.x, position.y, glFormat, glType, srcTexture.image );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tstate.unbindTexture();\r\n\r\n\t\t};\r\n\r\n\t\tthis.initTexture = function ( texture ) {\r\n\r\n\t\t\ttextures.setTexture2D( texture, 0 );\r\n\r\n\t\t\tstate.unbindTexture();\r\n\r\n\t\t};\r\n\r\n\t\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\r\n\r\n\t\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) ); // eslint-disable-line no-undef\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction FogExp2( color, density ) {\r\n\r\n\t\tthis.name = '';\r\n\r\n\t\tthis.color = new Color( color );\r\n\t\tthis.density = ( density !== undefined ) ? density : 0.00025;\r\n\r\n\t}\r\n\r\n\tObject.assign( FogExp2.prototype, {\r\n\r\n\t\tisFogExp2: true,\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new FogExp2( this.color, this.density );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( /* meta */ ) {\r\n\r\n\t\t\treturn {\r\n\t\t\t\ttype: 'FogExp2',\r\n\t\t\t\tcolor: this.color.getHex(),\r\n\t\t\t\tdensity: this.density\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Fog( color, near, far ) {\r\n\r\n\t\tthis.name = '';\r\n\r\n\t\tthis.color = new Color( color );\r\n\r\n\t\tthis.near = ( near !== undefined ) ? near : 1;\r\n\t\tthis.far = ( far !== undefined ) ? far : 1000;\r\n\r\n\t}\r\n\r\n\tObject.assign( Fog.prototype, {\r\n\r\n\t\tisFog: true,\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new Fog( this.color, this.near, this.far );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( /* meta */ ) {\r\n\r\n\t\t\treturn {\r\n\t\t\t\ttype: 'Fog',\r\n\t\t\t\tcolor: this.color.getHex(),\r\n\t\t\t\tnear: this.near,\r\n\t\t\t\tfar: this.far\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tfunction InterleavedBuffer( array, stride ) {\r\n\r\n\t\tthis.array = array;\r\n\t\tthis.stride = stride;\r\n\t\tthis.count = array !== undefined ? array.length / stride : 0;\r\n\r\n\t\tthis.usage = StaticDrawUsage;\r\n\t\tthis.updateRange = { offset: 0, count: - 1 };\r\n\r\n\t\tthis.version = 0;\r\n\r\n\t}\r\n\r\n\tObject.defineProperty( InterleavedBuffer.prototype, 'needsUpdate', {\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tif ( value === true ) { this.version ++; }\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( InterleavedBuffer.prototype, {\r\n\r\n\t\tisInterleavedBuffer: true,\r\n\r\n\t\tonUploadCallback: function () {},\r\n\r\n\t\tsetUsage: function ( value ) {\r\n\r\n\t\t\tthis.usage = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.array = new source.array.constructor( source.array );\r\n\t\t\tthis.count = source.count;\r\n\t\t\tthis.stride = source.stride;\r\n\t\t\tthis.usage = source.usage;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyAt: function ( index1, attribute, index2 ) {\r\n\r\n\t\t\tindex1 *= this.stride;\r\n\t\t\tindex2 *= attribute.stride;\r\n\r\n\t\t\tfor ( var i = 0, l = this.stride; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tthis.array.set( value, offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tonUpload: function ( callback ) {\r\n\r\n\t\t\tthis.onUploadCallback = callback;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tvar _vector$6 = new Vector3();\r\n\r\n\tfunction InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, normalized ) {\r\n\r\n\t\tthis.data = interleavedBuffer;\r\n\t\tthis.itemSize = itemSize;\r\n\t\tthis.offset = offset;\r\n\r\n\t\tthis.normalized = normalized === true;\r\n\r\n\t}\r\n\r\n\tObject.defineProperties( InterleavedBufferAttribute.prototype, {\r\n\r\n\t\tcount: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.data.count;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tarray: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.data.array;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( InterleavedBufferAttribute.prototype, {\r\n\r\n\t\tisInterleavedBufferAttribute: true,\r\n\r\n\t\tapplyMatrix4: function ( m ) {\r\n\r\n\t\t\tfor ( var i = 0, l = this.data.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t_vector$6.x = this.getX( i );\r\n\t\t\t\t_vector$6.y = this.getY( i );\r\n\t\t\t\t_vector$6.z = this.getZ( i );\r\n\r\n\t\t\t\t_vector$6.applyMatrix4( m );\r\n\r\n\t\t\t\tthis.setXYZ( i, _vector$6.x, _vector$6.y, _vector$6.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetX: function ( index, x ) {\r\n\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetY: function ( index, y ) {\r\n\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetZ: function ( index, z ) {\r\n\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetW: function ( index, w ) {\r\n\r\n\t\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetX: function ( index ) {\r\n\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset ];\r\n\r\n\t\t},\r\n\r\n\t\tgetY: function ( index ) {\r\n\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\r\n\r\n\t\t},\r\n\r\n\t\tgetZ: function ( index ) {\r\n\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\r\n\r\n\t\t},\r\n\r\n\t\tgetW: function ( index ) {\r\n\r\n\t\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetXY: function ( index, x, y ) {\r\n\r\n\t\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\t\tthis.data.array[ index + 0 ] = x;\r\n\t\t\tthis.data.array[ index + 1 ] = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXYZ: function ( index, x, y, z ) {\r\n\r\n\t\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\t\tthis.data.array[ index + 0 ] = x;\r\n\t\t\tthis.data.array[ index + 1 ] = y;\r\n\t\t\tthis.data.array[ index + 2 ] = z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetXYZW: function ( index, x, y, z, w ) {\r\n\r\n\t\t\tindex = index * this.data.stride + this.offset;\r\n\r\n\t\t\tthis.data.array[ index + 0 ] = x;\r\n\t\t\tthis.data.array[ index + 1 ] = y;\r\n\t\t\tthis.data.array[ index + 2 ] = z;\r\n\t\t\tthis.data.array[ index + 3 ] = w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *  rotation: <float>,\r\n\t *  sizeAttenuation: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction SpriteMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'SpriteMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff );\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.rotation = 0;\r\n\r\n\t\tthis.sizeAttenuation = true;\r\n\r\n\t\tthis.transparent = true;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tSpriteMaterial.prototype = Object.create( Material.prototype );\r\n\tSpriteMaterial.prototype.constructor = SpriteMaterial;\r\n\tSpriteMaterial.prototype.isSpriteMaterial = true;\r\n\r\n\tSpriteMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.rotation = source.rotation;\r\n\r\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tvar _geometry;\r\n\r\n\tvar _intersectPoint = new Vector3();\r\n\tvar _worldScale = new Vector3();\r\n\tvar _mvPosition = new Vector3();\r\n\r\n\tvar _alignedPosition = new Vector2();\r\n\tvar _rotatedPosition = new Vector2();\r\n\tvar _viewWorldMatrix = new Matrix4();\r\n\r\n\tvar _vA$1 = new Vector3();\r\n\tvar _vB$1 = new Vector3();\r\n\tvar _vC$1 = new Vector3();\r\n\r\n\tvar _uvA$1 = new Vector2();\r\n\tvar _uvB$1 = new Vector2();\r\n\tvar _uvC$1 = new Vector2();\r\n\r\n\tfunction Sprite( material ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Sprite';\r\n\r\n\t\tif ( _geometry === undefined ) {\r\n\r\n\t\t\t_geometry = new BufferGeometry();\r\n\r\n\t\t\tvar float32Array = new Float32Array( [\r\n\t\t\t\t- 0.5, - 0.5, 0, 0, 0,\r\n\t\t\t\t0.5, - 0.5, 0, 1, 0,\r\n\t\t\t\t0.5, 0.5, 0, 1, 1,\r\n\t\t\t\t- 0.5, 0.5, 0, 0, 1\r\n\t\t\t] );\r\n\r\n\t\t\tvar interleavedBuffer = new InterleavedBuffer( float32Array, 5 );\r\n\r\n\t\t\t_geometry.setIndex( [ 0, 1, 2,\t0, 2, 3 ] );\r\n\t\t\t_geometry.setAttribute( 'position', new InterleavedBufferAttribute( interleavedBuffer, 3, 0, false ) );\r\n\t\t\t_geometry.setAttribute( 'uv', new InterleavedBufferAttribute( interleavedBuffer, 2, 3, false ) );\r\n\r\n\t\t}\r\n\r\n\t\tthis.geometry = _geometry;\r\n\t\tthis.material = ( material !== undefined ) ? material : new SpriteMaterial();\r\n\r\n\t\tthis.center = new Vector2( 0.5, 0.5 );\r\n\r\n\t}\r\n\r\n\tSprite.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Sprite,\r\n\r\n\t\tisSprite: true,\r\n\r\n\t\traycast: function ( raycaster, intersects ) {\r\n\r\n\t\t\tif ( raycaster.camera === null ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Sprite: \"Raycaster.camera\" needs to be set in order to raycast against sprites.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_worldScale.setFromMatrixScale( this.matrixWorld );\r\n\r\n\t\t\t_viewWorldMatrix.copy( raycaster.camera.matrixWorld );\r\n\t\t\tthis.modelViewMatrix.multiplyMatrices( raycaster.camera.matrixWorldInverse, this.matrixWorld );\r\n\r\n\t\t\t_mvPosition.setFromMatrixPosition( this.modelViewMatrix );\r\n\r\n\t\t\tif ( raycaster.camera.isPerspectiveCamera && this.material.sizeAttenuation === false ) {\r\n\r\n\t\t\t\t_worldScale.multiplyScalar( - _mvPosition.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar rotation = this.material.rotation;\r\n\t\t\tvar sin, cos;\r\n\t\t\tif ( rotation !== 0 ) {\r\n\r\n\t\t\t\tcos = Math.cos( rotation );\r\n\t\t\t\tsin = Math.sin( rotation );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar center = this.center;\r\n\r\n\t\t\ttransformVertex( _vA$1.set( - 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\r\n\t\t\ttransformVertex( _vB$1.set( 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\r\n\t\t\ttransformVertex( _vC$1.set( 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\r\n\r\n\t\t\t_uvA$1.set( 0, 0 );\r\n\t\t\t_uvB$1.set( 1, 0 );\r\n\t\t\t_uvC$1.set( 1, 1 );\r\n\r\n\t\t\t// check first triangle\r\n\t\t\tvar intersect = raycaster.ray.intersectTriangle( _vA$1, _vB$1, _vC$1, false, _intersectPoint );\r\n\r\n\t\t\tif ( intersect === null ) {\r\n\r\n\t\t\t\t// check second triangle\r\n\t\t\t\ttransformVertex( _vB$1.set( - 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\r\n\t\t\t\t_uvB$1.set( 0, 1 );\r\n\r\n\t\t\t\tintersect = raycaster.ray.intersectTriangle( _vA$1, _vC$1, _vB$1, false, _intersectPoint );\r\n\t\t\t\tif ( intersect === null ) {\r\n\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar distance = raycaster.ray.origin.distanceTo( _intersectPoint );\r\n\r\n\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) { return; }\r\n\r\n\t\t\tintersects.push( {\r\n\r\n\t\t\t\tdistance: distance,\r\n\t\t\t\tpoint: _intersectPoint.clone(),\r\n\t\t\t\tuv: Triangle.getUV( _intersectPoint, _vA$1, _vB$1, _vC$1, _uvA$1, _uvB$1, _uvC$1, new Vector2() ),\r\n\t\t\t\tface: null,\r\n\t\t\t\tobject: this\r\n\r\n\t\t\t} );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.material ).copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source );\r\n\r\n\t\t\tif ( source.center !== undefined ) { this.center.copy( source.center ); }\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\r\n\t} );\r\n\r\n\tfunction transformVertex( vertexPosition, mvPosition, center, scale, sin, cos ) {\r\n\r\n\t\t// compute position in camera space\r\n\t\t_alignedPosition.subVectors( vertexPosition, center ).addScalar( 0.5 ).multiply( scale );\r\n\r\n\t\t// to check if rotation is not zero\r\n\t\tif ( sin !== undefined ) {\r\n\r\n\t\t\t_rotatedPosition.x = ( cos * _alignedPosition.x ) - ( sin * _alignedPosition.y );\r\n\t\t\t_rotatedPosition.y = ( sin * _alignedPosition.x ) + ( cos * _alignedPosition.y );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_rotatedPosition.copy( _alignedPosition );\r\n\r\n\t\t}\r\n\r\n\r\n\t\tvertexPosition.copy( mvPosition );\r\n\t\tvertexPosition.x += _rotatedPosition.x;\r\n\t\tvertexPosition.y += _rotatedPosition.y;\r\n\r\n\t\t// transform to world space\r\n\t\tvertexPosition.applyMatrix4( _viewWorldMatrix );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _v1$4 = new Vector3();\r\n\tvar _v2$2 = new Vector3();\r\n\r\n\tfunction LOD() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis._currentLevel = 0;\r\n\r\n\t\tthis.type = 'LOD';\r\n\r\n\t\tObject.defineProperties( this, {\r\n\t\t\tlevels: {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tvalue: []\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\tthis.autoUpdate = true;\r\n\r\n\t}\r\n\r\n\tLOD.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: LOD,\r\n\r\n\t\tisLOD: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source, false );\r\n\r\n\t\t\tvar levels = source.levels;\r\n\r\n\t\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar level = levels[ i ];\r\n\r\n\t\t\t\tthis.addLevel( level.object.clone(), level.distance );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.autoUpdate = source.autoUpdate;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddLevel: function ( object, distance ) {\r\n\r\n\t\t\tif ( distance === undefined ) { distance = 0; }\r\n\r\n\t\t\tdistance = Math.abs( distance );\r\n\r\n\t\t\tvar levels = this.levels;\r\n\r\n\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\t\t\tif ( distance < levels[ l ].distance ) {\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlevels.splice( l, 0, { distance: distance, object: object } );\r\n\r\n\t\t\tthis.add( object );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetCurrentLevel: function () {\r\n\r\n\t\t\treturn this._currentLevel;\r\n\r\n\t\t},\r\n\r\n\t\tgetObjectForDistance: function ( distance ) {\r\n\r\n\t\t\tvar levels = this.levels;\r\n\r\n\t\t\tif ( levels.length > 0 ) {\r\n\r\n\t\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tif ( distance < levels[ i ].distance ) {\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn levels[ i - 1 ].object;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t},\r\n\r\n\t\traycast: function ( raycaster, intersects ) {\r\n\r\n\t\t\tvar levels = this.levels;\r\n\r\n\t\t\tif ( levels.length > 0 ) {\r\n\r\n\t\t\t\t_v1$4.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( _v1$4 );\r\n\r\n\t\t\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdate: function ( camera ) {\r\n\r\n\t\t\tvar levels = this.levels;\r\n\r\n\t\t\tif ( levels.length > 1 ) {\r\n\r\n\t\t\t\t_v1$4.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\t_v2$2.setFromMatrixPosition( this.matrixWorld );\r\n\r\n\t\t\t\tvar distance = _v1$4.distanceTo( _v2$2 ) / camera.zoom;\r\n\r\n\t\t\t\tlevels[ 0 ].object.visible = true;\r\n\r\n\t\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tif ( distance >= levels[ i ].distance ) {\r\n\r\n\t\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\r\n\t\t\t\t\t\tlevels[ i ].object.visible = true;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._currentLevel = i - 1;\r\n\r\n\t\t\t\tfor ( ; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tlevels[ i ].object.visible = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tif ( this.autoUpdate === false ) { data.object.autoUpdate = false; }\r\n\r\n\t\t\tdata.object.levels = [];\r\n\r\n\t\t\tvar levels = this.levels;\r\n\r\n\t\t\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar level = levels[ i ];\r\n\r\n\t\t\t\tdata.object.levels.push( {\r\n\t\t\t\t\tobject: level.object.uuid,\r\n\t\t\t\t\tdistance: level.distance\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\r\n\tfunction SkinnedMesh( geometry, material ) {\r\n\r\n\t\tif ( geometry && geometry.isGeometry ) {\r\n\r\n\t\t\tconsole.error( 'THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.' );\r\n\r\n\t\t}\r\n\r\n\t\tMesh.call( this, geometry, material );\r\n\r\n\t\tthis.type = 'SkinnedMesh';\r\n\r\n\t\tthis.bindMode = 'attached';\r\n\t\tthis.bindMatrix = new Matrix4();\r\n\t\tthis.bindMatrixInverse = new Matrix4();\r\n\r\n\t}\r\n\r\n\tSkinnedMesh.prototype = Object.assign( Object.create( Mesh.prototype ), {\r\n\r\n\t\tconstructor: SkinnedMesh,\r\n\r\n\t\tisSkinnedMesh: true,\r\n\r\n\t\tbind: function ( skeleton, bindMatrix ) {\r\n\r\n\t\t\tthis.skeleton = skeleton;\r\n\r\n\t\t\tif ( bindMatrix === undefined ) {\r\n\r\n\t\t\t\tthis.updateMatrixWorld( true );\r\n\r\n\t\t\t\tthis.skeleton.calculateInverses();\r\n\r\n\t\t\t\tbindMatrix = this.matrixWorld;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.bindMatrix.copy( bindMatrix );\r\n\t\t\tthis.bindMatrixInverse.getInverse( bindMatrix );\r\n\r\n\t\t},\r\n\r\n\t\tpose: function () {\r\n\r\n\t\t\tthis.skeleton.pose();\r\n\r\n\t\t},\r\n\r\n\t\tnormalizeSkinWeights: function () {\r\n\r\n\t\t\tvar vector = new Vector4();\r\n\r\n\t\t\tvar skinWeight = this.geometry.attributes.skinWeight;\r\n\r\n\t\t\tfor ( var i = 0, l = skinWeight.count; i < l; i ++ ) {\r\n\r\n\t\t\t\tvector.x = skinWeight.getX( i );\r\n\t\t\t\tvector.y = skinWeight.getY( i );\r\n\t\t\t\tvector.z = skinWeight.getZ( i );\r\n\t\t\t\tvector.w = skinWeight.getW( i );\r\n\r\n\t\t\t\tvar scale = 1.0 / vector.manhattanLength();\r\n\r\n\t\t\t\tif ( scale !== Infinity ) {\r\n\r\n\t\t\t\t\tvector.multiplyScalar( scale );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvector.set( 1, 0, 0, 0 ); // do something reasonable\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tskinWeight.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\t\tMesh.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\tif ( this.bindMode === 'attached' ) {\r\n\r\n\t\t\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\r\n\r\n\t\t\t} else if ( this.bindMode === 'detached' ) {\r\n\r\n\t\t\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.SkinnedMesh: Unrecognized bindMode: ' + this.bindMode );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author michael guerrero / http://realitymeltdown.com\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\r\n\tvar _offsetMatrix = new Matrix4();\r\n\tvar _identityMatrix = new Matrix4();\r\n\r\n\tfunction Skeleton( bones, boneInverses ) {\r\n\r\n\t\t// copy the bone array\r\n\r\n\t\tbones = bones || [];\r\n\r\n\t\tthis.bones = bones.slice( 0 );\r\n\t\tthis.boneMatrices = new Float32Array( this.bones.length * 16 );\r\n\r\n\t\tthis.frame = - 1;\r\n\r\n\t\t// use the supplied bone inverses or calculate the inverses\r\n\r\n\t\tif ( boneInverses === undefined ) {\r\n\r\n\t\t\tthis.calculateInverses();\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( this.bones.length === boneInverses.length ) {\r\n\r\n\t\t\t\tthis.boneInverses = boneInverses.slice( 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Skeleton boneInverses is the wrong length.' );\r\n\r\n\t\t\t\tthis.boneInverses = [];\r\n\r\n\t\t\t\tfor ( var i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tthis.boneInverses.push( new Matrix4() );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( Skeleton.prototype, {\r\n\r\n\t\tcalculateInverses: function () {\r\n\r\n\t\t\tthis.boneInverses = [];\r\n\r\n\t\t\tfor ( var i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar inverse = new Matrix4();\r\n\r\n\t\t\t\tif ( this.bones[ i ] ) {\r\n\r\n\t\t\t\t\tinverse.getInverse( this.bones[ i ].matrixWorld );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.boneInverses.push( inverse );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tpose: function () {\r\n\r\n\t\t\tvar bone, i, il;\r\n\r\n\t\t\t// recover the bind-time world matrices\r\n\r\n\t\t\tfor ( i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tbone = this.bones[ i ];\r\n\r\n\t\t\t\tif ( bone ) {\r\n\r\n\t\t\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// compute the local matrices, positions, rotations and scales\r\n\r\n\t\t\tfor ( i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tbone = this.bones[ i ];\r\n\r\n\t\t\t\tif ( bone ) {\r\n\r\n\t\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\r\n\r\n\t\t\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\r\n\t\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdate: function () {\r\n\r\n\t\t\tvar bones = this.bones;\r\n\t\t\tvar boneInverses = this.boneInverses;\r\n\t\t\tvar boneMatrices = this.boneMatrices;\r\n\t\t\tvar boneTexture = this.boneTexture;\r\n\r\n\t\t\t// flatten bone matrices to array\r\n\r\n\t\t\tfor ( var i = 0, il = bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t// compute the offset between the current and the original transform\r\n\r\n\t\t\t\tvar matrix = bones[ i ] ? bones[ i ].matrixWorld : _identityMatrix;\r\n\r\n\t\t\t\t_offsetMatrix.multiplyMatrices( matrix, boneInverses[ i ] );\r\n\t\t\t\t_offsetMatrix.toArray( boneMatrices, i * 16 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( boneTexture !== undefined ) {\r\n\r\n\t\t\t\tboneTexture.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new Skeleton( this.bones, this.boneInverses );\r\n\r\n\t\t},\r\n\r\n\t\tgetBoneByName: function ( name ) {\r\n\r\n\t\t\tfor ( var i = 0, il = this.bones.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar bone = this.bones[ i ];\r\n\r\n\t\t\t\tif ( bone.name === name ) {\r\n\r\n\t\t\t\t\treturn bone;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\r\n\t\t},\r\n\r\n\t\tdispose: function ( ) {\r\n\r\n\t\t\tif ( this.boneTexture ) {\r\n\r\n\t\t\t\tthis.boneTexture.dispose();\r\n\r\n\t\t\t\tthis.boneTexture = undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mikael emtinger / http://gomo.se/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author ikerr / http://verold.com\r\n\t */\r\n\r\n\tfunction Bone() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Bone';\r\n\r\n\t}\r\n\r\n\tBone.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Bone,\r\n\r\n\t\tisBone: true\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _instanceLocalMatrix = new Matrix4();\r\n\tvar _instanceWorldMatrix = new Matrix4();\r\n\r\n\tvar _instanceIntersects = [];\r\n\r\n\tvar _mesh = new Mesh();\r\n\r\n\tfunction InstancedMesh( geometry, material, count ) {\r\n\r\n\t\tMesh.call( this, geometry, material );\r\n\r\n\t\tthis.instanceMatrix = new BufferAttribute( new Float32Array( count * 16 ), 16 );\r\n\r\n\t\tthis.count = count;\r\n\r\n\t\tthis.frustumCulled = false;\r\n\r\n\t}\r\n\r\n\tInstancedMesh.prototype = Object.assign( Object.create( Mesh.prototype ), {\r\n\r\n\t\tconstructor: InstancedMesh,\r\n\r\n\t\tisInstancedMesh: true,\r\n\r\n\t\tgetMatrixAt: function ( index, matrix ) {\r\n\r\n\t\t\tmatrix.fromArray( this.instanceMatrix.array, index * 16 );\r\n\r\n\t\t},\r\n\r\n\t\traycast: function ( raycaster, intersects ) {\r\n\r\n\t\t\tvar matrixWorld = this.matrixWorld;\r\n\t\t\tvar raycastTimes = this.count;\r\n\r\n\t\t\t_mesh.geometry = this.geometry;\r\n\t\t\t_mesh.material = this.material;\r\n\r\n\t\t\tif ( _mesh.material === undefined ) { return; }\r\n\r\n\t\t\tfor ( var instanceId = 0; instanceId < raycastTimes; instanceId ++ ) {\r\n\r\n\t\t\t\t// calculate the world matrix for each instance\r\n\r\n\t\t\t\tthis.getMatrixAt( instanceId, _instanceLocalMatrix );\r\n\r\n\t\t\t\t_instanceWorldMatrix.multiplyMatrices( matrixWorld, _instanceLocalMatrix );\r\n\r\n\t\t\t\t// the mesh represents this single instance\r\n\r\n\t\t\t\t_mesh.matrixWorld = _instanceWorldMatrix;\r\n\r\n\t\t\t\t_mesh.raycast( raycaster, _instanceIntersects );\r\n\r\n\t\t\t\t// process the result of raycast\r\n\r\n\t\t\t\tif ( _instanceIntersects.length > 0 ) {\r\n\r\n\t\t\t\t\t_instanceIntersects[ 0 ].instanceId = instanceId;\r\n\t\t\t\t\t_instanceIntersects[ 0 ].object = this;\r\n\r\n\t\t\t\t\tintersects.push( _instanceIntersects[ 0 ] );\r\n\r\n\t\t\t\t\t_instanceIntersects.length = 0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tsetMatrixAt: function ( index, matrix ) {\r\n\r\n\t\t\tmatrix.toArray( this.instanceMatrix.array, index * 16 );\r\n\r\n\t\t},\r\n\r\n\t\tupdateMorphTargets: function () {\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  linewidth: <float>,\r\n\t *  linecap: \"round\",\r\n\t *  linejoin: \"round\"\r\n\t * }\r\n\t */\r\n\r\n\tfunction LineBasicMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'LineBasicMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff );\r\n\r\n\t\tthis.linewidth = 1;\r\n\t\tthis.linecap = 'round';\r\n\t\tthis.linejoin = 'round';\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tLineBasicMaterial.prototype = Object.create( Material.prototype );\r\n\tLineBasicMaterial.prototype.constructor = LineBasicMaterial;\r\n\r\n\tLineBasicMaterial.prototype.isLineBasicMaterial = true;\r\n\r\n\tLineBasicMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.linewidth = source.linewidth;\r\n\t\tthis.linecap = source.linecap;\r\n\t\tthis.linejoin = source.linejoin;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _start = new Vector3();\r\n\tvar _end = new Vector3();\r\n\tvar _inverseMatrix$1 = new Matrix4();\r\n\tvar _ray$1 = new Ray();\r\n\tvar _sphere$2 = new Sphere();\r\n\r\n\tfunction Line( geometry, material, mode ) {\r\n\r\n\t\tif ( mode === 1 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.' );\r\n\r\n\t\t}\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Line';\r\n\r\n\t\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\r\n\t\tthis.material = material !== undefined ? material : new LineBasicMaterial();\r\n\r\n\t}\r\n\r\n\tLine.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Line,\r\n\r\n\t\tisLine: true,\r\n\r\n\t\tcomputeLineDistances: function () {\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t// we assume non-indexed geometry\r\n\r\n\t\t\t\tif ( geometry.index === null ) {\r\n\r\n\t\t\t\t\tvar positionAttribute = geometry.attributes.position;\r\n\t\t\t\t\tvar lineDistances = [ 0 ];\r\n\r\n\t\t\t\t\tfor ( var i = 1, l = positionAttribute.count; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t_start.fromBufferAttribute( positionAttribute, i - 1 );\r\n\t\t\t\t\t\t_end.fromBufferAttribute( positionAttribute, i );\r\n\r\n\t\t\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\r\n\t\t\t\t\t\tlineDistances[ i ] += _start.distanceTo( _end );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\tvar lineDistances = geometry.lineDistances;\r\n\r\n\t\t\t\tlineDistances[ 0 ] = 0;\r\n\r\n\t\t\t\tfor ( var i = 1, l = vertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\r\n\t\t\t\t\tlineDistances[ i ] += vertices[ i - 1 ].distanceTo( vertices[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\traycast: function ( raycaster, intersects ) {\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar matrixWorld = this.matrixWorld;\r\n\t\t\tvar threshold = raycaster.params.Line.threshold;\r\n\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) { geometry.computeBoundingSphere(); }\r\n\r\n\t\t\t_sphere$2.copy( geometry.boundingSphere );\r\n\t\t\t_sphere$2.applyMatrix4( matrixWorld );\r\n\t\t\t_sphere$2.radius += threshold;\r\n\r\n\t\t\tif ( raycaster.ray.intersectsSphere( _sphere$2 ) === false ) { return; }\r\n\r\n\t\t\t//\r\n\r\n\t\t\t_inverseMatrix$1.getInverse( matrixWorld );\r\n\t\t\t_ray$1.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$1 );\r\n\r\n\t\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\t\tvar localThresholdSq = localThreshold * localThreshold;\r\n\r\n\t\t\tvar vStart = new Vector3();\r\n\t\t\tvar vEnd = new Vector3();\r\n\t\t\tvar interSegment = new Vector3();\r\n\t\t\tvar interRay = new Vector3();\r\n\t\t\tvar step = ( this && this.isLineSegments ) ? 2 : 1;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tvar index = geometry.index;\r\n\t\t\t\tvar attributes = geometry.attributes;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = indices.length - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\t\tvar a = indices[ i ];\r\n\t\t\t\t\t\tvar b = indices[ i + 1 ];\r\n\r\n\t\t\t\t\t\tvStart.fromArray( positions, a * 3 );\r\n\t\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\r\n\r\n\t\t\t\t\t\tvar distSq = _ray$1.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\t\tif ( distSq > localThresholdSq ) { continue; }\r\n\r\n\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) { continue; }\r\n\r\n\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = positions.length / 3 - 1; i < l; i += step ) {\r\n\r\n\t\t\t\t\t\tvStart.fromArray( positions, 3 * i );\r\n\t\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\r\n\r\n\t\t\t\t\t\tvar distSq = _ray$1.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\r\n\r\n\t\t\t\t\t\tif ( distSq > localThresholdSq ) { continue; }\r\n\r\n\t\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) { continue; }\r\n\r\n\t\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\tvar nbVertices = vertices.length;\r\n\r\n\t\t\t\tfor ( var i = 0; i < nbVertices - 1; i += step ) {\r\n\r\n\t\t\t\t\tvar distSq = _ray$1.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\r\n\r\n\t\t\t\t\tif ( distSq > localThresholdSq ) { continue; }\r\n\r\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\r\n\r\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) { continue; }\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\r\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\r\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\r\n\t\t\t\t\t\tindex: i,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tfaceIndex: null,\r\n\t\t\t\t\t\tobject: this\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _start$1 = new Vector3();\r\n\tvar _end$1 = new Vector3();\r\n\r\n\tfunction LineSegments( geometry, material ) {\r\n\r\n\t\tLine.call( this, geometry, material );\r\n\r\n\t\tthis.type = 'LineSegments';\r\n\r\n\t}\r\n\r\n\tLineSegments.prototype = Object.assign( Object.create( Line.prototype ), {\r\n\r\n\t\tconstructor: LineSegments,\r\n\r\n\t\tisLineSegments: true,\r\n\r\n\t\tcomputeLineDistances: function () {\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t// we assume non-indexed geometry\r\n\r\n\t\t\t\tif ( geometry.index === null ) {\r\n\r\n\t\t\t\t\tvar positionAttribute = geometry.attributes.position;\r\n\t\t\t\t\tvar lineDistances = [];\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = positionAttribute.count; i < l; i += 2 ) {\r\n\r\n\t\t\t\t\t\t_start$1.fromBufferAttribute( positionAttribute, i );\r\n\t\t\t\t\t\t_end$1.fromBufferAttribute( positionAttribute, i + 1 );\r\n\r\n\t\t\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\r\n\t\t\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start$1.distanceTo( _end$1 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( geometry.isGeometry ) {\r\n\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\t\t\t\tvar lineDistances = geometry.lineDistances;\r\n\r\n\t\t\t\tfor ( var i = 0, l = vertices.length; i < l; i += 2 ) {\r\n\r\n\t\t\t\t\t_start$1.copy( vertices[ i ] );\r\n\t\t\t\t\t_end$1.copy( vertices[ i + 1 ] );\r\n\r\n\t\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\r\n\t\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start$1.distanceTo( _end$1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mgreter / http://github.com/mgreter\r\n\t */\r\n\r\n\tfunction LineLoop( geometry, material ) {\r\n\r\n\t\tLine.call( this, geometry, material );\r\n\r\n\t\tthis.type = 'LineLoop';\r\n\r\n\t}\r\n\r\n\tLineLoop.prototype = Object.assign( Object.create( Line.prototype ), {\r\n\r\n\t\tconstructor: LineLoop,\r\n\r\n\t\tisLineLoop: true,\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  size: <float>,\r\n\t *  sizeAttenuation: <bool>\r\n\t *\r\n\t *  morphTargets: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction PointsMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'PointsMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff );\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.size = 1;\r\n\t\tthis.sizeAttenuation = true;\r\n\r\n\t\tthis.morphTargets = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tPointsMaterial.prototype = Object.create( Material.prototype );\r\n\tPointsMaterial.prototype.constructor = PointsMaterial;\r\n\r\n\tPointsMaterial.prototype.isPointsMaterial = true;\r\n\r\n\tPointsMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.size = source.size;\r\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\r\n\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tvar _inverseMatrix$2 = new Matrix4();\r\n\tvar _ray$2 = new Ray();\r\n\tvar _sphere$3 = new Sphere();\r\n\tvar _position$1 = new Vector3();\r\n\r\n\tfunction Points( geometry, material ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Points';\r\n\r\n\t\tthis.geometry = geometry !== undefined ? geometry : new BufferGeometry();\r\n\t\tthis.material = material !== undefined ? material : new PointsMaterial();\r\n\r\n\t\tthis.updateMorphTargets();\r\n\r\n\t}\r\n\r\n\tPoints.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Points,\r\n\r\n\t\tisPoints: true,\r\n\r\n\t\traycast: function ( raycaster, intersects ) {\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar matrixWorld = this.matrixWorld;\r\n\t\t\tvar threshold = raycaster.params.Points.threshold;\r\n\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) { geometry.computeBoundingSphere(); }\r\n\r\n\t\t\t_sphere$3.copy( geometry.boundingSphere );\r\n\t\t\t_sphere$3.applyMatrix4( matrixWorld );\r\n\t\t\t_sphere$3.radius += threshold;\r\n\r\n\t\t\tif ( raycaster.ray.intersectsSphere( _sphere$3 ) === false ) { return; }\r\n\r\n\t\t\t//\r\n\r\n\t\t\t_inverseMatrix$2.getInverse( matrixWorld );\r\n\t\t\t_ray$2.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$2 );\r\n\r\n\t\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\t\tvar localThresholdSq = localThreshold * localThreshold;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tvar index = geometry.index;\r\n\t\t\t\tvar attributes = geometry.attributes;\r\n\t\t\t\tvar positions = attributes.position.array;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tvar indices = index.array;\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = indices.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar a = indices[ i ];\r\n\r\n\t\t\t\t\t\t_position$1.fromArray( positions, a * 3 );\r\n\r\n\t\t\t\t\t\ttestPoint( _position$1, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = positions.length / 3; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\t_position$1.fromArray( positions, i * 3 );\r\n\r\n\t\t\t\t\t\ttestPoint( _position$1, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar vertices = geometry.vertices;\r\n\r\n\t\t\t\tfor ( var i = 0, l = vertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\ttestPoint( vertices[ i ], i, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tupdateMorphTargets: function () {\r\n\r\n\t\t\tvar geometry = this.geometry;\r\n\t\t\tvar m, ml, name;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tvar morphAttributes = geometry.morphAttributes;\r\n\t\t\t\tvar keys = Object.keys( morphAttributes );\r\n\r\n\t\t\t\tif ( keys.length > 0 ) {\r\n\r\n\t\t\t\t\tvar morphAttribute = morphAttributes[ keys[ 0 ] ];\r\n\r\n\t\t\t\t\tif ( morphAttribute !== undefined ) {\r\n\r\n\t\t\t\t\t\tthis.morphTargetInfluences = [];\r\n\t\t\t\t\t\tthis.morphTargetDictionary = {};\r\n\r\n\t\t\t\t\t\tfor ( m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\r\n\r\n\t\t\t\t\t\t\tname = morphAttribute[ m ].name || String( m );\r\n\r\n\t\t\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\r\n\t\t\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar morphTargets = geometry.morphTargets;\r\n\r\n\t\t\t\tif ( morphTargets !== undefined && morphTargets.length > 0 ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor( this.geometry, this.material ).copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\r\n\r\n\t\tvar rayPointDistanceSq = _ray$2.distanceSqToPoint( point );\r\n\r\n\t\tif ( rayPointDistanceSq < localThresholdSq ) {\r\n\r\n\t\t\tvar intersectPoint = new Vector3();\r\n\r\n\t\t\t_ray$2.closestPointToPoint( point, intersectPoint );\r\n\t\t\tintersectPoint.applyMatrix4( matrixWorld );\r\n\r\n\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) { return; }\r\n\r\n\t\t\tintersects.push( {\r\n\r\n\t\t\t\tdistance: distance,\r\n\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\r\n\t\t\t\tpoint: intersectPoint,\r\n\t\t\t\tindex: index,\r\n\t\t\t\tface: null,\r\n\t\t\t\tobject: object\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction VideoTexture( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\t\tTexture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\t\tthis.format = format !== undefined ? format : RGBFormat;\r\n\r\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : LinearFilter;\r\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : LinearFilter;\r\n\r\n\t\tthis.generateMipmaps = false;\r\n\r\n\t}\r\n\r\n\tVideoTexture.prototype = Object.assign( Object.create( Texture.prototype ), {\r\n\r\n\t\tconstructor: VideoTexture,\r\n\r\n\t\tisVideoTexture: true,\r\n\r\n\t\tupdate: function () {\r\n\r\n\t\t\tvar video = this.image;\r\n\r\n\t\t\tif ( video.readyState >= video.HAVE_CURRENT_DATA ) {\r\n\r\n\t\t\t\tthis.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction CompressedTexture( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, encoding ) {\r\n\r\n\t\tTexture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, encoding );\r\n\r\n\t\tthis.image = { width: width, height: height };\r\n\t\tthis.mipmaps = mipmaps;\r\n\r\n\t\t// no flipping for cube textures\r\n\t\t// (also flipping doesn't work for compressed textures )\r\n\r\n\t\tthis.flipY = false;\r\n\r\n\t\t// can't generate mipmaps for compressed textures\r\n\t\t// mips must be embedded in DDS files\r\n\r\n\t\tthis.generateMipmaps = false;\r\n\r\n\t}\r\n\r\n\tCompressedTexture.prototype = Object.create( Texture.prototype );\r\n\tCompressedTexture.prototype.constructor = CompressedTexture;\r\n\r\n\tCompressedTexture.prototype.isCompressedTexture = true;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction CanvasTexture( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\r\n\r\n\t\tTexture.call( this, canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\t\tthis.needsUpdate = true;\r\n\r\n\t}\r\n\r\n\tCanvasTexture.prototype = Object.create( Texture.prototype );\r\n\tCanvasTexture.prototype.constructor = CanvasTexture;\r\n\tCanvasTexture.prototype.isCanvasTexture = true;\r\n\r\n\t/**\r\n\t * @author Matt DesLauriers / @mattdesl\r\n\t * @author atix / arthursilber.de\r\n\t */\r\n\r\n\tfunction DepthTexture( width, height, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, format ) {\r\n\r\n\t\tformat = format !== undefined ? format : DepthFormat;\r\n\r\n\t\tif ( format !== DepthFormat && format !== DepthStencilFormat ) {\r\n\r\n\t\t\tthrow new Error( 'DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( type === undefined && format === DepthFormat ) { type = UnsignedShortType; }\r\n\t\tif ( type === undefined && format === DepthStencilFormat ) { type = UnsignedInt248Type; }\r\n\r\n\t\tTexture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\r\n\r\n\t\tthis.image = { width: width, height: height };\r\n\r\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\r\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\r\n\r\n\t\tthis.flipY = false;\r\n\t\tthis.generateMipmaps\t= false;\r\n\r\n\t}\r\n\r\n\tDepthTexture.prototype = Object.create( Texture.prototype );\r\n\tDepthTexture.prototype.constructor = DepthTexture;\r\n\tDepthTexture.prototype.isDepthTexture = true;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction WireframeGeometry( geometry ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'WireframeGeometry';\r\n\r\n\t\t// buffer\r\n\r\n\t\tvar vertices = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar i, j, l, o, ol;\r\n\t\tvar edge = [ 0, 0 ], edges = {}, e, edge1, edge2;\r\n\t\tvar key, keys = [ 'a', 'b', 'c' ];\r\n\t\tvar vertex;\r\n\r\n\t\t// different logic for Geometry and BufferGeometry\r\n\r\n\t\tif ( geometry && geometry.isGeometry ) {\r\n\r\n\t\t\t// create a data structure that contains all edges without duplicates\r\n\r\n\t\t\tvar faces = geometry.faces;\r\n\r\n\t\t\tfor ( i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\tedge1 = face[ keys[ j ] ];\r\n\t\t\t\t\tedge2 = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\t\tedge[ 0 ] = Math.min( edge1, edge2 ); // sorting prevents duplicates\r\n\t\t\t\t\tedge[ 1 ] = Math.max( edge1, edge2 );\r\n\r\n\t\t\t\t\tkey = edge[ 0 ] + ',' + edge[ 1 ];\r\n\r\n\t\t\t\t\tif ( edges[ key ] === undefined ) {\r\n\r\n\t\t\t\t\t\tedges[ key ] = { index1: edge[ 0 ], index2: edge[ 1 ] };\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// generate vertices\r\n\r\n\t\t\tfor ( key in edges ) {\r\n\r\n\t\t\t\te = edges[ key ];\r\n\r\n\t\t\t\tvertex = geometry.vertices[ e.index1 ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\tvertex = geometry.vertices[ e.index2 ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( geometry && geometry.isBufferGeometry ) {\r\n\r\n\t\t\tvar position, indices, groups;\r\n\t\t\tvar group, start, count;\r\n\t\t\tvar index1, index2;\r\n\r\n\t\t\tvertex = new Vector3();\r\n\r\n\t\t\tif ( geometry.index !== null ) {\r\n\r\n\t\t\t\t// indexed BufferGeometry\r\n\r\n\t\t\t\tposition = geometry.attributes.position;\r\n\t\t\t\tindices = geometry.index;\r\n\t\t\t\tgroups = geometry.groups;\r\n\r\n\t\t\t\tif ( groups.length === 0 ) {\r\n\r\n\t\t\t\t\tgroups = [ { start: 0, count: indices.count, materialIndex: 0 } ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// create a data structure that contains all eges without duplicates\r\n\r\n\t\t\t\tfor ( o = 0, ol = groups.length; o < ol; ++ o ) {\r\n\r\n\t\t\t\t\tgroup = groups[ o ];\r\n\r\n\t\t\t\t\tstart = group.start;\r\n\t\t\t\t\tcount = group.count;\r\n\r\n\t\t\t\t\tfor ( i = start, l = ( start + count ); i < l; i += 3 ) {\r\n\r\n\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tedge1 = indices.getX( i + j );\r\n\t\t\t\t\t\t\tedge2 = indices.getX( i + ( j + 1 ) % 3 );\r\n\t\t\t\t\t\t\tedge[ 0 ] = Math.min( edge1, edge2 ); // sorting prevents duplicates\r\n\t\t\t\t\t\t\tedge[ 1 ] = Math.max( edge1, edge2 );\r\n\r\n\t\t\t\t\t\t\tkey = edge[ 0 ] + ',' + edge[ 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( edges[ key ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tedges[ key ] = { index1: edge[ 0 ], index2: edge[ 1 ] };\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// generate vertices\r\n\r\n\t\t\t\tfor ( key in edges ) {\r\n\r\n\t\t\t\t\te = edges[ key ];\r\n\r\n\t\t\t\t\tvertex.fromBufferAttribute( position, e.index1 );\r\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t\tvertex.fromBufferAttribute( position, e.index2 );\r\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// non-indexed BufferGeometry\r\n\r\n\t\t\t\tposition = geometry.attributes.position;\r\n\r\n\t\t\t\tfor ( i = 0, l = ( position.count / 3 ); i < l; i ++ ) {\r\n\r\n\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\t\t\t// three edges per triangle, an edge is represented as (index1, index2)\r\n\t\t\t\t\t\t// e.g. the first triangle has the following edges: (0,1),(1,2),(2,0)\r\n\r\n\t\t\t\t\t\tindex1 = 3 * i + j;\r\n\t\t\t\t\t\tvertex.fromBufferAttribute( position, index1 );\r\n\t\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t\t\tindex2 = 3 * i + ( ( j + 1 ) % 3 );\r\n\t\t\t\t\t\tvertex.fromBufferAttribute( position, index2 );\r\n\t\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\r\n\t}\r\n\r\n\tWireframeGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tWireframeGeometry.prototype.constructor = WireframeGeometry;\r\n\r\n\t/**\r\n\t * @author zz85 / https://github.com/zz85\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t * Parametric Surfaces Geometry\r\n\t * based on the brilliant article by @prideout https://prideout.net/blog/old/blog/index.html@p=44.html\r\n\t */\r\n\r\n\t// ParametricGeometry\r\n\r\n\tfunction ParametricGeometry( func, slices, stacks ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'ParametricGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tfunc: func,\r\n\t\t\tslices: slices,\r\n\t\t\tstacks: stacks\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new ParametricBufferGeometry( func, slices, stacks ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tParametricGeometry.prototype = Object.create( Geometry.prototype );\r\n\tParametricGeometry.prototype.constructor = ParametricGeometry;\r\n\r\n\t// ParametricBufferGeometry\r\n\r\n\tfunction ParametricBufferGeometry( func, slices, stacks ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'ParametricBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tfunc: func,\r\n\t\t\tslices: slices,\r\n\t\t\tstacks: stacks\r\n\t\t};\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\tvar EPS = 0.00001;\r\n\r\n\t\tvar normal = new Vector3();\r\n\r\n\t\tvar p0 = new Vector3(), p1 = new Vector3();\r\n\t\tvar pu = new Vector3(), pv = new Vector3();\r\n\r\n\t\tvar i, j;\r\n\r\n\t\tif ( func.length < 3 ) {\r\n\r\n\t\t\tconsole.error( 'THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.' );\r\n\r\n\t\t}\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tvar sliceCount = slices + 1;\r\n\r\n\t\tfor ( i = 0; i <= stacks; i ++ ) {\r\n\r\n\t\t\tvar v = i / stacks;\r\n\r\n\t\t\tfor ( j = 0; j <= slices; j ++ ) {\r\n\r\n\t\t\t\tvar u = j / slices;\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tfunc( u, v, p0 );\r\n\t\t\t\tvertices.push( p0.x, p0.y, p0.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\t// approximate tangent vectors via finite differences\r\n\r\n\t\t\t\tif ( u - EPS >= 0 ) {\r\n\r\n\t\t\t\t\tfunc( u - EPS, v, p1 );\r\n\t\t\t\t\tpu.subVectors( p0, p1 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfunc( u + EPS, v, p1 );\r\n\t\t\t\t\tpu.subVectors( p1, p0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( v - EPS >= 0 ) {\r\n\r\n\t\t\t\t\tfunc( u, v - EPS, p1 );\r\n\t\t\t\t\tpv.subVectors( p0, p1 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfunc( u, v + EPS, p1 );\r\n\t\t\t\t\tpv.subVectors( p1, p0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// cross product of tangent vectors returns surface normal\r\n\r\n\t\t\t\tnormal.crossVectors( pu, pv ).normalize();\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( u, v );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( i = 0; i < stacks; i ++ ) {\r\n\r\n\t\t\tfor ( j = 0; j < slices; j ++ ) {\r\n\r\n\t\t\t\tvar a = i * sliceCount + j;\r\n\t\t\t\tvar b = i * sliceCount + j + 1;\r\n\t\t\t\tvar c = ( i + 1 ) * sliceCount + j + 1;\r\n\t\t\t\tvar d = ( i + 1 ) * sliceCount + j;\r\n\r\n\t\t\t\t// faces one and two\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tParametricBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tParametricBufferGeometry.prototype.constructor = ParametricBufferGeometry;\r\n\r\n\t/**\r\n\t * @author clockworkgeek / https://github.com/clockworkgeek\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// PolyhedronGeometry\r\n\r\n\tfunction PolyhedronGeometry( vertices, indices, radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'PolyhedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tvertices: vertices,\r\n\t\t\tindices: indices,\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new PolyhedronBufferGeometry( vertices, indices, radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tPolyhedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tPolyhedronGeometry.prototype.constructor = PolyhedronGeometry;\r\n\r\n\t// PolyhedronBufferGeometry\r\n\r\n\tfunction PolyhedronBufferGeometry( vertices, indices, radius, detail ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'PolyhedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tvertices: vertices,\r\n\t\t\tindices: indices,\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\t\tdetail = detail || 0;\r\n\r\n\t\t// default buffer data\r\n\r\n\t\tvar vertexBuffer = [];\r\n\t\tvar uvBuffer = [];\r\n\r\n\t\t// the subdivision creates the vertex buffer data\r\n\r\n\t\tsubdivide( detail );\r\n\r\n\t\t// all vertices should lie on a conceptual sphere with a given radius\r\n\r\n\t\tapplyRadius( radius );\r\n\r\n\t\t// finally, create the uv data\r\n\r\n\t\tgenerateUVs();\r\n\r\n\t\t// build non-indexed geometry\r\n\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertexBuffer, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( vertexBuffer.slice(), 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvBuffer, 2 ) );\r\n\r\n\t\tif ( detail === 0 ) {\r\n\r\n\t\t\tthis.computeVertexNormals(); // flat normals\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.normalizeNormals(); // smooth normals\r\n\r\n\t\t}\r\n\r\n\t\t// helper functions\r\n\r\n\t\tfunction subdivide( detail ) {\r\n\r\n\t\t\tvar a = new Vector3();\r\n\t\t\tvar b = new Vector3();\r\n\t\t\tvar c = new Vector3();\r\n\r\n\t\t\t// iterate over all faces and apply a subdivison with the given detail value\r\n\r\n\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\r\n\r\n\t\t\t\t// get the vertices of the face\r\n\r\n\t\t\t\tgetVertexByIndex( indices[ i + 0 ], a );\r\n\t\t\t\tgetVertexByIndex( indices[ i + 1 ], b );\r\n\t\t\t\tgetVertexByIndex( indices[ i + 2 ], c );\r\n\r\n\t\t\t\t// perform subdivision\r\n\r\n\t\t\t\tsubdivideFace( a, b, c, detail );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction subdivideFace( a, b, c, detail ) {\r\n\r\n\t\t\tvar cols = Math.pow( 2, detail );\r\n\r\n\t\t\t// we use this multidimensional array as a data structure for creating the subdivision\r\n\r\n\t\t\tvar v = [];\r\n\r\n\t\t\tvar i, j;\r\n\r\n\t\t\t// construct all of the vertices for this subdivision\r\n\r\n\t\t\tfor ( i = 0; i <= cols; i ++ ) {\r\n\r\n\t\t\t\tv[ i ] = [];\r\n\r\n\t\t\t\tvar aj = a.clone().lerp( c, i / cols );\r\n\t\t\t\tvar bj = b.clone().lerp( c, i / cols );\r\n\r\n\t\t\t\tvar rows = cols - i;\r\n\r\n\t\t\t\tfor ( j = 0; j <= rows; j ++ ) {\r\n\r\n\t\t\t\t\tif ( j === 0 && i === cols ) {\r\n\r\n\t\t\t\t\t\tv[ i ][ j ] = aj;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tv[ i ][ j ] = aj.clone().lerp( bj, j / rows );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// construct all of the faces\r\n\r\n\t\t\tfor ( i = 0; i < cols; i ++ ) {\r\n\r\n\t\t\t\tfor ( j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\r\n\r\n\t\t\t\t\tvar k = Math.floor( j / 2 );\r\n\r\n\t\t\t\t\tif ( j % 2 === 0 ) {\r\n\r\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\r\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\r\n\t\t\t\t\t\tpushVertex( v[ i ][ k ] );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\r\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k + 1 ] );\r\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction applyRadius( radius ) {\r\n\r\n\t\t\tvar vertex = new Vector3();\r\n\r\n\t\t\t// iterate over the entire buffer and apply the radius to each vertex\r\n\r\n\t\t\tfor ( var i = 0; i < vertexBuffer.length; i += 3 ) {\r\n\r\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\r\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\r\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\r\n\r\n\t\t\t\tvertex.normalize().multiplyScalar( radius );\r\n\r\n\t\t\t\tvertexBuffer[ i + 0 ] = vertex.x;\r\n\t\t\t\tvertexBuffer[ i + 1 ] = vertex.y;\r\n\t\t\t\tvertexBuffer[ i + 2 ] = vertex.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateUVs() {\r\n\r\n\t\t\tvar vertex = new Vector3();\r\n\r\n\t\t\tfor ( var i = 0; i < vertexBuffer.length; i += 3 ) {\r\n\r\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\r\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\r\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\r\n\r\n\t\t\t\tvar u = azimuth( vertex ) / 2 / Math.PI + 0.5;\r\n\t\t\t\tvar v = inclination( vertex ) / Math.PI + 0.5;\r\n\t\t\t\tuvBuffer.push( u, 1 - v );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcorrectUVs();\r\n\r\n\t\t\tcorrectSeam();\r\n\r\n\t\t}\r\n\r\n\t\tfunction correctSeam() {\r\n\r\n\t\t\t// handle case when face straddles the seam, see #3269\r\n\r\n\t\t\tfor ( var i = 0; i < uvBuffer.length; i += 6 ) {\r\n\r\n\t\t\t\t// uv data of a single face\r\n\r\n\t\t\t\tvar x0 = uvBuffer[ i + 0 ];\r\n\t\t\t\tvar x1 = uvBuffer[ i + 2 ];\r\n\t\t\t\tvar x2 = uvBuffer[ i + 4 ];\r\n\r\n\t\t\t\tvar max = Math.max( x0, x1, x2 );\r\n\t\t\t\tvar min = Math.min( x0, x1, x2 );\r\n\r\n\t\t\t\t// 0.9 is somewhat arbitrary\r\n\r\n\t\t\t\tif ( max > 0.9 && min < 0.1 ) {\r\n\r\n\t\t\t\t\tif ( x0 < 0.2 ) { uvBuffer[ i + 0 ] += 1; }\r\n\t\t\t\t\tif ( x1 < 0.2 ) { uvBuffer[ i + 2 ] += 1; }\r\n\t\t\t\t\tif ( x2 < 0.2 ) { uvBuffer[ i + 4 ] += 1; }\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction pushVertex( vertex ) {\r\n\r\n\t\t\tvertexBuffer.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getVertexByIndex( index, vertex ) {\r\n\r\n\t\t\tvar stride = index * 3;\r\n\r\n\t\t\tvertex.x = vertices[ stride + 0 ];\r\n\t\t\tvertex.y = vertices[ stride + 1 ];\r\n\t\t\tvertex.z = vertices[ stride + 2 ];\r\n\r\n\t\t}\r\n\r\n\t\tfunction correctUVs() {\r\n\r\n\t\t\tvar a = new Vector3();\r\n\t\t\tvar b = new Vector3();\r\n\t\t\tvar c = new Vector3();\r\n\r\n\t\t\tvar centroid = new Vector3();\r\n\r\n\t\t\tvar uvA = new Vector2();\r\n\t\t\tvar uvB = new Vector2();\r\n\t\t\tvar uvC = new Vector2();\r\n\r\n\t\t\tfor ( var i = 0, j = 0; i < vertexBuffer.length; i += 9, j += 6 ) {\r\n\r\n\t\t\t\ta.set( vertexBuffer[ i + 0 ], vertexBuffer[ i + 1 ], vertexBuffer[ i + 2 ] );\r\n\t\t\t\tb.set( vertexBuffer[ i + 3 ], vertexBuffer[ i + 4 ], vertexBuffer[ i + 5 ] );\r\n\t\t\t\tc.set( vertexBuffer[ i + 6 ], vertexBuffer[ i + 7 ], vertexBuffer[ i + 8 ] );\r\n\r\n\t\t\t\tuvA.set( uvBuffer[ j + 0 ], uvBuffer[ j + 1 ] );\r\n\t\t\t\tuvB.set( uvBuffer[ j + 2 ], uvBuffer[ j + 3 ] );\r\n\t\t\t\tuvC.set( uvBuffer[ j + 4 ], uvBuffer[ j + 5 ] );\r\n\r\n\t\t\t\tcentroid.copy( a ).add( b ).add( c ).divideScalar( 3 );\r\n\r\n\t\t\t\tvar azi = azimuth( centroid );\r\n\r\n\t\t\t\tcorrectUV( uvA, j + 0, a, azi );\r\n\t\t\t\tcorrectUV( uvB, j + 2, b, azi );\r\n\t\t\t\tcorrectUV( uvC, j + 4, c, azi );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction correctUV( uv, stride, vector, azimuth ) {\r\n\r\n\t\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) {\r\n\r\n\t\t\t\tuvBuffer[ stride ] = uv.x - 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) {\r\n\r\n\t\t\t\tuvBuffer[ stride ] = azimuth / 2 / Math.PI + 0.5;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Angle around the Y axis, counter-clockwise when looking from above.\r\n\r\n\t\tfunction azimuth( vector ) {\r\n\r\n\t\t\treturn Math.atan2( vector.z, - vector.x );\r\n\r\n\t\t}\r\n\r\n\r\n\t\t// Angle above the XZ plane.\r\n\r\n\t\tfunction inclination( vector ) {\r\n\r\n\t\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tPolyhedronBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tPolyhedronBufferGeometry.prototype.constructor = PolyhedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// TetrahedronGeometry\r\n\r\n\tfunction TetrahedronGeometry( radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TetrahedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new TetrahedronBufferGeometry( radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTetrahedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTetrahedronGeometry.prototype.constructor = TetrahedronGeometry;\r\n\r\n\t// TetrahedronBufferGeometry\r\n\r\n\tfunction TetrahedronBufferGeometry( radius, detail ) {\r\n\r\n\t\tvar vertices = [\r\n\t\t\t1, 1, 1, \t- 1, - 1, 1, \t- 1, 1, - 1, \t1, - 1, - 1\r\n\t\t];\r\n\r\n\t\tvar indices = [\r\n\t\t\t2, 1, 0, \t0, 3, 2,\t1, 3, 0,\t2, 3, 1\r\n\t\t];\r\n\r\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\t\tthis.type = 'TetrahedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tTetrahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\r\n\tTetrahedronBufferGeometry.prototype.constructor = TetrahedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// OctahedronGeometry\r\n\r\n\tfunction OctahedronGeometry( radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'OctahedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new OctahedronBufferGeometry( radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tOctahedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tOctahedronGeometry.prototype.constructor = OctahedronGeometry;\r\n\r\n\t// OctahedronBufferGeometry\r\n\r\n\tfunction OctahedronBufferGeometry( radius, detail ) {\r\n\r\n\t\tvar vertices = [\r\n\t\t\t1, 0, 0, \t- 1, 0, 0,\t0, 1, 0,\r\n\t\t\t0, - 1, 0, \t0, 0, 1,\t0, 0, - 1\r\n\t\t];\r\n\r\n\t\tvar indices = [\r\n\t\t\t0, 2, 4,\t0, 4, 3,\t0, 3, 5,\r\n\t\t\t0, 5, 2,\t1, 2, 5,\t1, 5, 3,\r\n\t\t\t1, 3, 4,\t1, 4, 2\r\n\t\t];\r\n\r\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\t\tthis.type = 'OctahedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tOctahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\r\n\tOctahedronBufferGeometry.prototype.constructor = OctahedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author timothypratley / https://github.com/timothypratley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// IcosahedronGeometry\r\n\r\n\tfunction IcosahedronGeometry( radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'IcosahedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new IcosahedronBufferGeometry( radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tIcosahedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tIcosahedronGeometry.prototype.constructor = IcosahedronGeometry;\r\n\r\n\t// IcosahedronBufferGeometry\r\n\r\n\tfunction IcosahedronBufferGeometry( radius, detail ) {\r\n\r\n\t\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\r\n\t\tvar vertices = [\r\n\t\t\t- 1, t, 0, \t1, t, 0, \t- 1, - t, 0, \t1, - t, 0,\r\n\t\t\t 0, - 1, t, \t0, 1, t,\t0, - 1, - t, \t0, 1, - t,\r\n\t\t\t t, 0, - 1, \tt, 0, 1, \t- t, 0, - 1, \t- t, 0, 1\r\n\t\t];\r\n\r\n\t\tvar indices = [\r\n\t\t\t 0, 11, 5, \t0, 5, 1, \t0, 1, 7, \t0, 7, 10, \t0, 10, 11,\r\n\t\t\t 1, 5, 9, \t5, 11, 4,\t11, 10, 2,\t10, 7, 6,\t7, 1, 8,\r\n\t\t\t 3, 9, 4, \t3, 4, 2,\t3, 2, 6,\t3, 6, 8,\t3, 8, 9,\r\n\t\t\t 4, 9, 5, \t2, 4, 11,\t6, 2, 10,\t8, 6, 7,\t9, 8, 1\r\n\t\t];\r\n\r\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\t\tthis.type = 'IcosahedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tIcosahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\r\n\tIcosahedronBufferGeometry.prototype.constructor = IcosahedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author Abe Pazos / https://hamoid.com\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// DodecahedronGeometry\r\n\r\n\tfunction DodecahedronGeometry( radius, detail ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'DodecahedronGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new DodecahedronBufferGeometry( radius, detail ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tDodecahedronGeometry.prototype = Object.create( Geometry.prototype );\r\n\tDodecahedronGeometry.prototype.constructor = DodecahedronGeometry;\r\n\r\n\t// DodecahedronBufferGeometry\r\n\r\n\tfunction DodecahedronBufferGeometry( radius, detail ) {\r\n\r\n\t\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\t\tvar r = 1 / t;\r\n\r\n\t\tvar vertices = [\r\n\r\n\t\t\t// (1, 1, 1)\r\n\t\t\t- 1, - 1, - 1,\t- 1, - 1, 1,\r\n\t\t\t- 1, 1, - 1, - 1, 1, 1,\r\n\t\t\t1, - 1, - 1, 1, - 1, 1,\r\n\t\t\t1, 1, - 1, 1, 1, 1,\r\n\r\n\t\t\t// (0, 1/, )\r\n\t\t\t 0, - r, - t, 0, - r, t,\r\n\t\t\t 0, r, - t, 0, r, t,\r\n\r\n\t\t\t// (1/, , 0)\r\n\t\t\t- r, - t, 0, - r, t, 0,\r\n\t\t\t r, - t, 0, r, t, 0,\r\n\r\n\t\t\t// (, 0, 1/)\r\n\t\t\t- t, 0, - r, t, 0, - r,\r\n\t\t\t- t, 0, r, t, 0, r\r\n\t\t];\r\n\r\n\t\tvar indices = [\r\n\t\t\t3, 11, 7, \t3, 7, 15, \t3, 15, 13,\r\n\t\t\t7, 19, 17, \t7, 17, 6, \t7, 6, 15,\r\n\t\t\t17, 4, 8, \t17, 8, 10, \t17, 10, 6,\r\n\t\t\t8, 0, 16, \t8, 16, 2, \t8, 2, 10,\r\n\t\t\t0, 12, 1, \t0, 1, 18, \t0, 18, 16,\r\n\t\t\t6, 10, 2, \t6, 2, 13, \t6, 13, 15,\r\n\t\t\t2, 16, 18, \t2, 18, 3, \t2, 3, 13,\r\n\t\t\t18, 1, 9, \t18, 9, 11, \t18, 11, 3,\r\n\t\t\t4, 14, 12, \t4, 12, 0, \t4, 0, 8,\r\n\t\t\t11, 9, 5, \t11, 5, 19, \t11, 19, 7,\r\n\t\t\t19, 5, 14, \t19, 14, 4, \t19, 4, 17,\r\n\t\t\t1, 12, 14, \t1, 14, 5, \t1, 5, 9\r\n\t\t];\r\n\r\n\t\tPolyhedronBufferGeometry.call( this, vertices, indices, radius, detail );\r\n\r\n\t\tthis.type = 'DodecahedronBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tdetail: detail\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tDodecahedronBufferGeometry.prototype = Object.create( PolyhedronBufferGeometry.prototype );\r\n\tDodecahedronBufferGeometry.prototype.constructor = DodecahedronBufferGeometry;\r\n\r\n\t/**\r\n\t * @author oosmoxiecode / https://github.com/oosmoxiecode\r\n\t * @author WestLangley / https://github.com/WestLangley\r\n\t * @author zz85 / https://github.com/zz85\r\n\t * @author miningold / https://github.com/miningold\r\n\t * @author jonobr1 / https://github.com/jonobr1\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t */\r\n\r\n\t// TubeGeometry\r\n\r\n\tfunction TubeGeometry( path, tubularSegments, radius, radialSegments, closed, taper ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TubeGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tpath: path,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tradius: radius,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\tclosed: closed\r\n\t\t};\r\n\r\n\t\tif ( taper !== undefined ) { console.warn( 'THREE.TubeGeometry: taper has been removed.' ); }\r\n\r\n\t\tvar bufferGeometry = new TubeBufferGeometry( path, tubularSegments, radius, radialSegments, closed );\r\n\r\n\t\t// expose internals\r\n\r\n\t\tthis.tangents = bufferGeometry.tangents;\r\n\t\tthis.normals = bufferGeometry.normals;\r\n\t\tthis.binormals = bufferGeometry.binormals;\r\n\r\n\t\t// create geometry\r\n\r\n\t\tthis.fromBufferGeometry( bufferGeometry );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTubeGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTubeGeometry.prototype.constructor = TubeGeometry;\r\n\r\n\t// TubeBufferGeometry\r\n\r\n\tfunction TubeBufferGeometry( path, tubularSegments, radius, radialSegments, closed ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'TubeBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tpath: path,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tradius: radius,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\tclosed: closed\r\n\t\t};\r\n\r\n\t\ttubularSegments = tubularSegments || 64;\r\n\t\tradius = radius || 1;\r\n\t\tradialSegments = radialSegments || 8;\r\n\t\tclosed = closed || false;\r\n\r\n\t\tvar frames = path.computeFrenetFrames( tubularSegments, closed );\r\n\r\n\t\t// expose internals\r\n\r\n\t\tthis.tangents = frames.tangents;\r\n\t\tthis.normals = frames.normals;\r\n\t\tthis.binormals = frames.binormals;\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar normal = new Vector3();\r\n\t\tvar uv = new Vector2();\r\n\t\tvar P = new Vector3();\r\n\r\n\t\tvar i, j;\r\n\r\n\t\t// buffer\r\n\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\t\tvar indices = [];\r\n\r\n\t\t// create buffer data\r\n\r\n\t\tgenerateBufferData();\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\t// functions\r\n\r\n\t\tfunction generateBufferData() {\r\n\r\n\t\t\tfor ( i = 0; i < tubularSegments; i ++ ) {\r\n\r\n\t\t\t\tgenerateSegment( i );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// if the geometry is not closed, generate the last row of vertices and normals\r\n\t\t\t// at the regular position on the given path\r\n\t\t\t//\r\n\t\t\t// if the geometry is closed, duplicate the first row of vertices and normals (uvs will differ)\r\n\r\n\t\t\tgenerateSegment( ( closed === false ) ? tubularSegments : 0 );\r\n\r\n\t\t\t// uvs are generated in a separate function.\r\n\t\t\t// this makes it easy compute correct values for closed geometries\r\n\r\n\t\t\tgenerateUVs();\r\n\r\n\t\t\t// finally create faces\r\n\r\n\t\t\tgenerateIndices();\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateSegment( i ) {\r\n\r\n\t\t\t// we use getPointAt to sample evenly distributed points from the given path\r\n\r\n\t\t\tP = path.getPointAt( i / tubularSegments, P );\r\n\r\n\t\t\t// retrieve corresponding normal and binormal\r\n\r\n\t\t\tvar N = frames.normals[ i ];\r\n\t\t\tvar B = frames.binormals[ i ];\r\n\r\n\t\t\t// generate normals and vertices for the current segment\r\n\r\n\t\t\tfor ( j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\r\n\t\t\t\tvar sin = Math.sin( v );\r\n\t\t\t\tvar cos = - Math.cos( v );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormal.x = ( cos * N.x + sin * B.x );\r\n\t\t\t\tnormal.y = ( cos * N.y + sin * B.y );\r\n\t\t\t\tnormal.z = ( cos * N.z + sin * B.z );\r\n\t\t\t\tnormal.normalize();\r\n\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = P.x + radius * normal.x;\r\n\t\t\t\tvertex.y = P.y + radius * normal.y;\r\n\t\t\t\tvertex.z = P.z + radius * normal.z;\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateIndices() {\r\n\r\n\t\t\tfor ( j = 1; j <= tubularSegments; j ++ ) {\r\n\r\n\t\t\t\tfor ( i = 1; i <= radialSegments; i ++ ) {\r\n\r\n\t\t\t\t\tvar a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\r\n\t\t\t\t\tvar b = ( radialSegments + 1 ) * j + ( i - 1 );\r\n\t\t\t\t\tvar c = ( radialSegments + 1 ) * j + i;\r\n\t\t\t\t\tvar d = ( radialSegments + 1 ) * ( j - 1 ) + i;\r\n\r\n\t\t\t\t\t// faces\r\n\r\n\t\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateUVs() {\r\n\r\n\t\t\tfor ( i = 0; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\t\tfor ( j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\t\t\t\tuv.x = i / tubularSegments;\r\n\t\t\t\t\tuv.y = j / radialSegments;\r\n\r\n\t\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tTubeBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tTubeBufferGeometry.prototype.constructor = TubeBufferGeometry;\r\n\r\n\tTubeBufferGeometry.prototype.toJSON = function () {\r\n\r\n\t\tvar data = BufferGeometry.prototype.toJSON.call( this );\r\n\r\n\t\tdata.path = this.parameters.path.toJSON();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author oosmoxiecode\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t * based on http://www.blackpawn.com/texts/pqtorus/\r\n\t */\r\n\r\n\t// TorusKnotGeometry\r\n\r\n\tfunction TorusKnotGeometry( radius, tube, tubularSegments, radialSegments, p, q, heightScale ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TorusKnotGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\tp: p,\r\n\t\t\tq: q\r\n\t\t};\r\n\r\n\t\tif ( heightScale !== undefined ) { console.warn( 'THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.' ); }\r\n\r\n\t\tthis.fromBufferGeometry( new TorusKnotBufferGeometry( radius, tube, tubularSegments, radialSegments, p, q ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTorusKnotGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTorusKnotGeometry.prototype.constructor = TorusKnotGeometry;\r\n\r\n\t// TorusKnotBufferGeometry\r\n\r\n\tfunction TorusKnotBufferGeometry( radius, tube, tubularSegments, radialSegments, p, q ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'TorusKnotBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\tp: p,\r\n\t\t\tq: q\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\t\ttube = tube || 0.4;\r\n\t\ttubularSegments = Math.floor( tubularSegments ) || 64;\r\n\t\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\t\tp = p || 2;\r\n\t\tq = q || 3;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar i, j;\r\n\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar normal = new Vector3();\r\n\r\n\t\tvar P1 = new Vector3();\r\n\t\tvar P2 = new Vector3();\r\n\r\n\t\tvar B = new Vector3();\r\n\t\tvar T = new Vector3();\r\n\t\tvar N = new Vector3();\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( i = 0; i <= tubularSegments; ++ i ) {\r\n\r\n\t\t\t// the radian \"u\" is used to calculate the position on the torus curve of the current tubular segement\r\n\r\n\t\t\tvar u = i / tubularSegments * p * Math.PI * 2;\r\n\r\n\t\t\t// now we calculate two points. P1 is our current position on the curve, P2 is a little farther ahead.\r\n\t\t\t// these points are used to create a special \"coordinate space\", which is necessary to calculate the correct vertex positions\r\n\r\n\t\t\tcalculatePositionOnCurve( u, p, q, radius, P1 );\r\n\t\t\tcalculatePositionOnCurve( u + 0.01, p, q, radius, P2 );\r\n\r\n\t\t\t// calculate orthonormal basis\r\n\r\n\t\t\tT.subVectors( P2, P1 );\r\n\t\t\tN.addVectors( P2, P1 );\r\n\t\t\tB.crossVectors( T, N );\r\n\t\t\tN.crossVectors( B, T );\r\n\r\n\t\t\t// normalize B, N. T can be ignored, we don't use it\r\n\r\n\t\t\tB.normalize();\r\n\t\t\tN.normalize();\r\n\r\n\t\t\tfor ( j = 0; j <= radialSegments; ++ j ) {\r\n\r\n\t\t\t\t// now calculate the vertices. they are nothing more than an extrusion of the torus curve.\r\n\t\t\t\t// because we extrude a shape in the xy-plane, there is no need to calculate a z-value.\r\n\r\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\t\t\t\tvar cx = - tube * Math.cos( v );\r\n\t\t\t\tvar cy = tube * Math.sin( v );\r\n\r\n\t\t\t\t// now calculate the final vertex position.\r\n\t\t\t\t// first we orient the extrusion with our basis vectos, then we add it to the current position on the curve\r\n\r\n\t\t\t\tvertex.x = P1.x + ( cx * N.x + cy * B.x );\r\n\t\t\t\tvertex.y = P1.y + ( cx * N.y + cy * B.y );\r\n\t\t\t\tvertex.z = P1.z + ( cx * N.z + cy * B.z );\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal (P1 is always the center/origin of the extrusion, thus we can use it to calculate the normal)\r\n\r\n\t\t\t\tnormal.subVectors( vertex, P1 ).normalize();\r\n\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( i / tubularSegments );\r\n\t\t\t\tuvs.push( j / radialSegments );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( j = 1; j <= tubularSegments; j ++ ) {\r\n\r\n\t\t\tfor ( i = 1; i <= radialSegments; i ++ ) {\r\n\r\n\t\t\t\t// indices\r\n\r\n\t\t\t\tvar a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\r\n\t\t\t\tvar b = ( radialSegments + 1 ) * j + ( i - 1 );\r\n\t\t\t\tvar c = ( radialSegments + 1 ) * j + i;\r\n\t\t\t\tvar d = ( radialSegments + 1 ) * ( j - 1 ) + i;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\t// this function calculates the current position on the torus curve\r\n\r\n\t\tfunction calculatePositionOnCurve( u, p, q, radius, position ) {\r\n\r\n\t\t\tvar cu = Math.cos( u );\r\n\t\t\tvar su = Math.sin( u );\r\n\t\t\tvar quOverP = q / p * u;\r\n\t\t\tvar cs = Math.cos( quOverP );\r\n\r\n\t\t\tposition.x = radius * ( 2 + cs ) * 0.5 * cu;\r\n\t\t\tposition.y = radius * ( 2 + cs ) * su * 0.5;\r\n\t\t\tposition.z = radius * Math.sin( quOverP ) * 0.5;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tTorusKnotBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tTorusKnotBufferGeometry.prototype.constructor = TorusKnotBufferGeometry;\r\n\r\n\t/**\r\n\t * @author oosmoxiecode\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// TorusGeometry\r\n\r\n\tfunction TorusGeometry( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TorusGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tarc: arc\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new TorusBufferGeometry( radius, tube, radialSegments, tubularSegments, arc ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTorusGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTorusGeometry.prototype.constructor = TorusGeometry;\r\n\r\n\t// TorusBufferGeometry\r\n\r\n\tfunction TorusBufferGeometry( radius, tube, radialSegments, tubularSegments, arc ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'TorusBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\ttube: tube,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\ttubularSegments: tubularSegments,\r\n\t\t\tarc: arc\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\t\ttube = tube || 0.4;\r\n\t\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\t\ttubularSegments = Math.floor( tubularSegments ) || 6;\r\n\t\tarc = arc || Math.PI * 2;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar center = new Vector3();\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar normal = new Vector3();\r\n\r\n\t\tvar j, i;\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( j = 0; j <= radialSegments; j ++ ) {\r\n\r\n\t\t\tfor ( i = 0; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\t\tvar u = i / tubularSegments * arc;\r\n\t\t\t\tvar v = j / radialSegments * Math.PI * 2;\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\r\n\t\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\r\n\t\t\t\tvertex.z = tube * Math.sin( v );\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tcenter.x = radius * Math.cos( u );\r\n\t\t\t\tcenter.y = radius * Math.sin( u );\r\n\t\t\t\tnormal.subVectors( vertex, center ).normalize();\r\n\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( i / tubularSegments );\r\n\t\t\t\tuvs.push( j / radialSegments );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// generate indices\r\n\r\n\t\tfor ( j = 1; j <= radialSegments; j ++ ) {\r\n\r\n\t\t\tfor ( i = 1; i <= tubularSegments; i ++ ) {\r\n\r\n\t\t\t\t// indices\r\n\r\n\t\t\t\tvar a = ( tubularSegments + 1 ) * j + i - 1;\r\n\t\t\t\tvar b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\r\n\t\t\t\tvar c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\r\n\t\t\t\tvar d = ( tubularSegments + 1 ) * j + i;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tTorusBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tTorusBufferGeometry.prototype.constructor = TorusBufferGeometry;\r\n\r\n\t/**\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t * Port from https://github.com/mapbox/earcut (v2.1.5)\r\n\t */\r\n\r\n\tvar Earcut = {\r\n\r\n\t\ttriangulate: function ( data, holeIndices, dim ) {\r\n\r\n\t\t\tdim = dim || 2;\r\n\r\n\t\t\tvar hasHoles = holeIndices && holeIndices.length,\r\n\t\t\t\touterLen = hasHoles ? holeIndices[ 0 ] * dim : data.length,\r\n\t\t\t\touterNode = linkedList( data, 0, outerLen, dim, true ),\r\n\t\t\t\ttriangles = [];\r\n\r\n\t\t\tif ( ! outerNode || outerNode.next === outerNode.prev ) { return triangles; }\r\n\r\n\t\t\tvar minX, minY, maxX, maxY, x, y, invSize;\r\n\r\n\t\t\tif ( hasHoles ) { outerNode = eliminateHoles( data, holeIndices, outerNode, dim ); }\r\n\r\n\t\t\t// if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\r\n\t\t\tif ( data.length > 80 * dim ) {\r\n\r\n\t\t\t\tminX = maxX = data[ 0 ];\r\n\t\t\t\tminY = maxY = data[ 1 ];\r\n\r\n\t\t\t\tfor ( var i = dim; i < outerLen; i += dim ) {\r\n\r\n\t\t\t\t\tx = data[ i ];\r\n\t\t\t\t\ty = data[ i + 1 ];\r\n\t\t\t\t\tif ( x < minX ) { minX = x; }\r\n\t\t\t\t\tif ( y < minY ) { minY = y; }\r\n\t\t\t\t\tif ( x > maxX ) { maxX = x; }\r\n\t\t\t\t\tif ( y > maxY ) { maxY = y; }\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// minX, minY and invSize are later used to transform coords into integers for z-order calculation\r\n\t\t\t\tinvSize = Math.max( maxX - minX, maxY - minY );\r\n\t\t\t\tinvSize = invSize !== 0 ? 1 / invSize : 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tearcutLinked( outerNode, triangles, dim, minX, minY, invSize );\r\n\r\n\t\t\treturn triangles;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t// create a circular doubly linked list from polygon points in the specified winding order\r\n\tfunction linkedList( data, start, end, dim, clockwise ) {\r\n\r\n\t\tvar i, last;\r\n\r\n\t\tif ( clockwise === ( signedArea( data, start, end, dim ) > 0 ) ) {\r\n\r\n\t\t\tfor ( i = start; i < end; i += dim ) { last = insertNode( i, data[ i ], data[ i + 1 ], last ); }\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( i = end - dim; i >= start; i -= dim ) { last = insertNode( i, data[ i ], data[ i + 1 ], last ); }\r\n\r\n\t\t}\r\n\r\n\t\tif ( last && equals( last, last.next ) ) {\r\n\r\n\t\t\tremoveNode( last );\r\n\t\t\tlast = last.next;\r\n\r\n\t\t}\r\n\r\n\t\treturn last;\r\n\r\n\t}\r\n\r\n\t// eliminate colinear or duplicate points\r\n\tfunction filterPoints( start, end ) {\r\n\r\n\t\tif ( ! start ) { return start; }\r\n\t\tif ( ! end ) { end = start; }\r\n\r\n\t\tvar p = start,\r\n\t\t\tagain;\r\n\t\tdo {\r\n\r\n\t\t\tagain = false;\r\n\r\n\t\t\tif ( ! p.steiner && ( equals( p, p.next ) || area( p.prev, p, p.next ) === 0 ) ) {\r\n\r\n\t\t\t\tremoveNode( p );\r\n\t\t\t\tp = end = p.prev;\r\n\t\t\t\tif ( p === p.next ) { break; }\r\n\t\t\t\tagain = true;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tp = p.next;\r\n\r\n\t\t\t}\r\n\r\n\t\t} while ( again || p !== end );\r\n\r\n\t\treturn end;\r\n\r\n\t}\r\n\r\n\t// main ear slicing loop which triangulates a polygon (given as a linked list)\r\n\tfunction earcutLinked( ear, triangles, dim, minX, minY, invSize, pass ) {\r\n\r\n\t\tif ( ! ear ) { return; }\r\n\r\n\t\t// interlink polygon nodes in z-order\r\n\t\tif ( ! pass && invSize ) { indexCurve( ear, minX, minY, invSize ); }\r\n\r\n\t\tvar stop = ear,\r\n\t\t\tprev, next;\r\n\r\n\t\t// iterate through ears, slicing them one by one\r\n\t\twhile ( ear.prev !== ear.next ) {\r\n\r\n\t\t\tprev = ear.prev;\r\n\t\t\tnext = ear.next;\r\n\r\n\t\t\tif ( invSize ? isEarHashed( ear, minX, minY, invSize ) : isEar( ear ) ) {\r\n\r\n\t\t\t\t// cut off the triangle\r\n\t\t\t\ttriangles.push( prev.i / dim );\r\n\t\t\t\ttriangles.push( ear.i / dim );\r\n\t\t\t\ttriangles.push( next.i / dim );\r\n\r\n\t\t\t\tremoveNode( ear );\r\n\r\n\t\t\t\t// skipping the next vertex leads to less sliver triangles\r\n\t\t\t\tear = next.next;\r\n\t\t\t\tstop = next.next;\r\n\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tear = next;\r\n\r\n\t\t\t// if we looped through the whole remaining polygon and can't find any more ears\r\n\t\t\tif ( ear === stop ) {\r\n\r\n\t\t\t\t// try filtering points and slicing again\r\n\t\t\t\tif ( ! pass ) {\r\n\r\n\t\t\t\t\tearcutLinked( filterPoints( ear ), triangles, dim, minX, minY, invSize, 1 );\r\n\r\n\t\t\t\t\t// if this didn't work, try curing all small self-intersections locally\r\n\r\n\t\t\t\t} else if ( pass === 1 ) {\r\n\r\n\t\t\t\t\tear = cureLocalIntersections( ear, triangles, dim );\r\n\t\t\t\t\tearcutLinked( ear, triangles, dim, minX, minY, invSize, 2 );\r\n\r\n\t\t\t\t\t// as a last resort, try splitting the remaining polygon into two\r\n\r\n\t\t\t\t} else if ( pass === 2 ) {\r\n\r\n\t\t\t\t\tsplitEarcut( ear, triangles, dim, minX, minY, invSize );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// check whether a polygon node forms a valid ear with adjacent nodes\r\n\tfunction isEar( ear ) {\r\n\r\n\t\tvar a = ear.prev,\r\n\t\t\tb = ear,\r\n\t\t\tc = ear.next;\r\n\r\n\t\tif ( area( a, b, c ) >= 0 ) { return false; } // reflex, can't be an ear\r\n\r\n\t\t// now make sure we don't have other points inside the potential ear\r\n\t\tvar p = ear.next.next;\r\n\r\n\t\twhile ( p !== ear.prev ) {\r\n\r\n\t\t\tif ( pointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\r\n\t\t\t\tarea( p.prev, p, p.next ) >= 0 ) { return false; }\r\n\t\t\tp = p.next;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\tfunction isEarHashed( ear, minX, minY, invSize ) {\r\n\r\n\t\tvar a = ear.prev,\r\n\t\t\tb = ear,\r\n\t\t\tc = ear.next;\r\n\r\n\t\tif ( area( a, b, c ) >= 0 ) { return false; } // reflex, can't be an ear\r\n\r\n\t\t// triangle bbox; min & max are calculated like this for speed\r\n\t\tvar minTX = a.x < b.x ? ( a.x < c.x ? a.x : c.x ) : ( b.x < c.x ? b.x : c.x ),\r\n\t\t\tminTY = a.y < b.y ? ( a.y < c.y ? a.y : c.y ) : ( b.y < c.y ? b.y : c.y ),\r\n\t\t\tmaxTX = a.x > b.x ? ( a.x > c.x ? a.x : c.x ) : ( b.x > c.x ? b.x : c.x ),\r\n\t\t\tmaxTY = a.y > b.y ? ( a.y > c.y ? a.y : c.y ) : ( b.y > c.y ? b.y : c.y );\r\n\r\n\t\t// z-order range for the current triangle bbox;\r\n\t\tvar minZ = zOrder( minTX, minTY, minX, minY, invSize ),\r\n\t\t\tmaxZ = zOrder( maxTX, maxTY, minX, minY, invSize );\r\n\r\n\t\tvar p = ear.prevZ,\r\n\t\t\tn = ear.nextZ;\r\n\r\n\t\t// look for points inside the triangle in both directions\r\n\t\twhile ( p && p.z >= minZ && n && n.z <= maxZ ) {\r\n\r\n\t\t\tif ( p !== ear.prev && p !== ear.next &&\r\n\t\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\r\n\t\t\t\tarea( p.prev, p, p.next ) >= 0 ) { return false; }\r\n\t\t\tp = p.prevZ;\r\n\r\n\t\t\tif ( n !== ear.prev && n !== ear.next &&\r\n\t\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y ) &&\r\n\t\t\t\tarea( n.prev, n, n.next ) >= 0 ) { return false; }\r\n\t\t\tn = n.nextZ;\r\n\r\n\t\t}\r\n\r\n\t\t// look for remaining points in decreasing z-order\r\n\t\twhile ( p && p.z >= minZ ) {\r\n\r\n\t\t\tif ( p !== ear.prev && p !== ear.next &&\r\n\t\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y ) &&\r\n\t\t\t\tarea( p.prev, p, p.next ) >= 0 ) { return false; }\r\n\t\t\tp = p.prevZ;\r\n\r\n\t\t}\r\n\r\n\t\t// look for remaining points in increasing z-order\r\n\t\twhile ( n && n.z <= maxZ ) {\r\n\r\n\t\t\tif ( n !== ear.prev && n !== ear.next &&\r\n\t\t\t\tpointInTriangle( a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y ) &&\r\n\t\t\t\tarea( n.prev, n, n.next ) >= 0 ) { return false; }\r\n\t\t\tn = n.nextZ;\r\n\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\t// go through all polygon nodes and cure small local self-intersections\r\n\tfunction cureLocalIntersections( start, triangles, dim ) {\r\n\r\n\t\tvar p = start;\r\n\t\tdo {\r\n\r\n\t\t\tvar a = p.prev,\r\n\t\t\t\tb = p.next.next;\r\n\r\n\t\t\tif ( ! equals( a, b ) && intersects( a, p, p.next, b ) && locallyInside( a, b ) && locallyInside( b, a ) ) {\r\n\r\n\t\t\t\ttriangles.push( a.i / dim );\r\n\t\t\t\ttriangles.push( p.i / dim );\r\n\t\t\t\ttriangles.push( b.i / dim );\r\n\r\n\t\t\t\t// remove two nodes involved\r\n\t\t\t\tremoveNode( p );\r\n\t\t\t\tremoveNode( p.next );\r\n\r\n\t\t\t\tp = start = b;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== start );\r\n\r\n\t\treturn p;\r\n\r\n\t}\r\n\r\n\t// try splitting polygon into two and triangulate them independently\r\n\tfunction splitEarcut( start, triangles, dim, minX, minY, invSize ) {\r\n\r\n\t\t// look for a valid diagonal that divides the polygon into two\r\n\t\tvar a = start;\r\n\t\tdo {\r\n\r\n\t\t\tvar b = a.next.next;\r\n\t\t\twhile ( b !== a.prev ) {\r\n\r\n\t\t\t\tif ( a.i !== b.i && isValidDiagonal( a, b ) ) {\r\n\r\n\t\t\t\t\t// split the polygon in two by the diagonal\r\n\t\t\t\t\tvar c = splitPolygon( a, b );\r\n\r\n\t\t\t\t\t// filter colinear points around the cuts\r\n\t\t\t\t\ta = filterPoints( a, a.next );\r\n\t\t\t\t\tc = filterPoints( c, c.next );\r\n\r\n\t\t\t\t\t// run earcut on each half\r\n\t\t\t\t\tearcutLinked( a, triangles, dim, minX, minY, invSize );\r\n\t\t\t\t\tearcutLinked( c, triangles, dim, minX, minY, invSize );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tb = b.next;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ta = a.next;\r\n\r\n\t\t} while ( a !== start );\r\n\r\n\t}\r\n\r\n\t// link every hole into the outer loop, producing a single-ring polygon without holes\r\n\tfunction eliminateHoles( data, holeIndices, outerNode, dim ) {\r\n\r\n\t\tvar queue = [],\r\n\t\t\ti, len, start, end, list;\r\n\r\n\t\tfor ( i = 0, len = holeIndices.length; i < len; i ++ ) {\r\n\r\n\t\t\tstart = holeIndices[ i ] * dim;\r\n\t\t\tend = i < len - 1 ? holeIndices[ i + 1 ] * dim : data.length;\r\n\t\t\tlist = linkedList( data, start, end, dim, false );\r\n\t\t\tif ( list === list.next ) { list.steiner = true; }\r\n\t\t\tqueue.push( getLeftmost( list ) );\r\n\r\n\t\t}\r\n\r\n\t\tqueue.sort( compareX );\r\n\r\n\t\t// process holes from left to right\r\n\t\tfor ( i = 0; i < queue.length; i ++ ) {\r\n\r\n\t\t\teliminateHole( queue[ i ], outerNode );\r\n\t\t\touterNode = filterPoints( outerNode, outerNode.next );\r\n\r\n\t\t}\r\n\r\n\t\treturn outerNode;\r\n\r\n\t}\r\n\r\n\tfunction compareX( a, b ) {\r\n\r\n\t\treturn a.x - b.x;\r\n\r\n\t}\r\n\r\n\t// find a bridge between vertices that connects hole with an outer ring and and link it\r\n\tfunction eliminateHole( hole, outerNode ) {\r\n\r\n\t\touterNode = findHoleBridge( hole, outerNode );\r\n\t\tif ( outerNode ) {\r\n\r\n\t\t\tvar b = splitPolygon( outerNode, hole );\r\n\t\t\tfilterPoints( b, b.next );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// David Eberly's algorithm for finding a bridge between hole and outer polygon\r\n\tfunction findHoleBridge( hole, outerNode ) {\r\n\r\n\t\tvar p = outerNode,\r\n\t\t\thx = hole.x,\r\n\t\t\thy = hole.y,\r\n\t\t\tqx = - Infinity,\r\n\t\t\tm;\r\n\r\n\t\t// find a segment intersected by a ray from the hole's leftmost point to the left;\r\n\t\t// segment's endpoint with lesser x will be potential connection point\r\n\t\tdo {\r\n\r\n\t\t\tif ( hy <= p.y && hy >= p.next.y && p.next.y !== p.y ) {\r\n\r\n\t\t\t\tvar x = p.x + ( hy - p.y ) * ( p.next.x - p.x ) / ( p.next.y - p.y );\r\n\t\t\t\tif ( x <= hx && x > qx ) {\r\n\r\n\t\t\t\t\tqx = x;\r\n\t\t\t\t\tif ( x === hx ) {\r\n\r\n\t\t\t\t\t\tif ( hy === p.y ) { return p; }\r\n\t\t\t\t\t\tif ( hy === p.next.y ) { return p.next; }\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tm = p.x < p.next.x ? p : p.next;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== outerNode );\r\n\r\n\t\tif ( ! m ) { return null; }\r\n\r\n\t\tif ( hx === qx ) { return m.prev; } // hole touches outer segment; pick lower endpoint\r\n\r\n\t\t// look for points inside the triangle of hole point, segment intersection and endpoint;\r\n\t\t// if there are no points found, we have a valid connection;\r\n\t\t// otherwise choose the point of the minimum angle with the ray as connection point\r\n\r\n\t\tvar stop = m,\r\n\t\t\tmx = m.x,\r\n\t\t\tmy = m.y,\r\n\t\t\ttanMin = Infinity,\r\n\t\t\ttan;\r\n\r\n\t\tp = m.next;\r\n\r\n\t\twhile ( p !== stop ) {\r\n\r\n\t\t\tif ( hx >= p.x && p.x >= mx && hx !== p.x &&\r\n\t\t\t\t\tpointInTriangle( hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y ) ) {\r\n\r\n\t\t\t\ttan = Math.abs( hy - p.y ) / ( hx - p.x ); // tangential\r\n\r\n\t\t\t\tif ( ( tan < tanMin || ( tan === tanMin && p.x > m.x ) ) && locallyInside( p, hole ) ) {\r\n\r\n\t\t\t\t\tm = p;\r\n\t\t\t\t\ttanMin = tan;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tp = p.next;\r\n\r\n\t\t}\r\n\r\n\t\treturn m;\r\n\r\n\t}\r\n\r\n\t// interlink polygon nodes in z-order\r\n\tfunction indexCurve( start, minX, minY, invSize ) {\r\n\r\n\t\tvar p = start;\r\n\t\tdo {\r\n\r\n\t\t\tif ( p.z === null ) { p.z = zOrder( p.x, p.y, minX, minY, invSize ); }\r\n\t\t\tp.prevZ = p.prev;\r\n\t\t\tp.nextZ = p.next;\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== start );\r\n\r\n\t\tp.prevZ.nextZ = null;\r\n\t\tp.prevZ = null;\r\n\r\n\t\tsortLinked( p );\r\n\r\n\t}\r\n\r\n\t// Simon Tatham's linked list merge sort algorithm\r\n\t// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\r\n\tfunction sortLinked( list ) {\r\n\r\n\t\tvar i, p, q, e, tail, numMerges, pSize, qSize,\r\n\t\t\tinSize = 1;\r\n\r\n\t\tdo {\r\n\r\n\t\t\tp = list;\r\n\t\t\tlist = null;\r\n\t\t\ttail = null;\r\n\t\t\tnumMerges = 0;\r\n\r\n\t\t\twhile ( p ) {\r\n\r\n\t\t\t\tnumMerges ++;\r\n\t\t\t\tq = p;\r\n\t\t\t\tpSize = 0;\r\n\t\t\t\tfor ( i = 0; i < inSize; i ++ ) {\r\n\r\n\t\t\t\t\tpSize ++;\r\n\t\t\t\t\tq = q.nextZ;\r\n\t\t\t\t\tif ( ! q ) { break; }\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tqSize = inSize;\r\n\r\n\t\t\t\twhile ( pSize > 0 || ( qSize > 0 && q ) ) {\r\n\r\n\t\t\t\t\tif ( pSize !== 0 && ( qSize === 0 || ! q || p.z <= q.z ) ) {\r\n\r\n\t\t\t\t\t\te = p;\r\n\t\t\t\t\t\tp = p.nextZ;\r\n\t\t\t\t\t\tpSize --;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\te = q;\r\n\t\t\t\t\t\tq = q.nextZ;\r\n\t\t\t\t\t\tqSize --;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( tail ) { tail.nextZ = e; }\r\n\t\t\t\t\telse { list = e; }\r\n\r\n\t\t\t\t\te.prevZ = tail;\r\n\t\t\t\t\ttail = e;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tp = q;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttail.nextZ = null;\r\n\t\t\tinSize *= 2;\r\n\r\n\t\t} while ( numMerges > 1 );\r\n\r\n\t\treturn list;\r\n\r\n\t}\r\n\r\n\t// z-order of a point given coords and inverse of the longer side of data bbox\r\n\tfunction zOrder( x, y, minX, minY, invSize ) {\r\n\r\n\t\t// coords are transformed into non-negative 15-bit integer range\r\n\t\tx = 32767 * ( x - minX ) * invSize;\r\n\t\ty = 32767 * ( y - minY ) * invSize;\r\n\r\n\t\tx = ( x | ( x << 8 ) ) & 0x00FF00FF;\r\n\t\tx = ( x | ( x << 4 ) ) & 0x0F0F0F0F;\r\n\t\tx = ( x | ( x << 2 ) ) & 0x33333333;\r\n\t\tx = ( x | ( x << 1 ) ) & 0x55555555;\r\n\r\n\t\ty = ( y | ( y << 8 ) ) & 0x00FF00FF;\r\n\t\ty = ( y | ( y << 4 ) ) & 0x0F0F0F0F;\r\n\t\ty = ( y | ( y << 2 ) ) & 0x33333333;\r\n\t\ty = ( y | ( y << 1 ) ) & 0x55555555;\r\n\r\n\t\treturn x | ( y << 1 );\r\n\r\n\t}\r\n\r\n\t// find the leftmost node of a polygon ring\r\n\tfunction getLeftmost( start ) {\r\n\r\n\t\tvar p = start,\r\n\t\t\tleftmost = start;\r\n\t\tdo {\r\n\r\n\t\t\tif ( p.x < leftmost.x || ( p.x === leftmost.x && p.y < leftmost.y ) ) { leftmost = p; }\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== start );\r\n\r\n\t\treturn leftmost;\r\n\r\n\t}\r\n\r\n\t// check if a point lies within a convex triangle\r\n\tfunction pointInTriangle( ax, ay, bx, by, cx, cy, px, py ) {\r\n\r\n\t\treturn ( cx - px ) * ( ay - py ) - ( ax - px ) * ( cy - py ) >= 0 &&\r\n\t\t\t   ( ax - px ) * ( by - py ) - ( bx - px ) * ( ay - py ) >= 0 &&\r\n\t\t\t   ( bx - px ) * ( cy - py ) - ( cx - px ) * ( by - py ) >= 0;\r\n\r\n\t}\r\n\r\n\t// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\r\n\tfunction isValidDiagonal( a, b ) {\r\n\r\n\t\treturn a.next.i !== b.i && a.prev.i !== b.i && ! intersectsPolygon( a, b ) &&\r\n\t\t\t   locallyInside( a, b ) && locallyInside( b, a ) && middleInside( a, b );\r\n\r\n\t}\r\n\r\n\t// signed area of a triangle\r\n\tfunction area( p, q, r ) {\r\n\r\n\t\treturn ( q.y - p.y ) * ( r.x - q.x ) - ( q.x - p.x ) * ( r.y - q.y );\r\n\r\n\t}\r\n\r\n\t// check if two points are equal\r\n\tfunction equals( p1, p2 ) {\r\n\r\n\t\treturn p1.x === p2.x && p1.y === p2.y;\r\n\r\n\t}\r\n\r\n\t// check if two segments intersect\r\n\tfunction intersects( p1, q1, p2, q2 ) {\r\n\r\n\t\tif ( ( equals( p1, p2 ) && equals( q1, q2 ) ) ||\r\n\t\t\t( equals( p1, q2 ) && equals( p2, q1 ) ) ) { return true; }\r\n\t\treturn area( p1, q1, p2 ) > 0 !== area( p1, q1, q2 ) > 0 &&\r\n\t\t\t   area( p2, q2, p1 ) > 0 !== area( p2, q2, q1 ) > 0;\r\n\r\n\t}\r\n\r\n\t// check if a polygon diagonal intersects any polygon segments\r\n\tfunction intersectsPolygon( a, b ) {\r\n\r\n\t\tvar p = a;\r\n\t\tdo {\r\n\r\n\t\t\tif ( p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\r\n\t\t\t\t\tintersects( p, p.next, a, b ) ) { return true; }\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== a );\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t// check if a polygon diagonal is locally inside the polygon\r\n\tfunction locallyInside( a, b ) {\r\n\r\n\t\treturn area( a.prev, a, a.next ) < 0 ?\r\n\t\t\tarea( a, b, a.next ) >= 0 && area( a, a.prev, b ) >= 0 :\r\n\t\t\tarea( a, b, a.prev ) < 0 || area( a, a.next, b ) < 0;\r\n\r\n\t}\r\n\r\n\t// check if the middle point of a polygon diagonal is inside the polygon\r\n\tfunction middleInside( a, b ) {\r\n\r\n\t\tvar p = a,\r\n\t\t\tinside = false,\r\n\t\t\tpx = ( a.x + b.x ) / 2,\r\n\t\t\tpy = ( a.y + b.y ) / 2;\r\n\t\tdo {\r\n\r\n\t\t\tif ( ( ( p.y > py ) !== ( p.next.y > py ) ) && p.next.y !== p.y &&\r\n\t\t\t\t\t( px < ( p.next.x - p.x ) * ( py - p.y ) / ( p.next.y - p.y ) + p.x ) )\r\n\t\t\t\t{ inside = ! inside; }\r\n\t\t\tp = p.next;\r\n\r\n\t\t} while ( p !== a );\r\n\r\n\t\treturn inside;\r\n\r\n\t}\r\n\r\n\t// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\r\n\t// if one belongs to the outer ring and another to a hole, it merges it into a single ring\r\n\tfunction splitPolygon( a, b ) {\r\n\r\n\t\tvar a2 = new Node( a.i, a.x, a.y ),\r\n\t\t\tb2 = new Node( b.i, b.x, b.y ),\r\n\t\t\tan = a.next,\r\n\t\t\tbp = b.prev;\r\n\r\n\t\ta.next = b;\r\n\t\tb.prev = a;\r\n\r\n\t\ta2.next = an;\r\n\t\tan.prev = a2;\r\n\r\n\t\tb2.next = a2;\r\n\t\ta2.prev = b2;\r\n\r\n\t\tbp.next = b2;\r\n\t\tb2.prev = bp;\r\n\r\n\t\treturn b2;\r\n\r\n\t}\r\n\r\n\t// create a node and optionally link it with previous one (in a circular doubly linked list)\r\n\tfunction insertNode( i, x, y, last ) {\r\n\r\n\t\tvar p = new Node( i, x, y );\r\n\r\n\t\tif ( ! last ) {\r\n\r\n\t\t\tp.prev = p;\r\n\t\t\tp.next = p;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tp.next = last.next;\r\n\t\t\tp.prev = last;\r\n\t\t\tlast.next.prev = p;\r\n\t\t\tlast.next = p;\r\n\r\n\t\t}\r\n\r\n\t\treturn p;\r\n\r\n\t}\r\n\r\n\tfunction removeNode( p ) {\r\n\r\n\t\tp.next.prev = p.prev;\r\n\t\tp.prev.next = p.next;\r\n\r\n\t\tif ( p.prevZ ) { p.prevZ.nextZ = p.nextZ; }\r\n\t\tif ( p.nextZ ) { p.nextZ.prevZ = p.prevZ; }\r\n\r\n\t}\r\n\r\n\tfunction Node( i, x, y ) {\r\n\r\n\t\t// vertex index in coordinates array\r\n\t\tthis.i = i;\r\n\r\n\t\t// vertex coordinates\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\r\n\t\t// previous and next vertex nodes in a polygon ring\r\n\t\tthis.prev = null;\r\n\t\tthis.next = null;\r\n\r\n\t\t// z-order curve value\r\n\t\tthis.z = null;\r\n\r\n\t\t// previous and next nodes in z-order\r\n\t\tthis.prevZ = null;\r\n\t\tthis.nextZ = null;\r\n\r\n\t\t// indicates whether this is a steiner point\r\n\t\tthis.steiner = false;\r\n\r\n\t}\r\n\r\n\tfunction signedArea( data, start, end, dim ) {\r\n\r\n\t\tvar sum = 0;\r\n\t\tfor ( var i = start, j = end - dim; i < end; i += dim ) {\r\n\r\n\t\t\tsum += ( data[ j ] - data[ i ] ) * ( data[ i + 1 ] + data[ j + 1 ] );\r\n\t\t\tj = i;\r\n\r\n\t\t}\r\n\r\n\t\treturn sum;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t */\r\n\r\n\tvar ShapeUtils = {\r\n\r\n\t\t// calculate area of the contour polygon\r\n\r\n\t\tarea: function ( contour ) {\r\n\r\n\t\t\tvar n = contour.length;\r\n\t\t\tvar a = 0.0;\r\n\r\n\t\t\tfor ( var p = n - 1, q = 0; q < n; p = q ++ ) {\r\n\r\n\t\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn a * 0.5;\r\n\r\n\t\t},\r\n\r\n\t\tisClockWise: function ( pts ) {\r\n\r\n\t\t\treturn ShapeUtils.area( pts ) < 0;\r\n\r\n\t\t},\r\n\r\n\t\ttriangulateShape: function ( contour, holes ) {\r\n\r\n\t\t\tvar vertices = []; // flat array of vertices like [ x0,y0, x1,y1, x2,y2, ... ]\r\n\t\t\tvar holeIndices = []; // array of hole indices\r\n\t\t\tvar faces = []; // final array of vertex indices like [ [ a,b,d ], [ b,c,d ] ]\r\n\r\n\t\t\tremoveDupEndPts( contour );\r\n\t\t\taddContour( vertices, contour );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar holeIndex = contour.length;\r\n\r\n\t\t\tholes.forEach( removeDupEndPts );\r\n\r\n\t\t\tfor ( var i = 0; i < holes.length; i ++ ) {\r\n\r\n\t\t\t\tholeIndices.push( holeIndex );\r\n\t\t\t\tholeIndex += holes[ i ].length;\r\n\t\t\t\taddContour( vertices, holes[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar triangles = Earcut.triangulate( vertices, holeIndices );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tfor ( var i = 0; i < triangles.length; i += 3 ) {\r\n\r\n\t\t\t\tfaces.push( triangles.slice( i, i + 3 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn faces;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction removeDupEndPts( points ) {\r\n\r\n\t\tvar l = points.length;\r\n\r\n\t\tif ( l > 2 && points[ l - 1 ].equals( points[ 0 ] ) ) {\r\n\r\n\t\t\tpoints.pop();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction addContour( vertices, contour ) {\r\n\r\n\t\tfor ( var i = 0; i < contour.length; i ++ ) {\r\n\r\n\t\t\tvertices.push( contour[ i ].x );\r\n\t\t\tvertices.push( contour[ i ].y );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t *\r\n\t * Creates extruded geometry from a path shape.\r\n\t *\r\n\t * parameters = {\r\n\t *\r\n\t *  curveSegments: <int>, // number of points on the curves\r\n\t *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\r\n\t *  depth: <float>, // Depth to extrude the shape\r\n\t *\r\n\t *  bevelEnabled: <bool>, // turn on bevel\r\n\t *  bevelThickness: <float>, // how deep into the original shape bevel goes\r\n\t *  bevelSize: <float>, // how far from shape outline (including bevelOffset) is bevel\r\n\t *  bevelOffset: <float>, // how far from shape outline does bevel start\r\n\t *  bevelSegments: <int>, // number of bevel layers\r\n\t *\r\n\t *  extrudePath: <THREE.Curve> // curve to extrude shape along\r\n\t *\r\n\t *  UVGenerator: <Object> // object that provides UV generator functions\r\n\t *\r\n\t * }\r\n\t */\r\n\r\n\t// ExtrudeGeometry\r\n\r\n\tfunction ExtrudeGeometry( shapes, options ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'ExtrudeGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tshapes: shapes,\r\n\t\t\toptions: options\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new ExtrudeBufferGeometry( shapes, options ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tExtrudeGeometry.prototype = Object.create( Geometry.prototype );\r\n\tExtrudeGeometry.prototype.constructor = ExtrudeGeometry;\r\n\r\n\tExtrudeGeometry.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Geometry.prototype.toJSON.call( this );\r\n\r\n\t\tvar shapes = this.parameters.shapes;\r\n\t\tvar options = this.parameters.options;\r\n\r\n\t\treturn toJSON( shapes, options, data );\r\n\r\n\t};\r\n\r\n\t// ExtrudeBufferGeometry\r\n\r\n\tfunction ExtrudeBufferGeometry( shapes, options ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'ExtrudeBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tshapes: shapes,\r\n\t\t\toptions: options\r\n\t\t};\r\n\r\n\t\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar verticesArray = [];\r\n\t\tvar uvArray = [];\r\n\r\n\t\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar shape = shapes[ i ];\r\n\t\t\taddShape( shape );\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( verticesArray, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvArray, 2 ) );\r\n\r\n\t\tthis.computeVertexNormals();\r\n\r\n\t\t// functions\r\n\r\n\t\tfunction addShape( shape ) {\r\n\r\n\t\t\tvar placeholder = [];\r\n\r\n\t\t\t// options\r\n\r\n\t\t\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\r\n\t\t\tvar steps = options.steps !== undefined ? options.steps : 1;\r\n\t\t\tvar depth = options.depth !== undefined ? options.depth : 100;\r\n\r\n\t\t\tvar bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true;\r\n\t\t\tvar bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6;\r\n\t\t\tvar bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2;\r\n\t\t\tvar bevelOffset = options.bevelOffset !== undefined ? options.bevelOffset : 0;\r\n\t\t\tvar bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\r\n\r\n\t\t\tvar extrudePath = options.extrudePath;\r\n\r\n\t\t\tvar uvgen = options.UVGenerator !== undefined ? options.UVGenerator : WorldUVGenerator;\r\n\r\n\t\t\t// deprecated options\r\n\r\n\t\t\tif ( options.amount !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.ExtrudeBufferGeometry: amount has been renamed to depth.' );\r\n\t\t\t\tdepth = options.amount;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tvar extrudePts, extrudeByPath = false;\r\n\t\t\tvar splineTube, binormal, normal, position2;\r\n\r\n\t\t\tif ( extrudePath ) {\r\n\r\n\t\t\t\textrudePts = extrudePath.getSpacedPoints( steps );\r\n\r\n\t\t\t\textrudeByPath = true;\r\n\t\t\t\tbevelEnabled = false; // bevels not supported for path extrusion\r\n\r\n\t\t\t\t// SETUP TNB variables\r\n\r\n\t\t\t\t// TODO1 - have a .isClosed in spline?\r\n\r\n\t\t\t\tsplineTube = extrudePath.computeFrenetFrames( steps, false );\r\n\r\n\t\t\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\r\n\r\n\t\t\t\tbinormal = new Vector3();\r\n\t\t\t\tnormal = new Vector3();\r\n\t\t\t\tposition2 = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Safeguards if bevels are not enabled\r\n\r\n\t\t\tif ( ! bevelEnabled ) {\r\n\r\n\t\t\t\tbevelSegments = 0;\r\n\t\t\t\tbevelThickness = 0;\r\n\t\t\t\tbevelSize = 0;\r\n\t\t\t\tbevelOffset = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Variables initialization\r\n\r\n\t\t\tvar ahole, h, hl; // looping of holes\r\n\r\n\t\t\tvar shapePoints = shape.extractPoints( curveSegments );\r\n\r\n\t\t\tvar vertices = shapePoints.shape;\r\n\t\t\tvar holes = shapePoints.holes;\r\n\r\n\t\t\tvar reverse = ! ShapeUtils.isClockWise( vertices );\r\n\r\n\t\t\tif ( reverse ) {\r\n\r\n\t\t\t\tvertices = vertices.reverse();\r\n\r\n\t\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\r\n\r\n\t\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\t\tahole = holes[ h ];\r\n\r\n\t\t\t\t\tif ( ShapeUtils.isClockWise( ahole ) ) {\r\n\r\n\t\t\t\t\t\tholes[ h ] = ahole.reverse();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar faces = ShapeUtils.triangulateShape( vertices, holes );\r\n\r\n\t\t\t/* Vertices */\r\n\r\n\t\t\tvar contour = vertices; // vertices has all points but contour has only points of circumference\r\n\r\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\tahole = holes[ h ];\r\n\r\n\t\t\t\tvertices = vertices.concat( ahole );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfunction scalePt2( pt, vec, size ) {\r\n\r\n\t\t\t\tif ( ! vec ) { console.error( \"THREE.ExtrudeGeometry: vec does not exist\" ); }\r\n\r\n\t\t\t\treturn vec.clone().multiplyScalar( size ).add( pt );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar b, bs, t, z,\r\n\t\t\t\tvert, vlen = vertices.length,\r\n\t\t\t\tface, flen = faces.length;\r\n\r\n\r\n\t\t\t// Find directions for point movement\r\n\r\n\r\n\t\t\tfunction getBevelVec( inPt, inPrev, inNext ) {\r\n\r\n\t\t\t\t// computes for inPt the corresponding point inPt' on a new contour\r\n\t\t\t\t//   shifted by 1 unit (length of normalized vector) to the left\r\n\t\t\t\t// if we walk along contour clockwise, this new contour is outside the old one\r\n\t\t\t\t//\r\n\t\t\t\t// inPt' is the intersection of the two lines parallel to the two\r\n\t\t\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\r\n\r\n\t\t\t\tvar v_trans_x, v_trans_y, shrink_by; // resulting translation vector for inPt\r\n\r\n\t\t\t\t// good reading for geometry algorithms (here: line-line intersection)\r\n\t\t\t\t// http://geomalgorithms.com/a05-_intersect-1.html\r\n\r\n\t\t\t\tvar v_prev_x = inPt.x - inPrev.x,\r\n\t\t\t\t\tv_prev_y = inPt.y - inPrev.y;\r\n\t\t\t\tvar v_next_x = inNext.x - inPt.x,\r\n\t\t\t\t\tv_next_y = inNext.y - inPt.y;\r\n\r\n\t\t\t\tvar v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\r\n\r\n\t\t\t\t// check for collinear edges\r\n\t\t\t\tvar collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\t\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t\t// not collinear\r\n\r\n\t\t\t\t\t// length of vectors for normalizing\r\n\r\n\t\t\t\t\tvar v_prev_len = Math.sqrt( v_prev_lensq );\r\n\t\t\t\t\tvar v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\r\n\r\n\t\t\t\t\t// shift adjacent points by unit vectors to the left\r\n\r\n\t\t\t\t\tvar ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\r\n\t\t\t\t\tvar ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\r\n\r\n\t\t\t\t\tvar ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\r\n\t\t\t\t\tvar ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\r\n\r\n\t\t\t\t\t// scaling factor for v_prev to intersection point\r\n\r\n\t\t\t\t\tvar sf = ( ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\r\n\t\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x ) /\r\n\t\t\t\t\t\t( v_prev_x * v_next_y - v_prev_y * v_next_x );\r\n\r\n\t\t\t\t\t// vector from inPt to intersection point\r\n\r\n\t\t\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\r\n\t\t\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\r\n\r\n\t\t\t\t\t// Don't normalize!, otherwise sharp corners become ugly\r\n\t\t\t\t\t//  but prevent crazy spikes\r\n\t\t\t\t\tvar v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\r\n\t\t\t\t\tif ( v_trans_lensq <= 2 ) {\r\n\r\n\t\t\t\t\t\treturn new Vector2( v_trans_x, v_trans_y );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// handle special case of collinear edges\r\n\r\n\t\t\t\t\tvar direction_eq = false; // assumes: opposite\r\n\t\t\t\t\tif ( v_prev_x > Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\tif ( v_next_x > Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\r\n\r\n\t\t\t\t\t\t\t\tdirection_eq = true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( direction_eq ) {\r\n\r\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\r\n\t\t\t\t\t\tv_trans_x = - v_prev_y;\r\n\t\t\t\t\t\tv_trans_y = v_prev_x;\r\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\r\n\t\t\t\t\t\tv_trans_x = v_prev_x;\r\n\t\t\t\t\t\tv_trans_y = v_prev_y;\r\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn new Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar contourMovements = [];\r\n\r\n\t\t\tfor ( var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\t\t\tif ( j === il ) { j = 0; }\r\n\t\t\t\tif ( k === il ) { k = 0; }\r\n\r\n\t\t\t\t//  (j)---(i)---(k)\r\n\t\t\t\t// console.log('i,j,k', i, j , k)\r\n\r\n\t\t\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar holesMovements = [],\r\n\t\t\t\toneHoleMovements, verticesMovements = contourMovements.concat();\r\n\r\n\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\tahole = holes[ h ];\r\n\r\n\t\t\t\toneHoleMovements = [];\r\n\r\n\t\t\t\tfor ( i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\r\n\r\n\t\t\t\t\tif ( j === il ) { j = 0; }\r\n\t\t\t\t\tif ( k === il ) { k = 0; }\r\n\r\n\t\t\t\t\t//  (j)---(i)---(k)\r\n\t\t\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tholesMovements.push( oneHoleMovements );\r\n\t\t\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// Loop bevelSegments, 1 for the front, 1 for the back\r\n\r\n\t\t\tfor ( b = 0; b < bevelSegments; b ++ ) {\r\n\r\n\t\t\t\t//for ( b = bevelSegments; b > 0; b -- ) {\r\n\r\n\t\t\t\tt = b / bevelSegments;\r\n\t\t\t\tz = bevelThickness * Math.cos( t * Math.PI / 2 );\r\n\t\t\t\tbs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\r\n\r\n\t\t\t\t// contract shape\r\n\r\n\t\t\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\r\n\t\t\t\t\tv( vert.x, vert.y, - z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// expand holes\r\n\r\n\t\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\t\tahole = holes[ h ];\r\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\t\t\tv( vert.x, vert.y, - z );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbs = bevelSize + bevelOffset;\r\n\r\n\t\t\t// Back facing vertices\r\n\r\n\t\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\tv( vert.x, vert.y, 0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\r\n\r\n\t\t\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\r\n\t\t\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\r\n\r\n\t\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Add stepped vertices...\r\n\t\t\t// Including front facing vertices\r\n\r\n\t\t\tvar s;\r\n\r\n\t\t\tfor ( s = 1; s <= steps; s ++ ) {\r\n\r\n\t\t\t\tfor ( i = 0; i < vlen; i ++ ) {\r\n\r\n\t\t\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\r\n\r\n\t\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\t\tv( vert.x, vert.y, depth / steps * s );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\r\n\r\n\t\t\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\r\n\t\t\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\r\n\r\n\t\t\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\r\n\r\n\t\t\t\t\t\tv( position2.x, position2.y, position2.z );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// Add bevel segments planes\r\n\r\n\t\t\t//for ( b = 1; b <= bevelSegments; b ++ ) {\r\n\t\t\tfor ( b = bevelSegments - 1; b >= 0; b -- ) {\r\n\r\n\t\t\t\tt = b / bevelSegments;\r\n\t\t\t\tz = bevelThickness * Math.cos( t * Math.PI / 2 );\r\n\t\t\t\tbs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\r\n\r\n\t\t\t\t// contract shape\r\n\r\n\t\t\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\r\n\t\t\t\t\tv( vert.x, vert.y, depth + z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// expand holes\r\n\r\n\t\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\t\tahole = holes[ h ];\r\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\r\n\r\n\t\t\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\r\n\r\n\t\t\t\t\t\tif ( ! extrudeByPath ) {\r\n\r\n\t\t\t\t\t\t\tv( vert.x, vert.y, depth + z );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/* Faces */\r\n\r\n\t\t\t// Top and bottom faces\r\n\r\n\t\t\tbuildLidFaces();\r\n\r\n\t\t\t// Sides faces\r\n\r\n\t\t\tbuildSideFaces();\r\n\r\n\r\n\t\t\t/////  Internal functions\r\n\r\n\t\t\tfunction buildLidFaces() {\r\n\r\n\t\t\t\tvar start = verticesArray.length / 3;\r\n\r\n\t\t\t\tif ( bevelEnabled ) {\r\n\r\n\t\t\t\t\tvar layer = 0; // steps + 1\r\n\t\t\t\t\tvar offset = vlen * layer;\r\n\r\n\t\t\t\t\t// Bottom faces\r\n\r\n\t\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlayer = steps + bevelSegments * 2;\r\n\t\t\t\t\toffset = vlen * layer;\r\n\r\n\t\t\t\t\t// Top faces\r\n\r\n\t\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// Bottom faces\r\n\r\n\t\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Top faces\r\n\r\n\t\t\t\t\tfor ( i = 0; i < flen; i ++ ) {\r\n\r\n\t\t\t\t\t\tface = faces[ i ];\r\n\t\t\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Create faces for the z-sides of the shape\r\n\r\n\t\t\tfunction buildSideFaces() {\r\n\r\n\t\t\t\tvar start = verticesArray.length / 3;\r\n\t\t\t\tvar layeroffset = 0;\r\n\t\t\t\tsidewalls( contour, layeroffset );\r\n\t\t\t\tlayeroffset += contour.length;\r\n\r\n\t\t\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\r\n\r\n\t\t\t\t\tahole = holes[ h ];\r\n\t\t\t\t\tsidewalls( ahole, layeroffset );\r\n\r\n\t\t\t\t\t//, true\r\n\t\t\t\t\tlayeroffset += ahole.length;\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 1 );\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction sidewalls( contour, layeroffset ) {\r\n\r\n\t\t\t\tvar j, k;\r\n\t\t\t\ti = contour.length;\r\n\r\n\t\t\t\twhile ( -- i >= 0 ) {\r\n\r\n\t\t\t\t\tj = i;\r\n\t\t\t\t\tk = i - 1;\r\n\t\t\t\t\tif ( k < 0 ) { k = contour.length - 1; }\r\n\r\n\t\t\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\r\n\r\n\t\t\t\t\tvar s = 0,\r\n\t\t\t\t\t\tsl = steps + bevelSegments * 2;\r\n\r\n\t\t\t\t\tfor ( s = 0; s < sl; s ++ ) {\r\n\r\n\t\t\t\t\t\tvar slen1 = vlen * s;\r\n\t\t\t\t\t\tvar slen2 = vlen * ( s + 1 );\r\n\r\n\t\t\t\t\t\tvar a = layeroffset + j + slen1,\r\n\t\t\t\t\t\t\tb = layeroffset + k + slen1,\r\n\t\t\t\t\t\t\tc = layeroffset + k + slen2,\r\n\t\t\t\t\t\t\td = layeroffset + j + slen2;\r\n\r\n\t\t\t\t\t\tf4( a, b, c, d );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction v( x, y, z ) {\r\n\r\n\t\t\t\tplaceholder.push( x );\r\n\t\t\t\tplaceholder.push( y );\r\n\t\t\t\tplaceholder.push( z );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfunction f3( a, b, c ) {\r\n\r\n\t\t\t\taddVertex( a );\r\n\t\t\t\taddVertex( b );\r\n\t\t\t\taddVertex( c );\r\n\r\n\t\t\t\tvar nextIndex = verticesArray.length / 3;\r\n\t\t\t\tvar uvs = uvgen.generateTopUV( scope, verticesArray, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\r\n\r\n\t\t\t\taddUV( uvs[ 0 ] );\r\n\t\t\t\taddUV( uvs[ 1 ] );\r\n\t\t\t\taddUV( uvs[ 2 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction f4( a, b, c, d ) {\r\n\r\n\t\t\t\taddVertex( a );\r\n\t\t\t\taddVertex( b );\r\n\t\t\t\taddVertex( d );\r\n\r\n\t\t\t\taddVertex( b );\r\n\t\t\t\taddVertex( c );\r\n\t\t\t\taddVertex( d );\r\n\r\n\r\n\t\t\t\tvar nextIndex = verticesArray.length / 3;\r\n\t\t\t\tvar uvs = uvgen.generateSideWallUV( scope, verticesArray, nextIndex - 6, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\r\n\r\n\t\t\t\taddUV( uvs[ 0 ] );\r\n\t\t\t\taddUV( uvs[ 1 ] );\r\n\t\t\t\taddUV( uvs[ 3 ] );\r\n\r\n\t\t\t\taddUV( uvs[ 1 ] );\r\n\t\t\t\taddUV( uvs[ 2 ] );\r\n\t\t\t\taddUV( uvs[ 3 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction addVertex( index ) {\r\n\r\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 0 ] );\r\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 1 ] );\r\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 2 ] );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfunction addUV( vector2 ) {\r\n\r\n\t\t\t\tuvArray.push( vector2.x );\r\n\t\t\t\tuvArray.push( vector2.y );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tExtrudeBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tExtrudeBufferGeometry.prototype.constructor = ExtrudeBufferGeometry;\r\n\r\n\tExtrudeBufferGeometry.prototype.toJSON = function () {\r\n\r\n\t\tvar data = BufferGeometry.prototype.toJSON.call( this );\r\n\r\n\t\tvar shapes = this.parameters.shapes;\r\n\t\tvar options = this.parameters.options;\r\n\r\n\t\treturn toJSON( shapes, options, data );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tvar WorldUVGenerator = {\r\n\r\n\t\tgenerateTopUV: function ( geometry, vertices, indexA, indexB, indexC ) {\r\n\r\n\t\t\tvar a_x = vertices[ indexA * 3 ];\r\n\t\t\tvar a_y = vertices[ indexA * 3 + 1 ];\r\n\t\t\tvar b_x = vertices[ indexB * 3 ];\r\n\t\t\tvar b_y = vertices[ indexB * 3 + 1 ];\r\n\t\t\tvar c_x = vertices[ indexC * 3 ];\r\n\t\t\tvar c_y = vertices[ indexC * 3 + 1 ];\r\n\r\n\t\t\treturn [\r\n\t\t\t\tnew Vector2( a_x, a_y ),\r\n\t\t\t\tnew Vector2( b_x, b_y ),\r\n\t\t\t\tnew Vector2( c_x, c_y )\r\n\t\t\t];\r\n\r\n\t\t},\r\n\r\n\t\tgenerateSideWallUV: function ( geometry, vertices, indexA, indexB, indexC, indexD ) {\r\n\r\n\t\t\tvar a_x = vertices[ indexA * 3 ];\r\n\t\t\tvar a_y = vertices[ indexA * 3 + 1 ];\r\n\t\t\tvar a_z = vertices[ indexA * 3 + 2 ];\r\n\t\t\tvar b_x = vertices[ indexB * 3 ];\r\n\t\t\tvar b_y = vertices[ indexB * 3 + 1 ];\r\n\t\t\tvar b_z = vertices[ indexB * 3 + 2 ];\r\n\t\t\tvar c_x = vertices[ indexC * 3 ];\r\n\t\t\tvar c_y = vertices[ indexC * 3 + 1 ];\r\n\t\t\tvar c_z = vertices[ indexC * 3 + 2 ];\r\n\t\t\tvar d_x = vertices[ indexD * 3 ];\r\n\t\t\tvar d_y = vertices[ indexD * 3 + 1 ];\r\n\t\t\tvar d_z = vertices[ indexD * 3 + 2 ];\r\n\r\n\t\t\tif ( Math.abs( a_y - b_y ) < 0.01 ) {\r\n\r\n\t\t\t\treturn [\r\n\t\t\t\t\tnew Vector2( a_x, 1 - a_z ),\r\n\t\t\t\t\tnew Vector2( b_x, 1 - b_z ),\r\n\t\t\t\t\tnew Vector2( c_x, 1 - c_z ),\r\n\t\t\t\t\tnew Vector2( d_x, 1 - d_z )\r\n\t\t\t\t];\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn [\r\n\t\t\t\t\tnew Vector2( a_y, 1 - a_z ),\r\n\t\t\t\t\tnew Vector2( b_y, 1 - b_z ),\r\n\t\t\t\t\tnew Vector2( c_y, 1 - c_z ),\r\n\t\t\t\t\tnew Vector2( d_y, 1 - d_z )\r\n\t\t\t\t];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t};\r\n\r\n\tfunction toJSON( shapes, options, data ) {\r\n\r\n\t\t//\r\n\r\n\t\tdata.shapes = [];\r\n\r\n\t\tif ( Array.isArray( shapes ) ) {\r\n\r\n\t\t\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar shape = shapes[ i ];\r\n\r\n\t\t\t\tdata.shapes.push( shape.uuid );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdata.shapes.push( shapes.uuid );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( options.extrudePath !== undefined ) { data.options.extrudePath = options.extrudePath.toJSON(); }\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * Text = 3D Text\r\n\t *\r\n\t * parameters = {\r\n\t *  font: <THREE.Font>, // font\r\n\t *\r\n\t *  size: <float>, // size of the text\r\n\t *  height: <float>, // thickness to extrude text\r\n\t *  curveSegments: <int>, // number of points on the curves\r\n\t *\r\n\t *  bevelEnabled: <bool>, // turn on bevel\r\n\t *  bevelThickness: <float>, // how deep into text bevel goes\r\n\t *  bevelSize: <float>, // how far from text outline (including bevelOffset) is bevel\r\n\t *  bevelOffset: <float> // how far from text outline does bevel start\r\n\t * }\r\n\t */\r\n\r\n\t// TextGeometry\r\n\r\n\tfunction TextGeometry( text, parameters ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'TextGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\ttext: text,\r\n\t\t\tparameters: parameters\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new TextBufferGeometry( text, parameters ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tTextGeometry.prototype = Object.create( Geometry.prototype );\r\n\tTextGeometry.prototype.constructor = TextGeometry;\r\n\r\n\t// TextBufferGeometry\r\n\r\n\tfunction TextBufferGeometry( text, parameters ) {\r\n\r\n\t\tparameters = parameters || {};\r\n\r\n\t\tvar font = parameters.font;\r\n\r\n\t\tif ( ! ( font && font.isFont ) ) {\r\n\r\n\t\t\tconsole.error( 'THREE.TextGeometry: font parameter is not an instance of THREE.Font.' );\r\n\t\t\treturn new Geometry();\r\n\r\n\t\t}\r\n\r\n\t\tvar shapes = font.generateShapes( text, parameters.size );\r\n\r\n\t\t// translate parameters to ExtrudeGeometry API\r\n\r\n\t\tparameters.depth = parameters.height !== undefined ? parameters.height : 50;\r\n\r\n\t\t// defaults\r\n\r\n\t\tif ( parameters.bevelThickness === undefined ) { parameters.bevelThickness = 10; }\r\n\t\tif ( parameters.bevelSize === undefined ) { parameters.bevelSize = 8; }\r\n\t\tif ( parameters.bevelEnabled === undefined ) { parameters.bevelEnabled = false; }\r\n\r\n\t\tExtrudeBufferGeometry.call( this, shapes, parameters );\r\n\r\n\t\tthis.type = 'TextBufferGeometry';\r\n\r\n\t}\r\n\r\n\tTextBufferGeometry.prototype = Object.create( ExtrudeBufferGeometry.prototype );\r\n\tTextBufferGeometry.prototype.constructor = TextBufferGeometry;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// SphereGeometry\r\n\r\n\tfunction SphereGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'SphereGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tSphereGeometry.prototype = Object.create( Geometry.prototype );\r\n\tSphereGeometry.prototype.constructor = SphereGeometry;\r\n\r\n\t// SphereBufferGeometry\r\n\r\n\tfunction SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'SphereBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\twidthSegments: widthSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\r\n\t\twidthSegments = Math.max( 3, Math.floor( widthSegments ) || 8 );\r\n\t\theightSegments = Math.max( 2, Math.floor( heightSegments ) || 6 );\r\n\r\n\t\tphiStart = phiStart !== undefined ? phiStart : 0;\r\n\t\tphiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\r\n\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\r\n\r\n\t\tvar thetaEnd = Math.min( thetaStart + thetaLength, Math.PI );\r\n\r\n\t\tvar ix, iy;\r\n\r\n\t\tvar index = 0;\r\n\t\tvar grid = [];\r\n\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar normal = new Vector3();\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( iy = 0; iy <= heightSegments; iy ++ ) {\r\n\r\n\t\t\tvar verticesRow = [];\r\n\r\n\t\t\tvar v = iy / heightSegments;\r\n\r\n\t\t\t// special case for the poles\r\n\r\n\t\t\tvar uOffset = 0;\r\n\r\n\t\t\tif ( iy == 0 && thetaStart == 0 ) {\r\n\r\n\t\t\t\tuOffset = 0.5 / widthSegments;\r\n\r\n\t\t\t} else if ( iy == heightSegments && thetaEnd == Math.PI ) {\r\n\r\n\t\t\t\tuOffset = - 0.5 / widthSegments;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( ix = 0; ix <= widthSegments; ix ++ ) {\r\n\r\n\t\t\t\tvar u = ix / widthSegments;\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\t\t\t\tvertex.y = radius * Math.cos( thetaStart + v * thetaLength );\r\n\t\t\t\tvertex.z = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormal.copy( vertex ).normalize();\r\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( u + uOffset, 1 - v );\r\n\r\n\t\t\t\tverticesRow.push( index ++ );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgrid.push( verticesRow );\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( iy = 0; iy < heightSegments; iy ++ ) {\r\n\r\n\t\t\tfor ( ix = 0; ix < widthSegments; ix ++ ) {\r\n\r\n\t\t\t\tvar a = grid[ iy ][ ix + 1 ];\r\n\t\t\t\tvar b = grid[ iy ][ ix ];\r\n\t\t\t\tvar c = grid[ iy + 1 ][ ix ];\r\n\t\t\t\tvar d = grid[ iy + 1 ][ ix + 1 ];\r\n\r\n\t\t\t\tif ( iy !== 0 || thetaStart > 0 ) { indices.push( a, b, d ); }\r\n\t\t\t\tif ( iy !== heightSegments - 1 || thetaEnd < Math.PI ) { indices.push( b, c, d ); }\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tSphereBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tSphereBufferGeometry.prototype.constructor = SphereBufferGeometry;\r\n\r\n\t/**\r\n\t * @author Kaleb Murphy\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// RingGeometry\r\n\r\n\tfunction RingGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'RingGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tinnerRadius: innerRadius,\r\n\t\t\touterRadius: outerRadius,\r\n\t\t\tthetaSegments: thetaSegments,\r\n\t\t\tphiSegments: phiSegments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new RingBufferGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tRingGeometry.prototype = Object.create( Geometry.prototype );\r\n\tRingGeometry.prototype.constructor = RingGeometry;\r\n\r\n\t// RingBufferGeometry\r\n\r\n\tfunction RingBufferGeometry( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'RingBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tinnerRadius: innerRadius,\r\n\t\t\touterRadius: outerRadius,\r\n\t\t\tthetaSegments: thetaSegments,\r\n\t\t\tphiSegments: phiSegments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tinnerRadius = innerRadius || 0.5;\r\n\t\touterRadius = outerRadius || 1;\r\n\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\t\tthetaSegments = thetaSegments !== undefined ? Math.max( 3, thetaSegments ) : 8;\r\n\t\tphiSegments = phiSegments !== undefined ? Math.max( 1, phiSegments ) : 1;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// some helper variables\r\n\r\n\t\tvar segment;\r\n\t\tvar radius = innerRadius;\r\n\t\tvar radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar uv = new Vector2();\r\n\t\tvar j, i;\r\n\r\n\t\t// generate vertices, normals and uvs\r\n\r\n\t\tfor ( j = 0; j <= phiSegments; j ++ ) {\r\n\r\n\t\t\tfor ( i = 0; i <= thetaSegments; i ++ ) {\r\n\r\n\t\t\t\t// values are generate from the inside of the ring to the outside\r\n\r\n\t\t\t\tsegment = thetaStart + i / thetaSegments * thetaLength;\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = radius * Math.cos( segment );\r\n\t\t\t\tvertex.y = radius * Math.sin( segment );\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormals.push( 0, 0, 1 );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\r\n\t\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\r\n\r\n\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// increase the radius for next row of vertices\r\n\r\n\t\t\tradius += radiusStep;\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( j = 0; j < phiSegments; j ++ ) {\r\n\r\n\t\t\tvar thetaSegmentLevel = j * ( thetaSegments + 1 );\r\n\r\n\t\t\tfor ( i = 0; i < thetaSegments; i ++ ) {\r\n\r\n\t\t\t\tsegment = i + thetaSegmentLevel;\r\n\r\n\t\t\t\tvar a = segment;\r\n\t\t\t\tvar b = segment + thetaSegments + 1;\r\n\t\t\t\tvar c = segment + thetaSegments + 2;\r\n\t\t\t\tvar d = segment + 1;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tRingBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tRingBufferGeometry.prototype.constructor = RingBufferGeometry;\r\n\r\n\t/**\r\n\t * @author zz85 / https://github.com/zz85\r\n\t * @author bhouston / http://clara.io\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// LatheGeometry\r\n\r\n\tfunction LatheGeometry( points, segments, phiStart, phiLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'LatheGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tpoints: points,\r\n\t\t\tsegments: segments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new LatheBufferGeometry( points, segments, phiStart, phiLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tLatheGeometry.prototype = Object.create( Geometry.prototype );\r\n\tLatheGeometry.prototype.constructor = LatheGeometry;\r\n\r\n\t// LatheBufferGeometry\r\n\r\n\tfunction LatheBufferGeometry( points, segments, phiStart, phiLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'LatheBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tpoints: points,\r\n\t\t\tsegments: segments,\r\n\t\t\tphiStart: phiStart,\r\n\t\t\tphiLength: phiLength\r\n\t\t};\r\n\r\n\t\tsegments = Math.floor( segments ) || 12;\r\n\t\tphiStart = phiStart || 0;\r\n\t\tphiLength = phiLength || Math.PI * 2;\r\n\r\n\t\t// clamp phiLength so it's in range of [ 0, 2PI ]\r\n\r\n\t\tphiLength = MathUtils.clamp( phiLength, 0, Math.PI * 2 );\r\n\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar base;\r\n\t\tvar inverseSegments = 1.0 / segments;\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar uv = new Vector2();\r\n\t\tvar i, j;\r\n\r\n\t\t// generate vertices and uvs\r\n\r\n\t\tfor ( i = 0; i <= segments; i ++ ) {\r\n\r\n\t\t\tvar phi = phiStart + i * inverseSegments * phiLength;\r\n\r\n\t\t\tvar sin = Math.sin( phi );\r\n\t\t\tvar cos = Math.cos( phi );\r\n\r\n\t\t\tfor ( j = 0; j <= ( points.length - 1 ); j ++ ) {\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = points[ j ].x * sin;\r\n\t\t\t\tvertex.y = points[ j ].y;\r\n\t\t\t\tvertex.z = points[ j ].x * cos;\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuv.x = i / segments;\r\n\t\t\t\tuv.y = j / ( points.length - 1 );\r\n\r\n\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( i = 0; i < segments; i ++ ) {\r\n\r\n\t\t\tfor ( j = 0; j < ( points.length - 1 ); j ++ ) {\r\n\r\n\t\t\t\tbase = j + i * points.length;\r\n\r\n\t\t\t\tvar a = base;\r\n\t\t\t\tvar b = base + points.length;\r\n\t\t\t\tvar c = base + points.length + 1;\r\n\t\t\t\tvar d = base + 1;\r\n\r\n\t\t\t\t// faces\r\n\r\n\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\t// generate normals\r\n\r\n\t\tthis.computeVertexNormals();\r\n\r\n\t\t// if the geometry is closed, we need to average the normals along the seam.\r\n\t\t// because the corresponding vertices are identical (but still have different UVs).\r\n\r\n\t\tif ( phiLength === Math.PI * 2 ) {\r\n\r\n\t\t\tvar normals = this.attributes.normal.array;\r\n\t\t\tvar n1 = new Vector3();\r\n\t\t\tvar n2 = new Vector3();\r\n\t\t\tvar n = new Vector3();\r\n\r\n\t\t\t// this is the buffer offset for the last line of vertices\r\n\r\n\t\t\tbase = segments * points.length * 3;\r\n\r\n\t\t\tfor ( i = 0, j = 0; i < points.length; i ++, j += 3 ) {\r\n\r\n\t\t\t\t// select the normal of the vertex in the first line\r\n\r\n\t\t\t\tn1.x = normals[ j + 0 ];\r\n\t\t\t\tn1.y = normals[ j + 1 ];\r\n\t\t\t\tn1.z = normals[ j + 2 ];\r\n\r\n\t\t\t\t// select the normal of the vertex in the last line\r\n\r\n\t\t\t\tn2.x = normals[ base + j + 0 ];\r\n\t\t\t\tn2.y = normals[ base + j + 1 ];\r\n\t\t\t\tn2.z = normals[ base + j + 2 ];\r\n\r\n\t\t\t\t// average normals\r\n\r\n\t\t\t\tn.addVectors( n1, n2 ).normalize();\r\n\r\n\t\t\t\t// assign the new values to both normals\r\n\r\n\t\t\t\tnormals[ j + 0 ] = normals[ base + j + 0 ] = n.x;\r\n\t\t\t\tnormals[ j + 1 ] = normals[ base + j + 1 ] = n.y;\r\n\t\t\t\tnormals[ j + 2 ] = normals[ base + j + 2 ] = n.z;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tLatheBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tLatheBufferGeometry.prototype.constructor = LatheBufferGeometry;\r\n\r\n\t/**\r\n\t * @author jonobr1 / http://jonobr1.com\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// ShapeGeometry\r\n\r\n\tfunction ShapeGeometry( shapes, curveSegments ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'ShapeGeometry';\r\n\r\n\t\tif ( typeof curveSegments === 'object' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.ShapeGeometry: Options parameter has been removed.' );\r\n\r\n\t\t\tcurveSegments = curveSegments.curveSegments;\r\n\r\n\t\t}\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tshapes: shapes,\r\n\t\t\tcurveSegments: curveSegments\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new ShapeBufferGeometry( shapes, curveSegments ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tShapeGeometry.prototype = Object.create( Geometry.prototype );\r\n\tShapeGeometry.prototype.constructor = ShapeGeometry;\r\n\r\n\tShapeGeometry.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Geometry.prototype.toJSON.call( this );\r\n\r\n\t\tvar shapes = this.parameters.shapes;\r\n\r\n\t\treturn toJSON$1( shapes, data );\r\n\r\n\t};\r\n\r\n\t// ShapeBufferGeometry\r\n\r\n\tfunction ShapeBufferGeometry( shapes, curveSegments ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'ShapeBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tshapes: shapes,\r\n\t\t\tcurveSegments: curveSegments\r\n\t\t};\r\n\r\n\t\tcurveSegments = curveSegments || 12;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar groupStart = 0;\r\n\t\tvar groupCount = 0;\r\n\r\n\t\t// allow single and array values for \"shapes\" parameter\r\n\r\n\t\tif ( Array.isArray( shapes ) === false ) {\r\n\r\n\t\t\taddShape( shapes );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor ( var i = 0; i < shapes.length; i ++ ) {\r\n\r\n\t\t\t\taddShape( shapes[ i ] );\r\n\r\n\t\t\t\tthis.addGroup( groupStart, groupCount, i ); // enables MultiMaterial support\r\n\r\n\t\t\t\tgroupStart += groupCount;\r\n\t\t\t\tgroupCount = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\r\n\t\t// helper functions\r\n\r\n\t\tfunction addShape( shape ) {\r\n\r\n\t\t\tvar i, l, shapeHole;\r\n\r\n\t\t\tvar indexOffset = vertices.length / 3;\r\n\t\t\tvar points = shape.extractPoints( curveSegments );\r\n\r\n\t\t\tvar shapeVertices = points.shape;\r\n\t\t\tvar shapeHoles = points.holes;\r\n\r\n\t\t\t// check direction of vertices\r\n\r\n\t\t\tif ( ShapeUtils.isClockWise( shapeVertices ) === false ) {\r\n\r\n\t\t\t\tshapeVertices = shapeVertices.reverse();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( i = 0, l = shapeHoles.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tshapeHole = shapeHoles[ i ];\r\n\r\n\t\t\t\tif ( ShapeUtils.isClockWise( shapeHole ) === true ) {\r\n\r\n\t\t\t\t\tshapeHoles[ i ] = shapeHole.reverse();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar faces = ShapeUtils.triangulateShape( shapeVertices, shapeHoles );\r\n\r\n\t\t\t// join vertices of inner and outer paths to a single array\r\n\r\n\t\t\tfor ( i = 0, l = shapeHoles.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tshapeHole = shapeHoles[ i ];\r\n\t\t\t\tshapeVertices = shapeVertices.concat( shapeHole );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// vertices, normals, uvs\r\n\r\n\t\t\tfor ( i = 0, l = shapeVertices.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar vertex = shapeVertices[ i ];\r\n\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, 0 );\r\n\t\t\t\tnormals.push( 0, 0, 1 );\r\n\t\t\t\tuvs.push( vertex.x, vertex.y ); // world uvs\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// incides\r\n\r\n\t\t\tfor ( i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\t\tvar a = face[ 0 ] + indexOffset;\r\n\t\t\t\tvar b = face[ 1 ] + indexOffset;\r\n\t\t\t\tvar c = face[ 2 ] + indexOffset;\r\n\r\n\t\t\t\tindices.push( a, b, c );\r\n\t\t\t\tgroupCount += 3;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tShapeBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tShapeBufferGeometry.prototype.constructor = ShapeBufferGeometry;\r\n\r\n\tShapeBufferGeometry.prototype.toJSON = function () {\r\n\r\n\t\tvar data = BufferGeometry.prototype.toJSON.call( this );\r\n\r\n\t\tvar shapes = this.parameters.shapes;\r\n\r\n\t\treturn toJSON$1( shapes, data );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tfunction toJSON$1( shapes, data ) {\r\n\r\n\t\tdata.shapes = [];\r\n\r\n\t\tif ( Array.isArray( shapes ) ) {\r\n\r\n\t\t\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar shape = shapes[ i ];\r\n\r\n\t\t\t\tdata.shapes.push( shape.uuid );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tdata.shapes.push( shapes.uuid );\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tfunction EdgesGeometry( geometry, thresholdAngle ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'EdgesGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tthresholdAngle: thresholdAngle\r\n\t\t};\r\n\r\n\t\tthresholdAngle = ( thresholdAngle !== undefined ) ? thresholdAngle : 1;\r\n\r\n\t\t// buffer\r\n\r\n\t\tvar vertices = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar thresholdDot = Math.cos( MathUtils.DEG2RAD * thresholdAngle );\r\n\t\tvar edge = [ 0, 0 ], edges = {}, edge1, edge2;\r\n\t\tvar key, keys = [ 'a', 'b', 'c' ];\r\n\r\n\t\t// prepare source geometry\r\n\r\n\t\tvar geometry2;\r\n\r\n\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\tgeometry2 = new Geometry();\r\n\t\t\tgeometry2.fromBufferGeometry( geometry );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tgeometry2 = geometry.clone();\r\n\r\n\t\t}\r\n\r\n\t\tgeometry2.mergeVertices();\r\n\t\tgeometry2.computeFaceNormals();\r\n\r\n\t\tvar sourceVertices = geometry2.vertices;\r\n\t\tvar faces = geometry2.faces;\r\n\r\n\t\t// now create a data structure where each entry represents an edge with its adjoining faces\r\n\r\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar face = faces[ i ];\r\n\r\n\t\t\tfor ( var j = 0; j < 3; j ++ ) {\r\n\r\n\t\t\t\tedge1 = face[ keys[ j ] ];\r\n\t\t\t\tedge2 = face[ keys[ ( j + 1 ) % 3 ] ];\r\n\t\t\t\tedge[ 0 ] = Math.min( edge1, edge2 );\r\n\t\t\t\tedge[ 1 ] = Math.max( edge1, edge2 );\r\n\r\n\t\t\t\tkey = edge[ 0 ] + ',' + edge[ 1 ];\r\n\r\n\t\t\t\tif ( edges[ key ] === undefined ) {\r\n\r\n\t\t\t\t\tedges[ key ] = { index1: edge[ 0 ], index2: edge[ 1 ], face1: i, face2: undefined };\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tedges[ key ].face2 = i;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// generate vertices\r\n\r\n\t\tfor ( key in edges ) {\r\n\r\n\t\t\tvar e = edges[ key ];\r\n\r\n\t\t\t// an edge is only rendered if the angle (in degrees) between the face normals of the adjoining faces exceeds this value. default = 1 degree.\r\n\r\n\t\t\tif ( e.face2 === undefined || faces[ e.face1 ].normal.dot( faces[ e.face2 ].normal ) <= thresholdDot ) {\r\n\r\n\t\t\t\tvar vertex = sourceVertices[ e.index1 ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\tvertex = sourceVertices[ e.index2 ];\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\r\n\t}\r\n\r\n\tEdgesGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tEdgesGeometry.prototype.constructor = EdgesGeometry;\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\t// CylinderGeometry\r\n\r\n\tfunction CylinderGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'CylinderGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradiusTop: radiusTop,\r\n\t\t\tradiusBottom: radiusBottom,\r\n\t\t\theight: height,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\topenEnded: openEnded,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new CylinderBufferGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tCylinderGeometry.prototype = Object.create( Geometry.prototype );\r\n\tCylinderGeometry.prototype.constructor = CylinderGeometry;\r\n\r\n\t// CylinderBufferGeometry\r\n\r\n\tfunction CylinderBufferGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'CylinderBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradiusTop: radiusTop,\r\n\t\t\tradiusBottom: radiusBottom,\r\n\t\t\theight: height,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\topenEnded: openEnded,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tradiusTop = radiusTop !== undefined ? radiusTop : 1;\r\n\t\tradiusBottom = radiusBottom !== undefined ? radiusBottom : 1;\r\n\t\theight = height || 1;\r\n\r\n\t\tradialSegments = Math.floor( radialSegments ) || 8;\r\n\t\theightSegments = Math.floor( heightSegments ) || 1;\r\n\r\n\t\topenEnded = openEnded !== undefined ? openEnded : false;\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0.0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar index = 0;\r\n\t\tvar indexArray = [];\r\n\t\tvar halfHeight = height / 2;\r\n\t\tvar groupStart = 0;\r\n\r\n\t\t// generate geometry\r\n\r\n\t\tgenerateTorso();\r\n\r\n\t\tif ( openEnded === false ) {\r\n\r\n\t\t\tif ( radiusTop > 0 ) { generateCap( true ); }\r\n\t\t\tif ( radiusBottom > 0 ) { generateCap( false ); }\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t\tfunction generateTorso() {\r\n\r\n\t\t\tvar x, y;\r\n\t\t\tvar normal = new Vector3();\r\n\t\t\tvar vertex = new Vector3();\r\n\r\n\t\t\tvar groupCount = 0;\r\n\r\n\t\t\t// this will be used to calculate the normal\r\n\t\t\tvar slope = ( radiusBottom - radiusTop ) / height;\r\n\r\n\t\t\t// generate vertices, normals and uvs\r\n\r\n\t\t\tfor ( y = 0; y <= heightSegments; y ++ ) {\r\n\r\n\t\t\t\tvar indexRow = [];\r\n\r\n\t\t\t\tvar v = y / heightSegments;\r\n\r\n\t\t\t\t// calculate the radius of the current row\r\n\r\n\t\t\t\tvar radius = v * ( radiusBottom - radiusTop ) + radiusTop;\r\n\r\n\t\t\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t\t\tvar u = x / radialSegments;\r\n\r\n\t\t\t\t\tvar theta = u * thetaLength + thetaStart;\r\n\r\n\t\t\t\t\tvar sinTheta = Math.sin( theta );\r\n\t\t\t\t\tvar cosTheta = Math.cos( theta );\r\n\r\n\t\t\t\t\t// vertex\r\n\r\n\t\t\t\t\tvertex.x = radius * sinTheta;\r\n\t\t\t\t\tvertex.y = - v * height + halfHeight;\r\n\t\t\t\t\tvertex.z = radius * cosTheta;\r\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t\t// normal\r\n\r\n\t\t\t\t\tnormal.set( sinTheta, slope, cosTheta ).normalize();\r\n\t\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\r\n\r\n\t\t\t\t\t// uv\r\n\r\n\t\t\t\t\tuvs.push( u, 1 - v );\r\n\r\n\t\t\t\t\t// save index of vertex in respective row\r\n\r\n\t\t\t\t\tindexRow.push( index ++ );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// now save vertices of the row in our index array\r\n\r\n\t\t\t\tindexArray.push( indexRow );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// generate indices\r\n\r\n\t\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\t\tfor ( y = 0; y < heightSegments; y ++ ) {\r\n\r\n\t\t\t\t\t// we use the index array to access the correct indices\r\n\r\n\t\t\t\t\tvar a = indexArray[ y ][ x ];\r\n\t\t\t\t\tvar b = indexArray[ y + 1 ][ x ];\r\n\t\t\t\t\tvar c = indexArray[ y + 1 ][ x + 1 ];\r\n\t\t\t\t\tvar d = indexArray[ y ][ x + 1 ];\r\n\r\n\t\t\t\t\t// faces\r\n\r\n\t\t\t\t\tindices.push( a, b, d );\r\n\t\t\t\t\tindices.push( b, c, d );\r\n\r\n\t\t\t\t\t// update group counter\r\n\r\n\t\t\t\t\tgroupCount += 6;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// add a group to the geometry. this will ensure multi material support\r\n\r\n\t\t\tscope.addGroup( groupStart, groupCount, 0 );\r\n\r\n\t\t\t// calculate new start value for groups\r\n\r\n\t\t\tgroupStart += groupCount;\r\n\r\n\t\t}\r\n\r\n\t\tfunction generateCap( top ) {\r\n\r\n\t\t\tvar x, centerIndexStart, centerIndexEnd;\r\n\r\n\t\t\tvar uv = new Vector2();\r\n\t\t\tvar vertex = new Vector3();\r\n\r\n\t\t\tvar groupCount = 0;\r\n\r\n\t\t\tvar radius = ( top === true ) ? radiusTop : radiusBottom;\r\n\t\t\tvar sign = ( top === true ) ? 1 : - 1;\r\n\r\n\t\t\t// save the index of the first center vertex\r\n\t\t\tcenterIndexStart = index;\r\n\r\n\t\t\t// first we generate the center vertex data of the cap.\r\n\t\t\t// because the geometry needs one set of uvs per face,\r\n\t\t\t// we must generate a center vertex per face/segment\r\n\r\n\t\t\tfor ( x = 1; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertices.push( 0, halfHeight * sign, 0 );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormals.push( 0, sign, 0 );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuvs.push( 0.5, 0.5 );\r\n\r\n\t\t\t\t// increase index\r\n\r\n\t\t\t\tindex ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// save the index of the last center vertex\r\n\r\n\t\t\tcenterIndexEnd = index;\r\n\r\n\t\t\t// now we generate the surrounding vertices, normals and uvs\r\n\r\n\t\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\r\n\r\n\t\t\t\tvar u = x / radialSegments;\r\n\t\t\t\tvar theta = u * thetaLength + thetaStart;\r\n\r\n\t\t\t\tvar cosTheta = Math.cos( theta );\r\n\t\t\t\tvar sinTheta = Math.sin( theta );\r\n\r\n\t\t\t\t// vertex\r\n\r\n\t\t\t\tvertex.x = radius * sinTheta;\r\n\t\t\t\tvertex.y = halfHeight * sign;\r\n\t\t\t\tvertex.z = radius * cosTheta;\r\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t\t// normal\r\n\r\n\t\t\t\tnormals.push( 0, sign, 0 );\r\n\r\n\t\t\t\t// uv\r\n\r\n\t\t\t\tuv.x = ( cosTheta * 0.5 ) + 0.5;\r\n\t\t\t\tuv.y = ( sinTheta * 0.5 * sign ) + 0.5;\r\n\t\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t\t\t// increase index\r\n\r\n\t\t\t\tindex ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// generate indices\r\n\r\n\t\t\tfor ( x = 0; x < radialSegments; x ++ ) {\r\n\r\n\t\t\t\tvar c = centerIndexStart + x;\r\n\t\t\t\tvar i = centerIndexEnd + x;\r\n\r\n\t\t\t\tif ( top === true ) {\r\n\r\n\t\t\t\t\t// face top\r\n\r\n\t\t\t\t\tindices.push( i, i + 1, c );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// face bottom\r\n\r\n\t\t\t\t\tindices.push( i + 1, i, c );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgroupCount += 3;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// add a group to the geometry. this will ensure multi material support\r\n\r\n\t\t\tscope.addGroup( groupStart, groupCount, top === true ? 1 : 2 );\r\n\r\n\t\t\t// calculate new start value for groups\r\n\r\n\t\t\tgroupStart += groupCount;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tCylinderBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tCylinderBufferGeometry.prototype.constructor = CylinderBufferGeometry;\r\n\r\n\t/**\r\n\t * @author abelnation / http://github.com/abelnation\r\n\t */\r\n\r\n\t// ConeGeometry\r\n\r\n\tfunction ConeGeometry( radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\t\tCylinderGeometry.call( this, 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\r\n\r\n\t\tthis.type = 'ConeGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\theight: height,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\topenEnded: openEnded,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tConeGeometry.prototype = Object.create( CylinderGeometry.prototype );\r\n\tConeGeometry.prototype.constructor = ConeGeometry;\r\n\r\n\t// ConeBufferGeometry\r\n\r\n\tfunction ConeBufferGeometry( radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\r\n\r\n\t\tCylinderBufferGeometry.call( this, 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\r\n\r\n\t\tthis.type = 'ConeBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\theight: height,\r\n\t\t\tradialSegments: radialSegments,\r\n\t\t\theightSegments: heightSegments,\r\n\t\t\topenEnded: openEnded,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tConeBufferGeometry.prototype = Object.create( CylinderBufferGeometry.prototype );\r\n\tConeBufferGeometry.prototype.constructor = ConeBufferGeometry;\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t * @author hughes\r\n\t */\r\n\r\n\t// CircleGeometry\r\n\r\n\tfunction CircleGeometry( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\t\tGeometry.call( this );\r\n\r\n\t\tthis.type = 'CircleGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tsegments: segments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tthis.fromBufferGeometry( new CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) );\r\n\t\tthis.mergeVertices();\r\n\r\n\t}\r\n\r\n\tCircleGeometry.prototype = Object.create( Geometry.prototype );\r\n\tCircleGeometry.prototype.constructor = CircleGeometry;\r\n\r\n\t// CircleBufferGeometry\r\n\r\n\tfunction CircleBufferGeometry( radius, segments, thetaStart, thetaLength ) {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'CircleBufferGeometry';\r\n\r\n\t\tthis.parameters = {\r\n\t\t\tradius: radius,\r\n\t\t\tsegments: segments,\r\n\t\t\tthetaStart: thetaStart,\r\n\t\t\tthetaLength: thetaLength\r\n\t\t};\r\n\r\n\t\tradius = radius || 1;\r\n\t\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\r\n\r\n\t\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\r\n\t\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\r\n\r\n\t\t// buffers\r\n\r\n\t\tvar indices = [];\r\n\t\tvar vertices = [];\r\n\t\tvar normals = [];\r\n\t\tvar uvs = [];\r\n\r\n\t\t// helper variables\r\n\r\n\t\tvar i, s;\r\n\t\tvar vertex = new Vector3();\r\n\t\tvar uv = new Vector2();\r\n\r\n\t\t// center point\r\n\r\n\t\tvertices.push( 0, 0, 0 );\r\n\t\tnormals.push( 0, 0, 1 );\r\n\t\tuvs.push( 0.5, 0.5 );\r\n\r\n\t\tfor ( s = 0, i = 3; s <= segments; s ++, i += 3 ) {\r\n\r\n\t\t\tvar segment = thetaStart + s / segments * thetaLength;\r\n\r\n\t\t\t// vertex\r\n\r\n\t\t\tvertex.x = radius * Math.cos( segment );\r\n\t\t\tvertex.y = radius * Math.sin( segment );\r\n\r\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\r\n\r\n\t\t\t// normal\r\n\r\n\t\t\tnormals.push( 0, 0, 1 );\r\n\r\n\t\t\t// uvs\r\n\r\n\t\t\tuv.x = ( vertices[ i ] / radius + 1 ) / 2;\r\n\t\t\tuv.y = ( vertices[ i + 1 ] / radius + 1 ) / 2;\r\n\r\n\t\t\tuvs.push( uv.x, uv.y );\r\n\r\n\t\t}\r\n\r\n\t\t// indices\r\n\r\n\t\tfor ( i = 1; i <= segments; i ++ ) {\r\n\r\n\t\t\tindices.push( i, i + 1, 0 );\r\n\r\n\t\t}\r\n\r\n\t\t// build geometry\r\n\r\n\t\tthis.setIndex( indices );\r\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\r\n\r\n\t}\r\n\r\n\tCircleBufferGeometry.prototype = Object.create( BufferGeometry.prototype );\r\n\tCircleBufferGeometry.prototype.constructor = CircleBufferGeometry;\r\n\r\n\r\n\r\n\tvar Geometries = /*#__PURE__*/Object.freeze({\r\n\t\t__proto__: null,\r\n\t\tWireframeGeometry: WireframeGeometry,\r\n\t\tParametricGeometry: ParametricGeometry,\r\n\t\tParametricBufferGeometry: ParametricBufferGeometry,\r\n\t\tTetrahedronGeometry: TetrahedronGeometry,\r\n\t\tTetrahedronBufferGeometry: TetrahedronBufferGeometry,\r\n\t\tOctahedronGeometry: OctahedronGeometry,\r\n\t\tOctahedronBufferGeometry: OctahedronBufferGeometry,\r\n\t\tIcosahedronGeometry: IcosahedronGeometry,\r\n\t\tIcosahedronBufferGeometry: IcosahedronBufferGeometry,\r\n\t\tDodecahedronGeometry: DodecahedronGeometry,\r\n\t\tDodecahedronBufferGeometry: DodecahedronBufferGeometry,\r\n\t\tPolyhedronGeometry: PolyhedronGeometry,\r\n\t\tPolyhedronBufferGeometry: PolyhedronBufferGeometry,\r\n\t\tTubeGeometry: TubeGeometry,\r\n\t\tTubeBufferGeometry: TubeBufferGeometry,\r\n\t\tTorusKnotGeometry: TorusKnotGeometry,\r\n\t\tTorusKnotBufferGeometry: TorusKnotBufferGeometry,\r\n\t\tTorusGeometry: TorusGeometry,\r\n\t\tTorusBufferGeometry: TorusBufferGeometry,\r\n\t\tTextGeometry: TextGeometry,\r\n\t\tTextBufferGeometry: TextBufferGeometry,\r\n\t\tSphereGeometry: SphereGeometry,\r\n\t\tSphereBufferGeometry: SphereBufferGeometry,\r\n\t\tRingGeometry: RingGeometry,\r\n\t\tRingBufferGeometry: RingBufferGeometry,\r\n\t\tPlaneGeometry: PlaneGeometry,\r\n\t\tPlaneBufferGeometry: PlaneBufferGeometry,\r\n\t\tLatheGeometry: LatheGeometry,\r\n\t\tLatheBufferGeometry: LatheBufferGeometry,\r\n\t\tShapeGeometry: ShapeGeometry,\r\n\t\tShapeBufferGeometry: ShapeBufferGeometry,\r\n\t\tExtrudeGeometry: ExtrudeGeometry,\r\n\t\tExtrudeBufferGeometry: ExtrudeBufferGeometry,\r\n\t\tEdgesGeometry: EdgesGeometry,\r\n\t\tConeGeometry: ConeGeometry,\r\n\t\tConeBufferGeometry: ConeBufferGeometry,\r\n\t\tCylinderGeometry: CylinderGeometry,\r\n\t\tCylinderBufferGeometry: CylinderBufferGeometry,\r\n\t\tCircleGeometry: CircleGeometry,\r\n\t\tCircleBufferGeometry: CircleBufferGeometry,\r\n\t\tBoxGeometry: BoxGeometry,\r\n\t\tBoxBufferGeometry: BoxBufferGeometry\r\n\t});\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <THREE.Color>\r\n\t * }\r\n\t */\r\n\r\n\tfunction ShadowMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'ShadowMaterial';\r\n\r\n\t\tthis.color = new Color( 0x000000 );\r\n\t\tthis.transparent = true;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tShadowMaterial.prototype = Object.create( Material.prototype );\r\n\tShadowMaterial.prototype.constructor = ShadowMaterial;\r\n\r\n\tShadowMaterial.prototype.isShadowMaterial = true;\r\n\r\n\tShadowMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction RawShaderMaterial( parameters ) {\r\n\r\n\t\tShaderMaterial.call( this, parameters );\r\n\r\n\t\tthis.type = 'RawShaderMaterial';\r\n\r\n\t}\r\n\r\n\tRawShaderMaterial.prototype = Object.create( ShaderMaterial.prototype );\r\n\tRawShaderMaterial.prototype.constructor = RawShaderMaterial;\r\n\r\n\tRawShaderMaterial.prototype.isRawShaderMaterial = true;\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  roughness: <float>,\r\n\t *  metalness: <float>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  emissive: <hex>,\r\n\t *  emissiveIntensity: <float>\r\n\t *  emissiveMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  bumpMap: new THREE.Texture( <Image> ),\r\n\t *  bumpScale: <float>,\r\n\t *\r\n\t *  normalMap: new THREE.Texture( <Image> ),\r\n\t *  normalMapType: THREE.TangentSpaceNormalMap,\r\n\t *  normalScale: <Vector2>,\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  roughnessMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  metalnessMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  envMapIntensity: <float>\r\n\t *\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshStandardMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.defines = { 'STANDARD': '' };\r\n\r\n\t\tthis.type = 'MeshStandardMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff ); // diffuse\r\n\t\tthis.roughness = 1.0;\r\n\t\tthis.metalness = 0.0;\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\r\n\t\tthis.emissive = new Color( 0x000000 );\r\n\t\tthis.emissiveIntensity = 1.0;\r\n\t\tthis.emissiveMap = null;\r\n\r\n\t\tthis.bumpMap = null;\r\n\t\tthis.bumpScale = 1;\r\n\r\n\t\tthis.normalMap = null;\r\n\t\tthis.normalMapType = TangentSpaceNormalMap;\r\n\t\tthis.normalScale = new Vector2( 1, 1 );\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.roughnessMap = null;\r\n\r\n\t\tthis.metalnessMap = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.envMap = null;\r\n\t\tthis.envMapIntensity = 1.0;\r\n\r\n\t\tthis.refractionRatio = 0.98;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.vertexTangents = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshStandardMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshStandardMaterial.prototype.constructor = MeshStandardMaterial;\r\n\r\n\tMeshStandardMaterial.prototype.isMeshStandardMaterial = true;\r\n\r\n\tMeshStandardMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.defines = { 'STANDARD': '' };\r\n\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.roughness = source.roughness;\r\n\t\tthis.metalness = source.metalness;\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\t\tthis.emissive.copy( source.emissive );\r\n\t\tthis.emissiveMap = source.emissiveMap;\r\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\t\tthis.bumpMap = source.bumpMap;\r\n\t\tthis.bumpScale = source.bumpScale;\r\n\r\n\t\tthis.normalMap = source.normalMap;\r\n\t\tthis.normalMapType = source.normalMapType;\r\n\t\tthis.normalScale.copy( source.normalScale );\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.roughnessMap = source.roughnessMap;\r\n\r\n\t\tthis.metalnessMap = source.metalnessMap;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.envMapIntensity = source.envMapIntensity;\r\n\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\tthis.vertexTangents = source.vertexTangents;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *  clearcoat: <float>,\r\n\t *  clearcoatMap: new THREE.Texture( <Image> ),\r\n\t *  clearcoatRoughness: <float>,\r\n\t *  clearcoatRoughnessMap: new THREE.Texture( <Image> ),\r\n\t *  clearcoatNormalScale: <Vector2>,\r\n\t *  clearcoatNormalMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  reflectivity: <float>,\r\n\t *\r\n\t *  sheen: <Color>,\r\n\t *\r\n\t *  transparency: <float>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshPhysicalMaterial( parameters ) {\r\n\r\n\t\tMeshStandardMaterial.call( this );\r\n\r\n\t\tthis.defines = {\r\n\r\n\t\t\t'STANDARD': '',\r\n\t\t\t'PHYSICAL': ''\r\n\r\n\t\t};\r\n\r\n\t\tthis.type = 'MeshPhysicalMaterial';\r\n\r\n\t\tthis.clearcoat = 0.0;\r\n\t\tthis.clearcoatMap = null;\r\n\t\tthis.clearcoatRoughness = 0.0;\r\n\t\tthis.clearcoatRoughnessMap = null;\r\n\t\tthis.clearcoatNormalScale = new Vector2( 1, 1 );\r\n\t\tthis.clearcoatNormalMap = null;\r\n\r\n\t\tthis.reflectivity = 0.5; // maps to F0 = 0.04\r\n\r\n\t\tthis.sheen = null; // null will disable sheen bsdf\r\n\r\n\t\tthis.transparency = 0.0;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshPhysicalMaterial.prototype = Object.create( MeshStandardMaterial.prototype );\r\n\tMeshPhysicalMaterial.prototype.constructor = MeshPhysicalMaterial;\r\n\r\n\tMeshPhysicalMaterial.prototype.isMeshPhysicalMaterial = true;\r\n\r\n\tMeshPhysicalMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMeshStandardMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.defines = {\r\n\r\n\t\t\t'STANDARD': '',\r\n\t\t\t'PHYSICAL': ''\r\n\r\n\t\t};\r\n\r\n\t\tthis.clearcoat = source.clearcoat;\r\n\t\tthis.clearcoatMap = source.clearcoatMap;\r\n\t\tthis.clearcoatRoughness = source.clearcoatRoughness;\r\n\t\tthis.clearcoatRoughnessMap = source.clearcoatRoughnessMap;\r\n\t\tthis.clearcoatNormalMap = source.clearcoatNormalMap;\r\n\t\tthis.clearcoatNormalScale.copy( source.clearcoatNormalScale );\r\n\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\r\n\t\tif ( source.sheen ) {\r\n\r\n\t\t\tthis.sheen = ( this.sheen || new Color() ).copy( source.sheen );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.sheen = null;\r\n\r\n\t\t}\r\n\r\n\t\tthis.transparency = source.transparency;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  specular: <hex>,\r\n\t *  shininess: <float>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  emissive: <hex>,\r\n\t *  emissiveIntensity: <float>\r\n\t *  emissiveMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  bumpMap: new THREE.Texture( <Image> ),\r\n\t *  bumpScale: <float>,\r\n\t *\r\n\t *  normalMap: new THREE.Texture( <Image> ),\r\n\t *  normalMapType: THREE.TangentSpaceNormalMap,\r\n\t *  normalScale: <Vector2>,\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  combine: THREE.MultiplyOperation,\r\n\t *  reflectivity: <float>,\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshPhongMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshPhongMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff ); // diffuse\r\n\t\tthis.specular = new Color( 0x111111 );\r\n\t\tthis.shininess = 30;\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\r\n\t\tthis.emissive = new Color( 0x000000 );\r\n\t\tthis.emissiveIntensity = 1.0;\r\n\t\tthis.emissiveMap = null;\r\n\r\n\t\tthis.bumpMap = null;\r\n\t\tthis.bumpScale = 1;\r\n\r\n\t\tthis.normalMap = null;\r\n\t\tthis.normalMapType = TangentSpaceNormalMap;\r\n\t\tthis.normalScale = new Vector2( 1, 1 );\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.specularMap = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.envMap = null;\r\n\t\tthis.combine = MultiplyOperation;\r\n\t\tthis.reflectivity = 1;\r\n\t\tthis.refractionRatio = 0.98;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshPhongMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshPhongMaterial.prototype.constructor = MeshPhongMaterial;\r\n\r\n\tMeshPhongMaterial.prototype.isMeshPhongMaterial = true;\r\n\r\n\tMeshPhongMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.specular.copy( source.specular );\r\n\t\tthis.shininess = source.shininess;\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\t\tthis.emissive.copy( source.emissive );\r\n\t\tthis.emissiveMap = source.emissiveMap;\r\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\t\tthis.bumpMap = source.bumpMap;\r\n\t\tthis.bumpScale = source.bumpScale;\r\n\r\n\t\tthis.normalMap = source.normalMap;\r\n\t\tthis.normalMapType = source.normalMapType;\r\n\t\tthis.normalScale.copy( source.normalScale );\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.specularMap = source.specularMap;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.combine = source.combine;\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author takahirox / http://github.com/takahirox\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  specular: <hex>,\r\n\t *  shininess: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *  gradientMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  emissive: <hex>,\r\n\t *  emissiveIntensity: <float>\r\n\t *  emissiveMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  bumpMap: new THREE.Texture( <Image> ),\r\n\t *  bumpScale: <float>,\r\n\t *\r\n\t *  normalMap: new THREE.Texture( <Image> ),\r\n\t *  normalMapType: THREE.TangentSpaceNormalMap,\r\n\t *  normalScale: <Vector2>,\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshToonMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.defines = { 'TOON': '' };\r\n\r\n\t\tthis.type = 'MeshToonMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff );\r\n\t\tthis.specular = new Color( 0x111111 );\r\n\t\tthis.shininess = 30;\r\n\r\n\t\tthis.map = null;\r\n\t\tthis.gradientMap = null;\r\n\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\r\n\t\tthis.emissive = new Color( 0x000000 );\r\n\t\tthis.emissiveIntensity = 1.0;\r\n\t\tthis.emissiveMap = null;\r\n\r\n\t\tthis.bumpMap = null;\r\n\t\tthis.bumpScale = 1;\r\n\r\n\t\tthis.normalMap = null;\r\n\t\tthis.normalMapType = TangentSpaceNormalMap;\r\n\t\tthis.normalScale = new Vector2( 1, 1 );\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.specularMap = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshToonMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshToonMaterial.prototype.constructor = MeshToonMaterial;\r\n\r\n\tMeshToonMaterial.prototype.isMeshToonMaterial = true;\r\n\r\n\tMeshToonMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\t\tthis.specular.copy( source.specular );\r\n\t\tthis.shininess = source.shininess;\r\n\r\n\t\tthis.map = source.map;\r\n\t\tthis.gradientMap = source.gradientMap;\r\n\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\t\tthis.emissive.copy( source.emissive );\r\n\t\tthis.emissiveMap = source.emissiveMap;\r\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\t\tthis.bumpMap = source.bumpMap;\r\n\t\tthis.bumpScale = source.bumpScale;\r\n\r\n\t\tthis.normalMap = source.normalMap;\r\n\t\tthis.normalMapType = source.normalMapType;\r\n\t\tthis.normalScale.copy( source.normalScale );\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.specularMap = source.specularMap;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  bumpMap: new THREE.Texture( <Image> ),\r\n\t *  bumpScale: <float>,\r\n\t *\r\n\t *  normalMap: new THREE.Texture( <Image> ),\r\n\t *  normalMapType: THREE.TangentSpaceNormalMap,\r\n\t *  normalScale: <Vector2>,\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshNormalMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshNormalMaterial';\r\n\r\n\t\tthis.bumpMap = null;\r\n\t\tthis.bumpScale = 1;\r\n\r\n\t\tthis.normalMap = null;\r\n\t\tthis.normalMapType = TangentSpaceNormalMap;\r\n\t\tthis.normalScale = new Vector2( 1, 1 );\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\r\n\t\tthis.fog = false;\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshNormalMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshNormalMaterial.prototype.constructor = MeshNormalMaterial;\r\n\r\n\tMeshNormalMaterial.prototype.isMeshNormalMaterial = true;\r\n\r\n\tMeshNormalMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.bumpMap = source.bumpMap;\r\n\t\tthis.bumpScale = source.bumpScale;\r\n\r\n\t\tthis.normalMap = source.normalMap;\r\n\t\tthis.normalMapType = source.normalMapType;\r\n\t\tthis.normalScale.copy( source.normalScale );\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  lightMap: new THREE.Texture( <Image> ),\r\n\t *  lightMapIntensity: <float>\r\n\t *\r\n\t *  aoMap: new THREE.Texture( <Image> ),\r\n\t *  aoMapIntensity: <float>\r\n\t *\r\n\t *  emissive: <hex>,\r\n\t *  emissiveIntensity: <float>\r\n\t *  emissiveMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  specularMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  envMap: new THREE.CubeTexture( [posx, negx, posy, negy, posz, negz] ),\r\n\t *  combine: THREE.Multiply,\r\n\t *  reflectivity: <float>,\r\n\t *  refractionRatio: <float>,\r\n\t *\r\n\t *  wireframe: <boolean>,\r\n\t *  wireframeLinewidth: <float>,\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshLambertMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.type = 'MeshLambertMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff ); // diffuse\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.lightMap = null;\r\n\t\tthis.lightMapIntensity = 1.0;\r\n\r\n\t\tthis.aoMap = null;\r\n\t\tthis.aoMapIntensity = 1.0;\r\n\r\n\t\tthis.emissive = new Color( 0x000000 );\r\n\t\tthis.emissiveIntensity = 1.0;\r\n\t\tthis.emissiveMap = null;\r\n\r\n\t\tthis.specularMap = null;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.envMap = null;\r\n\t\tthis.combine = MultiplyOperation;\r\n\t\tthis.reflectivity = 1;\r\n\t\tthis.refractionRatio = 0.98;\r\n\r\n\t\tthis.wireframe = false;\r\n\t\tthis.wireframeLinewidth = 1;\r\n\t\tthis.wireframeLinecap = 'round';\r\n\t\tthis.wireframeLinejoin = 'round';\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshLambertMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshLambertMaterial.prototype.constructor = MeshLambertMaterial;\r\n\r\n\tMeshLambertMaterial.prototype.isMeshLambertMaterial = true;\r\n\r\n\tMeshLambertMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.lightMap = source.lightMap;\r\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\r\n\r\n\t\tthis.aoMap = source.aoMap;\r\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\r\n\r\n\t\tthis.emissive.copy( source.emissive );\r\n\t\tthis.emissiveMap = source.emissiveMap;\r\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\r\n\r\n\t\tthis.specularMap = source.specularMap;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.envMap = source.envMap;\r\n\t\tthis.combine = source.combine;\r\n\t\tthis.reflectivity = source.reflectivity;\r\n\t\tthis.refractionRatio = source.refractionRatio;\r\n\r\n\t\tthis.wireframe = source.wireframe;\r\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\r\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\r\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  matcap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  map: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  bumpMap: new THREE.Texture( <Image> ),\r\n\t *  bumpScale: <float>,\r\n\t *\r\n\t *  normalMap: new THREE.Texture( <Image> ),\r\n\t *  normalMapType: THREE.TangentSpaceNormalMap,\r\n\t *  normalScale: <Vector2>,\r\n\t *\r\n\t *  displacementMap: new THREE.Texture( <Image> ),\r\n\t *  displacementScale: <float>,\r\n\t *  displacementBias: <float>,\r\n\t *\r\n\t *  alphaMap: new THREE.Texture( <Image> ),\r\n\t *\r\n\t *  skinning: <bool>,\r\n\t *  morphTargets: <bool>,\r\n\t *  morphNormals: <bool>\r\n\t * }\r\n\t */\r\n\r\n\tfunction MeshMatcapMaterial( parameters ) {\r\n\r\n\t\tMaterial.call( this );\r\n\r\n\t\tthis.defines = { 'MATCAP': '' };\r\n\r\n\t\tthis.type = 'MeshMatcapMaterial';\r\n\r\n\t\tthis.color = new Color( 0xffffff ); // diffuse\r\n\r\n\t\tthis.matcap = null;\r\n\r\n\t\tthis.map = null;\r\n\r\n\t\tthis.bumpMap = null;\r\n\t\tthis.bumpScale = 1;\r\n\r\n\t\tthis.normalMap = null;\r\n\t\tthis.normalMapType = TangentSpaceNormalMap;\r\n\t\tthis.normalScale = new Vector2( 1, 1 );\r\n\r\n\t\tthis.displacementMap = null;\r\n\t\tthis.displacementScale = 1;\r\n\t\tthis.displacementBias = 0;\r\n\r\n\t\tthis.alphaMap = null;\r\n\r\n\t\tthis.skinning = false;\r\n\t\tthis.morphTargets = false;\r\n\t\tthis.morphNormals = false;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tMeshMatcapMaterial.prototype = Object.create( Material.prototype );\r\n\tMeshMatcapMaterial.prototype.constructor = MeshMatcapMaterial;\r\n\r\n\tMeshMatcapMaterial.prototype.isMeshMatcapMaterial = true;\r\n\r\n\tMeshMatcapMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.defines = { 'MATCAP': '' };\r\n\r\n\t\tthis.color.copy( source.color );\r\n\r\n\t\tthis.matcap = source.matcap;\r\n\r\n\t\tthis.map = source.map;\r\n\r\n\t\tthis.bumpMap = source.bumpMap;\r\n\t\tthis.bumpScale = source.bumpScale;\r\n\r\n\t\tthis.normalMap = source.normalMap;\r\n\t\tthis.normalMapType = source.normalMapType;\r\n\t\tthis.normalScale.copy( source.normalScale );\r\n\r\n\t\tthis.displacementMap = source.displacementMap;\r\n\t\tthis.displacementScale = source.displacementScale;\r\n\t\tthis.displacementBias = source.displacementBias;\r\n\r\n\t\tthis.alphaMap = source.alphaMap;\r\n\r\n\t\tthis.skinning = source.skinning;\r\n\t\tthis.morphTargets = source.morphTargets;\r\n\t\tthis.morphNormals = source.morphNormals;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t *\r\n\t * parameters = {\r\n\t *  color: <hex>,\r\n\t *  opacity: <float>,\r\n\t *\r\n\t *  linewidth: <float>,\r\n\t *\r\n\t *  scale: <float>,\r\n\t *  dashSize: <float>,\r\n\t *  gapSize: <float>\r\n\t * }\r\n\t */\r\n\r\n\tfunction LineDashedMaterial( parameters ) {\r\n\r\n\t\tLineBasicMaterial.call( this );\r\n\r\n\t\tthis.type = 'LineDashedMaterial';\r\n\r\n\t\tthis.scale = 1;\r\n\t\tthis.dashSize = 3;\r\n\t\tthis.gapSize = 1;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t}\r\n\r\n\tLineDashedMaterial.prototype = Object.create( LineBasicMaterial.prototype );\r\n\tLineDashedMaterial.prototype.constructor = LineDashedMaterial;\r\n\r\n\tLineDashedMaterial.prototype.isLineDashedMaterial = true;\r\n\r\n\tLineDashedMaterial.prototype.copy = function ( source ) {\r\n\r\n\t\tLineBasicMaterial.prototype.copy.call( this, source );\r\n\r\n\t\tthis.scale = source.scale;\r\n\t\tthis.dashSize = source.dashSize;\r\n\t\tthis.gapSize = source.gapSize;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\r\n\tvar Materials = /*#__PURE__*/Object.freeze({\r\n\t\t__proto__: null,\r\n\t\tShadowMaterial: ShadowMaterial,\r\n\t\tSpriteMaterial: SpriteMaterial,\r\n\t\tRawShaderMaterial: RawShaderMaterial,\r\n\t\tShaderMaterial: ShaderMaterial,\r\n\t\tPointsMaterial: PointsMaterial,\r\n\t\tMeshPhysicalMaterial: MeshPhysicalMaterial,\r\n\t\tMeshStandardMaterial: MeshStandardMaterial,\r\n\t\tMeshPhongMaterial: MeshPhongMaterial,\r\n\t\tMeshToonMaterial: MeshToonMaterial,\r\n\t\tMeshNormalMaterial: MeshNormalMaterial,\r\n\t\tMeshLambertMaterial: MeshLambertMaterial,\r\n\t\tMeshDepthMaterial: MeshDepthMaterial,\r\n\t\tMeshDistanceMaterial: MeshDistanceMaterial,\r\n\t\tMeshBasicMaterial: MeshBasicMaterial,\r\n\t\tMeshMatcapMaterial: MeshMatcapMaterial,\r\n\t\tLineDashedMaterial: LineDashedMaterial,\r\n\t\tLineBasicMaterial: LineBasicMaterial,\r\n\t\tMaterial: Material\r\n\t});\r\n\r\n\t/**\r\n\t * @author tschw\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\r\n\tvar AnimationUtils = {\r\n\r\n\t\t// same as Array.prototype.slice, but also works on typed arrays\r\n\t\tarraySlice: function ( array, from, to ) {\r\n\r\n\t\t\tif ( AnimationUtils.isTypedArray( array ) ) {\r\n\r\n\t\t\t\t// in ios9 array.subarray(from, undefined) will return empty array\r\n\t\t\t\t// but array.subarray(from) or array.subarray(from, len) is correct\r\n\t\t\t\treturn new array.constructor( array.subarray( from, to !== undefined ? to : array.length ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array.slice( from, to );\r\n\r\n\t\t},\r\n\r\n\t\t// converts an array to a specific type\r\n\t\tconvertArray: function ( array, type, forceClone ) {\r\n\r\n\t\t\tif ( ! array || // let 'undefined' and 'null' pass\r\n\t\t\t\t! forceClone && array.constructor === type ) { return array; }\r\n\r\n\t\t\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\r\n\r\n\t\t\t\treturn new type( array ); // create typed array\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn Array.prototype.slice.call( array ); // create Array\r\n\r\n\t\t},\r\n\r\n\t\tisTypedArray: function ( object ) {\r\n\r\n\t\t\treturn ArrayBuffer.isView( object ) &&\r\n\t\t\t\t! ( object instanceof DataView );\r\n\r\n\t\t},\r\n\r\n\t\t// returns an array by which times and values can be sorted\r\n\t\tgetKeyframeOrder: function ( times ) {\r\n\r\n\t\t\tfunction compareTime( i, j ) {\r\n\r\n\t\t\t\treturn times[ i ] - times[ j ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar n = times.length;\r\n\t\t\tvar result = new Array( n );\r\n\t\t\tfor ( var i = 0; i !== n; ++ i ) { result[ i ] = i; }\r\n\r\n\t\t\tresult.sort( compareTime );\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t},\r\n\r\n\t\t// uses the array previously returned by 'getKeyframeOrder' to sort data\r\n\t\tsortedArray: function ( values, stride, order ) {\r\n\r\n\t\t\tvar nValues = values.length;\r\n\t\t\tvar result = new values.constructor( nValues );\r\n\r\n\t\t\tfor ( var i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\r\n\r\n\t\t\t\tvar srcOffset = order[ i ] * stride;\r\n\r\n\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t},\r\n\r\n\t\t// function for parsing AOS keyframe formats\r\n\t\tflattenJSON: function ( jsonKeys, times, values, valuePropertyName ) {\r\n\r\n\t\t\tvar i = 1, key = jsonKeys[ 0 ];\r\n\r\n\t\t\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\r\n\r\n\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( key === undefined ) { return; } // no data\r\n\r\n\t\t\tvar value = key[ valuePropertyName ];\r\n\t\t\tif ( value === undefined ) { return; } // no data\r\n\r\n\t\t\tif ( Array.isArray( value ) ) {\r\n\r\n\t\t\t\tdo {\r\n\r\n\t\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\t\tvalues.push.apply( values, value ); // push all elements\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t\t} while ( key !== undefined );\r\n\r\n\t\t\t} else if ( value.toArray !== undefined ) {\r\n\r\n\t\t\t\t// ...assume THREE.Math-ish\r\n\r\n\t\t\t\tdo {\r\n\r\n\t\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\t\tvalue.toArray( values, values.length );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t\t} while ( key !== undefined );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// otherwise push as-is\r\n\r\n\t\t\t\tdo {\r\n\r\n\t\t\t\t\tvalue = key[ valuePropertyName ];\r\n\r\n\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\ttimes.push( key.time );\r\n\t\t\t\t\t\tvalues.push( value );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tkey = jsonKeys[ i ++ ];\r\n\r\n\t\t\t\t} while ( key !== undefined );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tsubclip: function ( sourceClip, name, startFrame, endFrame, fps ) {\r\n\r\n\t\t\tfps = fps || 30;\r\n\r\n\t\t\tvar clip = sourceClip.clone();\r\n\r\n\t\t\tclip.name = name;\r\n\r\n\t\t\tvar tracks = [];\r\n\r\n\t\t\tfor ( var i = 0; i < clip.tracks.length; ++ i ) {\r\n\r\n\t\t\t\tvar track = clip.tracks[ i ];\r\n\t\t\t\tvar valueSize = track.getValueSize();\r\n\r\n\t\t\t\tvar times = [];\r\n\t\t\t\tvar values = [];\r\n\r\n\t\t\t\tfor ( var j = 0; j < track.times.length; ++ j ) {\r\n\r\n\t\t\t\t\tvar frame = track.times[ j ] * fps;\r\n\r\n\t\t\t\t\tif ( frame < startFrame || frame >= endFrame ) { continue; }\r\n\r\n\t\t\t\t\ttimes.push( track.times[ j ] );\r\n\r\n\t\t\t\t\tfor ( var k = 0; k < valueSize; ++ k ) {\r\n\r\n\t\t\t\t\t\tvalues.push( track.values[ j * valueSize + k ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( times.length === 0 ) { continue; }\r\n\r\n\t\t\t\ttrack.times = AnimationUtils.convertArray( times, track.times.constructor );\r\n\t\t\t\ttrack.values = AnimationUtils.convertArray( values, track.values.constructor );\r\n\r\n\t\t\t\ttracks.push( track );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tclip.tracks = tracks;\r\n\r\n\t\t\t// find minimum .times value across all tracks in the trimmed clip\r\n\r\n\t\t\tvar minStartTime = Infinity;\r\n\r\n\t\t\tfor ( var i = 0; i < clip.tracks.length; ++ i ) {\r\n\r\n\t\t\t\tif ( minStartTime > clip.tracks[ i ].times[ 0 ] ) {\r\n\r\n\t\t\t\t\tminStartTime = clip.tracks[ i ].times[ 0 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// shift all tracks such that clip begins at t=0\r\n\r\n\t\t\tfor ( var i = 0; i < clip.tracks.length; ++ i ) {\r\n\r\n\t\t\t\tclip.tracks[ i ].shift( - 1 * minStartTime );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tclip.resetDuration();\r\n\r\n\t\t\treturn clip;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * Abstract base class of interpolants over parametric samples.\r\n\t *\r\n\t * The parameter domain is one dimensional, typically the time or a path\r\n\t * along a curve defined by the data.\r\n\t *\r\n\t * The sample values can have any dimensionality and derived classes may\r\n\t * apply special interpretations to the data.\r\n\t *\r\n\t * This class provides the interval seek in a Template Method, deferring\r\n\t * the actual interpolation to derived classes.\r\n\t *\r\n\t * Time complexity is O(1) for linear access crossing at most two points\r\n\t * and O(log N) for random access, where N is the number of positions.\r\n\t *\r\n\t * References:\r\n\t *\r\n\t * \t\thttp://www.oodesign.com/template-method-pattern.html\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction Interpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tthis.parameterPositions = parameterPositions;\r\n\t\tthis._cachedIndex = 0;\r\n\r\n\t\tthis.resultBuffer = resultBuffer !== undefined ?\r\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\r\n\t\tthis.sampleValues = sampleValues;\r\n\t\tthis.valueSize = sampleSize;\r\n\r\n\t}\r\n\r\n\tObject.assign( Interpolant.prototype, {\r\n\r\n\t\tevaluate: function ( t ) {\r\n\r\n\t\t\tvar pp = this.parameterPositions,\r\n\t\t\t\ti1 = this._cachedIndex,\r\n\r\n\t\t\t\tt1 = pp[ i1 ],\r\n\t\t\t\tt0 = pp[ i1 - 1 ];\r\n\r\n\t\t\tvalidate_interval: {\r\n\r\n\t\t\t\tseek: {\r\n\r\n\t\t\t\t\tvar right;\r\n\r\n\t\t\t\t\tlinear_scan: {\r\n\r\n\t\t\t\t\t\t//- See http://jsperf.com/comparison-to-undefined/3\r\n\t\t\t\t\t\t//- slower code:\r\n\t\t\t\t\t\t//-\r\n\t\t\t\t\t\t//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\r\n\t\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\r\n\r\n\t\t\t\t\t\t\tfor ( var giveUpAt = i1 + 2; ; ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( t1 === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tif ( t < t0 ) { break forward_scan; }\r\n\r\n\t\t\t\t\t\t\t\t\t// after end\r\n\r\n\t\t\t\t\t\t\t\t\ti1 = pp.length;\r\n\t\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\r\n\t\t\t\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t, t0 );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ( i1 === giveUpAt ) { break; } // this loop\r\n\r\n\t\t\t\t\t\t\t\tt0 = t1;\r\n\t\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\r\n\r\n\t\t\t\t\t\t\t\tif ( t < t1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t// we have arrived at the sought interval\r\n\t\t\t\t\t\t\t\t\tbreak seek;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// prepare binary search on the right side of the index\r\n\t\t\t\t\t\t\tright = pp.length;\r\n\t\t\t\t\t\t\tbreak linear_scan;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//- slower code:\r\n\t\t\t\t\t\t//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\r\n\t\t\t\t\t\tif ( ! ( t >= t0 ) ) {\r\n\r\n\t\t\t\t\t\t\t// looping?\r\n\r\n\t\t\t\t\t\t\tvar t1global = pp[ 1 ];\r\n\r\n\t\t\t\t\t\t\tif ( t < t1global ) {\r\n\r\n\t\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\r\n\t\t\t\t\t\t\t\tt0 = t1global;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// linear reverse scan\r\n\r\n\t\t\t\t\t\t\tfor ( var giveUpAt = i1 - 2; ; ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( t0 === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\t// before start\r\n\r\n\t\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\r\n\t\t\t\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ( i1 === giveUpAt ) { break; } // this loop\r\n\r\n\t\t\t\t\t\t\t\tt1 = t0;\r\n\t\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\r\n\r\n\t\t\t\t\t\t\t\tif ( t >= t0 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t// we have arrived at the sought interval\r\n\t\t\t\t\t\t\t\t\tbreak seek;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// prepare binary search on the left side of the index\r\n\t\t\t\t\t\t\tright = i1;\r\n\t\t\t\t\t\t\ti1 = 0;\r\n\t\t\t\t\t\t\tbreak linear_scan;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// the interval is valid\r\n\r\n\t\t\t\t\t\tbreak validate_interval;\r\n\r\n\t\t\t\t\t} // linear scan\r\n\r\n\t\t\t\t\t// binary search\r\n\r\n\t\t\t\t\twhile ( i1 < right ) {\r\n\r\n\t\t\t\t\t\tvar mid = ( i1 + right ) >>> 1;\r\n\r\n\t\t\t\t\t\tif ( t < pp[ mid ] ) {\r\n\r\n\t\t\t\t\t\t\tright = mid;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\ti1 = mid + 1;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tt1 = pp[ i1 ];\r\n\t\t\t\t\tt0 = pp[ i1 - 1 ];\r\n\r\n\t\t\t\t\t// check boundary cases, again\r\n\r\n\t\t\t\t\tif ( t0 === undefined ) {\r\n\r\n\t\t\t\t\t\tthis._cachedIndex = 0;\r\n\t\t\t\t\t\treturn this.beforeStart_( 0, t, t1 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( t1 === undefined ) {\r\n\r\n\t\t\t\t\t\ti1 = pp.length;\r\n\t\t\t\t\t\tthis._cachedIndex = i1;\r\n\t\t\t\t\t\treturn this.afterEnd_( i1 - 1, t0, t );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} // seek\r\n\r\n\t\t\t\tthis._cachedIndex = i1;\r\n\r\n\t\t\t\tthis.intervalChanged_( i1, t0, t1 );\r\n\r\n\t\t\t} // validate_interval\r\n\r\n\t\t\treturn this.interpolate_( i1, t0, t, t1 );\r\n\r\n\t\t},\r\n\r\n\t\tsettings: null, // optional, subclass-specific settings structure\r\n\t\t// Note: The indirection allows central control of many interpolants.\r\n\r\n\t\t// --- Protected interface\r\n\r\n\t\tDefaultSettings_: {},\r\n\r\n\t\tgetSettings_: function () {\r\n\r\n\t\t\treturn this.settings || this.DefaultSettings_;\r\n\r\n\t\t},\r\n\r\n\t\tcopySampleValue_: function ( index ) {\r\n\r\n\t\t\t// copies a sample value to the result buffer\r\n\r\n\t\t\tvar result = this.resultBuffer,\r\n\t\t\t\tvalues = this.sampleValues,\r\n\t\t\t\tstride = this.valueSize,\r\n\t\t\t\toffset = index * stride;\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tresult[ i ] = values[ offset + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t},\r\n\r\n\t\t// Template methods for derived classes:\r\n\r\n\t\tinterpolate_: function ( /* i1, t0, t, t1 */ ) {\r\n\r\n\t\t\tthrow new Error( 'call to abstract method' );\r\n\t\t\t// implementations shall return this.resultBuffer\r\n\r\n\t\t},\r\n\r\n\t\tintervalChanged_: function ( /* i1, t0, t1 */ ) {\r\n\r\n\t\t\t// empty\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t// DECLARE ALIAS AFTER assign prototype\r\n\tObject.assign( Interpolant.prototype, {\r\n\r\n\t\t//( 0, t, t0 ), returns this.resultBuffer\r\n\t\tbeforeStart_: Interpolant.prototype.copySampleValue_,\r\n\r\n\t\t//( N-1, tN-1, t ), returns this.resultBuffer\r\n\t\tafterEnd_: Interpolant.prototype.copySampleValue_,\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * Fast and simple cubic spline interpolant.\r\n\t *\r\n\t * It was derived from a Hermitian construction setting the first derivative\r\n\t * at each sample position to the linear slope between neighboring positions\r\n\t * over their parameter interval.\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction CubicInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\t\tthis._weightPrev = - 0;\r\n\t\tthis._offsetPrev = - 0;\r\n\t\tthis._weightNext = - 0;\r\n\t\tthis._offsetNext = - 0;\r\n\r\n\t}\r\n\r\n\tCubicInterpolant.prototype = Object.assign( Object.create( Interpolant.prototype ), {\r\n\r\n\t\tconstructor: CubicInterpolant,\r\n\r\n\t\tDefaultSettings_: {\r\n\r\n\t\t\tendingStart: ZeroCurvatureEnding,\r\n\t\t\tendingEnd: ZeroCurvatureEnding\r\n\r\n\t\t},\r\n\r\n\t\tintervalChanged_: function ( i1, t0, t1 ) {\r\n\r\n\t\t\tvar pp = this.parameterPositions,\r\n\t\t\t\tiPrev = i1 - 2,\r\n\t\t\t\tiNext = i1 + 1,\r\n\r\n\t\t\t\ttPrev = pp[ iPrev ],\r\n\t\t\t\ttNext = pp[ iNext ];\r\n\r\n\t\t\tif ( tPrev === undefined ) {\r\n\r\n\t\t\t\tswitch ( this.getSettings_().endingStart ) {\r\n\r\n\t\t\t\t\tcase ZeroSlopeEnding:\r\n\r\n\t\t\t\t\t\t// f'(t0) = 0\r\n\t\t\t\t\t\tiPrev = i1;\r\n\t\t\t\t\t\ttPrev = 2 * t0 - t1;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase WrapAroundEnding:\r\n\r\n\t\t\t\t\t\t// use the other end of the curve\r\n\t\t\t\t\t\tiPrev = pp.length - 2;\r\n\t\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault: // ZeroCurvatureEnding\r\n\r\n\t\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\r\n\t\t\t\t\t\tiPrev = i1;\r\n\t\t\t\t\t\ttPrev = t1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( tNext === undefined ) {\r\n\r\n\t\t\t\tswitch ( this.getSettings_().endingEnd ) {\r\n\r\n\t\t\t\t\tcase ZeroSlopeEnding:\r\n\r\n\t\t\t\t\t\t// f'(tN) = 0\r\n\t\t\t\t\t\tiNext = i1;\r\n\t\t\t\t\t\ttNext = 2 * t1 - t0;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase WrapAroundEnding:\r\n\r\n\t\t\t\t\t\t// use the other end of the curve\r\n\t\t\t\t\t\tiNext = 1;\r\n\t\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault: // ZeroCurvatureEnding\r\n\r\n\t\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\r\n\t\t\t\t\t\tiNext = i1 - 1;\r\n\t\t\t\t\t\ttNext = t0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar halfDt = ( t1 - t0 ) * 0.5,\r\n\t\t\t\tstride = this.valueSize;\r\n\r\n\t\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\r\n\t\t\tthis._weightNext = halfDt / ( tNext - t1 );\r\n\t\t\tthis._offsetPrev = iPrev * stride;\r\n\t\t\tthis._offsetNext = iNext * stride;\r\n\r\n\t\t},\r\n\r\n\t\tinterpolate_: function ( i1, t0, t, t1 ) {\r\n\r\n\t\t\tvar result = this.resultBuffer,\r\n\t\t\t\tvalues = this.sampleValues,\r\n\t\t\t\tstride = this.valueSize,\r\n\r\n\t\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\r\n\t\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\r\n\t\t\t\twP = this._weightPrev,\twN = this._weightNext,\r\n\r\n\t\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\r\n\t\t\t\tpp = p * p,\r\n\t\t\t\tppp = pp * p;\r\n\r\n\t\t\t// evaluate polynomials\r\n\r\n\t\t\tvar sP = - wP * ppp + 2 * wP * pp - wP * p;\r\n\t\t\tvar s0 = ( 1 + wP ) * ppp + ( - 1.5 - 2 * wP ) * pp + ( - 0.5 + wP ) * p + 1;\r\n\t\t\tvar s1 = ( - 1 - wN ) * ppp + ( 1.5 + wN ) * pp + 0.5 * p;\r\n\t\t\tvar sN = wN * ppp - wN * pp;\r\n\r\n\t\t\t// combine data linearly\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tresult[ i ] =\r\n\t\t\t\t\t\tsP * values[ oP + i ] +\r\n\t\t\t\t\t\ts0 * values[ o0 + i ] +\r\n\t\t\t\t\t\ts1 * values[ o1 + i ] +\r\n\t\t\t\t\t\tsN * values[ oN + i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction LinearInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\t}\r\n\r\n\tLinearInterpolant.prototype = Object.assign( Object.create( Interpolant.prototype ), {\r\n\r\n\t\tconstructor: LinearInterpolant,\r\n\r\n\t\tinterpolate_: function ( i1, t0, t, t1 ) {\r\n\r\n\t\t\tvar result = this.resultBuffer,\r\n\t\t\t\tvalues = this.sampleValues,\r\n\t\t\t\tstride = this.valueSize,\r\n\r\n\t\t\t\toffset1 = i1 * stride,\r\n\t\t\t\toffset0 = offset1 - stride,\r\n\r\n\t\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\r\n\t\t\t\tweight0 = 1 - weight1;\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tresult[ i ] =\r\n\t\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\r\n\t\t\t\t\t\tvalues[ offset1 + i ] * weight1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Interpolant that evaluates to the sample value at the position preceeding\r\n\t * the parameter.\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction DiscreteInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\t}\r\n\r\n\tDiscreteInterpolant.prototype = Object.assign( Object.create( Interpolant.prototype ), {\r\n\r\n\t\tconstructor: DiscreteInterpolant,\r\n\r\n\t\tinterpolate_: function ( i1 /*, t0, t, t1 */ ) {\r\n\r\n\t\t\treturn this.copySampleValue_( i1 - 1 );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A timed sequence of keyframes for a specific property.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction KeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tif ( name === undefined ) { throw new Error( 'THREE.KeyframeTrack: track name is undefined' ); }\r\n\t\tif ( times === undefined || times.length === 0 ) { throw new Error( 'THREE.KeyframeTrack: no keyframes in track named ' + name ); }\r\n\r\n\t\tthis.name = name;\r\n\r\n\t\tthis.times = AnimationUtils.convertArray( times, this.TimeBufferType );\r\n\t\tthis.values = AnimationUtils.convertArray( values, this.ValueBufferType );\r\n\r\n\t\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\r\n\r\n\t}\r\n\r\n\t// Static methods\r\n\r\n\tObject.assign( KeyframeTrack, {\r\n\r\n\t\t// Serialization (in static context, because of constructor invocation\r\n\t\t// and automatic invocation of .toJSON):\r\n\r\n\t\ttoJSON: function ( track ) {\r\n\r\n\t\t\tvar trackType = track.constructor;\r\n\r\n\t\t\tvar json;\r\n\r\n\t\t\t// derived classes can define a static toJSON method\r\n\t\t\tif ( trackType.toJSON !== undefined ) {\r\n\r\n\t\t\t\tjson = trackType.toJSON( track );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// by default, we assume the data can be serialized as-is\r\n\t\t\t\tjson = {\r\n\r\n\t\t\t\t\t'name': track.name,\r\n\t\t\t\t\t'times': AnimationUtils.convertArray( track.times, Array ),\r\n\t\t\t\t\t'values': AnimationUtils.convertArray( track.values, Array )\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar interpolation = track.getInterpolation();\r\n\r\n\t\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\r\n\r\n\t\t\t\t\tjson.interpolation = interpolation;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tjson.type = track.ValueTypeName; // mandatory\r\n\r\n\t\t\treturn json;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( KeyframeTrack.prototype, {\r\n\r\n\t\tconstructor: KeyframeTrack,\r\n\r\n\t\tTimeBufferType: Float32Array,\r\n\r\n\t\tValueBufferType: Float32Array,\r\n\r\n\t\tDefaultInterpolation: InterpolateLinear,\r\n\r\n\t\tInterpolantFactoryMethodDiscrete: function ( result ) {\r\n\r\n\t\t\treturn new DiscreteInterpolant( this.times, this.values, this.getValueSize(), result );\r\n\r\n\t\t},\r\n\r\n\t\tInterpolantFactoryMethodLinear: function ( result ) {\r\n\r\n\t\t\treturn new LinearInterpolant( this.times, this.values, this.getValueSize(), result );\r\n\r\n\t\t},\r\n\r\n\t\tInterpolantFactoryMethodSmooth: function ( result ) {\r\n\r\n\t\t\treturn new CubicInterpolant( this.times, this.values, this.getValueSize(), result );\r\n\r\n\t\t},\r\n\r\n\t\tsetInterpolation: function ( interpolation ) {\r\n\r\n\t\t\tvar factoryMethod;\r\n\r\n\t\t\tswitch ( interpolation ) {\r\n\r\n\t\t\t\tcase InterpolateDiscrete:\r\n\r\n\t\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase InterpolateLinear:\r\n\r\n\t\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase InterpolateSmooth:\r\n\r\n\t\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( factoryMethod === undefined ) {\r\n\r\n\t\t\t\tvar message = \"unsupported interpolation for \" +\r\n\t\t\t\t\tthis.ValueTypeName + \" keyframe track named \" + this.name;\r\n\r\n\t\t\t\tif ( this.createInterpolant === undefined ) {\r\n\r\n\t\t\t\t\t// fall back to default, unless the default itself is messed up\r\n\t\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\r\n\r\n\t\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tthrow new Error( message ); // fatal, in this case\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.warn( 'THREE.KeyframeTrack:', message );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.createInterpolant = factoryMethod;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetInterpolation: function () {\r\n\r\n\t\t\tswitch ( this.createInterpolant ) {\r\n\r\n\t\t\t\tcase this.InterpolantFactoryMethodDiscrete:\r\n\r\n\t\t\t\t\treturn InterpolateDiscrete;\r\n\r\n\t\t\t\tcase this.InterpolantFactoryMethodLinear:\r\n\r\n\t\t\t\t\treturn InterpolateLinear;\r\n\r\n\t\t\t\tcase this.InterpolantFactoryMethodSmooth:\r\n\r\n\t\t\t\t\treturn InterpolateSmooth;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tgetValueSize: function () {\r\n\r\n\t\t\treturn this.values.length / this.times.length;\r\n\r\n\t\t},\r\n\r\n\t\t// move all keyframes either forwards or backwards in time\r\n\t\tshift: function ( timeOffset ) {\r\n\r\n\t\t\tif ( timeOffset !== 0.0 ) {\r\n\r\n\t\t\t\tvar times = this.times;\r\n\r\n\t\t\t\tfor ( var i = 0, n = times.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\ttimes[ i ] += timeOffset;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\r\n\t\tscale: function ( timeScale ) {\r\n\r\n\t\t\tif ( timeScale !== 1.0 ) {\r\n\r\n\t\t\t\tvar times = this.times;\r\n\r\n\t\t\t\tfor ( var i = 0, n = times.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\ttimes[ i ] *= timeScale;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\r\n\t\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\r\n\t\ttrim: function ( startTime, endTime ) {\r\n\r\n\t\t\tvar times = this.times,\r\n\t\t\t\tnKeys = times.length,\r\n\t\t\t\tfrom = 0,\r\n\t\t\t\tto = nKeys - 1;\r\n\r\n\t\t\twhile ( from !== nKeys && times[ from ] < startTime ) {\r\n\r\n\t\t\t\t++ from;\r\n\r\n\t\t\t}\r\n\r\n\t\t\twhile ( to !== - 1 && times[ to ] > endTime ) {\r\n\r\n\t\t\t\t-- to;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t++ to; // inclusive -> exclusive bound\r\n\r\n\t\t\tif ( from !== 0 || to !== nKeys ) {\r\n\r\n\t\t\t\t// empty tracks are forbidden, so keep at least one keyframe\r\n\t\t\t\tif ( from >= to ) {\r\n\r\n\t\t\t\t\tto = Math.max( to, 1 );\r\n\t\t\t\t\tfrom = to - 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar stride = this.getValueSize();\r\n\t\t\t\tthis.times = AnimationUtils.arraySlice( times, from, to );\r\n\t\t\t\tthis.values = AnimationUtils.arraySlice( this.values, from * stride, to * stride );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\r\n\t\tvalidate: function () {\r\n\r\n\t\t\tvar valid = true;\r\n\r\n\t\t\tvar valueSize = this.getValueSize();\r\n\t\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Invalid value size in track.', this );\r\n\t\t\t\tvalid = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar times = this.times,\r\n\t\t\t\tvalues = this.values,\r\n\r\n\t\t\t\tnKeys = times.length;\r\n\r\n\t\t\tif ( nKeys === 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Track is empty.', this );\r\n\t\t\t\tvalid = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar prevTime = null;\r\n\r\n\t\t\tfor ( var i = 0; i !== nKeys; i ++ ) {\r\n\r\n\t\t\t\tvar currTime = times[ i ];\r\n\r\n\t\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Time is not a valid number.', this, i, currTime );\r\n\t\t\t\t\tvalid = false;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( prevTime !== null && prevTime > currTime ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Out of order keys.', this, i, currTime, prevTime );\r\n\t\t\t\t\tvalid = false;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tprevTime = currTime;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( values !== undefined ) {\r\n\r\n\t\t\t\tif ( AnimationUtils.isTypedArray( values ) ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0, n = values.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\t\tvar value = values[ i ];\r\n\r\n\t\t\t\t\t\tif ( isNaN( value ) ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Value is not a valid number.', this, i, value );\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn valid;\r\n\r\n\t\t},\r\n\r\n\t\t// removes equivalent sequential keys as common in morph target sequences\r\n\t\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\r\n\t\toptimize: function () {\r\n\r\n\t\t\t// times or values may be shared with other tracks, so overwriting is unsafe\r\n\t\t\tvar times = AnimationUtils.arraySlice( this.times ),\r\n\t\t\t\tvalues = AnimationUtils.arraySlice( this.values ),\r\n\t\t\t\tstride = this.getValueSize(),\r\n\r\n\t\t\t\tsmoothInterpolation = this.getInterpolation() === InterpolateSmooth,\r\n\r\n\t\t\t\twriteIndex = 1,\r\n\t\t\t\tlastIndex = times.length - 1;\r\n\r\n\t\t\tfor ( var i = 1; i < lastIndex; ++ i ) {\r\n\r\n\t\t\t\tvar keep = false;\r\n\r\n\t\t\t\tvar time = times[ i ];\r\n\t\t\t\tvar timeNext = times[ i + 1 ];\r\n\r\n\t\t\t\t// remove adjacent keyframes scheduled at the same time\r\n\r\n\t\t\t\tif ( time !== timeNext && ( i !== 1 || time !== time[ 0 ] ) ) {\r\n\r\n\t\t\t\t\tif ( ! smoothInterpolation ) {\r\n\r\n\t\t\t\t\t\t// remove unnecessary keyframes same as their neighbors\r\n\r\n\t\t\t\t\t\tvar offset = i * stride,\r\n\t\t\t\t\t\t\toffsetP = offset - stride,\r\n\t\t\t\t\t\t\toffsetN = offset + stride;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\t\t\tvar value = values[ offset + j ];\r\n\r\n\t\t\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\r\n\t\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\r\n\r\n\t\t\t\t\t\t\t\tkeep = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tkeep = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// in-place compaction\r\n\r\n\t\t\t\tif ( keep ) {\r\n\r\n\t\t\t\t\tif ( i !== writeIndex ) {\r\n\r\n\t\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\r\n\r\n\t\t\t\t\t\tvar readOffset = i * stride,\r\n\t\t\t\t\t\t\twriteOffset = writeIndex * stride;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t++ writeIndex;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// flush last keyframe (compaction looks ahead)\r\n\r\n\t\t\tif ( lastIndex > 0 ) {\r\n\r\n\t\t\t\ttimes[ writeIndex ] = times[ lastIndex ];\r\n\r\n\t\t\t\tfor ( var readOffset = lastIndex * stride, writeOffset = writeIndex * stride, j = 0; j !== stride; ++ j ) {\r\n\r\n\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t++ writeIndex;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( writeIndex !== times.length ) {\r\n\r\n\t\t\t\tthis.times = AnimationUtils.arraySlice( times, 0, writeIndex );\r\n\t\t\t\tthis.values = AnimationUtils.arraySlice( values, 0, writeIndex * stride );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.times = times;\r\n\t\t\t\tthis.values = values;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\tvar times = AnimationUtils.arraySlice( this.times, 0 );\r\n\t\t\tvar values = AnimationUtils.arraySlice( this.values, 0 );\r\n\r\n\t\t\tvar TypedKeyframeTrack = this.constructor;\r\n\t\t\tvar track = new TypedKeyframeTrack( this.name, times, values );\r\n\r\n\t\t\t// Interpolant argument to constructor is not saved, so copy the factory method directly.\r\n\t\t\ttrack.createInterpolant = this.createInterpolant;\r\n\r\n\t\t\treturn track;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of Boolean keyframe values.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction BooleanKeyframeTrack( name, times, values ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values );\r\n\r\n\t}\r\n\r\n\tBooleanKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: BooleanKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'bool',\r\n\t\tValueBufferType: Array,\r\n\r\n\t\tDefaultInterpolation: InterpolateDiscrete,\r\n\r\n\t\tInterpolantFactoryMethodLinear: undefined,\r\n\t\tInterpolantFactoryMethodSmooth: undefined\r\n\r\n\t\t// Note: Actually this track could have a optimized / compressed\r\n\t\t// representation of a single value and a custom interpolant that\r\n\t\t// computes \"firstValue ^ isOdd( index )\".\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of keyframe values that represent color.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction ColorKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tColorKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: ColorKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'color'\r\n\r\n\t\t// ValueBufferType is inherited\r\n\r\n\t\t// DefaultInterpolation is inherited\r\n\r\n\t\t// Note: Very basic implementation and nothing special yet.\r\n\t\t// However, this is the place for color space parameterization.\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of numeric keyframe values.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction NumberKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tNumberKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: NumberKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'number'\r\n\r\n\t\t// ValueBufferType is inherited\r\n\r\n\t\t// DefaultInterpolation is inherited\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * Spherical linear unit quaternion interpolant.\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction QuaternionLinearInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\r\n\r\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\r\n\r\n\t}\r\n\r\n\tQuaternionLinearInterpolant.prototype = Object.assign( Object.create( Interpolant.prototype ), {\r\n\r\n\t\tconstructor: QuaternionLinearInterpolant,\r\n\r\n\t\tinterpolate_: function ( i1, t0, t, t1 ) {\r\n\r\n\t\t\tvar result = this.resultBuffer,\r\n\t\t\t\tvalues = this.sampleValues,\r\n\t\t\t\tstride = this.valueSize,\r\n\r\n\t\t\t\toffset = i1 * stride,\r\n\r\n\t\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\r\n\r\n\t\t\tfor ( var end = offset + stride; offset !== end; offset += 4 ) {\r\n\r\n\t\t\t\tQuaternion.slerpFlat( result, 0, values, offset - stride, values, offset, alpha );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of quaternion keyframe values.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction QuaternionKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tQuaternionKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: QuaternionKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'quaternion',\r\n\r\n\t\t// ValueBufferType is inherited\r\n\r\n\t\tDefaultInterpolation: InterpolateLinear,\r\n\r\n\t\tInterpolantFactoryMethodLinear: function ( result ) {\r\n\r\n\t\t\treturn new QuaternionLinearInterpolant( this.times, this.values, this.getValueSize(), result );\r\n\r\n\t\t},\r\n\r\n\t\tInterpolantFactoryMethodSmooth: undefined // not yet implemented\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track that interpolates Strings\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction StringKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tStringKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: StringKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'string',\r\n\t\tValueBufferType: Array,\r\n\r\n\t\tDefaultInterpolation: InterpolateDiscrete,\r\n\r\n\t\tInterpolantFactoryMethodLinear: undefined,\r\n\r\n\t\tInterpolantFactoryMethodSmooth: undefined\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A Track of vectored keyframe values.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction VectorKeyframeTrack( name, times, values, interpolation ) {\r\n\r\n\t\tKeyframeTrack.call( this, name, times, values, interpolation );\r\n\r\n\t}\r\n\r\n\tVectorKeyframeTrack.prototype = Object.assign( Object.create( KeyframeTrack.prototype ), {\r\n\r\n\t\tconstructor: VectorKeyframeTrack,\r\n\r\n\t\tValueTypeName: 'vector'\r\n\r\n\t\t// ValueBufferType is inherited\r\n\r\n\t\t// DefaultInterpolation is inherited\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Reusable set of Tracks that represent an animation.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t */\r\n\r\n\tfunction AnimationClip( name, duration, tracks ) {\r\n\r\n\t\tthis.name = name;\r\n\t\tthis.tracks = tracks;\r\n\t\tthis.duration = ( duration !== undefined ) ? duration : - 1;\r\n\r\n\t\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\t\t// this means it should figure out its duration by scanning the tracks\r\n\t\tif ( this.duration < 0 ) {\r\n\r\n\t\t\tthis.resetDuration();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction getTrackTypeForValueTypeName( typeName ) {\r\n\r\n\t\tswitch ( typeName.toLowerCase() ) {\r\n\r\n\t\t\tcase 'scalar':\r\n\t\t\tcase 'double':\r\n\t\t\tcase 'float':\r\n\t\t\tcase 'number':\r\n\t\t\tcase 'integer':\r\n\r\n\t\t\t\treturn NumberKeyframeTrack;\r\n\r\n\t\t\tcase 'vector':\r\n\t\t\tcase 'vector2':\r\n\t\t\tcase 'vector3':\r\n\t\t\tcase 'vector4':\r\n\r\n\t\t\t\treturn VectorKeyframeTrack;\r\n\r\n\t\t\tcase 'color':\r\n\r\n\t\t\t\treturn ColorKeyframeTrack;\r\n\r\n\t\t\tcase 'quaternion':\r\n\r\n\t\t\t\treturn QuaternionKeyframeTrack;\r\n\r\n\t\t\tcase 'bool':\r\n\t\t\tcase 'boolean':\r\n\r\n\t\t\t\treturn BooleanKeyframeTrack;\r\n\r\n\t\t\tcase 'string':\r\n\r\n\t\t\t\treturn StringKeyframeTrack;\r\n\r\n\t\t}\r\n\r\n\t\tthrow new Error( 'THREE.KeyframeTrack: Unsupported typeName: ' + typeName );\r\n\r\n\t}\r\n\r\n\tfunction parseKeyframeTrack( json ) {\r\n\r\n\t\tif ( json.type === undefined ) {\r\n\r\n\t\t\tthrow new Error( 'THREE.KeyframeTrack: track type undefined, can not parse' );\r\n\r\n\t\t}\r\n\r\n\t\tvar trackType = getTrackTypeForValueTypeName( json.type );\r\n\r\n\t\tif ( json.times === undefined ) {\r\n\r\n\t\t\tvar times = [], values = [];\r\n\r\n\t\t\tAnimationUtils.flattenJSON( json.keys, times, values, 'value' );\r\n\r\n\t\t\tjson.times = times;\r\n\t\t\tjson.values = values;\r\n\r\n\t\t}\r\n\r\n\t\t// derived classes can define a static parse method\r\n\t\tif ( trackType.parse !== undefined ) {\r\n\r\n\t\t\treturn trackType.parse( json );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// by default, we assume a constructor compatible with the base\r\n\t\t\treturn new trackType( json.name, json.times, json.values, json.interpolation );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( AnimationClip, {\r\n\r\n\t\tparse: function ( json ) {\r\n\r\n\t\t\tvar tracks = [],\r\n\t\t\t\tjsonTracks = json.tracks,\r\n\t\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\r\n\r\n\t\t\tfor ( var i = 0, n = jsonTracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\ttracks.push( parseKeyframeTrack( jsonTracks[ i ] ).scale( frameTime ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn new AnimationClip( json.name, json.duration, tracks );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( clip ) {\r\n\r\n\t\t\tvar tracks = [],\r\n\t\t\t\tclipTracks = clip.tracks;\r\n\r\n\t\t\tvar json = {\r\n\r\n\t\t\t\t'name': clip.name,\r\n\t\t\t\t'duration': clip.duration,\r\n\t\t\t\t'tracks': tracks,\r\n\t\t\t\t'uuid': clip.uuid\r\n\r\n\t\t\t};\r\n\r\n\t\t\tfor ( var i = 0, n = clipTracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\ttracks.push( KeyframeTrack.toJSON( clipTracks[ i ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn json;\r\n\r\n\t\t},\r\n\r\n\t\tCreateFromMorphTargetSequence: function ( name, morphTargetSequence, fps, noLoop ) {\r\n\r\n\t\t\tvar numMorphTargets = morphTargetSequence.length;\r\n\t\t\tvar tracks = [];\r\n\r\n\t\t\tfor ( var i = 0; i < numMorphTargets; i ++ ) {\r\n\r\n\t\t\t\tvar times = [];\r\n\t\t\t\tvar values = [];\r\n\r\n\t\t\t\ttimes.push(\r\n\t\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\r\n\t\t\t\t\ti,\r\n\t\t\t\t\t( i + 1 ) % numMorphTargets );\r\n\r\n\t\t\t\tvalues.push( 0, 1, 0 );\r\n\r\n\t\t\t\tvar order = AnimationUtils.getKeyframeOrder( times );\r\n\t\t\t\ttimes = AnimationUtils.sortedArray( times, 1, order );\r\n\t\t\t\tvalues = AnimationUtils.sortedArray( values, 1, order );\r\n\r\n\t\t\t\t// if there is a key at the first frame, duplicate it as the\r\n\t\t\t\t// last frame as well for perfect loop.\r\n\t\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\r\n\r\n\t\t\t\t\ttimes.push( numMorphTargets );\r\n\t\t\t\t\tvalues.push( values[ 0 ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttracks.push(\r\n\t\t\t\t\tnew NumberKeyframeTrack(\r\n\t\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\r\n\t\t\t\t\t\ttimes, values\r\n\t\t\t\t\t).scale( 1.0 / fps ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn new AnimationClip( name, - 1, tracks );\r\n\r\n\t\t},\r\n\r\n\t\tfindByName: function ( objectOrClipArray, name ) {\r\n\r\n\t\t\tvar clipArray = objectOrClipArray;\r\n\r\n\t\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\r\n\r\n\t\t\t\tvar o = objectOrClipArray;\r\n\t\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < clipArray.length; i ++ ) {\r\n\r\n\t\t\t\tif ( clipArray[ i ].name === name ) {\r\n\r\n\t\t\t\t\treturn clipArray[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t},\r\n\r\n\t\tCreateClipsFromMorphTargetSequences: function ( morphTargets, fps, noLoop ) {\r\n\r\n\t\t\tvar animationToMorphTargets = {};\r\n\r\n\t\t\t// tested with https://regex101.com/ on trick sequences\r\n\t\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\r\n\t\t\tvar pattern = /^([\\w-]*?)([\\d]+)$/;\r\n\r\n\t\t\t// sort morph target names into animation groups based\r\n\t\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\r\n\t\t\tfor ( var i = 0, il = morphTargets.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tvar morphTarget = morphTargets[ i ];\r\n\t\t\t\tvar parts = morphTarget.name.match( pattern );\r\n\r\n\t\t\t\tif ( parts && parts.length > 1 ) {\r\n\r\n\t\t\t\t\tvar name = parts[ 1 ];\r\n\r\n\t\t\t\t\tvar animationMorphTargets = animationToMorphTargets[ name ];\r\n\t\t\t\t\tif ( ! animationMorphTargets ) {\r\n\r\n\t\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tanimationMorphTargets.push( morphTarget );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar clips = [];\r\n\r\n\t\t\tfor ( var name in animationToMorphTargets ) {\r\n\r\n\t\t\t\tclips.push( AnimationClip.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn clips;\r\n\r\n\t\t},\r\n\r\n\t\t// parse the animation.hierarchy format\r\n\t\tparseAnimation: function ( animation, bones ) {\r\n\r\n\t\t\tif ( ! animation ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.AnimationClip: No animation in JSONLoader data.' );\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar addNonemptyTrack = function ( trackType, trackName, animationKeys, propertyName, destTracks ) {\r\n\r\n\t\t\t\t// only return track if there are actually keys.\r\n\t\t\t\tif ( animationKeys.length !== 0 ) {\r\n\r\n\t\t\t\t\tvar times = [];\r\n\t\t\t\t\tvar values = [];\r\n\r\n\t\t\t\t\tAnimationUtils.flattenJSON( animationKeys, times, values, propertyName );\r\n\r\n\t\t\t\t\t// empty keys are filtered out, so check again\r\n\t\t\t\t\tif ( times.length !== 0 ) {\r\n\r\n\t\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t\tvar tracks = [];\r\n\r\n\t\t\tvar clipName = animation.name || 'default';\r\n\t\t\t// automatic length determination in AnimationClip.\r\n\t\t\tvar duration = animation.length || - 1;\r\n\t\t\tvar fps = animation.fps || 30;\r\n\r\n\t\t\tvar hierarchyTracks = animation.hierarchy || [];\r\n\r\n\t\t\tfor ( var h = 0; h < hierarchyTracks.length; h ++ ) {\r\n\r\n\t\t\t\tvar animationKeys = hierarchyTracks[ h ].keys;\r\n\r\n\t\t\t\t// skip empty tracks\r\n\t\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) { continue; }\r\n\r\n\t\t\t\t// process morph targets\r\n\t\t\t\tif ( animationKeys[ 0 ].morphTargets ) {\r\n\r\n\t\t\t\t\t// figure out all morph targets used in this track\r\n\t\t\t\t\tvar morphTargetNames = {};\r\n\r\n\t\t\t\t\tfor ( var k = 0; k < animationKeys.length; k ++ ) {\r\n\r\n\t\t\t\t\t\tif ( animationKeys[ k ].morphTargets ) {\r\n\r\n\t\t\t\t\t\t\tfor ( var m = 0; m < animationKeys[ k ].morphTargets.length; m ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[ k ].morphTargets[ m ] ] = - 1;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// create a track for each morph target with all zero\r\n\t\t\t\t\t// morphTargetInfluences except for the keys in which\r\n\t\t\t\t\t// the morphTarget is named.\r\n\t\t\t\t\tfor ( var morphTargetName in morphTargetNames ) {\r\n\r\n\t\t\t\t\t\tvar times = [];\r\n\t\t\t\t\t\tvar values = [];\r\n\r\n\t\t\t\t\t\tfor ( var m = 0; m !== animationKeys[ k ].morphTargets.length; ++ m ) {\r\n\r\n\t\t\t\t\t\t\tvar animationKey = animationKeys[ k ];\r\n\r\n\t\t\t\t\t\t\ttimes.push( animationKey.time );\r\n\t\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttracks.push( new NumberKeyframeTrack( '.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tduration = morphTargetNames.length * ( fps || 1.0 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// ...assume skeletal animation\r\n\r\n\t\t\t\t\tvar boneName = '.bones[' + bones[ h ].name + ']';\r\n\r\n\t\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tVectorKeyframeTrack, boneName + '.position',\r\n\t\t\t\t\t\tanimationKeys, 'pos', tracks );\r\n\r\n\t\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tQuaternionKeyframeTrack, boneName + '.quaternion',\r\n\t\t\t\t\t\tanimationKeys, 'rot', tracks );\r\n\r\n\t\t\t\t\taddNonemptyTrack(\r\n\t\t\t\t\t\tVectorKeyframeTrack, boneName + '.scale',\r\n\t\t\t\t\t\tanimationKeys, 'scl', tracks );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( tracks.length === 0 ) {\r\n\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar clip = new AnimationClip( clipName, duration, tracks );\r\n\r\n\t\t\treturn clip;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( AnimationClip.prototype, {\r\n\r\n\t\tresetDuration: function () {\r\n\r\n\t\t\tvar tracks = this.tracks, duration = 0;\r\n\r\n\t\t\tfor ( var i = 0, n = tracks.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar track = this.tracks[ i ];\r\n\r\n\t\t\t\tduration = Math.max( duration, track.times[ track.times.length - 1 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.duration = duration;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttrim: function () {\r\n\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\t\tthis.tracks[ i ].trim( 0, this.duration );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tvalidate: function () {\r\n\r\n\t\t\tvar valid = true;\r\n\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\t\tvalid = valid && this.tracks[ i ].validate();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn valid;\r\n\r\n\t\t},\r\n\r\n\t\toptimize: function () {\r\n\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\t\tthis.tracks[ i ].optimize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\tvar tracks = [];\r\n\r\n\t\t\tfor ( var i = 0; i < this.tracks.length; i ++ ) {\r\n\r\n\t\t\t\ttracks.push( this.tracks[ i ].clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn new AnimationClip( this.name, this.duration, tracks );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar Cache = {\r\n\r\n\t\tenabled: false,\r\n\r\n\t\tfiles: {},\r\n\r\n\t\tadd: function ( key, file ) {\r\n\r\n\t\t\tif ( this.enabled === false ) { return; }\r\n\r\n\t\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\r\n\r\n\t\t\tthis.files[ key ] = file;\r\n\r\n\t\t},\r\n\r\n\t\tget: function ( key ) {\r\n\r\n\t\t\tif ( this.enabled === false ) { return; }\r\n\r\n\t\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\r\n\r\n\t\t\treturn this.files[ key ];\r\n\r\n\t\t},\r\n\r\n\t\tremove: function ( key ) {\r\n\r\n\t\t\tdelete this.files[ key ];\r\n\r\n\t\t},\r\n\r\n\t\tclear: function () {\r\n\r\n\t\t\tthis.files = {};\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction LoadingManager( onLoad, onProgress, onError ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar isLoading = false;\r\n\t\tvar itemsLoaded = 0;\r\n\t\tvar itemsTotal = 0;\r\n\t\tvar urlModifier = undefined;\r\n\t\tvar handlers = [];\r\n\r\n\t\t// Refer to #5689 for the reason why we don't set .onStart\r\n\t\t// in the constructor\r\n\r\n\t\tthis.onStart = undefined;\r\n\t\tthis.onLoad = onLoad;\r\n\t\tthis.onProgress = onProgress;\r\n\t\tthis.onError = onError;\r\n\r\n\t\tthis.itemStart = function ( url ) {\r\n\r\n\t\t\titemsTotal ++;\r\n\r\n\t\t\tif ( isLoading === false ) {\r\n\r\n\t\t\t\tif ( scope.onStart !== undefined ) {\r\n\r\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tisLoading = true;\r\n\r\n\t\t};\r\n\r\n\t\tthis.itemEnd = function ( url ) {\r\n\r\n\t\t\titemsLoaded ++;\r\n\r\n\t\t\tif ( scope.onProgress !== undefined ) {\r\n\r\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( itemsLoaded === itemsTotal ) {\r\n\r\n\t\t\t\tisLoading = false;\r\n\r\n\t\t\t\tif ( scope.onLoad !== undefined ) {\r\n\r\n\t\t\t\t\tscope.onLoad();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.itemError = function ( url ) {\r\n\r\n\t\t\tif ( scope.onError !== undefined ) {\r\n\r\n\t\t\t\tscope.onError( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.resolveURL = function ( url ) {\r\n\r\n\t\t\tif ( urlModifier ) {\r\n\r\n\t\t\t\treturn urlModifier( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn url;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setURLModifier = function ( transform ) {\r\n\r\n\t\t\turlModifier = transform;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t\tthis.addHandler = function ( regex, loader ) {\r\n\r\n\t\t\thandlers.push( regex, loader );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t\tthis.removeHandler = function ( regex ) {\r\n\r\n\t\t\tvar index = handlers.indexOf( regex );\r\n\r\n\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\thandlers.splice( index, 2 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getHandler = function ( file ) {\r\n\r\n\t\t\tfor ( var i = 0, l = handlers.length; i < l; i += 2 ) {\r\n\r\n\t\t\t\tvar regex = handlers[ i ];\r\n\t\t\t\tvar loader = handlers[ i + 1 ];\r\n\r\n\t\t\t\tif ( regex.global ) { regex.lastIndex = 0; } // see #17920\r\n\r\n\t\t\t\tif ( regex.test( file ) ) {\r\n\r\n\t\t\t\t\treturn loader;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tvar DefaultLoadingManager = new LoadingManager();\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Loader( manager ) {\r\n\r\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\r\n\r\n\t\tthis.crossOrigin = 'anonymous';\r\n\t\tthis.path = '';\r\n\t\tthis.resourcePath = '';\r\n\r\n\t}\r\n\r\n\tObject.assign( Loader.prototype, {\r\n\r\n\t\tload: function ( /* url, onLoad, onProgress, onError */ ) {},\r\n\r\n\t\tparse: function ( /* data */ ) {},\r\n\r\n\t\tsetCrossOrigin: function ( crossOrigin ) {\r\n\r\n\t\t\tthis.crossOrigin = crossOrigin;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetPath: function ( path ) {\r\n\r\n\t\t\tthis.path = path;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetResourcePath: function ( resourcePath ) {\r\n\r\n\t\t\tthis.resourcePath = resourcePath;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar loading = {};\r\n\r\n\tfunction FileLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tFileLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: FileLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tif ( url === undefined ) { url = ''; }\r\n\r\n\t\t\tif ( this.path !== undefined ) { url = this.path + url; }\r\n\r\n\t\t\turl = this.manager.resolveURL( url );\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar cached = Cache.get( url );\r\n\r\n\t\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tif ( onLoad ) { onLoad( cached ); }\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t\treturn cached;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Check if request is duplicate\r\n\r\n\t\t\tif ( loading[ url ] !== undefined ) {\r\n\r\n\t\t\t\tloading[ url ].push( {\r\n\r\n\t\t\t\t\tonLoad: onLoad,\r\n\t\t\t\t\tonProgress: onProgress,\r\n\t\t\t\t\tonError: onError\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Check for data: URI\r\n\t\t\tvar dataUriRegex = /^data:(.*?)(;base64)?,(.*)$/;\r\n\t\t\tvar dataUriRegexResult = url.match( dataUriRegex );\r\n\r\n\t\t\t// Safari can not handle Data URIs through XMLHttpRequest so process manually\r\n\t\t\tif ( dataUriRegexResult ) {\r\n\r\n\t\t\t\tvar mimeType = dataUriRegexResult[ 1 ];\r\n\t\t\t\tvar isBase64 = !! dataUriRegexResult[ 2 ];\r\n\t\t\t\tvar data = dataUriRegexResult[ 3 ];\r\n\r\n\t\t\t\tdata = decodeURIComponent( data );\r\n\r\n\t\t\t\tif ( isBase64 ) { data = atob( data ); }\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tvar response;\r\n\t\t\t\t\tvar responseType = ( this.responseType || '' ).toLowerCase();\r\n\r\n\t\t\t\t\tswitch ( responseType ) {\r\n\r\n\t\t\t\t\t\tcase 'arraybuffer':\r\n\t\t\t\t\t\tcase 'blob':\r\n\r\n\t\t\t\t\t\t\tvar view = new Uint8Array( data.length );\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < data.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tview[ i ] = data.charCodeAt( i );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( responseType === 'blob' ) {\r\n\r\n\t\t\t\t\t\t\t\tresponse = new Blob( [ view.buffer ], { type: mimeType } );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tresponse = view.buffer;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'document':\r\n\r\n\t\t\t\t\t\t\tvar parser = new DOMParser();\r\n\t\t\t\t\t\t\tresponse = parser.parseFromString( data, mimeType );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'json':\r\n\r\n\t\t\t\t\t\t\tresponse = JSON.parse( data );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault: // 'text' or other\r\n\r\n\t\t\t\t\t\t\tresponse = data;\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Wait for next browser tick like standard XMLHttpRequest event dispatching does\r\n\t\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\t\tif ( onLoad ) { onLoad( response ); }\r\n\r\n\t\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t\t}, 0 );\r\n\r\n\t\t\t\t} catch ( error ) {\r\n\r\n\t\t\t\t\t// Wait for next browser tick like standard XMLHttpRequest event dispatching does\r\n\t\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\t\tif ( onError ) { onError( error ); }\r\n\r\n\t\t\t\t\t\tscope.manager.itemError( url );\r\n\t\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t\t}, 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Initialise array for duplicate requests\r\n\r\n\t\t\t\tloading[ url ] = [];\r\n\r\n\t\t\t\tloading[ url ].push( {\r\n\r\n\t\t\t\t\tonLoad: onLoad,\r\n\t\t\t\t\tonProgress: onProgress,\r\n\t\t\t\t\tonError: onError\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tvar request = new XMLHttpRequest();\r\n\r\n\t\t\t\trequest.open( 'GET', url, true );\r\n\r\n\t\t\t\trequest.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\t\t\tvar response = this.response;\r\n\r\n\t\t\t\t\tvar callbacks = loading[ url ];\r\n\r\n\t\t\t\t\tdelete loading[ url ];\r\n\r\n\t\t\t\t\tif ( this.status === 200 || this.status === 0 ) {\r\n\r\n\t\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\r\n\t\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\r\n\r\n\t\t\t\t\t\tif ( this.status === 0 ) { console.warn( 'THREE.FileLoader: HTTP Status 0 received.' ); }\r\n\r\n\t\t\t\t\t\t// Add to cache only on HTTP success, so that we do not cache\r\n\t\t\t\t\t\t// error response bodies as proper responses to requests.\r\n\t\t\t\t\t\tCache.add( url, response );\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\t\tif ( callback.onLoad ) { callback.onLoad( response ); }\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\t\tif ( callback.onError ) { callback.onError( event ); }\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tscope.manager.itemError( url );\r\n\t\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\trequest.addEventListener( 'progress', function ( event ) {\r\n\r\n\t\t\t\t\tvar callbacks = loading[ url ];\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\tif ( callback.onProgress ) { callback.onProgress( event ); }\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\trequest.addEventListener( 'error', function ( event ) {\r\n\r\n\t\t\t\t\tvar callbacks = loading[ url ];\r\n\r\n\t\t\t\t\tdelete loading[ url ];\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\tif ( callback.onError ) { callback.onError( event ); }\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tscope.manager.itemError( url );\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\trequest.addEventListener( 'abort', function ( event ) {\r\n\r\n\t\t\t\t\tvar callbacks = loading[ url ];\r\n\r\n\t\t\t\t\tdelete loading[ url ];\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar callback = callbacks[ i ];\r\n\t\t\t\t\t\tif ( callback.onError ) { callback.onError( event ); }\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tscope.manager.itemError( url );\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\tif ( this.responseType !== undefined ) { request.responseType = this.responseType; }\r\n\t\t\t\tif ( this.withCredentials !== undefined ) { request.withCredentials = this.withCredentials; }\r\n\r\n\t\t\t\tif ( request.overrideMimeType ) { request.overrideMimeType( this.mimeType !== undefined ? this.mimeType : 'text/plain' ); }\r\n\r\n\t\t\t\tfor ( var header in this.requestHeader ) {\r\n\r\n\t\t\t\t\trequest.setRequestHeader( header, this.requestHeader[ header ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\trequest.send( null );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\treturn request;\r\n\r\n\t\t},\r\n\r\n\t\tsetResponseType: function ( value ) {\r\n\r\n\t\t\tthis.responseType = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetWithCredentials: function ( value ) {\r\n\r\n\t\t\tthis.withCredentials = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetMimeType: function ( value ) {\r\n\r\n\t\t\tthis.mimeType = value;\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetRequestHeader: function ( value ) {\r\n\r\n\t\t\tthis.requestHeader = value;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io/\r\n\t */\r\n\r\n\tfunction AnimationLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tAnimationLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: AnimationLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar loader = new FileLoader( scope.manager );\r\n\t\t\tloader.setPath( scope.path );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( json ) {\r\n\r\n\t\t\tvar animations = [];\r\n\r\n\t\t\tfor ( var i = 0; i < json.length; i ++ ) {\r\n\r\n\t\t\t\tvar clip = AnimationClip.parse( json[ i ] );\r\n\r\n\t\t\t\tanimations.push( clip );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn animations;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t *\r\n\t * Abstract Base class to block based textures loader (dds, pvr, ...)\r\n\t *\r\n\t * Sub classes have to implement the parse() method which will be used in load().\r\n\t */\r\n\r\n\tfunction CompressedTextureLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tCompressedTextureLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: CompressedTextureLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar images = [];\r\n\r\n\t\t\tvar texture = new CompressedTexture();\r\n\t\t\ttexture.image = images;\r\n\r\n\t\t\tvar loader = new FileLoader( this.manager );\r\n\t\t\tloader.setPath( this.path );\r\n\t\t\tloader.setResponseType( 'arraybuffer' );\r\n\r\n\t\t\tfunction loadTexture( i ) {\r\n\r\n\t\t\t\tloader.load( url[ i ], function ( buffer ) {\r\n\r\n\t\t\t\t\tvar texDatas = scope.parse( buffer, true );\r\n\r\n\t\t\t\t\timages[ i ] = {\r\n\t\t\t\t\t\twidth: texDatas.width,\r\n\t\t\t\t\t\theight: texDatas.height,\r\n\t\t\t\t\t\tformat: texDatas.format,\r\n\t\t\t\t\t\tmipmaps: texDatas.mipmaps\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tloaded += 1;\r\n\r\n\t\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\t\tif ( texDatas.mipmapCount === 1 )\r\n\t\t\t\t\t\t\t{ texture.minFilter = LinearFilter; }\r\n\r\n\t\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tif ( onLoad ) { onLoad( texture ); }\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, onProgress, onError );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( Array.isArray( url ) ) {\r\n\r\n\t\t\t\tvar loaded = 0;\r\n\r\n\t\t\t\tfor ( var i = 0, il = url.length; i < il; ++ i ) {\r\n\r\n\t\t\t\t\tloadTexture( i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// compressed cubemap texture stored in a single DDS file\r\n\r\n\t\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\t\tvar texDatas = scope.parse( buffer, true );\r\n\r\n\t\t\t\t\tif ( texDatas.isCubemap ) {\r\n\r\n\t\t\t\t\t\tvar faces = texDatas.mipmaps.length / texDatas.mipmapCount;\r\n\r\n\t\t\t\t\t\tfor ( var f = 0; f < faces; f ++ ) {\r\n\r\n\t\t\t\t\t\t\timages[ f ] = { mipmaps: [] };\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < texDatas.mipmapCount; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\r\n\t\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\r\n\t\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\r\n\t\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ttexture.image.width = texDatas.width;\r\n\t\t\t\t\t\ttexture.image.height = texDatas.height;\r\n\t\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\r\n\r\n\t\t\t\t\t\ttexture.minFilter = LinearFilter;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture.format = texDatas.format;\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\tif ( onLoad ) { onLoad( texture ); }\r\n\r\n\t\t\t\t}, onProgress, onError );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author Nikos M. / https://github.com/foo123/\r\n\t *\r\n\t * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\r\n\t *\r\n\t * Sub classes have to implement the parse() method which will be used in load().\r\n\t */\r\n\r\n\tfunction DataTextureLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tDataTextureLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: DataTextureLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar texture = new DataTexture();\r\n\r\n\t\t\tvar loader = new FileLoader( this.manager );\r\n\t\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\t\tloader.setPath( this.path );\r\n\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\tvar texData = scope.parse( buffer );\r\n\r\n\t\t\t\tif ( ! texData ) { return; }\r\n\r\n\t\t\t\tif ( texData.image !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.image = texData.image;\r\n\r\n\t\t\t\t} else if ( texData.data !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.image.width = texData.width;\r\n\t\t\t\t\ttexture.image.height = texData.height;\r\n\t\t\t\t\ttexture.image.data = texData.data;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.wrapS = texData.wrapS !== undefined ? texData.wrapS : ClampToEdgeWrapping;\r\n\t\t\t\ttexture.wrapT = texData.wrapT !== undefined ? texData.wrapT : ClampToEdgeWrapping;\r\n\r\n\t\t\t\ttexture.magFilter = texData.magFilter !== undefined ? texData.magFilter : LinearFilter;\r\n\t\t\t\ttexture.minFilter = texData.minFilter !== undefined ? texData.minFilter : LinearFilter;\r\n\r\n\t\t\t\ttexture.anisotropy = texData.anisotropy !== undefined ? texData.anisotropy : 1;\r\n\r\n\t\t\t\tif ( texData.format !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.format = texData.format;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( texData.type !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.type = texData.type;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texData.mipmaps !== undefined ) {\r\n\r\n\t\t\t\t\ttexture.mipmaps = texData.mipmaps;\r\n\t\t\t\t\ttexture.minFilter = LinearMipmapLinearFilter; // presumably...\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( texData.mipmapCount === 1 ) {\r\n\r\n\t\t\t\t\ttexture.minFilter = LinearFilter;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\tif ( onLoad ) { onLoad( texture, texData ); }\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction ImageLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tImageLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: ImageLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tif ( this.path !== undefined ) { url = this.path + url; }\r\n\r\n\t\t\turl = this.manager.resolveURL( url );\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar cached = Cache.get( url );\r\n\r\n\t\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tif ( onLoad ) { onLoad( cached ); }\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t\treturn cached;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar image = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'img' );\r\n\r\n\t\t\tfunction onImageLoad() {\r\n\r\n\t\t\t\timage.removeEventListener( 'load', onImageLoad, false );\r\n\t\t\t\timage.removeEventListener( 'error', onImageError, false );\r\n\r\n\t\t\t\tCache.add( url, this );\r\n\r\n\t\t\t\tif ( onLoad ) { onLoad( this ); }\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction onImageError( event ) {\r\n\r\n\t\t\t\timage.removeEventListener( 'load', onImageLoad, false );\r\n\t\t\t\timage.removeEventListener( 'error', onImageError, false );\r\n\r\n\t\t\t\tif ( onError ) { onError( event ); }\r\n\r\n\t\t\t\tscope.manager.itemError( url );\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t\timage.addEventListener( 'load', onImageLoad, false );\r\n\t\t\timage.addEventListener( 'error', onImageError, false );\r\n\r\n\t\t\tif ( url.substr( 0, 5 ) !== 'data:' ) {\r\n\r\n\t\t\t\tif ( this.crossOrigin !== undefined ) { image.crossOrigin = this.crossOrigin; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\timage.src = url;\r\n\r\n\t\t\treturn image;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\r\n\tfunction CubeTextureLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tCubeTextureLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: CubeTextureLoader,\r\n\r\n\t\tload: function ( urls, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar texture = new CubeTexture();\r\n\r\n\t\t\tvar loader = new ImageLoader( this.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.setPath( this.path );\r\n\r\n\t\t\tvar loaded = 0;\r\n\r\n\t\t\tfunction loadTexture( i ) {\r\n\r\n\t\t\t\tloader.load( urls[ i ], function ( image ) {\r\n\r\n\t\t\t\t\ttexture.images[ i ] = image;\r\n\r\n\t\t\t\t\tloaded ++;\r\n\r\n\t\t\t\t\tif ( loaded === 6 ) {\r\n\r\n\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tif ( onLoad ) { onLoad( texture ); }\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, undefined, onError );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < urls.length; ++ i ) {\r\n\r\n\t\t\t\tloadTexture( i );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction TextureLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tTextureLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: TextureLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar texture = new Texture();\r\n\r\n\t\t\tvar loader = new ImageLoader( this.manager );\r\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\t\t\tloader.setPath( this.path );\r\n\r\n\t\t\tloader.load( url, function ( image ) {\r\n\r\n\t\t\t\ttexture.image = image;\r\n\r\n\t\t\t\t// JPEGs can't have an alpha channel, so memory can be saved by storing them as RGB.\r\n\t\t\t\tvar isJPEG = url.search( /\\.jpe?g($|\\?)/i ) > 0 || url.search( /^data\\:image\\/jpeg/ ) === 0;\r\n\r\n\t\t\t\ttexture.format = isJPEG ? RGBFormat : RGBAFormat;\r\n\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\tif ( onLoad !== undefined ) {\r\n\r\n\t\t\t\t\tonLoad( texture );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t\treturn texture;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * Extensible curve object\r\n\t *\r\n\t * Some common of curve methods:\r\n\t * .getPoint( t, optionalTarget ), .getTangent( t )\r\n\t * .getPointAt( u, optionalTarget ), .getTangentAt( u )\r\n\t * .getPoints(), .getSpacedPoints()\r\n\t * .getLength()\r\n\t * .updateArcLengths()\r\n\t *\r\n\t * This following curves inherit from THREE.Curve:\r\n\t *\r\n\t * -- 2D curves --\r\n\t * THREE.ArcCurve\r\n\t * THREE.CubicBezierCurve\r\n\t * THREE.EllipseCurve\r\n\t * THREE.LineCurve\r\n\t * THREE.QuadraticBezierCurve\r\n\t * THREE.SplineCurve\r\n\t *\r\n\t * -- 3D curves --\r\n\t * THREE.CatmullRomCurve3\r\n\t * THREE.CubicBezierCurve3\r\n\t * THREE.LineCurve3\r\n\t * THREE.QuadraticBezierCurve3\r\n\t *\r\n\t * A series of curves can be represented as a THREE.CurvePath.\r\n\t *\r\n\t **/\r\n\r\n\t/**************************************************************\r\n\t *\tAbstract Curve base class\r\n\t **************************************************************/\r\n\r\n\tfunction Curve() {\r\n\r\n\t\tthis.type = 'Curve';\r\n\r\n\t\tthis.arcLengthDivisions = 200;\r\n\r\n\t}\r\n\r\n\tObject.assign( Curve.prototype, {\r\n\r\n\t\t// Virtual base class method to overwrite and implement in subclasses\r\n\t\t//\t- t [0 .. 1]\r\n\r\n\t\tgetPoint: function ( /* t, optionalTarget */ ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Curve: .getPoint() not implemented.' );\r\n\t\t\treturn null;\r\n\r\n\t\t},\r\n\r\n\t\t// Get point at relative position in curve according to arc length\r\n\t\t// - u [0 .. 1]\r\n\r\n\t\tgetPointAt: function ( u, optionalTarget ) {\r\n\r\n\t\t\tvar t = this.getUtoTmapping( u );\r\n\t\t\treturn this.getPoint( t, optionalTarget );\r\n\r\n\t\t},\r\n\r\n\t\t// Get sequence of points using getPoint( t )\r\n\r\n\t\tgetPoints: function ( divisions ) {\r\n\r\n\t\t\tif ( divisions === undefined ) { divisions = 5; }\r\n\r\n\t\t\tvar points = [];\r\n\r\n\t\t\tfor ( var d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\t\tpoints.push( this.getPoint( d / divisions ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn points;\r\n\r\n\t\t},\r\n\r\n\t\t// Get sequence of points using getPointAt( u )\r\n\r\n\t\tgetSpacedPoints: function ( divisions ) {\r\n\r\n\t\t\tif ( divisions === undefined ) { divisions = 5; }\r\n\r\n\t\t\tvar points = [];\r\n\r\n\t\t\tfor ( var d = 0; d <= divisions; d ++ ) {\r\n\r\n\t\t\t\tpoints.push( this.getPointAt( d / divisions ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn points;\r\n\r\n\t\t},\r\n\r\n\t\t// Get total curve arc length\r\n\r\n\t\tgetLength: function () {\r\n\r\n\t\t\tvar lengths = this.getLengths();\r\n\t\t\treturn lengths[ lengths.length - 1 ];\r\n\r\n\t\t},\r\n\r\n\t\t// Get list of cumulative segment lengths\r\n\r\n\t\tgetLengths: function ( divisions ) {\r\n\r\n\t\t\tif ( divisions === undefined ) { divisions = this.arcLengthDivisions; }\r\n\r\n\t\t\tif ( this.cacheArcLengths &&\r\n\t\t\t\t( this.cacheArcLengths.length === divisions + 1 ) &&\r\n\t\t\t\t! this.needsUpdate ) {\r\n\r\n\t\t\t\treturn this.cacheArcLengths;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.needsUpdate = false;\r\n\r\n\t\t\tvar cache = [];\r\n\t\t\tvar current, last = this.getPoint( 0 );\r\n\t\t\tvar p, sum = 0;\r\n\r\n\t\t\tcache.push( 0 );\r\n\r\n\t\t\tfor ( p = 1; p <= divisions; p ++ ) {\r\n\r\n\t\t\t\tcurrent = this.getPoint( p / divisions );\r\n\t\t\t\tsum += current.distanceTo( last );\r\n\t\t\t\tcache.push( sum );\r\n\t\t\t\tlast = current;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cacheArcLengths = cache;\r\n\r\n\t\t\treturn cache; // { sums: cache, sum: sum }; Sum is in the last element.\r\n\r\n\t\t},\r\n\r\n\t\tupdateArcLengths: function () {\r\n\r\n\t\t\tthis.needsUpdate = true;\r\n\t\t\tthis.getLengths();\r\n\r\n\t\t},\r\n\r\n\t\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\r\n\r\n\t\tgetUtoTmapping: function ( u, distance ) {\r\n\r\n\t\t\tvar arcLengths = this.getLengths();\r\n\r\n\t\t\tvar i = 0, il = arcLengths.length;\r\n\r\n\t\t\tvar targetArcLength; // The targeted u distance value to get\r\n\r\n\t\t\tif ( distance ) {\r\n\r\n\t\t\t\ttargetArcLength = distance;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// binary search for the index with largest value smaller than target u distance\r\n\r\n\t\t\tvar low = 0, high = il - 1, comparison;\r\n\r\n\t\t\twhile ( low <= high ) {\r\n\r\n\t\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\r\n\r\n\t\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\r\n\r\n\t\t\t\tif ( comparison < 0 ) {\r\n\r\n\t\t\t\t\tlow = i + 1;\r\n\r\n\t\t\t\t} else if ( comparison > 0 ) {\r\n\r\n\t\t\t\t\thigh = i - 1;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\thigh = i;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t// DONE\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\ti = high;\r\n\r\n\t\t\tif ( arcLengths[ i ] === targetArcLength ) {\r\n\r\n\t\t\t\treturn i / ( il - 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// we could get finer grain at lengths, or use simple interpolation between two points\r\n\r\n\t\t\tvar lengthBefore = arcLengths[ i ];\r\n\t\t\tvar lengthAfter = arcLengths[ i + 1 ];\r\n\r\n\t\t\tvar segmentLength = lengthAfter - lengthBefore;\r\n\r\n\t\t\t// determine where we are between the 'before' and 'after' points\r\n\r\n\t\t\tvar segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\r\n\r\n\t\t\t// add that fractional amount to t\r\n\r\n\t\t\tvar t = ( i + segmentFraction ) / ( il - 1 );\r\n\r\n\t\t\treturn t;\r\n\r\n\t\t},\r\n\r\n\t\t// Returns a unit vector tangent at t\r\n\t\t// In case any sub curve does not implement its tangent derivation,\r\n\t\t// 2 points a small delta apart will be used to find its gradient\r\n\t\t// which seems to give a reasonable approximation\r\n\r\n\t\tgetTangent: function ( t ) {\r\n\r\n\t\t\tvar delta = 0.0001;\r\n\t\t\tvar t1 = t - delta;\r\n\t\t\tvar t2 = t + delta;\r\n\r\n\t\t\t// Capping in case of danger\r\n\r\n\t\t\tif ( t1 < 0 ) { t1 = 0; }\r\n\t\t\tif ( t2 > 1 ) { t2 = 1; }\r\n\r\n\t\t\tvar pt1 = this.getPoint( t1 );\r\n\t\t\tvar pt2 = this.getPoint( t2 );\r\n\r\n\t\t\tvar vec = pt2.clone().sub( pt1 );\r\n\t\t\treturn vec.normalize();\r\n\r\n\t\t},\r\n\r\n\t\tgetTangentAt: function ( u ) {\r\n\r\n\t\t\tvar t = this.getUtoTmapping( u );\r\n\t\t\treturn this.getTangent( t );\r\n\r\n\t\t},\r\n\r\n\t\tcomputeFrenetFrames: function ( segments, closed ) {\r\n\r\n\t\t\t// see http://www.cs.indiana.edu/pub/techreports/TR425.pdf\r\n\r\n\t\t\tvar normal = new Vector3();\r\n\r\n\t\t\tvar tangents = [];\r\n\t\t\tvar normals = [];\r\n\t\t\tvar binormals = [];\r\n\r\n\t\t\tvar vec = new Vector3();\r\n\t\t\tvar mat = new Matrix4();\r\n\r\n\t\t\tvar i, u, theta;\r\n\r\n\t\t\t// compute the tangent vectors for each segment on the curve\r\n\r\n\t\t\tfor ( i = 0; i <= segments; i ++ ) {\r\n\r\n\t\t\t\tu = i / segments;\r\n\r\n\t\t\t\ttangents[ i ] = this.getTangentAt( u );\r\n\t\t\t\ttangents[ i ].normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// select an initial normal vector perpendicular to the first tangent vector,\r\n\t\t\t// and in the direction of the minimum tangent xyz component\r\n\r\n\t\t\tnormals[ 0 ] = new Vector3();\r\n\t\t\tbinormals[ 0 ] = new Vector3();\r\n\t\t\tvar min = Number.MAX_VALUE;\r\n\t\t\tvar tx = Math.abs( tangents[ 0 ].x );\r\n\t\t\tvar ty = Math.abs( tangents[ 0 ].y );\r\n\t\t\tvar tz = Math.abs( tangents[ 0 ].z );\r\n\r\n\t\t\tif ( tx <= min ) {\r\n\r\n\t\t\t\tmin = tx;\r\n\t\t\t\tnormal.set( 1, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ty <= min ) {\r\n\r\n\t\t\t\tmin = ty;\r\n\t\t\t\tnormal.set( 0, 1, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( tz <= min ) {\r\n\r\n\t\t\t\tnormal.set( 0, 0, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\r\n\r\n\t\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\r\n\t\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\r\n\r\n\r\n\t\t\t// compute the slowly-varying normal and binormal vectors for each segment on the curve\r\n\r\n\t\t\tfor ( i = 1; i <= segments; i ++ ) {\r\n\r\n\t\t\t\tnormals[ i ] = normals[ i - 1 ].clone();\r\n\r\n\t\t\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\r\n\r\n\t\t\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\r\n\r\n\t\t\t\tif ( vec.length() > Number.EPSILON ) {\r\n\r\n\t\t\t\t\tvec.normalize();\r\n\r\n\t\t\t\t\ttheta = Math.acos( MathUtils.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\r\n\r\n\t\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\r\n\r\n\t\t\tif ( closed === true ) {\r\n\r\n\t\t\t\ttheta = Math.acos( MathUtils.clamp( normals[ 0 ].dot( normals[ segments ] ), - 1, 1 ) );\r\n\t\t\t\ttheta /= segments;\r\n\r\n\t\t\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ segments ] ) ) > 0 ) {\r\n\r\n\t\t\t\t\ttheta = - theta;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( i = 1; i <= segments; i ++ ) {\r\n\r\n\t\t\t\t\t// twist a little...\r\n\t\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\r\n\t\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\ttangents: tangents,\r\n\t\t\t\tnormals: normals,\r\n\t\t\t\tbinormals: binormals\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.arcLengthDivisions = source.arcLengthDivisions;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\tmetadata: {\r\n\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\ttype: 'Curve',\r\n\t\t\t\t\tgenerator: 'Curve.toJSON'\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tdata.arcLengthDivisions = this.arcLengthDivisions;\r\n\t\t\tdata.type = this.type;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tfromJSON: function ( json ) {\r\n\r\n\t\t\tthis.arcLengthDivisions = json.arcLengthDivisions;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'EllipseCurve';\r\n\r\n\t\tthis.aX = aX || 0;\r\n\t\tthis.aY = aY || 0;\r\n\r\n\t\tthis.xRadius = xRadius || 1;\r\n\t\tthis.yRadius = yRadius || 1;\r\n\r\n\t\tthis.aStartAngle = aStartAngle || 0;\r\n\t\tthis.aEndAngle = aEndAngle || 2 * Math.PI;\r\n\r\n\t\tthis.aClockwise = aClockwise || false;\r\n\r\n\t\tthis.aRotation = aRotation || 0;\r\n\r\n\t}\r\n\r\n\tEllipseCurve.prototype = Object.create( Curve.prototype );\r\n\tEllipseCurve.prototype.constructor = EllipseCurve;\r\n\r\n\tEllipseCurve.prototype.isEllipseCurve = true;\r\n\r\n\tEllipseCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tvar twoPi = Math.PI * 2;\r\n\t\tvar deltaAngle = this.aEndAngle - this.aStartAngle;\r\n\t\tvar samePoints = Math.abs( deltaAngle ) < Number.EPSILON;\r\n\r\n\t\t// ensures that deltaAngle is 0 .. 2 PI\r\n\t\twhile ( deltaAngle < 0 ) { deltaAngle += twoPi; }\r\n\t\twhile ( deltaAngle > twoPi ) { deltaAngle -= twoPi; }\r\n\r\n\t\tif ( deltaAngle < Number.EPSILON ) {\r\n\r\n\t\t\tif ( samePoints ) {\r\n\r\n\t\t\t\tdeltaAngle = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdeltaAngle = twoPi;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.aClockwise === true && ! samePoints ) {\r\n\r\n\t\t\tif ( deltaAngle === twoPi ) {\r\n\r\n\t\t\t\tdeltaAngle = - twoPi;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tdeltaAngle = deltaAngle - twoPi;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar angle = this.aStartAngle + t * deltaAngle;\r\n\t\tvar x = this.aX + this.xRadius * Math.cos( angle );\r\n\t\tvar y = this.aY + this.yRadius * Math.sin( angle );\r\n\r\n\t\tif ( this.aRotation !== 0 ) {\r\n\r\n\t\t\tvar cos = Math.cos( this.aRotation );\r\n\t\t\tvar sin = Math.sin( this.aRotation );\r\n\r\n\t\t\tvar tx = x - this.aX;\r\n\t\t\tvar ty = y - this.aY;\r\n\r\n\t\t\t// Rotate the point about the center of the ellipse.\r\n\t\t\tx = tx * cos - ty * sin + this.aX;\r\n\t\t\ty = tx * sin + ty * cos + this.aY;\r\n\r\n\t\t}\r\n\r\n\t\treturn point.set( x, y );\r\n\r\n\t};\r\n\r\n\tEllipseCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.aX = source.aX;\r\n\t\tthis.aY = source.aY;\r\n\r\n\t\tthis.xRadius = source.xRadius;\r\n\t\tthis.yRadius = source.yRadius;\r\n\r\n\t\tthis.aStartAngle = source.aStartAngle;\r\n\t\tthis.aEndAngle = source.aEndAngle;\r\n\r\n\t\tthis.aClockwise = source.aClockwise;\r\n\r\n\t\tthis.aRotation = source.aRotation;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\tEllipseCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.aX = this.aX;\r\n\t\tdata.aY = this.aY;\r\n\r\n\t\tdata.xRadius = this.xRadius;\r\n\t\tdata.yRadius = this.yRadius;\r\n\r\n\t\tdata.aStartAngle = this.aStartAngle;\r\n\t\tdata.aEndAngle = this.aEndAngle;\r\n\r\n\t\tdata.aClockwise = this.aClockwise;\r\n\r\n\t\tdata.aRotation = this.aRotation;\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tEllipseCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.aX = json.aX;\r\n\t\tthis.aY = json.aY;\r\n\r\n\t\tthis.xRadius = json.xRadius;\r\n\t\tthis.yRadius = json.yRadius;\r\n\r\n\t\tthis.aStartAngle = json.aStartAngle;\r\n\t\tthis.aEndAngle = json.aEndAngle;\r\n\r\n\t\tthis.aClockwise = json.aClockwise;\r\n\r\n\t\tthis.aRotation = json.aRotation;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction ArcCurve( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\t\tEllipseCurve.call( this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n\t\tthis.type = 'ArcCurve';\r\n\r\n\t}\r\n\r\n\tArcCurve.prototype = Object.create( EllipseCurve.prototype );\r\n\tArcCurve.prototype.constructor = ArcCurve;\r\n\r\n\tArcCurve.prototype.isArcCurve = true;\r\n\r\n\t/**\r\n\t * @author zz85 https://github.com/zz85\r\n\t *\r\n\t * Centripetal CatmullRom Curve - which is useful for avoiding\r\n\t * cusps and self-intersections in non-uniform catmull rom curves.\r\n\t * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\r\n\t *\r\n\t * curve.type accepts centripetal(default), chordal and catmullrom\r\n\t * curve.tension is used for catmullrom which defaults to 0.5\r\n\t */\r\n\r\n\r\n\t/*\r\n\tBased on an optimized c++ solution in\r\n\t - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\r\n\t - http://ideone.com/NoEbVM\r\n\r\n\tThis CubicPoly class could be used for reusing some variables and calculations,\r\n\tbut for three.js curve use, it could be possible inlined and flatten into a single function call\r\n\twhich can be placed in CurveUtils.\r\n\t*/\r\n\r\n\tfunction CubicPoly() {\r\n\r\n\t\tvar c0 = 0, c1 = 0, c2 = 0, c3 = 0;\r\n\r\n\t\t/*\r\n\t\t * Compute coefficients for a cubic polynomial\r\n\t\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\r\n\t\t * such that\r\n\t\t *   p(0) = x0, p(1) = x1\r\n\t\t *  and\r\n\t\t *   p'(0) = t0, p'(1) = t1.\r\n\t\t */\r\n\t\tfunction init( x0, x1, t0, t1 ) {\r\n\r\n\t\t\tc0 = x0;\r\n\t\t\tc1 = t0;\r\n\t\t\tc2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\r\n\t\t\tc3 = 2 * x0 - 2 * x1 + t0 + t1;\r\n\r\n\t\t}\r\n\r\n\t\treturn {\r\n\r\n\t\t\tinitCatmullRom: function ( x0, x1, x2, x3, tension ) {\r\n\r\n\t\t\t\tinit( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\r\n\r\n\t\t\t},\r\n\r\n\t\t\tinitNonuniformCatmullRom: function ( x0, x1, x2, x3, dt0, dt1, dt2 ) {\r\n\r\n\t\t\t\t// compute tangents when parameterized in [t1,t2]\r\n\t\t\t\tvar t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\r\n\t\t\t\tvar t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\r\n\r\n\t\t\t\t// rescale tangents for parametrization in [0,1]\r\n\t\t\t\tt1 *= dt1;\r\n\t\t\t\tt2 *= dt1;\r\n\r\n\t\t\t\tinit( x1, x2, t1, t2 );\r\n\r\n\t\t\t},\r\n\r\n\t\t\tcalc: function ( t ) {\r\n\r\n\t\t\t\tvar t2 = t * t;\r\n\t\t\t\tvar t3 = t2 * t;\r\n\t\t\t\treturn c0 + c1 * t + c2 * t2 + c3 * t3;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar tmp = new Vector3();\r\n\tvar px = new CubicPoly(), py = new CubicPoly(), pz = new CubicPoly();\r\n\r\n\tfunction CatmullRomCurve3( points, closed, curveType, tension ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'CatmullRomCurve3';\r\n\r\n\t\tthis.points = points || [];\r\n\t\tthis.closed = closed || false;\r\n\t\tthis.curveType = curveType || 'centripetal';\r\n\t\tthis.tension = tension || 0.5;\r\n\r\n\t}\r\n\r\n\tCatmullRomCurve3.prototype = Object.create( Curve.prototype );\r\n\tCatmullRomCurve3.prototype.constructor = CatmullRomCurve3;\r\n\r\n\tCatmullRomCurve3.prototype.isCatmullRomCurve3 = true;\r\n\r\n\tCatmullRomCurve3.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector3();\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar l = points.length;\r\n\r\n\t\tvar p = ( l - ( this.closed ? 0 : 1 ) ) * t;\r\n\t\tvar intPoint = Math.floor( p );\r\n\t\tvar weight = p - intPoint;\r\n\r\n\t\tif ( this.closed ) {\r\n\r\n\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / l ) + 1 ) * l;\r\n\r\n\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\r\n\r\n\t\t\tintPoint = l - 2;\r\n\t\t\tweight = 1;\r\n\r\n\t\t}\r\n\r\n\t\tvar p0, p1, p2, p3; // 4 points\r\n\r\n\t\tif ( this.closed || intPoint > 0 ) {\r\n\r\n\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// extrapolate first point\r\n\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\r\n\t\t\tp0 = tmp;\r\n\r\n\t\t}\r\n\r\n\t\tp1 = points[ intPoint % l ];\r\n\t\tp2 = points[ ( intPoint + 1 ) % l ];\r\n\r\n\t\tif ( this.closed || intPoint + 2 < l ) {\r\n\r\n\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// extrapolate last point\r\n\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\r\n\t\t\tp3 = tmp;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.curveType === 'centripetal' || this.curveType === 'chordal' ) {\r\n\r\n\t\t\t// init Centripetal / Chordal Catmull-Rom\r\n\t\t\tvar pow = this.curveType === 'chordal' ? 0.5 : 0.25;\r\n\t\t\tvar dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\r\n\t\t\tvar dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\r\n\t\t\tvar dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\r\n\r\n\t\t\t// safety check for repeated points\r\n\t\t\tif ( dt1 < 1e-4 ) { dt1 = 1.0; }\r\n\t\t\tif ( dt0 < 1e-4 ) { dt0 = dt1; }\r\n\t\t\tif ( dt2 < 1e-4 ) { dt2 = dt1; }\r\n\r\n\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\r\n\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\r\n\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\r\n\r\n\t\t} else if ( this.curveType === 'catmullrom' ) {\r\n\r\n\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, this.tension );\r\n\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, this.tension );\r\n\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, this.tension );\r\n\r\n\t\t}\r\n\r\n\t\tpoint.set(\r\n\t\t\tpx.calc( weight ),\r\n\t\t\tpy.calc( weight ),\r\n\t\t\tpz.calc( weight )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tCatmullRomCurve3.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0, l = source.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = source.points[ i ];\r\n\r\n\t\t\tthis.points.push( point.clone() );\r\n\r\n\t\t}\r\n\r\n\t\tthis.closed = source.closed;\r\n\t\tthis.curveType = source.curveType;\r\n\t\tthis.tension = source.tension;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tCatmullRomCurve3.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.points = [];\r\n\r\n\t\tfor ( var i = 0, l = this.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = this.points[ i ];\r\n\t\t\tdata.points.push( point.toArray() );\r\n\r\n\t\t}\r\n\r\n\t\tdata.closed = this.closed;\r\n\t\tdata.curveType = this.curveType;\r\n\t\tdata.tension = this.tension;\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tCatmullRomCurve3.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0, l = json.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = json.points[ i ];\r\n\t\t\tthis.points.push( new Vector3().fromArray( point ) );\r\n\r\n\t\t}\r\n\r\n\t\tthis.closed = json.closed;\r\n\t\tthis.curveType = json.curveType;\r\n\t\tthis.tension = json.tension;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t *\r\n\t * Bezier Curves formulas obtained from\r\n\t * http://en.wikipedia.org/wiki/Bzier_curve\r\n\t */\r\n\r\n\tfunction CatmullRom( t, p0, p1, p2, p3 ) {\r\n\r\n\t\tvar v0 = ( p2 - p0 ) * 0.5;\r\n\t\tvar v1 = ( p3 - p1 ) * 0.5;\r\n\t\tvar t2 = t * t;\r\n\t\tvar t3 = t * t2;\r\n\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction QuadraticBezierP0( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn k * k * p;\r\n\r\n\t}\r\n\r\n\tfunction QuadraticBezierP1( t, p ) {\r\n\r\n\t\treturn 2 * ( 1 - t ) * t * p;\r\n\r\n\t}\r\n\r\n\tfunction QuadraticBezierP2( t, p ) {\r\n\r\n\t\treturn t * t * p;\r\n\r\n\t}\r\n\r\n\tfunction QuadraticBezier( t, p0, p1, p2 ) {\r\n\r\n\t\treturn QuadraticBezierP0( t, p0 ) + QuadraticBezierP1( t, p1 ) +\r\n\t\t\tQuadraticBezierP2( t, p2 );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction CubicBezierP0( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn k * k * k * p;\r\n\r\n\t}\r\n\r\n\tfunction CubicBezierP1( t, p ) {\r\n\r\n\t\tvar k = 1 - t;\r\n\t\treturn 3 * k * k * t * p;\r\n\r\n\t}\r\n\r\n\tfunction CubicBezierP2( t, p ) {\r\n\r\n\t\treturn 3 * ( 1 - t ) * t * t * p;\r\n\r\n\t}\r\n\r\n\tfunction CubicBezierP3( t, p ) {\r\n\r\n\t\treturn t * t * t * p;\r\n\r\n\t}\r\n\r\n\tfunction CubicBezier( t, p0, p1, p2, p3 ) {\r\n\r\n\t\treturn CubicBezierP0( t, p0 ) + CubicBezierP1( t, p1 ) + CubicBezierP2( t, p2 ) +\r\n\t\t\tCubicBezierP3( t, p3 );\r\n\r\n\t}\r\n\r\n\tfunction CubicBezierCurve( v0, v1, v2, v3 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'CubicBezierCurve';\r\n\r\n\t\tthis.v0 = v0 || new Vector2();\r\n\t\tthis.v1 = v1 || new Vector2();\r\n\t\tthis.v2 = v2 || new Vector2();\r\n\t\tthis.v3 = v3 || new Vector2();\r\n\r\n\t}\r\n\r\n\tCubicBezierCurve.prototype = Object.create( Curve.prototype );\r\n\tCubicBezierCurve.prototype.constructor = CubicBezierCurve;\r\n\r\n\tCubicBezierCurve.prototype.isCubicBezierCurve = true;\r\n\r\n\tCubicBezierCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\r\n\r\n\t\tpoint.set(\r\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\r\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v0.copy( source.v0 );\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\t\tthis.v3.copy( source.v3 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v0 = this.v0.toArray();\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\t\tdata.v3 = this.v3.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v0.fromArray( json.v0 );\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\t\tthis.v3.fromArray( json.v3 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction CubicBezierCurve3( v0, v1, v2, v3 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'CubicBezierCurve3';\r\n\r\n\t\tthis.v0 = v0 || new Vector3();\r\n\t\tthis.v1 = v1 || new Vector3();\r\n\t\tthis.v2 = v2 || new Vector3();\r\n\t\tthis.v3 = v3 || new Vector3();\r\n\r\n\t}\r\n\r\n\tCubicBezierCurve3.prototype = Object.create( Curve.prototype );\r\n\tCubicBezierCurve3.prototype.constructor = CubicBezierCurve3;\r\n\r\n\tCubicBezierCurve3.prototype.isCubicBezierCurve3 = true;\r\n\r\n\tCubicBezierCurve3.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector3();\r\n\r\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\r\n\r\n\t\tpoint.set(\r\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\r\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y ),\r\n\t\t\tCubicBezier( t, v0.z, v1.z, v2.z, v3.z )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve3.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v0.copy( source.v0 );\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\t\tthis.v3.copy( source.v3 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve3.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v0 = this.v0.toArray();\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\t\tdata.v3 = this.v3.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tCubicBezierCurve3.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v0.fromArray( json.v0 );\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\t\tthis.v3.fromArray( json.v3 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction LineCurve( v1, v2 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'LineCurve';\r\n\r\n\t\tthis.v1 = v1 || new Vector2();\r\n\t\tthis.v2 = v2 || new Vector2();\r\n\r\n\t}\r\n\r\n\tLineCurve.prototype = Object.create( Curve.prototype );\r\n\tLineCurve.prototype.constructor = LineCurve;\r\n\r\n\tLineCurve.prototype.isLineCurve = true;\r\n\r\n\tLineCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tif ( t === 1 ) {\r\n\r\n\t\t\tpoint.copy( this.v2 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\r\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\r\n\r\n\t\t}\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\t// Line curve is linear, so we can overwrite default getPointAt\r\n\r\n\tLineCurve.prototype.getPointAt = function ( u, optionalTarget ) {\r\n\r\n\t\treturn this.getPoint( u, optionalTarget );\r\n\r\n\t};\r\n\r\n\tLineCurve.prototype.getTangent = function ( /* t */ ) {\r\n\r\n\t\tvar tangent = this.v2.clone().sub( this.v1 );\r\n\r\n\t\treturn tangent.normalize();\r\n\r\n\t};\r\n\r\n\tLineCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tLineCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tLineCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction LineCurve3( v1, v2 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'LineCurve3';\r\n\r\n\t\tthis.v1 = v1 || new Vector3();\r\n\t\tthis.v2 = v2 || new Vector3();\r\n\r\n\t}\r\n\r\n\tLineCurve3.prototype = Object.create( Curve.prototype );\r\n\tLineCurve3.prototype.constructor = LineCurve3;\r\n\r\n\tLineCurve3.prototype.isLineCurve3 = true;\r\n\r\n\tLineCurve3.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector3();\r\n\r\n\t\tif ( t === 1 ) {\r\n\r\n\t\t\tpoint.copy( this.v2 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\r\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\r\n\r\n\t\t}\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\t// Line curve is linear, so we can overwrite default getPointAt\r\n\r\n\tLineCurve3.prototype.getPointAt = function ( u, optionalTarget ) {\r\n\r\n\t\treturn this.getPoint( u, optionalTarget );\r\n\r\n\t};\r\n\r\n\tLineCurve3.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tLineCurve3.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tLineCurve3.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction QuadraticBezierCurve( v0, v1, v2 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'QuadraticBezierCurve';\r\n\r\n\t\tthis.v0 = v0 || new Vector2();\r\n\t\tthis.v1 = v1 || new Vector2();\r\n\t\tthis.v2 = v2 || new Vector2();\r\n\r\n\t}\r\n\r\n\tQuadraticBezierCurve.prototype = Object.create( Curve.prototype );\r\n\tQuadraticBezierCurve.prototype.constructor = QuadraticBezierCurve;\r\n\r\n\tQuadraticBezierCurve.prototype.isQuadraticBezierCurve = true;\r\n\r\n\tQuadraticBezierCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2;\r\n\r\n\t\tpoint.set(\r\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\r\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v0.copy( source.v0 );\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v0 = this.v0.toArray();\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v0.fromArray( json.v0 );\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction QuadraticBezierCurve3( v0, v1, v2 ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'QuadraticBezierCurve3';\r\n\r\n\t\tthis.v0 = v0 || new Vector3();\r\n\t\tthis.v1 = v1 || new Vector3();\r\n\t\tthis.v2 = v2 || new Vector3();\r\n\r\n\t}\r\n\r\n\tQuadraticBezierCurve3.prototype = Object.create( Curve.prototype );\r\n\tQuadraticBezierCurve3.prototype.constructor = QuadraticBezierCurve3;\r\n\r\n\tQuadraticBezierCurve3.prototype.isQuadraticBezierCurve3 = true;\r\n\r\n\tQuadraticBezierCurve3.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector3();\r\n\r\n\t\tvar v0 = this.v0, v1 = this.v1, v2 = this.v2;\r\n\r\n\t\tpoint.set(\r\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\r\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y ),\r\n\t\t\tQuadraticBezier( t, v0.z, v1.z, v2.z )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve3.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.v0.copy( source.v0 );\r\n\t\tthis.v1.copy( source.v1 );\r\n\t\tthis.v2.copy( source.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve3.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.v0 = this.v0.toArray();\r\n\t\tdata.v1 = this.v1.toArray();\r\n\t\tdata.v2 = this.v2.toArray();\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tQuadraticBezierCurve3.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.v0.fromArray( json.v0 );\r\n\t\tthis.v1.fromArray( json.v1 );\r\n\t\tthis.v2.fromArray( json.v2 );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tfunction SplineCurve( points /* array of Vector2 */ ) {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'SplineCurve';\r\n\r\n\t\tthis.points = points || [];\r\n\r\n\t}\r\n\r\n\tSplineCurve.prototype = Object.create( Curve.prototype );\r\n\tSplineCurve.prototype.constructor = SplineCurve;\r\n\r\n\tSplineCurve.prototype.isSplineCurve = true;\r\n\r\n\tSplineCurve.prototype.getPoint = function ( t, optionalTarget ) {\r\n\r\n\t\tvar point = optionalTarget || new Vector2();\r\n\r\n\t\tvar points = this.points;\r\n\t\tvar p = ( points.length - 1 ) * t;\r\n\r\n\t\tvar intPoint = Math.floor( p );\r\n\t\tvar weight = p - intPoint;\r\n\r\n\t\tvar p0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\r\n\t\tvar p1 = points[ intPoint ];\r\n\t\tvar p2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\r\n\t\tvar p3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\r\n\r\n\t\tpoint.set(\r\n\t\t\tCatmullRom( weight, p0.x, p1.x, p2.x, p3.x ),\r\n\t\t\tCatmullRom( weight, p0.y, p1.y, p2.y, p3.y )\r\n\t\t);\r\n\r\n\t\treturn point;\r\n\r\n\t};\r\n\r\n\tSplineCurve.prototype.copy = function ( source ) {\r\n\r\n\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0, l = source.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = source.points[ i ];\r\n\r\n\t\t\tthis.points.push( point.clone() );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tSplineCurve.prototype.toJSON = function () {\r\n\r\n\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\tdata.points = [];\r\n\r\n\t\tfor ( var i = 0, l = this.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = this.points[ i ];\r\n\t\t\tdata.points.push( point.toArray() );\r\n\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\r\n\t};\r\n\r\n\tSplineCurve.prototype.fromJSON = function ( json ) {\r\n\r\n\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\tthis.points = [];\r\n\r\n\t\tfor ( var i = 0, l = json.points.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar point = json.points[ i ];\r\n\t\t\tthis.points.push( new Vector2().fromArray( point ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\r\n\r\n\tvar Curves = /*#__PURE__*/Object.freeze({\r\n\t\t__proto__: null,\r\n\t\tArcCurve: ArcCurve,\r\n\t\tCatmullRomCurve3: CatmullRomCurve3,\r\n\t\tCubicBezierCurve: CubicBezierCurve,\r\n\t\tCubicBezierCurve3: CubicBezierCurve3,\r\n\t\tEllipseCurve: EllipseCurve,\r\n\t\tLineCurve: LineCurve,\r\n\t\tLineCurve3: LineCurve3,\r\n\t\tQuadraticBezierCurve: QuadraticBezierCurve,\r\n\t\tQuadraticBezierCurve3: QuadraticBezierCurve3,\r\n\t\tSplineCurve: SplineCurve\r\n\t});\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t *\r\n\t **/\r\n\r\n\t/**************************************************************\r\n\t *\tCurved Path - a curve path is simply a array of connected\r\n\t *  curves, but retains the api of a curve\r\n\t **************************************************************/\r\n\r\n\tfunction CurvePath() {\r\n\r\n\t\tCurve.call( this );\r\n\r\n\t\tthis.type = 'CurvePath';\r\n\r\n\t\tthis.curves = [];\r\n\t\tthis.autoClose = false; // Automatically closes the path\r\n\r\n\t}\r\n\r\n\tCurvePath.prototype = Object.assign( Object.create( Curve.prototype ), {\r\n\r\n\t\tconstructor: CurvePath,\r\n\r\n\t\tadd: function ( curve ) {\r\n\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t},\r\n\r\n\t\tclosePath: function () {\r\n\r\n\t\t\t// Add a line curve if start and end of lines are not connected\r\n\t\t\tvar startPoint = this.curves[ 0 ].getPoint( 0 );\r\n\t\t\tvar endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\r\n\r\n\t\t\tif ( ! startPoint.equals( endPoint ) ) {\r\n\r\n\t\t\t\tthis.curves.push( new LineCurve( endPoint, startPoint ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// To get accurate point with reference to\r\n\t\t// entire path distance at time t,\r\n\t\t// following has to be done:\r\n\r\n\t\t// 1. Length of each sub path have to be known\r\n\t\t// 2. Locate and identify type of curve\r\n\t\t// 3. Get t for the curve\r\n\t\t// 4. Return curve.getPointAt(t')\r\n\r\n\t\tgetPoint: function ( t ) {\r\n\r\n\t\t\tvar d = t * this.getLength();\r\n\t\t\tvar curveLengths = this.getCurveLengths();\r\n\t\t\tvar i = 0;\r\n\r\n\t\t\t// To think about boundaries points.\r\n\r\n\t\t\twhile ( i < curveLengths.length ) {\r\n\r\n\t\t\t\tif ( curveLengths[ i ] >= d ) {\r\n\r\n\t\t\t\t\tvar diff = curveLengths[ i ] - d;\r\n\t\t\t\t\tvar curve = this.curves[ i ];\r\n\r\n\t\t\t\t\tvar segmentLength = curve.getLength();\r\n\t\t\t\t\tvar u = segmentLength === 0 ? 0 : 1 - diff / segmentLength;\r\n\r\n\t\t\t\t\treturn curve.getPointAt( u );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ti ++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t\t// loop where sum != 0, sum > d , sum+1 <d\r\n\r\n\t\t},\r\n\r\n\t\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\r\n\t\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\r\n\t\t// getPoint() depends on getLength\r\n\r\n\t\tgetLength: function () {\r\n\r\n\t\t\tvar lens = this.getCurveLengths();\r\n\t\t\treturn lens[ lens.length - 1 ];\r\n\r\n\t\t},\r\n\r\n\t\t// cacheLengths must be recalculated.\r\n\t\tupdateArcLengths: function () {\r\n\r\n\t\t\tthis.needsUpdate = true;\r\n\t\t\tthis.cacheLengths = null;\r\n\t\t\tthis.getCurveLengths();\r\n\r\n\t\t},\r\n\r\n\t\t// Compute lengths and cache them\r\n\t\t// We cannot overwrite getLengths() because UtoT mapping uses it.\r\n\r\n\t\tgetCurveLengths: function () {\r\n\r\n\t\t\t// We use cache values if curves and cache array are same length\r\n\r\n\t\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\r\n\r\n\t\t\t\treturn this.cacheLengths;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Get length of sub-curve\r\n\t\t\t// Push sums into cached array\r\n\r\n\t\t\tvar lengths = [], sums = 0;\r\n\r\n\t\t\tfor ( var i = 0, l = this.curves.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tsums += this.curves[ i ].getLength();\r\n\t\t\t\tlengths.push( sums );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cacheLengths = lengths;\r\n\r\n\t\t\treturn lengths;\r\n\r\n\t\t},\r\n\r\n\t\tgetSpacedPoints: function ( divisions ) {\r\n\r\n\t\t\tif ( divisions === undefined ) { divisions = 40; }\r\n\r\n\t\t\tvar points = [];\r\n\r\n\t\t\tfor ( var i = 0; i <= divisions; i ++ ) {\r\n\r\n\t\t\t\tpoints.push( this.getPoint( i / divisions ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.autoClose ) {\r\n\r\n\t\t\t\tpoints.push( points[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn points;\r\n\r\n\t\t},\r\n\r\n\t\tgetPoints: function ( divisions ) {\r\n\r\n\t\t\tdivisions = divisions || 12;\r\n\r\n\t\t\tvar points = [], last;\r\n\r\n\t\t\tfor ( var i = 0, curves = this.curves; i < curves.length; i ++ ) {\r\n\r\n\t\t\t\tvar curve = curves[ i ];\r\n\t\t\t\tvar resolution = ( curve && curve.isEllipseCurve ) ? divisions * 2\r\n\t\t\t\t\t: ( curve && ( curve.isLineCurve || curve.isLineCurve3 ) ) ? 1\r\n\t\t\t\t\t\t: ( curve && curve.isSplineCurve ) ? divisions * curve.points.length\r\n\t\t\t\t\t\t\t: divisions;\r\n\r\n\t\t\t\tvar pts = curve.getPoints( resolution );\r\n\r\n\t\t\t\tfor ( var j = 0; j < pts.length; j ++ ) {\r\n\r\n\t\t\t\t\tvar point = pts[ j ];\r\n\r\n\t\t\t\t\tif ( last && last.equals( point ) ) { continue; } // ensures no consecutive points are duplicates\r\n\r\n\t\t\t\t\tpoints.push( point );\r\n\t\t\t\t\tlast = point;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.autoClose && points.length > 1 && ! points[ points.length - 1 ].equals( points[ 0 ] ) ) {\r\n\r\n\t\t\t\tpoints.push( points[ 0 ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn points;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tCurve.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.curves = [];\r\n\r\n\t\t\tfor ( var i = 0, l = source.curves.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar curve = source.curves[ i ];\r\n\r\n\t\t\t\tthis.curves.push( curve.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.autoClose = source.autoClose;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = Curve.prototype.toJSON.call( this );\r\n\r\n\t\t\tdata.autoClose = this.autoClose;\r\n\t\t\tdata.curves = [];\r\n\r\n\t\t\tfor ( var i = 0, l = this.curves.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar curve = this.curves[ i ];\r\n\t\t\t\tdata.curves.push( curve.toJSON() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tfromJSON: function ( json ) {\r\n\r\n\t\t\tCurve.prototype.fromJSON.call( this, json );\r\n\r\n\t\t\tthis.autoClose = json.autoClose;\r\n\t\t\tthis.curves = [];\r\n\r\n\t\t\tfor ( var i = 0, l = json.curves.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar curve = json.curves[ i ];\r\n\t\t\t\tthis.curves.push( new Curves[ curve.type ]().fromJSON( curve ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * Creates free form 2d path using series of points, lines or curves.\r\n\t **/\r\n\r\n\tfunction Path( points ) {\r\n\r\n\t\tCurvePath.call( this );\r\n\r\n\t\tthis.type = 'Path';\r\n\r\n\t\tthis.currentPoint = new Vector2();\r\n\r\n\t\tif ( points ) {\r\n\r\n\t\t\tthis.setFromPoints( points );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tPath.prototype = Object.assign( Object.create( CurvePath.prototype ), {\r\n\r\n\t\tconstructor: Path,\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tthis.moveTo( points[ 0 ].x, points[ 0 ].y );\r\n\r\n\t\t\tfor ( var i = 1, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.lineTo( points[ i ].x, points[ i ].y );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmoveTo: function ( x, y ) {\r\n\r\n\t\t\tthis.currentPoint.set( x, y ); // TODO consider referencing vectors instead of copying?\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlineTo: function ( x, y ) {\r\n\r\n\t\t\tvar curve = new LineCurve( this.currentPoint.clone(), new Vector2( x, y ) );\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tthis.currentPoint.set( x, y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tquadraticCurveTo: function ( aCPx, aCPy, aX, aY ) {\r\n\r\n\t\t\tvar curve = new QuadraticBezierCurve(\r\n\t\t\t\tthis.currentPoint.clone(),\r\n\t\t\t\tnew Vector2( aCPx, aCPy ),\r\n\t\t\t\tnew Vector2( aX, aY )\r\n\t\t\t);\r\n\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tthis.currentPoint.set( aX, aY );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tbezierCurveTo: function ( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\r\n\r\n\t\t\tvar curve = new CubicBezierCurve(\r\n\t\t\t\tthis.currentPoint.clone(),\r\n\t\t\t\tnew Vector2( aCP1x, aCP1y ),\r\n\t\t\t\tnew Vector2( aCP2x, aCP2y ),\r\n\t\t\t\tnew Vector2( aX, aY )\r\n\t\t\t);\r\n\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tthis.currentPoint.set( aX, aY );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsplineThru: function ( pts /*Array of Vector*/ ) {\r\n\r\n\t\t\tvar npts = [ this.currentPoint.clone() ].concat( pts );\r\n\r\n\t\t\tvar curve = new SplineCurve( npts );\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tthis.currentPoint.copy( pts[ pts.length - 1 ] );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tarc: function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\t\t\tvar x0 = this.currentPoint.x;\r\n\t\t\tvar y0 = this.currentPoint.y;\r\n\r\n\t\t\tthis.absarc( aX + x0, aY + y0, aRadius,\r\n\t\t\t\taStartAngle, aEndAngle, aClockwise );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tabsarc: function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\r\n\r\n\t\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tellipse: function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\t\t\tvar x0 = this.currentPoint.x;\r\n\t\t\tvar y0 = this.currentPoint.y;\r\n\r\n\t\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tabsellipse: function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\r\n\r\n\t\t\tvar curve = new EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\r\n\r\n\t\t\tif ( this.curves.length > 0 ) {\r\n\r\n\t\t\t\t// if a previous curve is present, attempt to join\r\n\t\t\t\tvar firstPoint = curve.getPoint( 0 );\r\n\r\n\t\t\t\tif ( ! firstPoint.equals( this.currentPoint ) ) {\r\n\r\n\t\t\t\t\tthis.lineTo( firstPoint.x, firstPoint.y );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.curves.push( curve );\r\n\r\n\t\t\tvar lastPoint = curve.getPoint( 1 );\r\n\t\t\tthis.currentPoint.copy( lastPoint );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tCurvePath.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.currentPoint.copy( source.currentPoint );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = CurvePath.prototype.toJSON.call( this );\r\n\r\n\t\t\tdata.currentPoint = this.currentPoint.toArray();\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tfromJSON: function ( json ) {\r\n\r\n\t\t\tCurvePath.prototype.fromJSON.call( this, json );\r\n\r\n\t\t\tthis.currentPoint.fromArray( json.currentPoint );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * Defines a 2d shape plane using paths.\r\n\t **/\r\n\r\n\t// STEP 1 Create a path.\r\n\t// STEP 2 Turn path into shape.\r\n\t// STEP 3 ExtrudeGeometry takes in Shape/Shapes\r\n\t// STEP 3a - Extract points from each shape, turn to vertices\r\n\t// STEP 3b - Triangulate each shape, add faces.\r\n\r\n\tfunction Shape( points ) {\r\n\r\n\t\tPath.call( this, points );\r\n\r\n\t\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\t\tthis.type = 'Shape';\r\n\r\n\t\tthis.holes = [];\r\n\r\n\t}\r\n\r\n\tShape.prototype = Object.assign( Object.create( Path.prototype ), {\r\n\r\n\t\tconstructor: Shape,\r\n\r\n\t\tgetPointsHoles: function ( divisions ) {\r\n\r\n\t\t\tvar holesPts = [];\r\n\r\n\t\t\tfor ( var i = 0, l = this.holes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn holesPts;\r\n\r\n\t\t},\r\n\r\n\t\t// get points of shape and holes (keypoints based on segments parameter)\r\n\r\n\t\textractPoints: function ( divisions ) {\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tshape: this.getPoints( divisions ),\r\n\t\t\t\tholes: this.getPointsHoles( divisions )\r\n\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tPath.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.holes = [];\r\n\r\n\t\t\tfor ( var i = 0, l = source.holes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar hole = source.holes[ i ];\r\n\r\n\t\t\t\tthis.holes.push( hole.clone() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = Path.prototype.toJSON.call( this );\r\n\r\n\t\t\tdata.uuid = this.uuid;\r\n\t\t\tdata.holes = [];\r\n\r\n\t\t\tfor ( var i = 0, l = this.holes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar hole = this.holes[ i ];\r\n\t\t\t\tdata.holes.push( hole.toJSON() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t},\r\n\r\n\t\tfromJSON: function ( json ) {\r\n\r\n\t\t\tPath.prototype.fromJSON.call( this, json );\r\n\r\n\t\t\tthis.uuid = json.uuid;\r\n\t\t\tthis.holes = [];\r\n\r\n\t\t\tfor ( var i = 0, l = json.holes.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar hole = json.holes[ i ];\r\n\t\t\t\tthis.holes.push( new Path().fromJSON( hole ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Light( color, intensity ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Light';\r\n\r\n\t\tthis.color = new Color( color );\r\n\t\tthis.intensity = intensity !== undefined ? intensity : 1;\r\n\r\n\t\tthis.receiveShadow = undefined;\r\n\r\n\t}\r\n\r\n\tLight.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Light,\r\n\r\n\t\tisLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tObject3D.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.color.copy( source.color );\r\n\t\t\tthis.intensity = source.intensity;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tdata.object.color = this.color.getHex();\r\n\t\t\tdata.object.intensity = this.intensity;\r\n\r\n\t\t\tif ( this.groundColor !== undefined ) { data.object.groundColor = this.groundColor.getHex(); }\r\n\r\n\t\t\tif ( this.distance !== undefined ) { data.object.distance = this.distance; }\r\n\t\t\tif ( this.angle !== undefined ) { data.object.angle = this.angle; }\r\n\t\t\tif ( this.decay !== undefined ) { data.object.decay = this.decay; }\r\n\t\t\tif ( this.penumbra !== undefined ) { data.object.penumbra = this.penumbra; }\r\n\r\n\t\t\tif ( this.shadow !== undefined ) { data.object.shadow = this.shadow.toJSON(); }\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction HemisphereLight( skyColor, groundColor, intensity ) {\r\n\r\n\t\tLight.call( this, skyColor, intensity );\r\n\r\n\t\tthis.type = 'HemisphereLight';\r\n\r\n\t\tthis.castShadow = undefined;\r\n\r\n\t\tthis.position.copy( Object3D.DefaultUp );\r\n\t\tthis.updateMatrix();\r\n\r\n\t\tthis.groundColor = new Color( groundColor );\r\n\r\n\t}\r\n\r\n\tHemisphereLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: HemisphereLight,\r\n\r\n\t\tisHemisphereLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.groundColor.copy( source.groundColor );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction LightShadow( camera ) {\r\n\r\n\t\tthis.camera = camera;\r\n\r\n\t\tthis.bias = 0;\r\n\t\tthis.radius = 1;\r\n\r\n\t\tthis.mapSize = new Vector2( 512, 512 );\r\n\r\n\t\tthis.map = null;\r\n\t\tthis.mapPass = null;\r\n\t\tthis.matrix = new Matrix4();\r\n\r\n\t\tthis._frustum = new Frustum();\r\n\t\tthis._frameExtents = new Vector2( 1, 1 );\r\n\r\n\t\tthis._viewportCount = 1;\r\n\r\n\t\tthis._viewports = [\r\n\r\n\t\t\tnew Vector4( 0, 0, 1, 1 )\r\n\r\n\t\t];\r\n\r\n\t}\r\n\r\n\tObject.assign( LightShadow.prototype, {\r\n\r\n\t\t_projScreenMatrix: new Matrix4(),\r\n\r\n\t\t_lightPositionWorld: new Vector3(),\r\n\r\n\t\t_lookTarget: new Vector3(),\r\n\r\n\t\tgetViewportCount: function () {\r\n\r\n\t\t\treturn this._viewportCount;\r\n\r\n\t\t},\r\n\r\n\t\tgetFrustum: function () {\r\n\r\n\t\t\treturn this._frustum;\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrices: function ( light ) {\r\n\r\n\t\t\tvar shadowCamera = this.camera,\r\n\t\t\t\tshadowMatrix = this.matrix,\r\n\t\t\t\tprojScreenMatrix = this._projScreenMatrix,\r\n\t\t\t\tlookTarget = this._lookTarget,\r\n\t\t\t\tlightPositionWorld = this._lightPositionWorld;\r\n\r\n\t\t\tlightPositionWorld.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\tshadowCamera.position.copy( lightPositionWorld );\r\n\r\n\t\t\tlookTarget.setFromMatrixPosition( light.target.matrixWorld );\r\n\t\t\tshadowCamera.lookAt( lookTarget );\r\n\t\t\tshadowCamera.updateMatrixWorld();\r\n\r\n\t\t\tprojScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\r\n\t\t\tthis._frustum.setFromProjectionMatrix( projScreenMatrix );\r\n\r\n\t\t\tshadowMatrix.set(\r\n\t\t\t\t0.5, 0.0, 0.0, 0.5,\r\n\t\t\t\t0.0, 0.5, 0.0, 0.5,\r\n\t\t\t\t0.0, 0.0, 0.5, 0.5,\r\n\t\t\t\t0.0, 0.0, 0.0, 1.0\r\n\t\t\t);\r\n\r\n\t\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\r\n\t\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\r\n\r\n\t\t},\r\n\r\n\t\tgetViewport: function ( viewportIndex ) {\r\n\r\n\t\t\treturn this._viewports[ viewportIndex ];\r\n\r\n\t\t},\r\n\r\n\t\tgetFrameExtents: function () {\r\n\r\n\t\t\treturn this._frameExtents;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tthis.camera = source.camera.clone();\r\n\r\n\t\t\tthis.bias = source.bias;\r\n\t\t\tthis.radius = source.radius;\r\n\r\n\t\t\tthis.mapSize.copy( source.mapSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar object = {};\r\n\r\n\t\t\tif ( this.bias !== 0 ) { object.bias = this.bias; }\r\n\t\t\tif ( this.radius !== 1 ) { object.radius = this.radius; }\r\n\t\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) { object.mapSize = this.mapSize.toArray(); }\r\n\r\n\t\t\tobject.camera = this.camera.toJSON( false ).object;\r\n\t\t\tdelete object.camera.matrix;\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction SpotLightShadow() {\r\n\r\n\t\tLightShadow.call( this, new PerspectiveCamera( 50, 1, 0.5, 500 ) );\r\n\r\n\t}\r\n\r\n\tSpotLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\r\n\r\n\t\tconstructor: SpotLightShadow,\r\n\r\n\t\tisSpotLightShadow: true,\r\n\r\n\t\tupdateMatrices: function ( light ) {\r\n\r\n\t\t\tvar camera = this.camera;\r\n\r\n\t\t\tvar fov = MathUtils.RAD2DEG * 2 * light.angle;\r\n\t\t\tvar aspect = this.mapSize.width / this.mapSize.height;\r\n\t\t\tvar far = light.distance || camera.far;\r\n\r\n\t\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\r\n\r\n\t\t\t\tcamera.fov = fov;\r\n\t\t\t\tcamera.aspect = aspect;\r\n\t\t\t\tcamera.far = far;\r\n\t\t\t\tcamera.updateProjectionMatrix();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tLightShadow.prototype.updateMatrices.call( this, light );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction SpotLight( color, intensity, distance, angle, penumbra, decay ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'SpotLight';\r\n\r\n\t\tthis.position.copy( Object3D.DefaultUp );\r\n\t\tthis.updateMatrix();\r\n\r\n\t\tthis.target = new Object3D();\r\n\r\n\t\tObject.defineProperty( this, 'power', {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\t// intensity = power per solid angle.\r\n\t\t\t\t// ref: equation (17) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\n\t\t\t\treturn this.intensity * Math.PI;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( power ) {\r\n\r\n\t\t\t\t// intensity = power per solid angle.\r\n\t\t\t\t// ref: equation (17) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\n\t\t\t\tthis.intensity = power / Math.PI;\r\n\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\t\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\r\n\t\tthis.penumbra = ( penumbra !== undefined ) ? penumbra : 0;\r\n\t\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\t\tthis.shadow = new SpotLightShadow();\r\n\r\n\t}\r\n\r\n\tSpotLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: SpotLight,\r\n\r\n\t\tisSpotLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.distance = source.distance;\r\n\t\t\tthis.angle = source.angle;\r\n\t\t\tthis.penumbra = source.penumbra;\r\n\t\t\tthis.decay = source.decay;\r\n\r\n\t\t\tthis.target = source.target.clone();\r\n\r\n\t\t\tthis.shadow = source.shadow.clone();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction PointLightShadow() {\r\n\r\n\t\tLightShadow.call( this, new PerspectiveCamera( 90, 1, 0.5, 500 ) );\r\n\r\n\t\tthis._frameExtents = new Vector2( 4, 2 );\r\n\r\n\t\tthis._viewportCount = 6;\r\n\r\n\t\tthis._viewports = [\r\n\t\t\t// These viewports map a cube-map onto a 2D texture with the\r\n\t\t\t// following orientation:\r\n\t\t\t//\r\n\t\t\t//  xzXZ\r\n\t\t\t//   y Y\r\n\t\t\t//\r\n\t\t\t// X - Positive x direction\r\n\t\t\t// x - Negative x direction\r\n\t\t\t// Y - Positive y direction\r\n\t\t\t// y - Negative y direction\r\n\t\t\t// Z - Positive z direction\r\n\t\t\t// z - Negative z direction\r\n\r\n\t\t\t// positive X\r\n\t\t\tnew Vector4( 2, 1, 1, 1 ),\r\n\t\t\t// negative X\r\n\t\t\tnew Vector4( 0, 1, 1, 1 ),\r\n\t\t\t// positive Z\r\n\t\t\tnew Vector4( 3, 1, 1, 1 ),\r\n\t\t\t// negative Z\r\n\t\t\tnew Vector4( 1, 1, 1, 1 ),\r\n\t\t\t// positive Y\r\n\t\t\tnew Vector4( 3, 0, 1, 1 ),\r\n\t\t\t// negative Y\r\n\t\t\tnew Vector4( 1, 0, 1, 1 )\r\n\t\t];\r\n\r\n\t\tthis._cubeDirections = [\r\n\t\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\r\n\t\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\r\n\t\t];\r\n\r\n\t\tthis._cubeUps = [\r\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\r\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\r\n\t\t];\r\n\r\n\t}\r\n\r\n\tPointLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\r\n\r\n\t\tconstructor: PointLightShadow,\r\n\r\n\t\tisPointLightShadow: true,\r\n\r\n\t\tupdateMatrices: function ( light, viewportIndex ) {\r\n\r\n\t\t\tif ( viewportIndex === undefined ) { viewportIndex = 0; }\r\n\r\n\t\t\tvar camera = this.camera,\r\n\t\t\t\tshadowMatrix = this.matrix,\r\n\t\t\t\tlightPositionWorld = this._lightPositionWorld,\r\n\t\t\t\tlookTarget = this._lookTarget,\r\n\t\t\t\tprojScreenMatrix = this._projScreenMatrix;\r\n\r\n\t\t\tlightPositionWorld.setFromMatrixPosition( light.matrixWorld );\r\n\t\t\tcamera.position.copy( lightPositionWorld );\r\n\r\n\t\t\tlookTarget.copy( camera.position );\r\n\t\t\tlookTarget.add( this._cubeDirections[ viewportIndex ] );\r\n\t\t\tcamera.up.copy( this._cubeUps[ viewportIndex ] );\r\n\t\t\tcamera.lookAt( lookTarget );\r\n\t\t\tcamera.updateMatrixWorld();\r\n\r\n\t\t\tshadowMatrix.makeTranslation( - lightPositionWorld.x, - lightPositionWorld.y, - lightPositionWorld.z );\r\n\r\n\t\t\tprojScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\r\n\t\t\tthis._frustum.setFromProjectionMatrix( projScreenMatrix );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\r\n\tfunction PointLight( color, intensity, distance, decay ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'PointLight';\r\n\r\n\t\tObject.defineProperty( this, 'power', {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\t// intensity = power per solid angle.\r\n\t\t\t\t// ref: equation (15) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\n\t\t\t\treturn this.intensity * 4 * Math.PI;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( power ) {\r\n\r\n\t\t\t\t// intensity = power per solid angle.\r\n\t\t\t\t// ref: equation (15) from https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\r\n\t\t\t\tthis.intensity = power / ( 4 * Math.PI );\r\n\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\tthis.distance = ( distance !== undefined ) ? distance : 0;\r\n\t\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\r\n\r\n\t\tthis.shadow = new PointLightShadow();\r\n\r\n\t}\r\n\r\n\tPointLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: PointLight,\r\n\r\n\t\tisPointLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.distance = source.distance;\r\n\t\t\tthis.decay = source.decay;\r\n\r\n\t\t\tthis.shadow = source.shadow.clone();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author arose / http://github.com/arose\r\n\t */\r\n\r\n\tfunction OrthographicCamera( left, right, top, bottom, near, far ) {\r\n\r\n\t\tCamera.call( this );\r\n\r\n\t\tthis.type = 'OrthographicCamera';\r\n\r\n\t\tthis.zoom = 1;\r\n\t\tthis.view = null;\r\n\r\n\t\tthis.left = ( left !== undefined ) ? left : - 1;\r\n\t\tthis.right = ( right !== undefined ) ? right : 1;\r\n\t\tthis.top = ( top !== undefined ) ? top : 1;\r\n\t\tthis.bottom = ( bottom !== undefined ) ? bottom : - 1;\r\n\r\n\t\tthis.near = ( near !== undefined ) ? near : 0.1;\r\n\t\tthis.far = ( far !== undefined ) ? far : 2000;\r\n\r\n\t\tthis.updateProjectionMatrix();\r\n\r\n\t}\r\n\r\n\tOrthographicCamera.prototype = Object.assign( Object.create( Camera.prototype ), {\r\n\r\n\t\tconstructor: OrthographicCamera,\r\n\r\n\t\tisOrthographicCamera: true,\r\n\r\n\t\tcopy: function ( source, recursive ) {\r\n\r\n\t\t\tCamera.prototype.copy.call( this, source, recursive );\r\n\r\n\t\t\tthis.left = source.left;\r\n\t\t\tthis.right = source.right;\r\n\t\t\tthis.top = source.top;\r\n\t\t\tthis.bottom = source.bottom;\r\n\t\t\tthis.near = source.near;\r\n\t\t\tthis.far = source.far;\r\n\r\n\t\t\tthis.zoom = source.zoom;\r\n\t\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetViewOffset: function ( fullWidth, fullHeight, x, y, width, height ) {\r\n\r\n\t\t\tif ( this.view === null ) {\r\n\r\n\t\t\t\tthis.view = {\r\n\t\t\t\t\tenabled: true,\r\n\t\t\t\t\tfullWidth: 1,\r\n\t\t\t\t\tfullHeight: 1,\r\n\t\t\t\t\toffsetX: 0,\r\n\t\t\t\t\toffsetY: 0,\r\n\t\t\t\t\twidth: 1,\r\n\t\t\t\t\theight: 1\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.view.enabled = true;\r\n\t\t\tthis.view.fullWidth = fullWidth;\r\n\t\t\tthis.view.fullHeight = fullHeight;\r\n\t\t\tthis.view.offsetX = x;\r\n\t\t\tthis.view.offsetY = y;\r\n\t\t\tthis.view.width = width;\r\n\t\t\tthis.view.height = height;\r\n\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\tclearViewOffset: function () {\r\n\r\n\t\t\tif ( this.view !== null ) {\r\n\r\n\t\t\t\tthis.view.enabled = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.updateProjectionMatrix();\r\n\r\n\t\t},\r\n\r\n\t\tupdateProjectionMatrix: function () {\r\n\r\n\t\t\tvar dx = ( this.right - this.left ) / ( 2 * this.zoom );\r\n\t\t\tvar dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\r\n\t\t\tvar cx = ( this.right + this.left ) / 2;\r\n\t\t\tvar cy = ( this.top + this.bottom ) / 2;\r\n\r\n\t\t\tvar left = cx - dx;\r\n\t\t\tvar right = cx + dx;\r\n\t\t\tvar top = cy + dy;\r\n\t\t\tvar bottom = cy - dy;\r\n\r\n\t\t\tif ( this.view !== null && this.view.enabled ) {\r\n\r\n\t\t\t\tvar scaleW = ( this.right - this.left ) / this.view.fullWidth / this.zoom;\r\n\t\t\t\tvar scaleH = ( this.top - this.bottom ) / this.view.fullHeight / this.zoom;\r\n\r\n\t\t\t\tleft += scaleW * this.view.offsetX;\r\n\t\t\t\tright = left + scaleW * this.view.width;\r\n\t\t\t\ttop -= scaleH * this.view.offsetY;\r\n\t\t\t\tbottom = top - scaleH * this.view.height;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far );\r\n\r\n\t\t\tthis.projectionMatrixInverse.getInverse( this.projectionMatrix );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Object3D.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tdata.object.zoom = this.zoom;\r\n\t\t\tdata.object.left = this.left;\r\n\t\t\tdata.object.right = this.right;\r\n\t\t\tdata.object.top = this.top;\r\n\t\t\tdata.object.bottom = this.bottom;\r\n\t\t\tdata.object.near = this.near;\r\n\t\t\tdata.object.far = this.far;\r\n\r\n\t\t\tif ( this.view !== null ) { data.object.view = Object.assign( {}, this.view ); }\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction DirectionalLightShadow() {\r\n\r\n\t\tLightShadow.call( this, new OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\r\n\r\n\t}\r\n\r\n\tDirectionalLightShadow.prototype = Object.assign( Object.create( LightShadow.prototype ), {\r\n\r\n\t\tconstructor: DirectionalLightShadow,\r\n\r\n\t\tisDirectionalLightShadow: true,\r\n\r\n\t\tupdateMatrices: function ( light ) {\r\n\r\n\t\t\tLightShadow.prototype.updateMatrices.call( this, light );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction DirectionalLight( color, intensity ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'DirectionalLight';\r\n\r\n\t\tthis.position.copy( Object3D.DefaultUp );\r\n\t\tthis.updateMatrix();\r\n\r\n\t\tthis.target = new Object3D();\r\n\r\n\t\tthis.shadow = new DirectionalLightShadow();\r\n\r\n\t}\r\n\r\n\tDirectionalLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: DirectionalLight,\r\n\r\n\t\tisDirectionalLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.target = source.target.clone();\r\n\r\n\t\t\tthis.shadow = source.shadow.clone();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction AmbientLight( color, intensity ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'AmbientLight';\r\n\r\n\t\tthis.castShadow = undefined;\r\n\r\n\t}\r\n\r\n\tAmbientLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: AmbientLight,\r\n\r\n\t\tisAmbientLight: true\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author abelnation / http://github.com/abelnation\r\n\t */\r\n\r\n\tfunction RectAreaLight( color, intensity, width, height ) {\r\n\r\n\t\tLight.call( this, color, intensity );\r\n\r\n\t\tthis.type = 'RectAreaLight';\r\n\r\n\t\tthis.width = ( width !== undefined ) ? width : 10;\r\n\t\tthis.height = ( height !== undefined ) ? height : 10;\r\n\r\n\t}\r\n\r\n\tRectAreaLight.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: RectAreaLight,\r\n\r\n\t\tisRectAreaLight: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.width = source.width;\r\n\t\t\tthis.height = source.height;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Light.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\tdata.object.width = this.width;\r\n\t\t\tdata.object.height = this.height;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction MaterialLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t\tthis.textures = {};\r\n\r\n\t}\r\n\r\n\tMaterialLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: MaterialLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar loader = new FileLoader( scope.manager );\r\n\t\t\tloader.setPath( scope.path );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( json ) {\r\n\r\n\t\t\tvar textures = this.textures;\r\n\r\n\t\t\tfunction getTexture( name ) {\r\n\r\n\t\t\t\tif ( textures[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn textures[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar material = new Materials[ json.type ]();\r\n\r\n\t\t\tif ( json.uuid !== undefined ) { material.uuid = json.uuid; }\r\n\t\t\tif ( json.name !== undefined ) { material.name = json.name; }\r\n\t\t\tif ( json.color !== undefined ) { material.color.setHex( json.color ); }\r\n\t\t\tif ( json.roughness !== undefined ) { material.roughness = json.roughness; }\r\n\t\t\tif ( json.metalness !== undefined ) { material.metalness = json.metalness; }\r\n\t\t\tif ( json.sheen !== undefined ) { material.sheen = new Color().setHex( json.sheen ); }\r\n\t\t\tif ( json.emissive !== undefined ) { material.emissive.setHex( json.emissive ); }\r\n\t\t\tif ( json.specular !== undefined ) { material.specular.setHex( json.specular ); }\r\n\t\t\tif ( json.shininess !== undefined ) { material.shininess = json.shininess; }\r\n\t\t\tif ( json.clearcoat !== undefined ) { material.clearcoat = json.clearcoat; }\r\n\t\t\tif ( json.clearcoatRoughness !== undefined ) { material.clearcoatRoughness = json.clearcoatRoughness; }\r\n\t\t\tif ( json.fog !== undefined ) { material.fog = json.fog; }\r\n\t\t\tif ( json.flatShading !== undefined ) { material.flatShading = json.flatShading; }\r\n\t\t\tif ( json.blending !== undefined ) { material.blending = json.blending; }\r\n\t\t\tif ( json.combine !== undefined ) { material.combine = json.combine; }\r\n\t\t\tif ( json.side !== undefined ) { material.side = json.side; }\r\n\t\t\tif ( json.opacity !== undefined ) { material.opacity = json.opacity; }\r\n\t\t\tif ( json.transparent !== undefined ) { material.transparent = json.transparent; }\r\n\t\t\tif ( json.alphaTest !== undefined ) { material.alphaTest = json.alphaTest; }\r\n\t\t\tif ( json.depthTest !== undefined ) { material.depthTest = json.depthTest; }\r\n\t\t\tif ( json.depthWrite !== undefined ) { material.depthWrite = json.depthWrite; }\r\n\t\t\tif ( json.colorWrite !== undefined ) { material.colorWrite = json.colorWrite; }\r\n\r\n\t\t\tif ( json.stencilWrite !== undefined ) { material.stencilWrite = json.stencilWrite; }\r\n\t\t\tif ( json.stencilWriteMask !== undefined ) { material.stencilWriteMask = json.stencilWriteMask; }\r\n\t\t\tif ( json.stencilFunc !== undefined ) { material.stencilFunc = json.stencilFunc; }\r\n\t\t\tif ( json.stencilRef !== undefined ) { material.stencilRef = json.stencilRef; }\r\n\t\t\tif ( json.stencilFuncMask !== undefined ) { material.stencilFuncMask = json.stencilFuncMask; }\r\n\t\t\tif ( json.stencilFail !== undefined ) { material.stencilFail = json.stencilFail; }\r\n\t\t\tif ( json.stencilZFail !== undefined ) { material.stencilZFail = json.stencilZFail; }\r\n\t\t\tif ( json.stencilZPass !== undefined ) { material.stencilZPass = json.stencilZPass; }\r\n\r\n\t\t\tif ( json.wireframe !== undefined ) { material.wireframe = json.wireframe; }\r\n\t\t\tif ( json.wireframeLinewidth !== undefined ) { material.wireframeLinewidth = json.wireframeLinewidth; }\r\n\t\t\tif ( json.wireframeLinecap !== undefined ) { material.wireframeLinecap = json.wireframeLinecap; }\r\n\t\t\tif ( json.wireframeLinejoin !== undefined ) { material.wireframeLinejoin = json.wireframeLinejoin; }\r\n\r\n\t\t\tif ( json.rotation !== undefined ) { material.rotation = json.rotation; }\r\n\r\n\t\t\tif ( json.linewidth !== 1 ) { material.linewidth = json.linewidth; }\r\n\t\t\tif ( json.dashSize !== undefined ) { material.dashSize = json.dashSize; }\r\n\t\t\tif ( json.gapSize !== undefined ) { material.gapSize = json.gapSize; }\r\n\t\t\tif ( json.scale !== undefined ) { material.scale = json.scale; }\r\n\r\n\t\t\tif ( json.polygonOffset !== undefined ) { material.polygonOffset = json.polygonOffset; }\r\n\t\t\tif ( json.polygonOffsetFactor !== undefined ) { material.polygonOffsetFactor = json.polygonOffsetFactor; }\r\n\t\t\tif ( json.polygonOffsetUnits !== undefined ) { material.polygonOffsetUnits = json.polygonOffsetUnits; }\r\n\r\n\t\t\tif ( json.skinning !== undefined ) { material.skinning = json.skinning; }\r\n\t\t\tif ( json.morphTargets !== undefined ) { material.morphTargets = json.morphTargets; }\r\n\t\t\tif ( json.morphNormals !== undefined ) { material.morphNormals = json.morphNormals; }\r\n\t\t\tif ( json.dithering !== undefined ) { material.dithering = json.dithering; }\r\n\r\n\t\t\tif ( json.vertexTangents !== undefined ) { material.vertexTangents = json.vertexTangents; }\r\n\r\n\t\t\tif ( json.visible !== undefined ) { material.visible = json.visible; }\r\n\r\n\t\t\tif ( json.toneMapped !== undefined ) { material.toneMapped = json.toneMapped; }\r\n\r\n\t\t\tif ( json.userData !== undefined ) { material.userData = json.userData; }\r\n\r\n\t\t\tif ( json.vertexColors !== undefined ) {\r\n\r\n\t\t\t\tif ( typeof json.vertexColors === 'number' ) {\r\n\r\n\t\t\t\t\tmaterial.vertexColors = ( json.vertexColors > 0 ) ? true : false;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tmaterial.vertexColors = json.vertexColors;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Shader Material\r\n\r\n\t\t\tif ( json.uniforms !== undefined ) {\r\n\r\n\t\t\t\tfor ( var name in json.uniforms ) {\r\n\r\n\t\t\t\t\tvar uniform = json.uniforms[ name ];\r\n\r\n\t\t\t\t\tmaterial.uniforms[ name ] = {};\r\n\r\n\t\t\t\t\tswitch ( uniform.type ) {\r\n\r\n\t\t\t\t\t\tcase 't':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = getTexture( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'c':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Color().setHex( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'v2':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector2().fromArray( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'v3':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector3().fromArray( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'v4':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector4().fromArray( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'm3':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix3().fromArray( uniform.value );\r\n\r\n\t\t\t\t\t\tcase 'm4':\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix4().fromArray( uniform.value );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tmaterial.uniforms[ name ].value = uniform.value;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.defines !== undefined ) { material.defines = json.defines; }\r\n\t\t\tif ( json.vertexShader !== undefined ) { material.vertexShader = json.vertexShader; }\r\n\t\t\tif ( json.fragmentShader !== undefined ) { material.fragmentShader = json.fragmentShader; }\r\n\r\n\t\t\tif ( json.extensions !== undefined ) {\r\n\r\n\t\t\t\tfor ( var key in json.extensions ) {\r\n\r\n\t\t\t\t\tmaterial.extensions[ key ] = json.extensions[ key ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Deprecated\r\n\r\n\t\t\tif ( json.shading !== undefined ) { material.flatShading = json.shading === 1; } // THREE.FlatShading\r\n\r\n\t\t\t// for PointsMaterial\r\n\r\n\t\t\tif ( json.size !== undefined ) { material.size = json.size; }\r\n\t\t\tif ( json.sizeAttenuation !== undefined ) { material.sizeAttenuation = json.sizeAttenuation; }\r\n\r\n\t\t\t// maps\r\n\r\n\t\t\tif ( json.map !== undefined ) { material.map = getTexture( json.map ); }\r\n\t\t\tif ( json.matcap !== undefined ) { material.matcap = getTexture( json.matcap ); }\r\n\r\n\t\t\tif ( json.alphaMap !== undefined ) { material.alphaMap = getTexture( json.alphaMap ); }\r\n\r\n\t\t\tif ( json.bumpMap !== undefined ) { material.bumpMap = getTexture( json.bumpMap ); }\r\n\t\t\tif ( json.bumpScale !== undefined ) { material.bumpScale = json.bumpScale; }\r\n\r\n\t\t\tif ( json.normalMap !== undefined ) { material.normalMap = getTexture( json.normalMap ); }\r\n\t\t\tif ( json.normalMapType !== undefined ) { material.normalMapType = json.normalMapType; }\r\n\t\t\tif ( json.normalScale !== undefined ) {\r\n\r\n\t\t\t\tvar normalScale = json.normalScale;\r\n\r\n\t\t\t\tif ( Array.isArray( normalScale ) === false ) {\r\n\r\n\t\t\t\t\t// Blender exporter used to export a scalar. See #7459\r\n\r\n\t\t\t\t\tnormalScale = [ normalScale, normalScale ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmaterial.normalScale = new Vector2().fromArray( normalScale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.displacementMap !== undefined ) { material.displacementMap = getTexture( json.displacementMap ); }\r\n\t\t\tif ( json.displacementScale !== undefined ) { material.displacementScale = json.displacementScale; }\r\n\t\t\tif ( json.displacementBias !== undefined ) { material.displacementBias = json.displacementBias; }\r\n\r\n\t\t\tif ( json.roughnessMap !== undefined ) { material.roughnessMap = getTexture( json.roughnessMap ); }\r\n\t\t\tif ( json.metalnessMap !== undefined ) { material.metalnessMap = getTexture( json.metalnessMap ); }\r\n\r\n\t\t\tif ( json.emissiveMap !== undefined ) { material.emissiveMap = getTexture( json.emissiveMap ); }\r\n\t\t\tif ( json.emissiveIntensity !== undefined ) { material.emissiveIntensity = json.emissiveIntensity; }\r\n\r\n\t\t\tif ( json.specularMap !== undefined ) { material.specularMap = getTexture( json.specularMap ); }\r\n\r\n\t\t\tif ( json.envMap !== undefined ) { material.envMap = getTexture( json.envMap ); }\r\n\t\t\tif ( json.envMapIntensity !== undefined ) { material.envMapIntensity = json.envMapIntensity; }\r\n\r\n\t\t\tif ( json.reflectivity !== undefined ) { material.reflectivity = json.reflectivity; }\r\n\t\t\tif ( json.refractionRatio !== undefined ) { material.refractionRatio = json.refractionRatio; }\r\n\r\n\t\t\tif ( json.lightMap !== undefined ) { material.lightMap = getTexture( json.lightMap ); }\r\n\t\t\tif ( json.lightMapIntensity !== undefined ) { material.lightMapIntensity = json.lightMapIntensity; }\r\n\r\n\t\t\tif ( json.aoMap !== undefined ) { material.aoMap = getTexture( json.aoMap ); }\r\n\t\t\tif ( json.aoMapIntensity !== undefined ) { material.aoMapIntensity = json.aoMapIntensity; }\r\n\r\n\t\t\tif ( json.gradientMap !== undefined ) { material.gradientMap = getTexture( json.gradientMap ); }\r\n\r\n\t\t\tif ( json.clearcoatMap !== undefined ) { material.clearcoatMap = getTexture( json.clearcoatMap ); }\r\n\t\t\tif ( json.clearcoatRoughnessMap !== undefined ) { material.clearcoatRoughnessMap = getTexture( json.clearcoatRoughnessMap ); }\r\n\t\t\tif ( json.clearcoatNormalMap !== undefined ) { material.clearcoatNormalMap = getTexture( json.clearcoatNormalMap ); }\r\n\t\t\tif ( json.clearcoatNormalScale !== undefined ) { material.clearcoatNormalScale = new Vector2().fromArray( json.clearcoatNormalScale ); }\r\n\r\n\t\t\treturn material;\r\n\r\n\t\t},\r\n\r\n\t\tsetTextures: function ( value ) {\r\n\r\n\t\t\tthis.textures = value;\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author Don McCurdy / https://www.donmccurdy.com\r\n\t */\r\n\r\n\tvar LoaderUtils = {\r\n\r\n\t\tdecodeText: function ( array ) {\r\n\r\n\t\t\tif ( typeof TextDecoder !== 'undefined' ) {\r\n\r\n\t\t\t\treturn new TextDecoder().decode( array );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Avoid the String.fromCharCode.apply(null, array) shortcut, which\r\n\t\t\t// throws a \"maximum call stack size exceeded\" error for large arrays.\r\n\r\n\t\t\tvar s = '';\r\n\r\n\t\t\tfor ( var i = 0, il = array.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t// Implicitly assumes little-endian.\r\n\t\t\t\ts += String.fromCharCode( array[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\t// merges multi-byte utf-8 characters.\r\n\r\n\t\t\t\treturn decodeURIComponent( escape( s ) );\r\n\r\n\t\t\t} catch ( e ) { // see #16358\r\n\r\n\t\t\t\treturn s;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\textractUrlBase: function ( url ) {\r\n\r\n\t\t\tvar index = url.lastIndexOf( '/' );\r\n\r\n\t\t\tif ( index === - 1 ) { return './'; }\r\n\r\n\t\t\treturn url.substr( 0, index + 1 );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tfunction InstancedBufferGeometry() {\r\n\r\n\t\tBufferGeometry.call( this );\r\n\r\n\t\tthis.type = 'InstancedBufferGeometry';\r\n\t\tthis.maxInstancedCount = undefined;\r\n\r\n\t}\r\n\r\n\tInstancedBufferGeometry.prototype = Object.assign( Object.create( BufferGeometry.prototype ), {\r\n\r\n\t\tconstructor: InstancedBufferGeometry,\r\n\r\n\t\tisInstancedBufferGeometry: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tBufferGeometry.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.maxInstancedCount = source.maxInstancedCount;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function () {\r\n\r\n\t\t\tvar data = BufferGeometry.prototype.toJSON.call( this );\r\n\r\n\t\t\tdata.maxInstancedCount = this.maxInstancedCount;\r\n\r\n\t\t\tdata.isInstancedBufferGeometry = true;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tfunction InstancedBufferAttribute( array, itemSize, normalized, meshPerAttribute ) {\r\n\r\n\t\tif ( typeof ( normalized ) === 'number' ) {\r\n\r\n\t\t\tmeshPerAttribute = normalized;\r\n\r\n\t\t\tnormalized = false;\r\n\r\n\t\t\tconsole.error( 'THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.' );\r\n\r\n\t\t}\r\n\r\n\t\tBufferAttribute.call( this, array, itemSize, normalized );\r\n\r\n\t\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n\t}\r\n\r\n\tInstancedBufferAttribute.prototype = Object.assign( Object.create( BufferAttribute.prototype ), {\r\n\r\n\t\tconstructor: InstancedBufferAttribute,\r\n\r\n\t\tisInstancedBufferAttribute: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tBufferAttribute.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ()\t{\r\n\r\n\t\t\tvar data = BufferAttribute.prototype.toJSON.call( this );\r\n\r\n\t\t\tdata.meshPerAttribute = this.meshPerAttribute;\r\n\r\n\t\t\tdata.isInstancedBufferAttribute = true;\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction BufferGeometryLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tBufferGeometryLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: BufferGeometryLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar loader = new FileLoader( scope.manager );\r\n\t\t\tloader.setPath( scope.path );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( json ) {\r\n\r\n\t\t\tvar geometry = json.isInstancedBufferGeometry ? new InstancedBufferGeometry() : new BufferGeometry();\r\n\r\n\t\t\tvar index = json.data.index;\r\n\r\n\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\tvar typedArray = new TYPED_ARRAYS[ index.type ]( index.array );\r\n\t\t\t\tgeometry.setIndex( new BufferAttribute( typedArray, 1 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attributes = json.data.attributes;\r\n\r\n\t\t\tfor ( var key in attributes ) {\r\n\r\n\t\t\t\tvar attribute = attributes[ key ];\r\n\t\t\t\tvar typedArray = new TYPED_ARRAYS[ attribute.type ]( attribute.array );\r\n\t\t\t\tvar bufferAttributeConstr = attribute.isInstancedBufferAttribute ? InstancedBufferAttribute : BufferAttribute;\r\n\t\t\t\tvar bufferAttribute = new bufferAttributeConstr( typedArray, attribute.itemSize, attribute.normalized );\r\n\t\t\t\tif ( attribute.name !== undefined ) { bufferAttribute.name = attribute.name; }\r\n\t\t\t\tgeometry.setAttribute( key, bufferAttribute );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphAttributes = json.data.morphAttributes;\r\n\r\n\t\t\tif ( morphAttributes ) {\r\n\r\n\t\t\t\tfor ( var key in morphAttributes ) {\r\n\r\n\t\t\t\t\tvar attributeArray = morphAttributes[ key ];\r\n\r\n\t\t\t\t\tvar array = [];\r\n\r\n\t\t\t\t\tfor ( var i = 0, il = attributeArray.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar attribute = attributeArray[ i ];\r\n\t\t\t\t\t\tvar typedArray = new TYPED_ARRAYS[ attribute.type ]( attribute.array );\r\n\r\n\t\t\t\t\t\tvar bufferAttribute = new BufferAttribute( typedArray, attribute.itemSize, attribute.normalized );\r\n\t\t\t\t\t\tif ( attribute.name !== undefined ) { bufferAttribute.name = attribute.name; }\r\n\t\t\t\t\t\tarray.push( bufferAttribute );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.morphAttributes[ key ] = array;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar morphTargetsRelative = json.data.morphTargetsRelative;\r\n\r\n\t\t\tif ( morphTargetsRelative ) {\r\n\r\n\t\t\t\tgeometry.morphTargetsRelative = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar groups = json.data.groups || json.data.drawcalls || json.data.offsets;\r\n\r\n\t\t\tif ( groups !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, n = groups.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar group = groups[ i ];\r\n\r\n\t\t\t\t\tgeometry.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar boundingSphere = json.data.boundingSphere;\r\n\r\n\t\t\tif ( boundingSphere !== undefined ) {\r\n\r\n\t\t\t\tvar center = new Vector3();\r\n\r\n\t\t\t\tif ( boundingSphere.center !== undefined ) {\r\n\r\n\t\t\t\t\tcenter.fromArray( boundingSphere.center );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry.boundingSphere = new Sphere( center, boundingSphere.radius );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.name ) { geometry.name = json.name; }\r\n\t\t\tif ( json.userData ) { geometry.userData = json.userData; }\r\n\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar TYPED_ARRAYS = {\r\n\t\tInt8Array: Int8Array,\r\n\t\tUint8Array: Uint8Array,\r\n\t\t// Workaround for IE11 pre KB2929437. See #11440\r\n\t\tUint8ClampedArray: typeof Uint8ClampedArray !== 'undefined' ? Uint8ClampedArray : Uint8Array,\r\n\t\tInt16Array: Int16Array,\r\n\t\tUint16Array: Uint16Array,\r\n\t\tInt32Array: Int32Array,\r\n\t\tUint32Array: Uint32Array,\r\n\t\tFloat32Array: Float32Array,\r\n\t\tFloat64Array: Float64Array\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction ObjectLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tObjectLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: ObjectLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\r\n\t\t\tthis.resourcePath = this.resourcePath || path;\r\n\r\n\t\t\tvar loader = new FileLoader( scope.manager );\r\n\t\t\tloader.setPath( this.path );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tvar json = null;\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tjson = JSON.parse( text );\r\n\r\n\t\t\t\t} catch ( error ) {\r\n\r\n\t\t\t\t\tif ( onError !== undefined ) { onError( error ); }\r\n\r\n\t\t\t\t\tconsole.error( 'THREE:ObjectLoader: Can\\'t parse ' + url + '.', error.message );\r\n\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar metadata = json.metadata;\r\n\r\n\t\t\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.ObjectLoader: Can\\'t load ' + url );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.parse( json, onLoad );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( json, onLoad ) {\r\n\r\n\t\t\tvar shapes = this.parseShape( json.shapes );\r\n\t\t\tvar geometries = this.parseGeometries( json.geometries, shapes );\r\n\r\n\t\t\tvar images = this.parseImages( json.images, function () {\r\n\r\n\t\t\t\tif ( onLoad !== undefined ) { onLoad( object ); }\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tvar textures = this.parseTextures( json.textures, images );\r\n\t\t\tvar materials = this.parseMaterials( json.materials, textures );\r\n\r\n\t\t\tvar object = this.parseObject( json.object, geometries, materials );\r\n\r\n\t\t\tif ( json.animations ) {\r\n\r\n\t\t\t\tobject.animations = this.parseAnimations( json.animations );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json.images === undefined || json.images.length === 0 ) {\r\n\r\n\t\t\t\tif ( onLoad !== undefined ) { onLoad( object ); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t},\r\n\r\n\t\tparseShape: function ( json ) {\r\n\r\n\t\t\tvar shapes = {};\r\n\r\n\t\t\tif ( json !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar shape = new Shape().fromJSON( json[ i ] );\r\n\r\n\t\t\t\t\tshapes[ shape.uuid ] = shape;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn shapes;\r\n\r\n\t\t},\r\n\r\n\t\tparseGeometries: function ( json, shapes ) {\r\n\r\n\t\t\tvar geometries = {};\r\n\r\n\t\t\tif ( json !== undefined ) {\r\n\r\n\t\t\t\tvar bufferGeometryLoader = new BufferGeometryLoader();\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar geometry;\r\n\t\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\t\t\tcase 'PlaneGeometry':\r\n\t\t\t\t\t\tcase 'PlaneBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'BoxGeometry':\r\n\t\t\t\t\t\tcase 'BoxBufferGeometry':\r\n\t\t\t\t\t\tcase 'CubeGeometry': // backwards compatible\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.width,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.depth,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.depthSegments\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'CircleGeometry':\r\n\t\t\t\t\t\tcase 'CircleBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'CylinderGeometry':\r\n\t\t\t\t\t\tcase 'CylinderBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radiusTop,\r\n\t\t\t\t\t\t\t\tdata.radiusBottom,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.openEnded,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'ConeGeometry':\r\n\t\t\t\t\t\tcase 'ConeBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.height,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.openEnded,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'SphereGeometry':\r\n\t\t\t\t\t\tcase 'SphereBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.widthSegments,\r\n\t\t\t\t\t\t\t\tdata.heightSegments,\r\n\t\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\t\tdata.phiLength,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'DodecahedronGeometry':\r\n\t\t\t\t\t\tcase 'DodecahedronBufferGeometry':\r\n\t\t\t\t\t\tcase 'IcosahedronGeometry':\r\n\t\t\t\t\t\tcase 'IcosahedronBufferGeometry':\r\n\t\t\t\t\t\tcase 'OctahedronGeometry':\r\n\t\t\t\t\t\tcase 'OctahedronBufferGeometry':\r\n\t\t\t\t\t\tcase 'TetrahedronGeometry':\r\n\t\t\t\t\t\tcase 'TetrahedronBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.detail\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'RingGeometry':\r\n\t\t\t\t\t\tcase 'RingBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.innerRadius,\r\n\t\t\t\t\t\t\t\tdata.outerRadius,\r\n\t\t\t\t\t\t\t\tdata.thetaSegments,\r\n\t\t\t\t\t\t\t\tdata.phiSegments,\r\n\t\t\t\t\t\t\t\tdata.thetaStart,\r\n\t\t\t\t\t\t\t\tdata.thetaLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'TorusGeometry':\r\n\t\t\t\t\t\tcase 'TorusBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\t\tdata.arc\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'TorusKnotGeometry':\r\n\t\t\t\t\t\tcase 'TorusKnotBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.tube,\r\n\t\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.p,\r\n\t\t\t\t\t\t\t\tdata.q\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'TubeGeometry':\r\n\t\t\t\t\t\tcase 'TubeBufferGeometry':\r\n\r\n\t\t\t\t\t\t\t// This only works for built-in curves (e.g. CatmullRomCurve3).\r\n\t\t\t\t\t\t\t// User defined curves or instances of CurvePath will not be deserialized.\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tnew Curves[ data.path.type ]().fromJSON( data.path ),\r\n\t\t\t\t\t\t\t\tdata.tubularSegments,\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.radialSegments,\r\n\t\t\t\t\t\t\t\tdata.closed\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'LatheGeometry':\r\n\t\t\t\t\t\tcase 'LatheBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.points,\r\n\t\t\t\t\t\t\t\tdata.segments,\r\n\t\t\t\t\t\t\t\tdata.phiStart,\r\n\t\t\t\t\t\t\t\tdata.phiLength\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'PolyhedronGeometry':\r\n\t\t\t\t\t\tcase 'PolyhedronBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tdata.vertices,\r\n\t\t\t\t\t\t\t\tdata.indices,\r\n\t\t\t\t\t\t\t\tdata.radius,\r\n\t\t\t\t\t\t\t\tdata.details\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'ShapeGeometry':\r\n\t\t\t\t\t\tcase 'ShapeBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tvar geometryShapes = [];\r\n\r\n\t\t\t\t\t\t\tfor ( var j = 0, jl = data.shapes.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar shape = shapes[ data.shapes[ j ] ];\r\n\r\n\t\t\t\t\t\t\t\tgeometryShapes.push( shape );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tgeometryShapes,\r\n\t\t\t\t\t\t\t\tdata.curveSegments\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\r\n\t\t\t\t\t\tcase 'ExtrudeGeometry':\r\n\t\t\t\t\t\tcase 'ExtrudeBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tvar geometryShapes = [];\r\n\r\n\t\t\t\t\t\t\tfor ( var j = 0, jl = data.shapes.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar shape = shapes[ data.shapes[ j ] ];\r\n\r\n\t\t\t\t\t\t\t\tgeometryShapes.push( shape );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar extrudePath = data.options.extrudePath;\r\n\r\n\t\t\t\t\t\t\tif ( extrudePath !== undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tdata.options.extrudePath = new Curves[ extrudePath.type ]().fromJSON( extrudePath );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tgeometry = new Geometries[ data.type ](\r\n\t\t\t\t\t\t\t\tgeometryShapes,\r\n\t\t\t\t\t\t\t\tdata.options\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'BufferGeometry':\r\n\t\t\t\t\t\tcase 'InstancedBufferGeometry':\r\n\r\n\t\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'Geometry':\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.ObjectLoader: Loading \"Geometry\" is not supported anymore.' );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Unsupported geometry type \"' + data.type + '\"' );\r\n\r\n\t\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry.uuid = data.uuid;\r\n\r\n\t\t\t\t\tif ( data.name !== undefined ) { geometry.name = data.name; }\r\n\t\t\t\t\tif ( geometry.isBufferGeometry === true && data.userData !== undefined ) { geometry.userData = data.userData; }\r\n\r\n\t\t\t\t\tgeometries[ data.uuid ] = geometry;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn geometries;\r\n\r\n\t\t},\r\n\r\n\t\tparseMaterials: function ( json, textures ) {\r\n\r\n\t\t\tvar cache = {}; // MultiMaterial\r\n\t\t\tvar materials = {};\r\n\r\n\t\t\tif ( json !== undefined ) {\r\n\r\n\t\t\t\tvar loader = new MaterialLoader();\r\n\t\t\t\tloader.setTextures( textures );\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\t\tif ( data.type === 'MultiMaterial' ) {\r\n\r\n\t\t\t\t\t\t// Deprecated\r\n\r\n\t\t\t\t\t\tvar array = [];\r\n\r\n\t\t\t\t\t\tfor ( var j = 0; j < data.materials.length; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar material = data.materials[ j ];\r\n\r\n\t\t\t\t\t\t\tif ( cache[ material.uuid ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\tcache[ material.uuid ] = loader.parse( material );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tarray.push( cache[ material.uuid ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tmaterials[ data.uuid ] = array;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( cache[ data.uuid ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\tcache[ data.uuid ] = loader.parse( data );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tmaterials[ data.uuid ] = cache[ data.uuid ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn materials;\r\n\r\n\t\t},\r\n\r\n\t\tparseAnimations: function ( json ) {\r\n\r\n\t\t\tvar animations = [];\r\n\r\n\t\t\tfor ( var i = 0; i < json.length; i ++ ) {\r\n\r\n\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\tvar clip = AnimationClip.parse( data );\r\n\r\n\t\t\t\tif ( data.uuid !== undefined ) { clip.uuid = data.uuid; }\r\n\r\n\t\t\t\tanimations.push( clip );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn animations;\r\n\r\n\t\t},\r\n\r\n\t\tparseImages: function ( json, onLoad ) {\r\n\r\n\t\t\tvar scope = this;\r\n\t\t\tvar images = {};\r\n\r\n\t\t\tfunction loadImage( url ) {\r\n\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\t\treturn loader.load( url, function () {\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, undefined, function () {\r\n\r\n\t\t\t\t\tscope.manager.itemError( url );\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( json !== undefined && json.length > 0 ) {\r\n\r\n\t\t\t\tvar manager = new LoadingManager( onLoad );\r\n\r\n\t\t\t\tvar loader = new ImageLoader( manager );\r\n\t\t\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\t\t\tfor ( var i = 0, il = json.length; i < il; i ++ ) {\r\n\r\n\t\t\t\t\tvar image = json[ i ];\r\n\t\t\t\t\tvar url = image.url;\r\n\r\n\t\t\t\t\tif ( Array.isArray( url ) ) {\r\n\r\n\t\t\t\t\t\t// load array of images e.g CubeTexture\r\n\r\n\t\t\t\t\t\timages[ image.uuid ] = [];\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, jl = url.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tvar currentUrl = url[ j ];\r\n\r\n\t\t\t\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( currentUrl ) ? currentUrl : scope.resourcePath + currentUrl;\r\n\r\n\t\t\t\t\t\t\timages[ image.uuid ].push( loadImage( path ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// load single image\r\n\r\n\t\t\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( image.url ) ? image.url : scope.resourcePath + image.url;\r\n\r\n\t\t\t\t\t\timages[ image.uuid ] = loadImage( path );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn images;\r\n\r\n\t\t},\r\n\r\n\t\tparseTextures: function ( json, images ) {\r\n\r\n\t\t\tfunction parseConstant( value, type ) {\r\n\r\n\t\t\t\tif ( typeof value === 'number' ) { return value; }\r\n\r\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\r\n\r\n\t\t\t\treturn type[ value ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar textures = {};\r\n\r\n\t\t\tif ( json !== undefined ) {\r\n\r\n\t\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar data = json[ i ];\r\n\r\n\t\t\t\t\tif ( data.image === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( images[ data.image ] === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar texture;\r\n\r\n\t\t\t\t\tif ( Array.isArray( images[ data.image ] ) ) {\r\n\r\n\t\t\t\t\t\ttexture = new CubeTexture( images[ data.image ] );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ttexture = new Texture( images[ data.image ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\ttexture.uuid = data.uuid;\r\n\r\n\t\t\t\t\tif ( data.name !== undefined ) { texture.name = data.name; }\r\n\r\n\t\t\t\t\tif ( data.mapping !== undefined ) { texture.mapping = parseConstant( data.mapping, TEXTURE_MAPPING ); }\r\n\r\n\t\t\t\t\tif ( data.offset !== undefined ) { texture.offset.fromArray( data.offset ); }\r\n\t\t\t\t\tif ( data.repeat !== undefined ) { texture.repeat.fromArray( data.repeat ); }\r\n\t\t\t\t\tif ( data.center !== undefined ) { texture.center.fromArray( data.center ); }\r\n\t\t\t\t\tif ( data.rotation !== undefined ) { texture.rotation = data.rotation; }\r\n\r\n\t\t\t\t\tif ( data.wrap !== undefined ) {\r\n\r\n\t\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ], TEXTURE_WRAPPING );\r\n\t\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ], TEXTURE_WRAPPING );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( data.format !== undefined ) { texture.format = data.format; }\r\n\t\t\t\t\tif ( data.type !== undefined ) { texture.type = data.type; }\r\n\t\t\t\t\tif ( data.encoding !== undefined ) { texture.encoding = data.encoding; }\r\n\r\n\t\t\t\t\tif ( data.minFilter !== undefined ) { texture.minFilter = parseConstant( data.minFilter, TEXTURE_FILTER ); }\r\n\t\t\t\t\tif ( data.magFilter !== undefined ) { texture.magFilter = parseConstant( data.magFilter, TEXTURE_FILTER ); }\r\n\t\t\t\t\tif ( data.anisotropy !== undefined ) { texture.anisotropy = data.anisotropy; }\r\n\r\n\t\t\t\t\tif ( data.flipY !== undefined ) { texture.flipY = data.flipY; }\r\n\r\n\t\t\t\t\tif ( data.premultiplyAlpha !== undefined ) { texture.premultiplyAlpha = data.premultiplyAlpha; }\r\n\t\t\t\t\tif ( data.unpackAlignment !== undefined ) { texture.unpackAlignment = data.unpackAlignment; }\r\n\r\n\t\t\t\t\ttextures[ data.uuid ] = texture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn textures;\r\n\r\n\t\t},\r\n\r\n\t\tparseObject: function ( data, geometries, materials ) {\r\n\r\n\t\t\tvar object;\r\n\r\n\t\t\tfunction getGeometry( name ) {\r\n\r\n\t\t\t\tif ( geometries[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn geometries[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getMaterial( name ) {\r\n\r\n\t\t\t\tif ( name === undefined ) { return undefined; }\r\n\r\n\t\t\t\tif ( Array.isArray( name ) ) {\r\n\r\n\t\t\t\t\tvar array = [];\r\n\r\n\t\t\t\t\tfor ( var i = 0, l = name.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar uuid = name[ i ];\r\n\r\n\t\t\t\t\t\tif ( materials[ uuid ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', uuid );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tarray.push( materials[ uuid ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn array;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( materials[ name ] === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn materials[ name ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( data.type ) {\r\n\r\n\t\t\t\tcase 'Scene':\r\n\r\n\t\t\t\t\tobject = new Scene();\r\n\r\n\t\t\t\t\tif ( data.background !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( Number.isInteger( data.background ) ) {\r\n\r\n\t\t\t\t\t\t\tobject.background = new Color( data.background );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( data.fog !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( data.fog.type === 'Fog' ) {\r\n\r\n\t\t\t\t\t\t\tobject.fog = new Fog( data.fog.color, data.fog.near, data.fog.far );\r\n\r\n\t\t\t\t\t\t} else if ( data.fog.type === 'FogExp2' ) {\r\n\r\n\t\t\t\t\t\t\tobject.fog = new FogExp2( data.fog.color, data.fog.density );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PerspectiveCamera':\r\n\r\n\t\t\t\t\tobject = new PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\r\n\r\n\t\t\t\t\tif ( data.focus !== undefined ) { object.focus = data.focus; }\r\n\t\t\t\t\tif ( data.zoom !== undefined ) { object.zoom = data.zoom; }\r\n\t\t\t\t\tif ( data.filmGauge !== undefined ) { object.filmGauge = data.filmGauge; }\r\n\t\t\t\t\tif ( data.filmOffset !== undefined ) { object.filmOffset = data.filmOffset; }\r\n\t\t\t\t\tif ( data.view !== undefined ) { object.view = Object.assign( {}, data.view ); }\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'OrthographicCamera':\r\n\r\n\t\t\t\t\tobject = new OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\r\n\r\n\t\t\t\t\tif ( data.zoom !== undefined ) { object.zoom = data.zoom; }\r\n\t\t\t\t\tif ( data.view !== undefined ) { object.view = Object.assign( {}, data.view ); }\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'AmbientLight':\r\n\r\n\t\t\t\t\tobject = new AmbientLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'DirectionalLight':\r\n\r\n\t\t\t\t\tobject = new DirectionalLight( data.color, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointLight':\r\n\r\n\t\t\t\t\tobject = new PointLight( data.color, data.intensity, data.distance, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'RectAreaLight':\r\n\r\n\t\t\t\t\tobject = new RectAreaLight( data.color, data.intensity, data.width, data.height );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'SpotLight':\r\n\r\n\t\t\t\t\tobject = new SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'HemisphereLight':\r\n\r\n\t\t\t\t\tobject = new HemisphereLight( data.color, data.groundColor, data.intensity );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'SkinnedMesh':\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.' );\r\n\r\n\t\t\t\tcase 'Mesh':\r\n\r\n\t\t\t\t\tvar geometry = getGeometry( data.geometry );\r\n\t\t\t\t\tvar material = getMaterial( data.material );\r\n\r\n\t\t\t\t\tobject = new Mesh( geometry, material );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'InstancedMesh':\r\n\r\n\t\t\t\t\tvar geometry = getGeometry( data.geometry );\r\n\t\t\t\t\tvar material = getMaterial( data.material );\r\n\t\t\t\t\tvar count = data.count;\r\n\t\t\t\t\tvar instanceMatrix = data.instanceMatrix;\r\n\r\n\t\t\t\t\tobject = new InstancedMesh( geometry, material, count );\r\n\t\t\t\t\tobject.instanceMatrix = new BufferAttribute( new Float32Array( instanceMatrix.array ), 16 );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'LOD':\r\n\r\n\t\t\t\t\tobject = new LOD();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Line':\r\n\r\n\t\t\t\t\tobject = new Line( getGeometry( data.geometry ), getMaterial( data.material ), data.mode );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'LineLoop':\r\n\r\n\t\t\t\t\tobject = new LineLoop( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'LineSegments':\r\n\r\n\t\t\t\t\tobject = new LineSegments( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'PointCloud':\r\n\t\t\t\tcase 'Points':\r\n\r\n\t\t\t\t\tobject = new Points( getGeometry( data.geometry ), getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Sprite':\r\n\r\n\t\t\t\t\tobject = new Sprite( getMaterial( data.material ) );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'Group':\r\n\r\n\t\t\t\t\tobject = new Group();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\r\n\t\t\t\t\tobject = new Object3D();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.uuid = data.uuid;\r\n\r\n\t\t\tif ( data.name !== undefined ) { object.name = data.name; }\r\n\r\n\t\t\tif ( data.matrix !== undefined ) {\r\n\r\n\t\t\t\tobject.matrix.fromArray( data.matrix );\r\n\r\n\t\t\t\tif ( data.matrixAutoUpdate !== undefined ) { object.matrixAutoUpdate = data.matrixAutoUpdate; }\r\n\t\t\t\tif ( object.matrixAutoUpdate ) { object.matrix.decompose( object.position, object.quaternion, object.scale ); }\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( data.position !== undefined ) { object.position.fromArray( data.position ); }\r\n\t\t\t\tif ( data.rotation !== undefined ) { object.rotation.fromArray( data.rotation ); }\r\n\t\t\t\tif ( data.quaternion !== undefined ) { object.quaternion.fromArray( data.quaternion ); }\r\n\t\t\t\tif ( data.scale !== undefined ) { object.scale.fromArray( data.scale ); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.castShadow !== undefined ) { object.castShadow = data.castShadow; }\r\n\t\t\tif ( data.receiveShadow !== undefined ) { object.receiveShadow = data.receiveShadow; }\r\n\r\n\t\t\tif ( data.shadow ) {\r\n\r\n\t\t\t\tif ( data.shadow.bias !== undefined ) { object.shadow.bias = data.shadow.bias; }\r\n\t\t\t\tif ( data.shadow.radius !== undefined ) { object.shadow.radius = data.shadow.radius; }\r\n\t\t\t\tif ( data.shadow.mapSize !== undefined ) { object.shadow.mapSize.fromArray( data.shadow.mapSize ); }\r\n\t\t\t\tif ( data.shadow.camera !== undefined ) { object.shadow.camera = this.parseObject( data.shadow.camera ); }\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.visible !== undefined ) { object.visible = data.visible; }\r\n\t\t\tif ( data.frustumCulled !== undefined ) { object.frustumCulled = data.frustumCulled; }\r\n\t\t\tif ( data.renderOrder !== undefined ) { object.renderOrder = data.renderOrder; }\r\n\t\t\tif ( data.userData !== undefined ) { object.userData = data.userData; }\r\n\t\t\tif ( data.layers !== undefined ) { object.layers.mask = data.layers; }\r\n\r\n\t\t\tif ( data.children !== undefined ) {\r\n\r\n\t\t\t\tvar children = data.children;\r\n\r\n\t\t\t\tfor ( var i = 0; i < children.length; i ++ ) {\r\n\r\n\t\t\t\t\tobject.add( this.parseObject( children[ i ], geometries, materials ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( data.type === 'LOD' ) {\r\n\r\n\t\t\t\tif ( data.autoUpdate !== undefined ) { object.autoUpdate = data.autoUpdate; }\r\n\r\n\t\t\t\tvar levels = data.levels;\r\n\r\n\t\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\r\n\r\n\t\t\t\t\tvar level = levels[ l ];\r\n\t\t\t\t\tvar child = object.getObjectByProperty( 'uuid', level.object );\r\n\r\n\t\t\t\t\tif ( child !== undefined ) {\r\n\r\n\t\t\t\t\t\tobject.addLevel( child, level.distance );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar TEXTURE_MAPPING = {\r\n\t\tUVMapping: UVMapping,\r\n\t\tCubeReflectionMapping: CubeReflectionMapping,\r\n\t\tCubeRefractionMapping: CubeRefractionMapping,\r\n\t\tEquirectangularReflectionMapping: EquirectangularReflectionMapping,\r\n\t\tEquirectangularRefractionMapping: EquirectangularRefractionMapping,\r\n\t\tSphericalReflectionMapping: SphericalReflectionMapping,\r\n\t\tCubeUVReflectionMapping: CubeUVReflectionMapping,\r\n\t\tCubeUVRefractionMapping: CubeUVRefractionMapping\r\n\t};\r\n\r\n\tvar TEXTURE_WRAPPING = {\r\n\t\tRepeatWrapping: RepeatWrapping,\r\n\t\tClampToEdgeWrapping: ClampToEdgeWrapping,\r\n\t\tMirroredRepeatWrapping: MirroredRepeatWrapping\r\n\t};\r\n\r\n\tvar TEXTURE_FILTER = {\r\n\t\tNearestFilter: NearestFilter,\r\n\t\tNearestMipmapNearestFilter: NearestMipmapNearestFilter,\r\n\t\tNearestMipmapLinearFilter: NearestMipmapLinearFilter,\r\n\t\tLinearFilter: LinearFilter,\r\n\t\tLinearMipmapNearestFilter: LinearMipmapNearestFilter,\r\n\t\tLinearMipmapLinearFilter: LinearMipmapLinearFilter\r\n\t};\r\n\r\n\t/**\r\n\t * @author thespite / http://clicktorelease.com/\r\n\t */\r\n\r\n\r\n\tfunction ImageBitmapLoader( manager ) {\r\n\r\n\t\tif ( typeof createImageBitmap === 'undefined' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: createImageBitmap() not supported.' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( typeof fetch === 'undefined' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: fetch() not supported.' );\r\n\r\n\t\t}\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t\tthis.options = undefined;\r\n\r\n\t}\r\n\r\n\tImageBitmapLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: ImageBitmapLoader,\r\n\r\n\t\tsetOptions: function setOptions( options ) {\r\n\r\n\t\t\tthis.options = options;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tif ( url === undefined ) { url = ''; }\r\n\r\n\t\t\tif ( this.path !== undefined ) { url = this.path + url; }\r\n\r\n\t\t\turl = this.manager.resolveURL( url );\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar cached = Cache.get( url );\r\n\r\n\t\t\tif ( cached !== undefined ) {\r\n\r\n\t\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\tif ( onLoad ) { onLoad( cached ); }\r\n\r\n\t\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t\t}, 0 );\r\n\r\n\t\t\t\treturn cached;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfetch( url ).then( function ( res ) {\r\n\r\n\t\t\t\treturn res.blob();\r\n\r\n\t\t\t} ).then( function ( blob ) {\r\n\r\n\t\t\t\tif ( scope.options === undefined ) {\r\n\r\n\t\t\t\t\t// Workaround for FireFox. It causes an error if you pass options.\r\n\t\t\t\t\treturn createImageBitmap( blob );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\treturn createImageBitmap( blob, scope.options );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} ).then( function ( imageBitmap ) {\r\n\r\n\t\t\t\tCache.add( url, imageBitmap );\r\n\r\n\t\t\t\tif ( onLoad ) { onLoad( imageBitmap ); }\r\n\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} ).catch( function ( e ) {\r\n\r\n\t\t\t\tif ( onError ) { onError( e ); }\r\n\r\n\t\t\t\tscope.manager.itemError( url );\r\n\t\t\t\tscope.manager.itemEnd( url );\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tscope.manager.itemStart( url );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * minimal class for proxing functions to Path. Replaces old \"extractSubpaths()\"\r\n\t **/\r\n\r\n\tfunction ShapePath() {\r\n\r\n\t\tthis.type = 'ShapePath';\r\n\r\n\t\tthis.color = new Color();\r\n\r\n\t\tthis.subPaths = [];\r\n\t\tthis.currentPath = null;\r\n\r\n\t}\r\n\r\n\tObject.assign( ShapePath.prototype, {\r\n\r\n\t\tmoveTo: function ( x, y ) {\r\n\r\n\t\t\tthis.currentPath = new Path();\r\n\t\t\tthis.subPaths.push( this.currentPath );\r\n\t\t\tthis.currentPath.moveTo( x, y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlineTo: function ( x, y ) {\r\n\r\n\t\t\tthis.currentPath.lineTo( x, y );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tquadraticCurveTo: function ( aCPx, aCPy, aX, aY ) {\r\n\r\n\t\t\tthis.currentPath.quadraticCurveTo( aCPx, aCPy, aX, aY );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tbezierCurveTo: function ( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\r\n\r\n\t\t\tthis.currentPath.bezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsplineThru: function ( pts ) {\r\n\r\n\t\t\tthis.currentPath.splineThru( pts );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoShapes: function ( isCCW, noHoles ) {\r\n\r\n\t\t\tfunction toShapesNoHoles( inSubpaths ) {\r\n\r\n\t\t\t\tvar shapes = [];\r\n\r\n\t\t\t\tfor ( var i = 0, l = inSubpaths.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tvar tmpPath = inSubpaths[ i ];\r\n\r\n\t\t\t\t\tvar tmpShape = new Shape();\r\n\t\t\t\t\ttmpShape.curves = tmpPath.curves;\r\n\r\n\t\t\t\t\tshapes.push( tmpShape );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn shapes;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\r\n\r\n\t\t\t\tvar polyLen = inPolygon.length;\r\n\r\n\t\t\t\t// inPt on polygon contour => immediate success    or\r\n\t\t\t\t// toggling of inside/outside at every single! intersection point of an edge\r\n\t\t\t\t//  with the horizontal line through inPt, left of inPt\r\n\t\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\r\n\t\t\t\tvar inside = false;\r\n\t\t\t\tfor ( var p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\r\n\r\n\t\t\t\t\tvar edgeLowPt = inPolygon[ p ];\r\n\t\t\t\t\tvar edgeHighPt = inPolygon[ q ];\r\n\r\n\t\t\t\t\tvar edgeDx = edgeHighPt.x - edgeLowPt.x;\r\n\t\t\t\t\tvar edgeDy = edgeHighPt.y - edgeLowPt.y;\r\n\r\n\t\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\r\n\r\n\t\t\t\t\t\t// not parallel\r\n\t\t\t\t\t\tif ( edgeDy < 0 ) {\r\n\r\n\t\t\t\t\t\t\tedgeLowPt = inPolygon[ q ]; edgeDx = - edgeDx;\r\n\t\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\t{ continue; }\r\n\r\n\t\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\r\n\r\n\t\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\t{ return\ttrue; }\t\t// inPt is on contour ?\r\n\t\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tvar perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\r\n\t\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\t{ return\ttrue; }\t\t// inPt is on contour ?\r\n\t\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\t{ continue; }\r\n\t\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// parallel or collinear\r\n\t\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\t{ continue; }\t\t\t// parallel\r\n\t\t\t\t\t\t// edge lies on the same horizontal line as inPt\r\n\t\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\r\n\t\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\t{ return\ttrue; }\t// inPt: Point on contour !\r\n\t\t\t\t\t\t// continue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\tinside;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar isClockWise = ShapeUtils.isClockWise;\r\n\r\n\t\t\tvar subPaths = this.subPaths;\r\n\t\t\tif ( subPaths.length === 0 ) { return []; }\r\n\r\n\t\t\tif ( noHoles === true )\t{ return\ttoShapesNoHoles( subPaths ); }\r\n\r\n\r\n\t\t\tvar solid, tmpPath, tmpShape, shapes = [];\r\n\r\n\t\t\tif ( subPaths.length === 1 ) {\r\n\r\n\t\t\t\ttmpPath = subPaths[ 0 ];\r\n\t\t\t\ttmpShape = new Shape();\r\n\t\t\t\ttmpShape.curves = tmpPath.curves;\r\n\t\t\t\tshapes.push( tmpShape );\r\n\t\t\t\treturn shapes;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\r\n\t\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\r\n\r\n\t\t\t// console.log(\"Holes first\", holesFirst);\r\n\r\n\t\t\tvar betterShapeHoles = [];\r\n\t\t\tvar newShapes = [];\r\n\t\t\tvar newShapeHoles = [];\r\n\t\t\tvar mainIdx = 0;\r\n\t\t\tvar tmpPoints;\r\n\r\n\t\t\tnewShapes[ mainIdx ] = undefined;\r\n\t\t\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\t\t\tfor ( var i = 0, l = subPaths.length; i < l; i ++ ) {\r\n\r\n\t\t\t\ttmpPath = subPaths[ i ];\r\n\t\t\t\ttmpPoints = tmpPath.getPoints();\r\n\t\t\t\tsolid = isClockWise( tmpPoints );\r\n\t\t\t\tsolid = isCCW ? ! solid : solid;\r\n\r\n\t\t\t\tif ( solid ) {\r\n\r\n\t\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\t{ mainIdx ++; }\r\n\r\n\t\t\t\t\tnewShapes[ mainIdx ] = { s: new Shape(), p: tmpPoints };\r\n\t\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\r\n\r\n\t\t\t\t\tif ( holesFirst )\t{ mainIdx ++; }\r\n\t\t\t\t\tnewShapeHoles[ mainIdx ] = [];\r\n\r\n\t\t\t\t\t//console.log('cw', i);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\r\n\r\n\t\t\t\t\t//console.log('ccw', i);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// only Holes? -> probably all Shapes with wrong orientation\r\n\t\t\tif ( ! newShapes[ 0 ] )\t{ return\ttoShapesNoHoles( subPaths ); }\r\n\r\n\r\n\t\t\tif ( newShapes.length > 1 ) {\r\n\r\n\t\t\t\tvar ambiguous = false;\r\n\t\t\t\tvar toChange = [];\r\n\r\n\t\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\t\t\tbetterShapeHoles[ sIdx ] = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\r\n\r\n\t\t\t\t\tvar sho = newShapeHoles[ sIdx ];\r\n\r\n\t\t\t\t\tfor ( var hIdx = 0; hIdx < sho.length; hIdx ++ ) {\r\n\r\n\t\t\t\t\t\tvar ho = sho[ hIdx ];\r\n\t\t\t\t\t\tvar hole_unassigned = true;\r\n\r\n\t\t\t\t\t\tfor ( var s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\t{ toChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } ); }\r\n\t\t\t\t\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\t\t\t\t\thole_unassigned = false;\r\n\t\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tambiguous = true;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( hole_unassigned ) {\r\n\r\n\t\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// console.log(\"ambiguous: \", ambiguous);\r\n\t\t\t\tif ( toChange.length > 0 ) {\r\n\r\n\t\t\t\t\t// console.log(\"to change: \", toChange);\r\n\t\t\t\t\tif ( ! ambiguous )\t{ newShapeHoles = betterShapeHoles; }\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar tmpHoles;\r\n\r\n\t\t\tfor ( var i = 0, il = newShapes.length; i < il; i ++ ) {\r\n\r\n\t\t\t\ttmpShape = newShapes[ i ].s;\r\n\t\t\t\tshapes.push( tmpShape );\r\n\t\t\t\ttmpHoles = newShapeHoles[ i ];\r\n\r\n\t\t\t\tfor ( var j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\r\n\r\n\t\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//console.log(\"shape\", shapes);\r\n\r\n\t\t\treturn shapes;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\r\n\tfunction Font( data ) {\r\n\r\n\t\tthis.type = 'Font';\r\n\r\n\t\tthis.data = data;\r\n\r\n\t}\r\n\r\n\tObject.assign( Font.prototype, {\r\n\r\n\t\tisFont: true,\r\n\r\n\t\tgenerateShapes: function ( text, size ) {\r\n\r\n\t\t\tif ( size === undefined ) { size = 100; }\r\n\r\n\t\t\tvar shapes = [];\r\n\t\t\tvar paths = createPaths( text, size, this.data );\r\n\r\n\t\t\tfor ( var p = 0, pl = paths.length; p < pl; p ++ ) {\r\n\r\n\t\t\t\tArray.prototype.push.apply( shapes, paths[ p ].toShapes() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn shapes;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction createPaths( text, size, data ) {\r\n\r\n\t\tvar chars = Array.from ? Array.from( text ) : String( text ).split( '' ); // workaround for IE11, see #13988\r\n\t\tvar scale = size / data.resolution;\r\n\t\tvar line_height = ( data.boundingBox.yMax - data.boundingBox.yMin + data.underlineThickness ) * scale;\r\n\r\n\t\tvar paths = [];\r\n\r\n\t\tvar offsetX = 0, offsetY = 0;\r\n\r\n\t\tfor ( var i = 0; i < chars.length; i ++ ) {\r\n\r\n\t\t\tvar char = chars[ i ];\r\n\r\n\t\t\tif ( char === '\\n' ) {\r\n\r\n\t\t\t\toffsetX = 0;\r\n\t\t\t\toffsetY -= line_height;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar ret = createPath( char, scale, offsetX, offsetY, data );\r\n\t\t\t\toffsetX += ret.offsetX;\r\n\t\t\t\tpaths.push( ret.path );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn paths;\r\n\r\n\t}\r\n\r\n\tfunction createPath( char, scale, offsetX, offsetY, data ) {\r\n\r\n\t\tvar glyph = data.glyphs[ char ] || data.glyphs[ '?' ];\r\n\r\n\t\tif ( ! glyph ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Font: character \"' + char + '\" does not exists in font family ' + data.familyName + '.' );\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar path = new ShapePath();\r\n\r\n\t\tvar x, y, cpx, cpy, cpx1, cpy1, cpx2, cpy2;\r\n\r\n\t\tif ( glyph.o ) {\r\n\r\n\t\t\tvar outline = glyph._cachedOutline || ( glyph._cachedOutline = glyph.o.split( ' ' ) );\r\n\r\n\t\t\tfor ( var i = 0, l = outline.length; i < l; ) {\r\n\r\n\t\t\t\tvar action = outline[ i ++ ];\r\n\r\n\t\t\t\tswitch ( action ) {\r\n\r\n\t\t\t\t\tcase 'm': // moveTo\r\n\r\n\t\t\t\t\t\tx = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\ty = outline[ i ++ ] * scale + offsetY;\r\n\r\n\t\t\t\t\t\tpath.moveTo( x, y );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'l': // lineTo\r\n\r\n\t\t\t\t\t\tx = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\ty = outline[ i ++ ] * scale + offsetY;\r\n\r\n\t\t\t\t\t\tpath.lineTo( x, y );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'q': // quadraticCurveTo\r\n\r\n\t\t\t\t\t\tcpx = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy = outline[ i ++ ] * scale + offsetY;\r\n\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale + offsetY;\r\n\r\n\t\t\t\t\t\tpath.quadraticCurveTo( cpx1, cpy1, cpx, cpy );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'b': // bezierCurveTo\r\n\r\n\t\t\t\t\t\tcpx = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy = outline[ i ++ ] * scale + offsetY;\r\n\t\t\t\t\t\tcpx1 = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy1 = outline[ i ++ ] * scale + offsetY;\r\n\t\t\t\t\t\tcpx2 = outline[ i ++ ] * scale + offsetX;\r\n\t\t\t\t\t\tcpy2 = outline[ i ++ ] * scale + offsetY;\r\n\r\n\t\t\t\t\t\tpath.bezierCurveTo( cpx1, cpy1, cpx2, cpy2, cpx, cpy );\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn { offsetX: glyph.ha * scale, path: path };\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction FontLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tFontLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: FontLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tvar loader = new FileLoader( this.manager );\r\n\t\t\tloader.setPath( this.path );\r\n\t\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\t\tvar json;\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tjson = JSON.parse( text );\r\n\r\n\t\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.' );\r\n\t\t\t\t\tjson = JSON.parse( text.substring( 65, text.length - 2 ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar font = scope.parse( json );\r\n\r\n\t\t\t\tif ( onLoad ) { onLoad( font ); }\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t},\r\n\r\n\t\tparse: function ( json ) {\r\n\r\n\t\t\treturn new Font( json );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _context;\r\n\r\n\tvar AudioContext = {\r\n\r\n\t\tgetContext: function () {\r\n\r\n\t\t\tif ( _context === undefined ) {\r\n\r\n\t\t\t\t_context = new ( window.AudioContext || window.webkitAudioContext )();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn _context;\r\n\r\n\t\t},\r\n\r\n\t\tsetContext: function ( value ) {\r\n\r\n\t\t\t_context = value;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author Reece Aaron Lecrivain / http://reecenotes.com/\r\n\t */\r\n\r\n\tfunction AudioLoader( manager ) {\r\n\r\n\t\tLoader.call( this, manager );\r\n\r\n\t}\r\n\r\n\tAudioLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\r\n\r\n\t\tconstructor: AudioLoader,\r\n\r\n\t\tload: function ( url, onLoad, onProgress, onError ) {\r\n\r\n\t\t\tvar loader = new FileLoader( this.manager );\r\n\t\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\t\tloader.setPath( this.path );\r\n\t\t\tloader.load( url, function ( buffer ) {\r\n\r\n\t\t\t\t// Create a copy of the buffer. The `decodeAudioData` method\r\n\t\t\t\t// detaches the buffer when complete, preventing reuse.\r\n\t\t\t\tvar bufferCopy = buffer.slice( 0 );\r\n\r\n\t\t\t\tvar context = AudioContext.getContext();\r\n\t\t\t\tcontext.decodeAudioData( bufferCopy, function ( audioBuffer ) {\r\n\r\n\t\t\t\t\tonLoad( audioBuffer );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}, onProgress, onError );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * Primary reference:\r\n\t *   https://graphics.stanford.edu/papers/envmap/envmap.pdf\r\n\t *\r\n\t * Secondary reference:\r\n\t *   https://www.ppsloan.org/publications/StupidSH36.pdf\r\n\t */\r\n\r\n\t// 3-band SH defined by 9 coefficients\r\n\r\n\tfunction SphericalHarmonics3() {\r\n\r\n\t\tthis.coefficients = [];\r\n\r\n\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\tthis.coefficients.push( new Vector3() );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( SphericalHarmonics3.prototype, {\r\n\r\n\t\tisSphericalHarmonics3: true,\r\n\r\n\t\tset: function ( coefficients ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tthis.coefficients[ i ].copy( coefficients[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tzero: function () {\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tthis.coefficients[ i ].set( 0, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// get the radiance in the direction of the normal\r\n\t\t// target is a Vector3\r\n\t\tgetAt: function ( normal, target ) {\r\n\r\n\t\t\t// normal is assumed to be unit length\r\n\r\n\t\t\tvar x = normal.x, y = normal.y, z = normal.z;\r\n\r\n\t\t\tvar coeff = this.coefficients;\r\n\r\n\t\t\t// band 0\r\n\t\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.282095 );\r\n\r\n\t\t\t// band 1\r\n\t\t\ttarget.addScaledVector( coeff[ 1 ], 0.488603 * y );\r\n\t\t\ttarget.addScaledVector( coeff[ 2 ], 0.488603 * z );\r\n\t\t\ttarget.addScaledVector( coeff[ 3 ], 0.488603 * x );\r\n\r\n\t\t\t// band 2\r\n\t\t\ttarget.addScaledVector( coeff[ 4 ], 1.092548 * ( x * y ) );\r\n\t\t\ttarget.addScaledVector( coeff[ 5 ], 1.092548 * ( y * z ) );\r\n\t\t\ttarget.addScaledVector( coeff[ 6 ], 0.315392 * ( 3.0 * z * z - 1.0 ) );\r\n\t\t\ttarget.addScaledVector( coeff[ 7 ], 1.092548 * ( x * z ) );\r\n\t\t\ttarget.addScaledVector( coeff[ 8 ], 0.546274 * ( x * x - y * y ) );\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\t// get the irradiance (radiance convolved with cosine lobe) in the direction of the normal\r\n\t\t// target is a Vector3\r\n\t\t// https://graphics.stanford.edu/papers/envmap/envmap.pdf\r\n\t\tgetIrradianceAt: function ( normal, target ) {\r\n\r\n\t\t\t// normal is assumed to be unit length\r\n\r\n\t\t\tvar x = normal.x, y = normal.y, z = normal.z;\r\n\r\n\t\t\tvar coeff = this.coefficients;\r\n\r\n\t\t\t// band 0\r\n\t\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.886227 ); //  * 0.282095\r\n\r\n\t\t\t// band 1\r\n\t\t\ttarget.addScaledVector( coeff[ 1 ], 2.0 * 0.511664 * y ); // ( 2 *  / 3 ) * 0.488603\r\n\t\t\ttarget.addScaledVector( coeff[ 2 ], 2.0 * 0.511664 * z );\r\n\t\t\ttarget.addScaledVector( coeff[ 3 ], 2.0 * 0.511664 * x );\r\n\r\n\t\t\t// band 2\r\n\t\t\ttarget.addScaledVector( coeff[ 4 ], 2.0 * 0.429043 * x * y ); // (  / 4 ) * 1.092548\r\n\t\t\ttarget.addScaledVector( coeff[ 5 ], 2.0 * 0.429043 * y * z );\r\n\t\t\ttarget.addScaledVector( coeff[ 6 ], 0.743125 * z * z - 0.247708 ); // (  / 4 ) * 0.315392 * 3\r\n\t\t\ttarget.addScaledVector( coeff[ 7 ], 2.0 * 0.429043 * x * z );\r\n\t\t\ttarget.addScaledVector( coeff[ 8 ], 0.429043 * ( x * x - y * y ) ); // (  / 4 ) * 0.546274\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t},\r\n\r\n\t\tadd: function ( sh ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tthis.coefficients[ i ].add( sh.coefficients[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\taddScaledSH: function ( sh, s ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tthis.coefficients[ i ].addScaledVector( sh.coefficients[ i ], s );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tscale: function ( s ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tthis.coefficients[ i ].multiplyScalar( s );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tlerp: function ( sh, alpha ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tthis.coefficients[ i ].lerp( sh.coefficients[ i ], alpha );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( sh ) {\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tif ( ! this.coefficients[ i ].equals( sh.coefficients[ i ] ) ) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( sh ) {\r\n\r\n\t\t\treturn this.set( sh.coefficients );\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tvar coefficients = this.coefficients;\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tcoefficients[ i ].fromArray( array, offset + ( i * 3 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) { array = []; }\r\n\t\t\tif ( offset === undefined ) { offset = 0; }\r\n\r\n\t\t\tvar coefficients = this.coefficients;\r\n\r\n\t\t\tfor ( var i = 0; i < 9; i ++ ) {\r\n\r\n\t\t\t\tcoefficients[ i ].toArray( array, offset + ( i * 3 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( SphericalHarmonics3, {\r\n\r\n\t\t// evaluate the basis functions\r\n\t\t// shBasis is an Array[ 9 ]\r\n\t\tgetBasisAt: function ( normal, shBasis ) {\r\n\r\n\t\t\t// normal is assumed to be unit length\r\n\r\n\t\t\tvar x = normal.x, y = normal.y, z = normal.z;\r\n\r\n\t\t\t// band 0\r\n\t\t\tshBasis[ 0 ] = 0.282095;\r\n\r\n\t\t\t// band 1\r\n\t\t\tshBasis[ 1 ] = 0.488603 * y;\r\n\t\t\tshBasis[ 2 ] = 0.488603 * z;\r\n\t\t\tshBasis[ 3 ] = 0.488603 * x;\r\n\r\n\t\t\t// band 2\r\n\t\t\tshBasis[ 4 ] = 1.092548 * x * y;\r\n\t\t\tshBasis[ 5 ] = 1.092548 * y * z;\r\n\t\t\tshBasis[ 6 ] = 0.315392 * ( 3 * z * z - 1 );\r\n\t\t\tshBasis[ 7 ] = 1.092548 * x * z;\r\n\t\t\tshBasis[ 8 ] = 0.546274 * ( x * x - y * y );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * A LightProbe is a source of indirect-diffuse light\r\n\t */\r\n\r\n\tfunction LightProbe( sh, intensity ) {\r\n\r\n\t\tLight.call( this, undefined, intensity );\r\n\r\n\t\tthis.sh = ( sh !== undefined ) ? sh : new SphericalHarmonics3();\r\n\r\n\t}\r\n\r\n\tLightProbe.prototype = Object.assign( Object.create( Light.prototype ), {\r\n\r\n\t\tconstructor: LightProbe,\r\n\r\n\t\tisLightProbe: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLight.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.sh.copy( source.sh );\r\n\t\t\tthis.intensity = source.intensity;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = Light.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\t// data.sh = this.sh.toArray(); // todo\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction HemisphereLightProbe( skyColor, groundColor, intensity ) {\r\n\r\n\t\tLightProbe.call( this, undefined, intensity );\r\n\r\n\t\tvar color1 = new Color().set( skyColor );\r\n\t\tvar color2 = new Color().set( groundColor );\r\n\r\n\t\tvar sky = new Vector3( color1.r, color1.g, color1.b );\r\n\t\tvar ground = new Vector3( color2.r, color2.g, color2.b );\r\n\r\n\t\t// without extra factor of PI in the shader, should = 1 / Math.sqrt( Math.PI );\r\n\t\tvar c0 = Math.sqrt( Math.PI );\r\n\t\tvar c1 = c0 * Math.sqrt( 0.75 );\r\n\r\n\t\tthis.sh.coefficients[ 0 ].copy( sky ).add( ground ).multiplyScalar( c0 );\r\n\t\tthis.sh.coefficients[ 1 ].copy( sky ).sub( ground ).multiplyScalar( c1 );\r\n\r\n\t}\r\n\r\n\tHemisphereLightProbe.prototype = Object.assign( Object.create( LightProbe.prototype ), {\r\n\r\n\t\tconstructor: HemisphereLightProbe,\r\n\r\n\t\tisHemisphereLightProbe: true,\r\n\r\n\t\tcopy: function ( source ) { // modifying colors not currently supported\r\n\r\n\t\t\tLightProbe.prototype.copy.call( this, source );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = LightProbe.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\t// data.sh = this.sh.toArray(); // todo\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction AmbientLightProbe( color, intensity ) {\r\n\r\n\t\tLightProbe.call( this, undefined, intensity );\r\n\r\n\t\tvar color1 = new Color().set( color );\r\n\r\n\t\t// without extra factor of PI in the shader, would be 2 / Math.sqrt( Math.PI );\r\n\t\tthis.sh.coefficients[ 0 ].set( color1.r, color1.g, color1.b ).multiplyScalar( 2 * Math.sqrt( Math.PI ) );\r\n\r\n\t}\r\n\r\n\tAmbientLightProbe.prototype = Object.assign( Object.create( LightProbe.prototype ), {\r\n\r\n\t\tconstructor: AmbientLightProbe,\r\n\r\n\t\tisAmbientLightProbe: true,\r\n\r\n\t\tcopy: function ( source ) { // modifying color not currently supported\r\n\r\n\t\t\tLightProbe.prototype.copy.call( this, source );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoJSON: function ( meta ) {\r\n\r\n\t\t\tvar data = LightProbe.prototype.toJSON.call( this, meta );\r\n\r\n\t\t\t// data.sh = this.sh.toArray(); // todo\r\n\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tvar _eyeRight = new Matrix4();\r\n\tvar _eyeLeft = new Matrix4();\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction StereoCamera() {\r\n\r\n\t\tthis.type = 'StereoCamera';\r\n\r\n\t\tthis.aspect = 1;\r\n\r\n\t\tthis.eyeSep = 0.064;\r\n\r\n\t\tthis.cameraL = new PerspectiveCamera();\r\n\t\tthis.cameraL.layers.enable( 1 );\r\n\t\tthis.cameraL.matrixAutoUpdate = false;\r\n\r\n\t\tthis.cameraR = new PerspectiveCamera();\r\n\t\tthis.cameraR.layers.enable( 2 );\r\n\t\tthis.cameraR.matrixAutoUpdate = false;\r\n\r\n\t\tthis._cache = {\r\n\t\t\tfocus: null,\r\n\t\t\tfov: null,\r\n\t\t\taspect: null,\r\n\t\t\tnear: null,\r\n\t\t\tfar: null,\r\n\t\t\tzoom: null,\r\n\t\t\teyeSep: null\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tObject.assign( StereoCamera.prototype, {\r\n\r\n\t\tupdate: function ( camera ) {\r\n\r\n\t\t\tvar cache = this._cache;\r\n\r\n\t\t\tvar needsUpdate = cache.focus !== camera.focus || cache.fov !== camera.fov ||\r\n\t\t\t\tcache.aspect !== camera.aspect * this.aspect || cache.near !== camera.near ||\r\n\t\t\t\tcache.far !== camera.far || cache.zoom !== camera.zoom || cache.eyeSep !== this.eyeSep;\r\n\r\n\t\t\tif ( needsUpdate ) {\r\n\r\n\t\t\t\tcache.focus = camera.focus;\r\n\t\t\t\tcache.fov = camera.fov;\r\n\t\t\t\tcache.aspect = camera.aspect * this.aspect;\r\n\t\t\t\tcache.near = camera.near;\r\n\t\t\t\tcache.far = camera.far;\r\n\t\t\t\tcache.zoom = camera.zoom;\r\n\t\t\t\tcache.eyeSep = this.eyeSep;\r\n\r\n\t\t\t\t// Off-axis stereoscopic effect based on\r\n\t\t\t\t// http://paulbourke.net/stereographics/stereorender/\r\n\r\n\t\t\t\tvar projectionMatrix = camera.projectionMatrix.clone();\r\n\t\t\t\tvar eyeSepHalf = cache.eyeSep / 2;\r\n\t\t\t\tvar eyeSepOnProjection = eyeSepHalf * cache.near / cache.focus;\r\n\t\t\t\tvar ymax = ( cache.near * Math.tan( MathUtils.DEG2RAD * cache.fov * 0.5 ) ) / cache.zoom;\r\n\t\t\t\tvar xmin, xmax;\r\n\r\n\t\t\t\t// translate xOffset\r\n\r\n\t\t\t\t_eyeLeft.elements[ 12 ] = - eyeSepHalf;\r\n\t\t\t\t_eyeRight.elements[ 12 ] = eyeSepHalf;\r\n\r\n\t\t\t\t// for left eye\r\n\r\n\t\t\t\txmin = - ymax * cache.aspect + eyeSepOnProjection;\r\n\t\t\t\txmax = ymax * cache.aspect + eyeSepOnProjection;\r\n\r\n\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\r\n\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\r\n\r\n\t\t\t\tthis.cameraL.projectionMatrix.copy( projectionMatrix );\r\n\r\n\t\t\t\t// for right eye\r\n\r\n\t\t\t\txmin = - ymax * cache.aspect - eyeSepOnProjection;\r\n\t\t\t\txmax = ymax * cache.aspect - eyeSepOnProjection;\r\n\r\n\t\t\t\tprojectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\r\n\t\t\t\tprojectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\r\n\r\n\t\t\t\tthis.cameraR.projectionMatrix.copy( projectionMatrix );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cameraL.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeLeft );\r\n\t\t\tthis.cameraR.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeRight );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction Clock( autoStart ) {\r\n\r\n\t\tthis.autoStart = ( autoStart !== undefined ) ? autoStart : true;\r\n\r\n\t\tthis.startTime = 0;\r\n\t\tthis.oldTime = 0;\r\n\t\tthis.elapsedTime = 0;\r\n\r\n\t\tthis.running = false;\r\n\r\n\t}\r\n\r\n\tObject.assign( Clock.prototype, {\r\n\r\n\t\tstart: function () {\r\n\r\n\t\t\tthis.startTime = ( typeof performance === 'undefined' ? Date : performance ).now(); // see #10732\r\n\r\n\t\t\tthis.oldTime = this.startTime;\r\n\t\t\tthis.elapsedTime = 0;\r\n\t\t\tthis.running = true;\r\n\r\n\t\t},\r\n\r\n\t\tstop: function () {\r\n\r\n\t\t\tthis.getElapsedTime();\r\n\t\t\tthis.running = false;\r\n\t\t\tthis.autoStart = false;\r\n\r\n\t\t},\r\n\r\n\t\tgetElapsedTime: function () {\r\n\r\n\t\t\tthis.getDelta();\r\n\t\t\treturn this.elapsedTime;\r\n\r\n\t\t},\r\n\r\n\t\tgetDelta: function () {\r\n\r\n\t\t\tvar diff = 0;\r\n\r\n\t\t\tif ( this.autoStart && ! this.running ) {\r\n\r\n\t\t\t\tthis.start();\r\n\t\t\t\treturn 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.running ) {\r\n\r\n\t\t\t\tvar newTime = ( typeof performance === 'undefined' ? Date : performance ).now();\r\n\r\n\t\t\t\tdiff = ( newTime - this.oldTime ) / 1000;\r\n\t\t\t\tthis.oldTime = newTime;\r\n\r\n\t\t\t\tthis.elapsedTime += diff;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn diff;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _position$2 = new Vector3();\r\n\tvar _quaternion$3 = new Quaternion();\r\n\tvar _scale$1 = new Vector3();\r\n\tvar _orientation = new Vector3();\r\n\r\n\tfunction AudioListener() {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'AudioListener';\r\n\r\n\t\tthis.context = AudioContext.getContext();\r\n\r\n\t\tthis.gain = this.context.createGain();\r\n\t\tthis.gain.connect( this.context.destination );\r\n\r\n\t\tthis.filter = null;\r\n\r\n\t\tthis.timeDelta = 0;\r\n\r\n\t\t// private\r\n\r\n\t\tthis._clock = new Clock();\r\n\r\n\t}\r\n\r\n\tAudioListener.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: AudioListener,\r\n\r\n\t\tgetInput: function () {\r\n\r\n\t\t\treturn this.gain;\r\n\r\n\t\t},\r\n\r\n\t\tremoveFilter: function ( ) {\r\n\r\n\t\t\tif ( this.filter !== null ) {\r\n\r\n\t\t\t\tthis.gain.disconnect( this.filter );\r\n\t\t\t\tthis.filter.disconnect( this.context.destination );\r\n\t\t\t\tthis.gain.connect( this.context.destination );\r\n\t\t\t\tthis.filter = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetFilter: function () {\r\n\r\n\t\t\treturn this.filter;\r\n\r\n\t\t},\r\n\r\n\t\tsetFilter: function ( value ) {\r\n\r\n\t\t\tif ( this.filter !== null ) {\r\n\r\n\t\t\t\tthis.gain.disconnect( this.filter );\r\n\t\t\t\tthis.filter.disconnect( this.context.destination );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.gain.disconnect( this.context.destination );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.filter = value;\r\n\t\t\tthis.gain.connect( this.filter );\r\n\t\t\tthis.filter.connect( this.context.destination );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetMasterVolume: function () {\r\n\r\n\t\t\treturn this.gain.gain.value;\r\n\r\n\t\t},\r\n\r\n\t\tsetMasterVolume: function ( value ) {\r\n\r\n\t\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\tvar listener = this.context.listener;\r\n\t\t\tvar up = this.up;\r\n\r\n\t\t\tthis.timeDelta = this._clock.getDelta();\r\n\r\n\t\t\tthis.matrixWorld.decompose( _position$2, _quaternion$3, _scale$1 );\r\n\r\n\t\t\t_orientation.set( 0, 0, - 1 ).applyQuaternion( _quaternion$3 );\r\n\r\n\t\t\tif ( listener.positionX ) {\r\n\r\n\t\t\t\t// code path for Chrome (see #14393)\r\n\r\n\t\t\t\tvar endTime = this.context.currentTime + this.timeDelta;\r\n\r\n\t\t\t\tlistener.positionX.linearRampToValueAtTime( _position$2.x, endTime );\r\n\t\t\t\tlistener.positionY.linearRampToValueAtTime( _position$2.y, endTime );\r\n\t\t\t\tlistener.positionZ.linearRampToValueAtTime( _position$2.z, endTime );\r\n\t\t\t\tlistener.forwardX.linearRampToValueAtTime( _orientation.x, endTime );\r\n\t\t\t\tlistener.forwardY.linearRampToValueAtTime( _orientation.y, endTime );\r\n\t\t\t\tlistener.forwardZ.linearRampToValueAtTime( _orientation.z, endTime );\r\n\t\t\t\tlistener.upX.linearRampToValueAtTime( up.x, endTime );\r\n\t\t\t\tlistener.upY.linearRampToValueAtTime( up.y, endTime );\r\n\t\t\t\tlistener.upZ.linearRampToValueAtTime( up.z, endTime );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tlistener.setPosition( _position$2.x, _position$2.y, _position$2.z );\r\n\t\t\t\tlistener.setOrientation( _orientation.x, _orientation.y, _orientation.z, up.x, up.y, up.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Reece Aaron Lecrivain / http://reecenotes.com/\r\n\t */\r\n\r\n\tfunction Audio( listener ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.type = 'Audio';\r\n\r\n\t\tthis.listener = listener;\r\n\t\tthis.context = listener.context;\r\n\r\n\t\tthis.gain = this.context.createGain();\r\n\t\tthis.gain.connect( listener.getInput() );\r\n\r\n\t\tthis.autoplay = false;\r\n\r\n\t\tthis.buffer = null;\r\n\t\tthis.detune = 0;\r\n\t\tthis.loop = false;\r\n\t\tthis.loopStart = 0;\r\n\t\tthis.loopEnd = 0;\r\n\t\tthis.offset = 0;\r\n\t\tthis.duration = undefined;\r\n\t\tthis.playbackRate = 1;\r\n\t\tthis.isPlaying = false;\r\n\t\tthis.hasPlaybackControl = true;\r\n\t\tthis.sourceType = 'empty';\r\n\r\n\t\tthis._startedAt = 0;\r\n\t\tthis._pausedAt = 0;\r\n\r\n\t\tthis.filters = [];\r\n\r\n\t}\r\n\r\n\tAudio.prototype = Object.assign( Object.create( Object3D.prototype ), {\r\n\r\n\t\tconstructor: Audio,\r\n\r\n\t\tgetOutput: function () {\r\n\r\n\t\t\treturn this.gain;\r\n\r\n\t\t},\r\n\r\n\t\tsetNodeSource: function ( audioNode ) {\r\n\r\n\t\t\tthis.hasPlaybackControl = false;\r\n\t\t\tthis.sourceType = 'audioNode';\r\n\t\t\tthis.source = audioNode;\r\n\t\t\tthis.connect();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetMediaElementSource: function ( mediaElement ) {\r\n\r\n\t\t\tthis.hasPlaybackControl = false;\r\n\t\t\tthis.sourceType = 'mediaNode';\r\n\t\t\tthis.source = this.context.createMediaElementSource( mediaElement );\r\n\t\t\tthis.connect();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetMediaStreamSource: function ( mediaStream ) {\r\n\r\n\t\t\tthis.hasPlaybackControl = false;\r\n\t\t\tthis.sourceType = 'mediaStreamNode';\r\n\t\t\tthis.source = this.context.createMediaStreamSource( mediaStream );\r\n\t\t\tthis.connect();\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetBuffer: function ( audioBuffer ) {\r\n\r\n\t\t\tthis.buffer = audioBuffer;\r\n\t\t\tthis.sourceType = 'buffer';\r\n\r\n\t\t\tif ( this.autoplay ) { this.play(); }\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tplay: function ( delay ) {\r\n\r\n\t\t\tif ( delay === undefined ) { delay = 0; }\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._startedAt = this.context.currentTime + delay;\r\n\r\n\t\t\tvar source = this.context.createBufferSource();\r\n\t\t\tsource.buffer = this.buffer;\r\n\t\t\tsource.loop = this.loop;\r\n\t\t\tsource.loopStart = this.loopStart;\r\n\t\t\tsource.loopEnd = this.loopEnd;\r\n\t\t\tsource.onended = this.onEnded.bind( this );\r\n\t\t\tsource.start( this._startedAt, this._pausedAt + this.offset, this.duration );\r\n\r\n\t\t\tthis.isPlaying = true;\r\n\r\n\t\t\tthis.source = source;\r\n\r\n\t\t\tthis.setDetune( this.detune );\r\n\t\t\tthis.setPlaybackRate( this.playbackRate );\r\n\r\n\t\t\treturn this.connect();\r\n\r\n\t\t},\r\n\r\n\t\tpause: function () {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tthis._pausedAt += Math.max( this.context.currentTime - this._startedAt, 0 ) * this.playbackRate;\r\n\r\n\t\t\t\tthis.source.stop();\r\n\t\t\t\tthis.source.onended = null;\r\n\r\n\t\t\t\tthis.isPlaying = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tstop: function () {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._pausedAt = 0;\r\n\r\n\t\t\tthis.source.stop();\r\n\t\t\tthis.source.onended = null;\r\n\t\t\tthis.isPlaying = false;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tconnect: function () {\r\n\r\n\t\t\tif ( this.filters.length > 0 ) {\r\n\r\n\t\t\t\tthis.source.connect( this.filters[ 0 ] );\r\n\r\n\t\t\t\tfor ( var i = 1, l = this.filters.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tthis.filters[ i - 1 ].connect( this.filters[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.filters[ this.filters.length - 1 ].connect( this.getOutput() );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.source.connect( this.getOutput() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdisconnect: function () {\r\n\r\n\t\t\tif ( this.filters.length > 0 ) {\r\n\r\n\t\t\t\tthis.source.disconnect( this.filters[ 0 ] );\r\n\r\n\t\t\t\tfor ( var i = 1, l = this.filters.length; i < l; i ++ ) {\r\n\r\n\t\t\t\t\tthis.filters[ i - 1 ].disconnect( this.filters[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.filters[ this.filters.length - 1 ].disconnect( this.getOutput() );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.source.disconnect( this.getOutput() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetFilters: function () {\r\n\r\n\t\t\treturn this.filters;\r\n\r\n\t\t},\r\n\r\n\t\tsetFilters: function ( value ) {\r\n\r\n\t\t\tif ( ! value ) { value = []; }\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tthis.disconnect();\r\n\t\t\t\tthis.filters = value;\r\n\t\t\t\tthis.connect();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.filters = value;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetDetune: function ( value ) {\r\n\r\n\t\t\tthis.detune = value;\r\n\r\n\t\t\tif ( this.source.detune === undefined ) { return; } // only set detune when available\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tthis.source.detune.setTargetAtTime( this.detune, this.context.currentTime, 0.01 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetDetune: function () {\r\n\r\n\t\t\treturn this.detune;\r\n\r\n\t\t},\r\n\r\n\t\tgetFilter: function () {\r\n\r\n\t\t\treturn this.getFilters()[ 0 ];\r\n\r\n\t\t},\r\n\r\n\t\tsetFilter: function ( filter ) {\r\n\r\n\t\t\treturn this.setFilters( filter ? [ filter ] : [] );\r\n\r\n\t\t},\r\n\r\n\t\tsetPlaybackRate: function ( value ) {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.playbackRate = value;\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tthis.source.playbackRate.setTargetAtTime( this.playbackRate, this.context.currentTime, 0.01 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetPlaybackRate: function () {\r\n\r\n\t\t\treturn this.playbackRate;\r\n\r\n\t\t},\r\n\r\n\t\tonEnded: function () {\r\n\r\n\t\t\tthis.isPlaying = false;\r\n\r\n\t\t},\r\n\r\n\t\tgetLoop: function () {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.loop;\r\n\r\n\t\t},\r\n\r\n\t\tsetLoop: function ( value ) {\r\n\r\n\t\t\tif ( this.hasPlaybackControl === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.loop = value;\r\n\r\n\t\t\tif ( this.isPlaying === true ) {\r\n\r\n\t\t\t\tthis.source.loop = this.loop;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetLoopStart: function ( value ) {\r\n\r\n\t\t\tthis.loopStart = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetLoopEnd: function ( value ) {\r\n\r\n\t\t\tthis.loopEnd = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetVolume: function () {\r\n\r\n\t\t\treturn this.gain.gain.value;\r\n\r\n\t\t},\r\n\r\n\t\tsetVolume: function ( value ) {\r\n\r\n\t\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tvar _position$3 = new Vector3();\r\n\tvar _quaternion$4 = new Quaternion();\r\n\tvar _scale$2 = new Vector3();\r\n\tvar _orientation$1 = new Vector3();\r\n\r\n\tfunction PositionalAudio( listener ) {\r\n\r\n\t\tAudio.call( this, listener );\r\n\r\n\t\tthis.panner = this.context.createPanner();\r\n\t\tthis.panner.panningModel = 'HRTF';\r\n\t\tthis.panner.connect( this.gain );\r\n\r\n\t}\r\n\r\n\tPositionalAudio.prototype = Object.assign( Object.create( Audio.prototype ), {\r\n\r\n\t\tconstructor: PositionalAudio,\r\n\r\n\t\tgetOutput: function () {\r\n\r\n\t\t\treturn this.panner;\r\n\r\n\t\t},\r\n\r\n\t\tgetRefDistance: function () {\r\n\r\n\t\t\treturn this.panner.refDistance;\r\n\r\n\t\t},\r\n\r\n\t\tsetRefDistance: function ( value ) {\r\n\r\n\t\t\tthis.panner.refDistance = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetRolloffFactor: function () {\r\n\r\n\t\t\treturn this.panner.rolloffFactor;\r\n\r\n\t\t},\r\n\r\n\t\tsetRolloffFactor: function ( value ) {\r\n\r\n\t\t\tthis.panner.rolloffFactor = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetDistanceModel: function () {\r\n\r\n\t\t\treturn this.panner.distanceModel;\r\n\r\n\t\t},\r\n\r\n\t\tsetDistanceModel: function ( value ) {\r\n\r\n\t\t\tthis.panner.distanceModel = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetMaxDistance: function () {\r\n\r\n\t\t\treturn this.panner.maxDistance;\r\n\r\n\t\t},\r\n\r\n\t\tsetMaxDistance: function ( value ) {\r\n\r\n\t\t\tthis.panner.maxDistance = value;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetDirectionalCone: function ( coneInnerAngle, coneOuterAngle, coneOuterGain ) {\r\n\r\n\t\t\tthis.panner.coneInnerAngle = coneInnerAngle;\r\n\t\t\tthis.panner.coneOuterAngle = coneOuterAngle;\r\n\t\t\tthis.panner.coneOuterGain = coneOuterGain;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tupdateMatrixWorld: function ( force ) {\r\n\r\n\t\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t\t\tif ( this.hasPlaybackControl === true && this.isPlaying === false ) { return; }\r\n\r\n\t\t\tthis.matrixWorld.decompose( _position$3, _quaternion$4, _scale$2 );\r\n\r\n\t\t\t_orientation$1.set( 0, 0, 1 ).applyQuaternion( _quaternion$4 );\r\n\r\n\t\t\tvar panner = this.panner;\r\n\r\n\t\t\tif ( panner.positionX ) {\r\n\r\n\t\t\t\t// code path for Chrome and Firefox (see #14393)\r\n\r\n\t\t\t\tvar endTime = this.context.currentTime + this.listener.timeDelta;\r\n\r\n\t\t\t\tpanner.positionX.linearRampToValueAtTime( _position$3.x, endTime );\r\n\t\t\t\tpanner.positionY.linearRampToValueAtTime( _position$3.y, endTime );\r\n\t\t\t\tpanner.positionZ.linearRampToValueAtTime( _position$3.z, endTime );\r\n\t\t\t\tpanner.orientationX.linearRampToValueAtTime( _orientation$1.x, endTime );\r\n\t\t\t\tpanner.orientationY.linearRampToValueAtTime( _orientation$1.y, endTime );\r\n\t\t\t\tpanner.orientationZ.linearRampToValueAtTime( _orientation$1.z, endTime );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tpanner.setPosition( _position$3.x, _position$3.y, _position$3.z );\r\n\t\t\t\tpanner.setOrientation( _orientation$1.x, _orientation$1.y, _orientation$1.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction AudioAnalyser( audio, fftSize ) {\r\n\r\n\t\tthis.analyser = audio.context.createAnalyser();\r\n\t\tthis.analyser.fftSize = fftSize !== undefined ? fftSize : 2048;\r\n\r\n\t\tthis.data = new Uint8Array( this.analyser.frequencyBinCount );\r\n\r\n\t\taudio.getOutput().connect( this.analyser );\r\n\r\n\t}\r\n\r\n\tObject.assign( AudioAnalyser.prototype, {\r\n\r\n\t\tgetFrequencyData: function () {\r\n\r\n\t\t\tthis.analyser.getByteFrequencyData( this.data );\r\n\r\n\t\t\treturn this.data;\r\n\r\n\t\t},\r\n\r\n\t\tgetAverageFrequency: function () {\r\n\r\n\t\t\tvar value = 0, data = this.getFrequencyData();\r\n\r\n\t\t\tfor ( var i = 0; i < data.length; i ++ ) {\r\n\r\n\t\t\t\tvalue += data[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn value / data.length;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Buffered scene graph property that allows weighted accumulation.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction PropertyMixer( binding, typeName, valueSize ) {\r\n\r\n\t\tthis.binding = binding;\r\n\t\tthis.valueSize = valueSize;\r\n\r\n\t\tvar bufferType = Float64Array,\r\n\t\t\tmixFunction;\r\n\r\n\t\tswitch ( typeName ) {\r\n\r\n\t\t\tcase 'quaternion':\r\n\t\t\t\tmixFunction = this._slerp;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'string':\r\n\t\t\tcase 'bool':\r\n\t\t\t\tbufferType = Array;\r\n\t\t\t\tmixFunction = this._select;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tmixFunction = this._lerp;\r\n\r\n\t\t}\r\n\r\n\t\tthis.buffer = new bufferType( valueSize * 4 );\r\n\t\t// layout: [ incoming | accu0 | accu1 | orig ]\r\n\t\t//\r\n\t\t// interpolators can use .buffer as their .result\r\n\t\t// the data then goes to 'incoming'\r\n\t\t//\r\n\t\t// 'accu0' and 'accu1' are used frame-interleaved for\r\n\t\t// the cumulative result and are compared to detect\r\n\t\t// changes\r\n\t\t//\r\n\t\t// 'orig' stores the original state of the property\r\n\r\n\t\tthis._mixBufferRegion = mixFunction;\r\n\r\n\t\tthis.cumulativeWeight = 0;\r\n\r\n\t\tthis.useCount = 0;\r\n\t\tthis.referenceCount = 0;\r\n\r\n\t}\r\n\r\n\tObject.assign( PropertyMixer.prototype, {\r\n\r\n\t\t// accumulate data in the 'incoming' region into 'accu<i>'\r\n\t\taccumulate: function ( accuIndex, weight ) {\r\n\r\n\t\t\t// note: happily accumulating nothing when weight = 0, the caller knows\r\n\t\t\t// the weight and shouldn't have made the call in the first place\r\n\r\n\t\t\tvar buffer = this.buffer,\r\n\t\t\t\tstride = this.valueSize,\r\n\t\t\t\toffset = accuIndex * stride + stride,\r\n\r\n\t\t\t\tcurrentWeight = this.cumulativeWeight;\r\n\r\n\t\t\tif ( currentWeight === 0 ) {\r\n\r\n\t\t\t\t// accuN := incoming * weight\r\n\r\n\t\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\t\tbuffer[ offset + i ] = buffer[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurrentWeight = weight;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// accuN := accuN + incoming * weight\r\n\r\n\t\t\t\tcurrentWeight += weight;\r\n\t\t\t\tvar mix = weight / currentWeight;\r\n\t\t\t\tthis._mixBufferRegion( buffer, offset, 0, mix, stride );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cumulativeWeight = currentWeight;\r\n\r\n\t\t},\r\n\r\n\t\t// apply the state of 'accu<i>' to the binding when accus differ\r\n\t\tapply: function ( accuIndex ) {\r\n\r\n\t\t\tvar stride = this.valueSize,\r\n\t\t\t\tbuffer = this.buffer,\r\n\t\t\t\toffset = accuIndex * stride + stride,\r\n\r\n\t\t\t\tweight = this.cumulativeWeight,\r\n\r\n\t\t\t\tbinding = this.binding;\r\n\r\n\t\t\tthis.cumulativeWeight = 0;\r\n\r\n\t\t\tif ( weight < 1 ) {\r\n\r\n\t\t\t\t// accuN := accuN + original * ( 1 - cumulativeWeight )\r\n\r\n\t\t\t\tvar originalValueOffset = stride * 3;\r\n\r\n\t\t\t\tthis._mixBufferRegion(\r\n\t\t\t\t\tbuffer, offset, originalValueOffset, 1 - weight, stride );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = stride, e = stride + stride; i !== e; ++ i ) {\r\n\r\n\t\t\t\tif ( buffer[ i ] !== buffer[ i + stride ] ) {\r\n\r\n\t\t\t\t\t// value has changed -> update scene graph\r\n\r\n\t\t\t\t\tbinding.setValue( buffer, offset );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// remember the state of the bound property and copy it to both accus\r\n\t\tsaveOriginalState: function () {\r\n\r\n\t\t\tvar binding = this.binding;\r\n\r\n\t\t\tvar buffer = this.buffer,\r\n\t\t\t\tstride = this.valueSize,\r\n\r\n\t\t\t\toriginalValueOffset = stride * 3;\r\n\r\n\t\t\tbinding.getValue( buffer, originalValueOffset );\r\n\r\n\t\t\t// accu[0..1] := orig -- initially detect changes against the original\r\n\t\t\tfor ( var i = stride, e = originalValueOffset; i !== e; ++ i ) {\r\n\r\n\t\t\t\tbuffer[ i ] = buffer[ originalValueOffset + ( i % stride ) ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.cumulativeWeight = 0;\r\n\r\n\t\t},\r\n\r\n\t\t// apply the state previously taken via 'saveOriginalState' to the binding\r\n\t\trestoreOriginalState: function () {\r\n\r\n\t\t\tvar originalValueOffset = this.valueSize * 3;\r\n\t\t\tthis.binding.setValue( this.buffer, originalValueOffset );\r\n\r\n\t\t},\r\n\r\n\r\n\t\t// mix functions\r\n\r\n\t\t_select: function ( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\t\tif ( t >= 0.5 ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\t\tbuffer[ dstOffset + i ] = buffer[ srcOffset + i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_slerp: function ( buffer, dstOffset, srcOffset, t ) {\r\n\r\n\t\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, srcOffset, t );\r\n\r\n\t\t},\r\n\r\n\t\t_lerp: function ( buffer, dstOffset, srcOffset, t, stride ) {\r\n\r\n\t\t\tvar s = 1 - t;\r\n\r\n\t\t\tfor ( var i = 0; i !== stride; ++ i ) {\r\n\r\n\t\t\t\tvar j = dstOffset + i;\r\n\r\n\t\t\t\tbuffer[ j ] = buffer[ j ] * s + buffer[ srcOffset + i ] * t;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A reference to a real property in the scene graph.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\t// Characters [].:/ are reserved for track binding syntax.\r\n\tvar _RESERVED_CHARS_RE = '\\\\[\\\\]\\\\.:\\\\/';\r\n\tvar _reservedRe = new RegExp( '[' + _RESERVED_CHARS_RE + ']', 'g' );\r\n\r\n\t// Attempts to allow node names from any language. ES5's `\\w` regexp matches\r\n\t// only latin characters, and the unicode \\p{L} is not yet supported. So\r\n\t// instead, we exclude reserved characters and match everything else.\r\n\tvar _wordChar = '[^' + _RESERVED_CHARS_RE + ']';\r\n\tvar _wordCharOrDot = '[^' + _RESERVED_CHARS_RE.replace( '\\\\.', '' ) + ']';\r\n\r\n\t// Parent directories, delimited by '/' or ':'. Currently unused, but must\r\n\t// be matched to parse the rest of the track name.\r\n\tvar _directoryRe = /((?:WC+[\\/:])*)/.source.replace( 'WC', _wordChar );\r\n\r\n\t// Target node. May contain word characters (a-zA-Z0-9_) and '.' or '-'.\r\n\tvar _nodeRe = /(WCOD+)?/.source.replace( 'WCOD', _wordCharOrDot );\r\n\r\n\t// Object on target node, and accessor. May not contain reserved\r\n\t// characters. Accessor may contain any character except closing bracket.\r\n\tvar _objectRe = /(?:\\.(WC+)(?:\\[(.+)\\])?)?/.source.replace( 'WC', _wordChar );\r\n\r\n\t// Property and accessor. May not contain reserved characters. Accessor may\r\n\t// contain any non-bracket characters.\r\n\tvar _propertyRe = /\\.(WC+)(?:\\[(.+)\\])?/.source.replace( 'WC', _wordChar );\r\n\r\n\tvar _trackRe = new RegExp( ''\r\n\t\t+ '^'\r\n\t\t+ _directoryRe\r\n\t\t+ _nodeRe\r\n\t\t+ _objectRe\r\n\t\t+ _propertyRe\r\n\t\t+ '$'\r\n\t);\r\n\r\n\tvar _supportedObjectNames = [ 'material', 'materials', 'bones' ];\r\n\r\n\tfunction Composite( targetGroup, path, optionalParsedPath ) {\r\n\r\n\t\tvar parsedPath = optionalParsedPath || PropertyBinding.parseTrackName( path );\r\n\r\n\t\tthis._targetGroup = targetGroup;\r\n\t\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\r\n\r\n\t}\r\n\r\n\tObject.assign( Composite.prototype, {\r\n\r\n\t\tgetValue: function ( array, offset ) {\r\n\r\n\t\t\tthis.bind(); // bind all binding\r\n\r\n\t\t\tvar firstValidIndex = this._targetGroup.nCachedObjects_,\r\n\t\t\t\tbinding = this._bindings[ firstValidIndex ];\r\n\r\n\t\t\t// and only call .getValue on the first\r\n\t\t\tif ( binding !== undefined ) { binding.getValue( array, offset ); }\r\n\r\n\t\t},\r\n\r\n\t\tsetValue: function ( array, offset ) {\r\n\r\n\t\t\tvar bindings = this._bindings;\r\n\r\n\t\t\tfor ( var i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].setValue( array, offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tbind: function () {\r\n\r\n\t\t\tvar bindings = this._bindings;\r\n\r\n\t\t\tfor ( var i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].bind();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tunbind: function () {\r\n\r\n\t\t\tvar bindings = this._bindings;\r\n\r\n\t\t\tfor ( var i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].unbind();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\r\n\tfunction PropertyBinding( rootNode, path, parsedPath ) {\r\n\r\n\t\tthis.path = path;\r\n\t\tthis.parsedPath = parsedPath || PropertyBinding.parseTrackName( path );\r\n\r\n\t\tthis.node = PropertyBinding.findNode( rootNode, this.parsedPath.nodeName ) || rootNode;\r\n\r\n\t\tthis.rootNode = rootNode;\r\n\r\n\t}\r\n\r\n\tObject.assign( PropertyBinding, {\r\n\r\n\t\tComposite: Composite,\r\n\r\n\t\tcreate: function ( root, path, parsedPath ) {\r\n\r\n\t\t\tif ( ! ( root && root.isAnimationObjectGroup ) ) {\r\n\r\n\t\t\t\treturn new PropertyBinding( root, path, parsedPath );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn new PropertyBinding.Composite( root, path, parsedPath );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Replaces spaces with underscores and removes unsupported characters from\r\n\t\t * node names, to ensure compatibility with parseTrackName().\r\n\t\t *\r\n\t\t * @param {string} name Node name to be sanitized.\r\n\t\t * @return {string}\r\n\t\t */\r\n\t\tsanitizeNodeName: function ( name ) {\r\n\r\n\t\t\treturn name.replace( /\\s/g, '_' ).replace( _reservedRe, '' );\r\n\r\n\t\t},\r\n\r\n\t\tparseTrackName: function ( trackName ) {\r\n\r\n\t\t\tvar matches = _trackRe.exec( trackName );\r\n\r\n\t\t\tif ( ! matches ) {\r\n\r\n\t\t\t\tthrow new Error( 'PropertyBinding: Cannot parse trackName: ' + trackName );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar results = {\r\n\t\t\t\t// directoryName: matches[ 1 ], // (tschw) currently unused\r\n\t\t\t\tnodeName: matches[ 2 ],\r\n\t\t\t\tobjectName: matches[ 3 ],\r\n\t\t\t\tobjectIndex: matches[ 4 ],\r\n\t\t\t\tpropertyName: matches[ 5 ], // required\r\n\t\t\t\tpropertyIndex: matches[ 6 ]\r\n\t\t\t};\r\n\r\n\t\t\tvar lastDot = results.nodeName && results.nodeName.lastIndexOf( '.' );\r\n\r\n\t\t\tif ( lastDot !== undefined && lastDot !== - 1 ) {\r\n\r\n\t\t\t\tvar objectName = results.nodeName.substring( lastDot + 1 );\r\n\r\n\t\t\t\t// Object names must be checked against a whitelist. Otherwise, there\r\n\t\t\t\t// is no way to parse 'foo.bar.baz': 'baz' must be a property, but\r\n\t\t\t\t// 'bar' could be the objectName, or part of a nodeName (which can\r\n\t\t\t\t// include '.' characters).\r\n\t\t\t\tif ( _supportedObjectNames.indexOf( objectName ) !== - 1 ) {\r\n\r\n\t\t\t\t\tresults.nodeName = results.nodeName.substring( 0, lastDot );\r\n\t\t\t\t\tresults.objectName = objectName;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\r\n\r\n\t\t\t\tthrow new Error( 'PropertyBinding: can not parse propertyName from trackName: ' + trackName );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn results;\r\n\r\n\t\t},\r\n\r\n\t\tfindNode: function ( root, nodeName ) {\r\n\r\n\t\t\tif ( ! nodeName || nodeName === \"\" || nodeName === \".\" || nodeName === - 1 || nodeName === root.name || nodeName === root.uuid ) {\r\n\r\n\t\t\t\treturn root;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// search into skeleton bones.\r\n\t\t\tif ( root.skeleton ) {\r\n\r\n\t\t\t\tvar bone = root.skeleton.getBoneByName( nodeName );\r\n\r\n\t\t\t\tif ( bone !== undefined ) {\r\n\r\n\t\t\t\t\treturn bone;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// search into node subtree.\r\n\t\t\tif ( root.children ) {\r\n\r\n\t\t\t\tvar searchNodeSubtree = function ( children ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < children.length; i ++ ) {\r\n\r\n\t\t\t\t\t\tvar childNode = children[ i ];\r\n\r\n\t\t\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\r\n\r\n\t\t\t\t\t\t\treturn childNode;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar result = searchNodeSubtree( childNode.children );\r\n\r\n\t\t\t\t\t\tif ( result ) { return result; }\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar subTreeNode = searchNodeSubtree( root.children );\r\n\r\n\t\t\t\tif ( subTreeNode ) {\r\n\r\n\t\t\t\t\treturn subTreeNode;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( PropertyBinding.prototype, { // prototype, continued\r\n\r\n\t\t// these are used to \"bind\" a nonexistent property\r\n\t\t_getValue_unavailable: function () {},\r\n\t\t_setValue_unavailable: function () {},\r\n\r\n\t\tBindingType: {\r\n\t\t\tDirect: 0,\r\n\t\t\tEntireArray: 1,\r\n\t\t\tArrayElement: 2,\r\n\t\t\tHasFromToArray: 3\r\n\t\t},\r\n\r\n\t\tVersioning: {\r\n\t\t\tNone: 0,\r\n\t\t\tNeedsUpdate: 1,\r\n\t\t\tMatrixWorldNeedsUpdate: 2\r\n\t\t},\r\n\r\n\t\tGetterByBindingType: [\r\n\r\n\t\t\tfunction getValue_direct( buffer, offset ) {\r\n\r\n\t\t\t\tbuffer[ offset ] = this.node[ this.propertyName ];\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction getValue_array( buffer, offset ) {\r\n\r\n\t\t\t\tvar source = this.resolvedProperty;\r\n\r\n\t\t\t\tfor ( var i = 0, n = source.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tbuffer[ offset ++ ] = source[ i ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction getValue_arrayElement( buffer, offset ) {\r\n\r\n\t\t\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\r\n\r\n\t\t\t},\r\n\r\n\t\t\tfunction getValue_toArray( buffer, offset ) {\r\n\r\n\t\t\t\tthis.resolvedProperty.toArray( buffer, offset );\r\n\r\n\t\t\t}\r\n\r\n\t\t],\r\n\r\n\t\tSetterByBindingTypeAndVersioning: [\r\n\r\n\t\t\t[\r\n\t\t\t\t// Direct\r\n\r\n\t\t\t\tfunction setValue_direct( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_direct_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\r\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\r\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t], [\r\n\r\n\t\t\t\t// EntireArray\r\n\r\n\t\t\t\tfunction setValue_array( buffer, offset ) {\r\n\r\n\t\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_array_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tvar dest = this.resolvedProperty;\r\n\r\n\t\t\t\t\tfor ( var i = 0, n = dest.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\t\tdest[ i ] = buffer[ offset ++ ];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t], [\r\n\r\n\t\t\t\t// ArrayElement\r\n\r\n\t\t\t\tfunction setValue_arrayElement( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\r\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t], [\r\n\r\n\t\t\t\t// HasToFromArray\r\n\r\n\t\t\t\tfunction setValue_fromArray( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_fromArray_setNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\t\t\t\t\tthis.targetObject.needsUpdate = true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tfunction setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\r\n\r\n\t\t\t\t\tthis.resolvedProperty.fromArray( buffer, offset );\r\n\t\t\t\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t]\r\n\r\n\t\t],\r\n\r\n\t\tgetValue: function getValue_unbound( targetArray, offset ) {\r\n\r\n\t\t\tthis.bind();\r\n\t\t\tthis.getValue( targetArray, offset );\r\n\r\n\t\t\t// Note: This class uses a State pattern on a per-method basis:\r\n\t\t\t// 'bind' sets 'this.getValue' / 'setValue' and shadows the\r\n\t\t\t// prototype version of these methods with one that represents\r\n\t\t\t// the bound state. When the property is not found, the methods\r\n\t\t\t// become no-ops.\r\n\r\n\t\t},\r\n\r\n\t\tsetValue: function getValue_unbound( sourceArray, offset ) {\r\n\r\n\t\t\tthis.bind();\r\n\t\t\tthis.setValue( sourceArray, offset );\r\n\r\n\t\t},\r\n\r\n\t\t// create getter / setter pair for a property in the scene graph\r\n\t\tbind: function () {\r\n\r\n\t\t\tvar targetObject = this.node,\r\n\t\t\t\tparsedPath = this.parsedPath,\r\n\r\n\t\t\t\tobjectName = parsedPath.objectName,\r\n\t\t\t\tpropertyName = parsedPath.propertyName,\r\n\t\t\t\tpropertyIndex = parsedPath.propertyIndex;\r\n\r\n\t\t\tif ( ! targetObject ) {\r\n\r\n\t\t\t\ttargetObject = PropertyBinding.findNode( this.rootNode, parsedPath.nodeName ) || this.rootNode;\r\n\r\n\t\t\t\tthis.node = targetObject;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// set fail state so we can just 'return' on error\r\n\t\t\tthis.getValue = this._getValue_unavailable;\r\n\t\t\tthis.setValue = this._setValue_unavailable;\r\n\r\n\t\t\t// ensure there is a value node\r\n\t\t\tif ( ! targetObject ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update node for track: ' + this.path + ' but it wasn\\'t found.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( objectName ) {\r\n\r\n\t\t\t\tvar objectIndex = parsedPath.objectIndex;\r\n\r\n\t\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\r\n\t\t\t\tswitch ( objectName ) {\r\n\r\n\t\t\t\t\tcase 'materials':\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.material ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.material.materials ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttargetObject = targetObject.material.materials;\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'bones':\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.skeleton ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\r\n\t\t\t\t\t\t// and convert the integer string to a true integer.\r\n\r\n\t\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\r\n\r\n\t\t\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\t\t\tfor ( var i = 0; i < targetObject.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( targetObject[ i ].name === objectIndex ) {\r\n\r\n\t\t\t\t\t\t\t\tobjectIndex = i;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to objectName of node undefined.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttargetObject = targetObject[ objectName ];\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif ( objectIndex !== undefined ) {\r\n\r\n\t\t\t\t\tif ( targetObject[ objectIndex ] === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.', this, targetObject );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttargetObject = targetObject[ objectIndex ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// resolve property\r\n\t\t\tvar nodeProperty = targetObject[ propertyName ];\r\n\r\n\t\t\tif ( nodeProperty === undefined ) {\r\n\r\n\t\t\t\tvar nodeName = parsedPath.nodeName;\r\n\r\n\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update property for track: ' + nodeName +\r\n\t\t\t\t\t'.' + propertyName + ' but it wasn\\'t found.', targetObject );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// determine versioning scheme\r\n\t\t\tvar versioning = this.Versioning.None;\r\n\r\n\t\t\tthis.targetObject = targetObject;\r\n\r\n\t\t\tif ( targetObject.needsUpdate !== undefined ) { // material\r\n\r\n\t\t\t\tversioning = this.Versioning.NeedsUpdate;\r\n\r\n\t\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\r\n\r\n\t\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// determine how the property gets bound\r\n\t\t\tvar bindingType = this.BindingType.Direct;\r\n\r\n\t\t\tif ( propertyIndex !== undefined ) {\r\n\r\n\t\t\t\t// access a sub element of the property array (only primitives are supported right now)\r\n\r\n\t\t\t\tif ( propertyName === \"morphTargetInfluences\" ) {\r\n\r\n\t\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\r\n\r\n\t\t\t\t\t// support resolving morphTarget names into indices.\r\n\t\t\t\t\tif ( ! targetObject.geometry ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.', this );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( targetObject.geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.geometry.morphAttributes ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < this.node.geometry.morphAttributes.position.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( targetObject.geometry.morphAttributes.position[ i ].name === propertyIndex ) {\r\n\r\n\t\t\t\t\t\t\t\tpropertyIndex = i;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( ! targetObject.geometry.morphTargets ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.', this );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < this.node.geometry.morphTargets.length; i ++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( targetObject.geometry.morphTargets[ i ].name === propertyIndex ) {\r\n\r\n\t\t\t\t\t\t\t\tpropertyIndex = i;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbindingType = this.BindingType.ArrayElement;\r\n\r\n\t\t\t\tthis.resolvedProperty = nodeProperty;\r\n\t\t\t\tthis.propertyIndex = propertyIndex;\r\n\r\n\t\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\r\n\r\n\t\t\t\t// must use copy for Object3D.Euler/Quaternion\r\n\r\n\t\t\t\tbindingType = this.BindingType.HasFromToArray;\r\n\r\n\t\t\t\tthis.resolvedProperty = nodeProperty;\r\n\r\n\t\t\t} else if ( Array.isArray( nodeProperty ) ) {\r\n\r\n\t\t\t\tbindingType = this.BindingType.EntireArray;\r\n\r\n\t\t\t\tthis.resolvedProperty = nodeProperty;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.propertyName = propertyName;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// select getter / setter\r\n\t\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\r\n\t\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\r\n\r\n\t\t},\r\n\r\n\t\tunbind: function () {\r\n\r\n\t\t\tthis.node = null;\r\n\r\n\t\t\t// back to the prototype version of getValue / setValue\r\n\t\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\r\n\t\t\tthis.getValue = this._getValue_unbound;\r\n\t\t\tthis.setValue = this._setValue_unbound;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t// DECLARE ALIAS AFTER assign prototype\r\n\tObject.assign( PropertyBinding.prototype, {\r\n\r\n\t\t// initial state of these methods that calls 'bind'\r\n\t\t_getValue_unbound: PropertyBinding.prototype.getValue,\r\n\t\t_setValue_unbound: PropertyBinding.prototype.setValue,\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * A group of objects that receives a shared animation state.\r\n\t *\r\n\t * Usage:\r\n\t *\r\n\t *  - Add objects you would otherwise pass as 'root' to the\r\n\t *    constructor or the .clipAction method of AnimationMixer.\r\n\t *\r\n\t *  - Instead pass this object as 'root'.\r\n\t *\r\n\t *  - You can also add and remove objects later when the mixer\r\n\t *    is running.\r\n\t *\r\n\t * Note:\r\n\t *\r\n\t *    Objects of this class appear as one object to the mixer,\r\n\t *    so cache control of the individual objects must be done\r\n\t *    on the group.\r\n\t *\r\n\t * Limitation:\r\n\t *\r\n\t *  - The animated properties must be compatible among the\r\n\t *    all objects in the group.\r\n\t *\r\n\t *  - A single property can either be controlled through a\r\n\t *    target group or directly, but not both.\r\n\t *\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction AnimationObjectGroup() {\r\n\r\n\t\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\t\t// cached objects followed by the active ones\r\n\t\tthis._objects = Array.prototype.slice.call( arguments );\r\n\r\n\t\tthis.nCachedObjects_ = 0; // threshold\r\n\t\t// note: read by PropertyBinding.Composite\r\n\r\n\t\tvar indices = {};\r\n\t\tthis._indicesByUUID = indices; // for bookkeeping\r\n\r\n\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\tindices[ arguments[ i ].uuid ] = i;\r\n\r\n\t\t}\r\n\r\n\t\tthis._paths = []; // inside: string\r\n\t\tthis._parsedPaths = []; // inside: { we don't care, here }\r\n\t\tthis._bindings = []; // inside: Array< PropertyBinding >\r\n\t\tthis._bindingsIndicesByPath = {}; // inside: indices in these arrays\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tthis.stats = {\r\n\r\n\t\t\tobjects: {\r\n\t\t\t\tget total() {\r\n\r\n\t\t\t\t\treturn scope._objects.length;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tget inUse() {\r\n\r\n\t\t\t\t\treturn this.total - scope.nCachedObjects_;\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tget bindingsPerObject() {\r\n\r\n\t\t\t\treturn scope._bindings.length;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n\tObject.assign( AnimationObjectGroup.prototype, {\r\n\r\n\t\tisAnimationObjectGroup: true,\r\n\r\n\t\tadd: function () {\r\n\r\n\t\t\tvar objects = this._objects,\r\n\t\t\t\tnObjects = objects.length,\r\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\t\tpaths = this._paths,\r\n\t\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tnBindings = bindings.length,\r\n\t\t\t\tknownObject = undefined;\r\n\r\n\t\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar object = arguments[ i ],\r\n\t\t\t\t\tuuid = object.uuid,\r\n\t\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\t\tif ( index === undefined ) {\r\n\r\n\t\t\t\t\t// unknown object -> add it to the ACTIVE region\r\n\r\n\t\t\t\t\tindex = nObjects ++;\r\n\t\t\t\t\tindicesByUUID[ uuid ] = index;\r\n\t\t\t\t\tobjects.push( object );\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tbindings[ j ].push( new PropertyBinding( object, paths[ j ], parsedPaths[ j ] ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( index < nCachedObjects ) {\r\n\r\n\t\t\t\t\tknownObject = objects[ index ];\r\n\r\n\t\t\t\t\t// move existing object to the ACTIVE region\r\n\r\n\t\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\r\n\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ];\r\n\r\n\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\r\n\t\t\t\t\tobjects[ index ] = lastCachedObject;\r\n\r\n\t\t\t\t\tindicesByUUID[ uuid ] = firstActiveIndex;\r\n\t\t\t\t\tobjects[ firstActiveIndex ] = object;\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\r\n\t\t\t\t\t\t\tbinding = bindingsForPath[ index ];\r\n\r\n\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\r\n\r\n\t\t\t\t\t\tif ( binding === undefined ) {\r\n\r\n\t\t\t\t\t\t\t// since we do not bother to create new bindings\r\n\t\t\t\t\t\t\t// for objects that are cached, the binding may\r\n\t\t\t\t\t\t\t// or may not exist\r\n\r\n\t\t\t\t\t\t\tbinding = new PropertyBinding( object, paths[ j ], parsedPaths[ j ] );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = binding;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if ( objects[ index ] !== knownObject ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.AnimationObjectGroup: Different objects with the same UUID ' +\r\n\t\t\t\t\t\t'detected. Clean the caches or recreate your infrastructure when reloading scenes.' );\r\n\r\n\t\t\t\t} // else the object is already where we want it to be\r\n\r\n\t\t\t} // for arguments\r\n\r\n\t\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t\t},\r\n\r\n\t\tremove: function () {\r\n\r\n\t\t\tvar objects = this._objects,\r\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tnBindings = bindings.length;\r\n\r\n\t\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar object = arguments[ i ],\r\n\t\t\t\t\tuuid = object.uuid,\r\n\t\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\t\tif ( index !== undefined && index >= nCachedObjects ) {\r\n\r\n\t\t\t\t\t// move existing object into the CACHED region\r\n\r\n\t\t\t\t\tvar lastCachedIndex = nCachedObjects ++,\r\n\t\t\t\t\t\tfirstActiveObject = objects[ lastCachedIndex ];\r\n\r\n\t\t\t\t\tindicesByUUID[ firstActiveObject.uuid ] = index;\r\n\t\t\t\t\tobjects[ index ] = firstActiveObject;\r\n\r\n\t\t\t\t\tindicesByUUID[ uuid ] = lastCachedIndex;\r\n\t\t\t\t\tobjects[ lastCachedIndex ] = object;\r\n\r\n\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\t\tfirstActive = bindingsForPath[ lastCachedIndex ],\r\n\t\t\t\t\t\t\tbinding = bindingsForPath[ index ];\r\n\r\n\t\t\t\t\t\tbindingsForPath[ index ] = firstActive;\r\n\t\t\t\t\t\tbindingsForPath[ lastCachedIndex ] = binding;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} // for arguments\r\n\r\n\t\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t\t},\r\n\r\n\t\t// remove & forget\r\n\t\tuncache: function () {\r\n\r\n\t\t\tvar objects = this._objects,\r\n\t\t\t\tnObjects = objects.length,\r\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\t\tindicesByUUID = this._indicesByUUID,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tnBindings = bindings.length;\r\n\r\n\t\t\tfor ( var i = 0, n = arguments.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar object = arguments[ i ],\r\n\t\t\t\t\tuuid = object.uuid,\r\n\t\t\t\t\tindex = indicesByUUID[ uuid ];\r\n\r\n\t\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\t\tdelete indicesByUUID[ uuid ];\r\n\r\n\t\t\t\t\tif ( index < nCachedObjects ) {\r\n\r\n\t\t\t\t\t\t// object is cached, shrink the CACHED region\r\n\r\n\t\t\t\t\t\tvar firstActiveIndex = -- nCachedObjects,\r\n\t\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ],\r\n\t\t\t\t\t\t\tlastIndex = -- nObjects,\r\n\t\t\t\t\t\t\tlastObject = objects[ lastIndex ];\r\n\r\n\t\t\t\t\t\t// last cached object takes this object's place\r\n\t\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\r\n\t\t\t\t\t\tobjects[ index ] = lastCachedObject;\r\n\r\n\t\t\t\t\t\t// last object goes to the activated slot and pop\r\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = firstActiveIndex;\r\n\t\t\t\t\t\tobjects[ firstActiveIndex ] = lastObject;\r\n\t\t\t\t\t\tobjects.pop();\r\n\r\n\t\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\t\tvar bindingsForPath = bindings[ j ],\r\n\t\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\r\n\t\t\t\t\t\t\t\tlast = bindingsForPath[ lastIndex ];\r\n\r\n\t\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\r\n\t\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = last;\r\n\t\t\t\t\t\t\tbindingsForPath.pop();\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// object is active, just swap with the last and pop\r\n\r\n\t\t\t\t\t\tvar lastIndex = -- nObjects,\r\n\t\t\t\t\t\t\tlastObject = objects[ lastIndex ];\r\n\r\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = index;\r\n\t\t\t\t\t\tobjects[ index ] = lastObject;\r\n\t\t\t\t\t\tobjects.pop();\r\n\r\n\t\t\t\t\t\t// accounting is done, now do the same for all bindings\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, m = nBindings; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\t\t\tvar bindingsForPath = bindings[ j ];\r\n\r\n\t\t\t\t\t\t\tbindingsForPath[ index ] = bindingsForPath[ lastIndex ];\r\n\t\t\t\t\t\t\tbindingsForPath.pop();\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} // cached or active\r\n\r\n\t\t\t\t} // if object is known\r\n\r\n\t\t\t} // for arguments\r\n\r\n\t\t\tthis.nCachedObjects_ = nCachedObjects;\r\n\r\n\t\t},\r\n\r\n\t\t// Internal interface used by befriended PropertyBinding.Composite:\r\n\r\n\t\tsubscribe_: function ( path, parsedPath ) {\r\n\r\n\t\t\t// returns an array of bindings for the given path that is changed\r\n\t\t\t// according to the contained objects in the group\r\n\r\n\t\t\tvar indicesByPath = this._bindingsIndicesByPath,\r\n\t\t\t\tindex = indicesByPath[ path ],\r\n\t\t\t\tbindings = this._bindings;\r\n\r\n\t\t\tif ( index !== undefined ) { return bindings[ index ]; }\r\n\r\n\t\t\tvar paths = this._paths,\r\n\t\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\t\tobjects = this._objects,\r\n\t\t\t\tnObjects = objects.length,\r\n\t\t\t\tnCachedObjects = this.nCachedObjects_,\r\n\t\t\t\tbindingsForPath = new Array( nObjects );\r\n\r\n\t\t\tindex = bindings.length;\r\n\r\n\t\t\tindicesByPath[ path ] = index;\r\n\r\n\t\t\tpaths.push( path );\r\n\t\t\tparsedPaths.push( parsedPath );\r\n\t\t\tbindings.push( bindingsForPath );\r\n\r\n\t\t\tfor ( var i = nCachedObjects, n = objects.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar object = objects[ i ];\r\n\t\t\t\tbindingsForPath[ i ] = new PropertyBinding( object, path, parsedPath );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn bindingsForPath;\r\n\r\n\t\t},\r\n\r\n\t\tunsubscribe_: function ( path ) {\r\n\r\n\t\t\t// tells the group to forget about a property path and no longer\r\n\t\t\t// update the array previously obtained with 'subscribe_'\r\n\r\n\t\t\tvar indicesByPath = this._bindingsIndicesByPath,\r\n\t\t\t\tindex = indicesByPath[ path ];\r\n\r\n\t\t\tif ( index !== undefined ) {\r\n\r\n\t\t\t\tvar paths = this._paths,\r\n\t\t\t\t\tparsedPaths = this._parsedPaths,\r\n\t\t\t\t\tbindings = this._bindings,\r\n\t\t\t\t\tlastBindingsIndex = bindings.length - 1,\r\n\t\t\t\t\tlastBindings = bindings[ lastBindingsIndex ],\r\n\t\t\t\t\tlastBindingsPath = path[ lastBindingsIndex ];\r\n\r\n\t\t\t\tindicesByPath[ lastBindingsPath ] = index;\r\n\r\n\t\t\t\tbindings[ index ] = lastBindings;\r\n\t\t\t\tbindings.pop();\r\n\r\n\t\t\t\tparsedPaths[ index ] = parsedPaths[ lastBindingsIndex ];\r\n\t\t\t\tparsedPaths.pop();\r\n\r\n\t\t\t\tpaths[ index ] = paths[ lastBindingsIndex ];\r\n\t\t\t\tpaths.pop();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Action provided by AnimationMixer for scheduling clip playback on specific\r\n\t * objects.\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t *\r\n\t */\r\n\r\n\tfunction AnimationAction( mixer, clip, localRoot ) {\r\n\r\n\t\tthis._mixer = mixer;\r\n\t\tthis._clip = clip;\r\n\t\tthis._localRoot = localRoot || null;\r\n\r\n\t\tvar tracks = clip.tracks,\r\n\t\t\tnTracks = tracks.length,\r\n\t\t\tinterpolants = new Array( nTracks );\r\n\r\n\t\tvar interpolantSettings = {\r\n\t\t\tendingStart: ZeroCurvatureEnding,\r\n\t\t\tendingEnd: ZeroCurvatureEnding\r\n\t\t};\r\n\r\n\t\tfor ( var i = 0; i !== nTracks; ++ i ) {\r\n\r\n\t\t\tvar interpolant = tracks[ i ].createInterpolant( null );\r\n\t\t\tinterpolants[ i ] = interpolant;\r\n\t\t\tinterpolant.settings = interpolantSettings;\r\n\r\n\t\t}\r\n\r\n\t\tthis._interpolantSettings = interpolantSettings;\r\n\r\n\t\tthis._interpolants = interpolants; // bound by the mixer\r\n\r\n\t\t// inside: PropertyMixer (managed by the mixer)\r\n\t\tthis._propertyBindings = new Array( nTracks );\r\n\r\n\t\tthis._cacheIndex = null; // for the memory manager\r\n\t\tthis._byClipCacheIndex = null; // for the memory manager\r\n\r\n\t\tthis._timeScaleInterpolant = null;\r\n\t\tthis._weightInterpolant = null;\r\n\r\n\t\tthis.loop = LoopRepeat;\r\n\t\tthis._loopCount = - 1;\r\n\r\n\t\t// global mixer time when the action is to be started\r\n\t\t// it's set back to 'null' upon start of the action\r\n\t\tthis._startTime = null;\r\n\r\n\t\t// scaled local time of the action\r\n\t\t// gets clamped or wrapped to 0..clip.duration according to loop\r\n\t\tthis.time = 0;\r\n\r\n\t\tthis.timeScale = 1;\r\n\t\tthis._effectiveTimeScale = 1;\r\n\r\n\t\tthis.weight = 1;\r\n\t\tthis._effectiveWeight = 1;\r\n\r\n\t\tthis.repetitions = Infinity; // no. of repetitions when looping\r\n\r\n\t\tthis.paused = false; // true -> zero effective time scale\r\n\t\tthis.enabled = true; // false -> zero effective weight\r\n\r\n\t\tthis.clampWhenFinished = false;// keep feeding the last frame?\r\n\r\n\t\tthis.zeroSlopeAtStart = true;// for smooth interpolation w/o separate\r\n\t\tthis.zeroSlopeAtEnd = true;// clips for start, loop and end\r\n\r\n\t}\r\n\r\n\tObject.assign( AnimationAction.prototype, {\r\n\r\n\t\t// State & Scheduling\r\n\r\n\t\tplay: function () {\r\n\r\n\t\t\tthis._mixer._activateAction( this );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tstop: function () {\r\n\r\n\t\t\tthis._mixer._deactivateAction( this );\r\n\r\n\t\t\treturn this.reset();\r\n\r\n\t\t},\r\n\r\n\t\treset: function () {\r\n\r\n\t\t\tthis.paused = false;\r\n\t\t\tthis.enabled = true;\r\n\r\n\t\t\tthis.time = 0; // restart clip\r\n\t\t\tthis._loopCount = - 1;// forget previous loops\r\n\t\t\tthis._startTime = null;// forget scheduling\r\n\r\n\t\t\treturn this.stopFading().stopWarping();\r\n\r\n\t\t},\r\n\r\n\t\tisRunning: function () {\r\n\r\n\t\t\treturn this.enabled && ! this.paused && this.timeScale !== 0 &&\r\n\t\t\t\tthis._startTime === null && this._mixer._isActiveAction( this );\r\n\r\n\t\t},\r\n\r\n\t\t// return true when play has been called\r\n\t\tisScheduled: function () {\r\n\r\n\t\t\treturn this._mixer._isActiveAction( this );\r\n\r\n\t\t},\r\n\r\n\t\tstartAt: function ( time ) {\r\n\r\n\t\t\tthis._startTime = time;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetLoop: function ( mode, repetitions ) {\r\n\r\n\t\t\tthis.loop = mode;\r\n\t\t\tthis.repetitions = repetitions;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// Weight\r\n\r\n\t\t// set the weight stopping any scheduled fading\r\n\t\t// although .enabled = false yields an effective weight of zero, this\r\n\t\t// method does *not* change .enabled, because it would be confusing\r\n\t\tsetEffectiveWeight: function ( weight ) {\r\n\r\n\t\t\tthis.weight = weight;\r\n\r\n\t\t\t// note: same logic as when updated at runtime\r\n\t\t\tthis._effectiveWeight = this.enabled ? weight : 0;\r\n\r\n\t\t\treturn this.stopFading();\r\n\r\n\t\t},\r\n\r\n\t\t// return the weight considering fading and .enabled\r\n\t\tgetEffectiveWeight: function () {\r\n\r\n\t\t\treturn this._effectiveWeight;\r\n\r\n\t\t},\r\n\r\n\t\tfadeIn: function ( duration ) {\r\n\r\n\t\t\treturn this._scheduleFading( duration, 0, 1 );\r\n\r\n\t\t},\r\n\r\n\t\tfadeOut: function ( duration ) {\r\n\r\n\t\t\treturn this._scheduleFading( duration, 1, 0 );\r\n\r\n\t\t},\r\n\r\n\t\tcrossFadeFrom: function ( fadeOutAction, duration, warp ) {\r\n\r\n\t\t\tfadeOutAction.fadeOut( duration );\r\n\t\t\tthis.fadeIn( duration );\r\n\r\n\t\t\tif ( warp ) {\r\n\r\n\t\t\t\tvar fadeInDuration = this._clip.duration,\r\n\t\t\t\t\tfadeOutDuration = fadeOutAction._clip.duration,\r\n\r\n\t\t\t\t\tstartEndRatio = fadeOutDuration / fadeInDuration,\r\n\t\t\t\t\tendStartRatio = fadeInDuration / fadeOutDuration;\r\n\r\n\t\t\t\tfadeOutAction.warp( 1.0, startEndRatio, duration );\r\n\t\t\t\tthis.warp( endStartRatio, 1.0, duration );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcrossFadeTo: function ( fadeInAction, duration, warp ) {\r\n\r\n\t\t\treturn fadeInAction.crossFadeFrom( this, duration, warp );\r\n\r\n\t\t},\r\n\r\n\t\tstopFading: function () {\r\n\r\n\t\t\tvar weightInterpolant = this._weightInterpolant;\r\n\r\n\t\t\tif ( weightInterpolant !== null ) {\r\n\r\n\t\t\t\tthis._weightInterpolant = null;\r\n\t\t\t\tthis._mixer._takeBackControlInterpolant( weightInterpolant );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// Time Scale Control\r\n\r\n\t\t// set the time scale stopping any scheduled warping\r\n\t\t// although .paused = true yields an effective time scale of zero, this\r\n\t\t// method does *not* change .paused, because it would be confusing\r\n\t\tsetEffectiveTimeScale: function ( timeScale ) {\r\n\r\n\t\t\tthis.timeScale = timeScale;\r\n\t\t\tthis._effectiveTimeScale = this.paused ? 0 : timeScale;\r\n\r\n\t\t\treturn this.stopWarping();\r\n\r\n\t\t},\r\n\r\n\t\t// return the time scale considering warping and .paused\r\n\t\tgetEffectiveTimeScale: function () {\r\n\r\n\t\t\treturn this._effectiveTimeScale;\r\n\r\n\t\t},\r\n\r\n\t\tsetDuration: function ( duration ) {\r\n\r\n\t\t\tthis.timeScale = this._clip.duration / duration;\r\n\r\n\t\t\treturn this.stopWarping();\r\n\r\n\t\t},\r\n\r\n\t\tsyncWith: function ( action ) {\r\n\r\n\t\t\tthis.time = action.time;\r\n\t\t\tthis.timeScale = action.timeScale;\r\n\r\n\t\t\treturn this.stopWarping();\r\n\r\n\t\t},\r\n\r\n\t\thalt: function ( duration ) {\r\n\r\n\t\t\treturn this.warp( this._effectiveTimeScale, 0, duration );\r\n\r\n\t\t},\r\n\r\n\t\twarp: function ( startTimeScale, endTimeScale, duration ) {\r\n\r\n\t\t\tvar mixer = this._mixer, now = mixer.time,\r\n\t\t\t\tinterpolant = this._timeScaleInterpolant,\r\n\r\n\t\t\t\ttimeScale = this.timeScale;\r\n\r\n\t\t\tif ( interpolant === null ) {\r\n\r\n\t\t\t\tinterpolant = mixer._lendControlInterpolant();\r\n\t\t\t\tthis._timeScaleInterpolant = interpolant;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar times = interpolant.parameterPositions,\r\n\t\t\t\tvalues = interpolant.sampleValues;\r\n\r\n\t\t\ttimes[ 0 ] = now;\r\n\t\t\ttimes[ 1 ] = now + duration;\r\n\r\n\t\t\tvalues[ 0 ] = startTimeScale / timeScale;\r\n\t\t\tvalues[ 1 ] = endTimeScale / timeScale;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tstopWarping: function () {\r\n\r\n\t\t\tvar timeScaleInterpolant = this._timeScaleInterpolant;\r\n\r\n\t\t\tif ( timeScaleInterpolant !== null ) {\r\n\r\n\t\t\t\tthis._timeScaleInterpolant = null;\r\n\t\t\t\tthis._mixer._takeBackControlInterpolant( timeScaleInterpolant );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// Object Accessors\r\n\r\n\t\tgetMixer: function () {\r\n\r\n\t\t\treturn this._mixer;\r\n\r\n\t\t},\r\n\r\n\t\tgetClip: function () {\r\n\r\n\t\t\treturn this._clip;\r\n\r\n\t\t},\r\n\r\n\t\tgetRoot: function () {\r\n\r\n\t\t\treturn this._localRoot || this._mixer._root;\r\n\r\n\t\t},\r\n\r\n\t\t// Interna\r\n\r\n\t\t_update: function ( time, deltaTime, timeDirection, accuIndex ) {\r\n\r\n\t\t\t// called by the mixer\r\n\r\n\t\t\tif ( ! this.enabled ) {\r\n\r\n\t\t\t\t// call ._updateWeight() to update ._effectiveWeight\r\n\r\n\t\t\t\tthis._updateWeight( time );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar startTime = this._startTime;\r\n\r\n\t\t\tif ( startTime !== null ) {\r\n\r\n\t\t\t\t// check for scheduled start of action\r\n\r\n\t\t\t\tvar timeRunning = ( time - startTime ) * timeDirection;\r\n\t\t\t\tif ( timeRunning < 0 || timeDirection === 0 ) {\r\n\r\n\t\t\t\t\treturn; // yet to come / don't decide when delta = 0\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// start\r\n\r\n\t\t\t\tthis._startTime = null; // unschedule\r\n\t\t\t\tdeltaTime = timeDirection * timeRunning;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// apply time scale and advance time\r\n\r\n\t\t\tdeltaTime *= this._updateTimeScale( time );\r\n\t\t\tvar clipTime = this._updateTime( deltaTime );\r\n\r\n\t\t\t// note: _updateTime may disable the action resulting in\r\n\t\t\t// an effective weight of 0\r\n\r\n\t\t\tvar weight = this._updateWeight( time );\r\n\r\n\t\t\tif ( weight > 0 ) {\r\n\r\n\t\t\t\tvar interpolants = this._interpolants;\r\n\t\t\t\tvar propertyMixers = this._propertyBindings;\r\n\r\n\t\t\t\tfor ( var j = 0, m = interpolants.length; j !== m; ++ j ) {\r\n\r\n\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\r\n\t\t\t\t\tpropertyMixers[ j ].accumulate( accuIndex, weight );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_updateWeight: function ( time ) {\r\n\r\n\t\t\tvar weight = 0;\r\n\r\n\t\t\tif ( this.enabled ) {\r\n\r\n\t\t\t\tweight = this.weight;\r\n\t\t\t\tvar interpolant = this._weightInterpolant;\r\n\r\n\t\t\t\tif ( interpolant !== null ) {\r\n\r\n\t\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\r\n\r\n\t\t\t\t\tweight *= interpolantValue;\r\n\r\n\t\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\r\n\r\n\t\t\t\t\t\tthis.stopFading();\r\n\r\n\t\t\t\t\t\tif ( interpolantValue === 0 ) {\r\n\r\n\t\t\t\t\t\t\t// faded out, disable\r\n\t\t\t\t\t\t\tthis.enabled = false;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._effectiveWeight = weight;\r\n\t\t\treturn weight;\r\n\r\n\t\t},\r\n\r\n\t\t_updateTimeScale: function ( time ) {\r\n\r\n\t\t\tvar timeScale = 0;\r\n\r\n\t\t\tif ( ! this.paused ) {\r\n\r\n\t\t\t\ttimeScale = this.timeScale;\r\n\r\n\t\t\t\tvar interpolant = this._timeScaleInterpolant;\r\n\r\n\t\t\t\tif ( interpolant !== null ) {\r\n\r\n\t\t\t\t\tvar interpolantValue = interpolant.evaluate( time )[ 0 ];\r\n\r\n\t\t\t\t\ttimeScale *= interpolantValue;\r\n\r\n\t\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\r\n\r\n\t\t\t\t\t\tthis.stopWarping();\r\n\r\n\t\t\t\t\t\tif ( timeScale === 0 ) {\r\n\r\n\t\t\t\t\t\t\t// motion has halted, pause\r\n\t\t\t\t\t\t\tthis.paused = true;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// warp done - apply final time scale\r\n\t\t\t\t\t\t\tthis.timeScale = timeScale;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._effectiveTimeScale = timeScale;\r\n\t\t\treturn timeScale;\r\n\r\n\t\t},\r\n\r\n\t\t_updateTime: function ( deltaTime ) {\r\n\r\n\t\t\tvar time = this.time + deltaTime;\r\n\t\t\tvar duration = this._clip.duration;\r\n\t\t\tvar loop = this.loop;\r\n\t\t\tvar loopCount = this._loopCount;\r\n\r\n\t\t\tvar pingPong = ( loop === LoopPingPong );\r\n\r\n\t\t\tif ( deltaTime === 0 ) {\r\n\r\n\t\t\t\tif ( loopCount === - 1 ) { return time; }\r\n\r\n\t\t\t\treturn ( pingPong && ( loopCount & 1 ) === 1 ) ? duration - time : time;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( loop === LoopOnce ) {\r\n\r\n\t\t\t\tif ( loopCount === - 1 ) {\r\n\r\n\t\t\t\t\t// just started\r\n\r\n\t\t\t\t\tthis._loopCount = 0;\r\n\t\t\t\t\tthis._setEndings( true, true, false );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\thandle_stop: {\r\n\r\n\t\t\t\t\tif ( time >= duration ) {\r\n\r\n\t\t\t\t\t\ttime = duration;\r\n\r\n\t\t\t\t\t} else if ( time < 0 ) {\r\n\r\n\t\t\t\t\t\ttime = 0;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tthis.time = time;\r\n\r\n\t\t\t\t\t\tbreak handle_stop;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.clampWhenFinished ) { this.paused = true; }\r\n\t\t\t\t\telse { this.enabled = false; }\r\n\r\n\t\t\t\t\tthis.time = time;\r\n\r\n\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\ttype: 'finished', action: this,\r\n\t\t\t\t\t\tdirection: deltaTime < 0 ? - 1 : 1\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else { // repetitive Repeat or PingPong\r\n\r\n\t\t\t\tif ( loopCount === - 1 ) {\r\n\r\n\t\t\t\t\t// just started\r\n\r\n\t\t\t\t\tif ( deltaTime >= 0 ) {\r\n\r\n\t\t\t\t\t\tloopCount = 0;\r\n\r\n\t\t\t\t\t\tthis._setEndings( true, this.repetitions === 0, pingPong );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// when looping in reverse direction, the initial\r\n\t\t\t\t\t\t// transition through zero counts as a repetition,\r\n\t\t\t\t\t\t// so leave loopCount at -1\r\n\r\n\t\t\t\t\t\tthis._setEndings( this.repetitions === 0, true, pingPong );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( time >= duration || time < 0 ) {\r\n\r\n\t\t\t\t\t// wrap around\r\n\r\n\t\t\t\t\tvar loopDelta = Math.floor( time / duration ); // signed\r\n\t\t\t\t\ttime -= duration * loopDelta;\r\n\r\n\t\t\t\t\tloopCount += Math.abs( loopDelta );\r\n\r\n\t\t\t\t\tvar pending = this.repetitions - loopCount;\r\n\r\n\t\t\t\t\tif ( pending <= 0 ) {\r\n\r\n\t\t\t\t\t\t// have to stop (switch state, clamp time, fire event)\r\n\r\n\t\t\t\t\t\tif ( this.clampWhenFinished ) { this.paused = true; }\r\n\t\t\t\t\t\telse { this.enabled = false; }\r\n\r\n\t\t\t\t\t\ttime = deltaTime > 0 ? duration : 0;\r\n\r\n\t\t\t\t\t\tthis.time = time;\r\n\r\n\t\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\t\ttype: 'finished', action: this,\r\n\t\t\t\t\t\t\tdirection: deltaTime > 0 ? 1 : - 1\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// keep running\r\n\r\n\t\t\t\t\t\tif ( pending === 1 ) {\r\n\r\n\t\t\t\t\t\t\t// entering the last round\r\n\r\n\t\t\t\t\t\t\tvar atStart = deltaTime < 0;\r\n\t\t\t\t\t\t\tthis._setEndings( atStart, ! atStart, pingPong );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tthis._setEndings( false, false, pingPong );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis._loopCount = loopCount;\r\n\r\n\t\t\t\t\t\tthis.time = time;\r\n\r\n\t\t\t\t\t\tthis._mixer.dispatchEvent( {\r\n\t\t\t\t\t\t\ttype: 'loop', action: this, loopDelta: loopDelta\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis.time = time;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( pingPong && ( loopCount & 1 ) === 1 ) {\r\n\r\n\t\t\t\t\t// invert time for the \"pong round\"\r\n\r\n\t\t\t\t\treturn duration - time;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn time;\r\n\r\n\t\t},\r\n\r\n\t\t_setEndings: function ( atStart, atEnd, pingPong ) {\r\n\r\n\t\t\tvar settings = this._interpolantSettings;\r\n\r\n\t\t\tif ( pingPong ) {\r\n\r\n\t\t\t\tsettings.endingStart = ZeroSlopeEnding;\r\n\t\t\t\tsettings.endingEnd = ZeroSlopeEnding;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// assuming for LoopOnce atStart == atEnd == true\r\n\r\n\t\t\t\tif ( atStart ) {\r\n\r\n\t\t\t\t\tsettings.endingStart = this.zeroSlopeAtStart ? ZeroSlopeEnding : ZeroCurvatureEnding;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tsettings.endingStart = WrapAroundEnding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( atEnd ) {\r\n\r\n\t\t\t\t\tsettings.endingEnd = this.zeroSlopeAtEnd ? ZeroSlopeEnding : ZeroCurvatureEnding;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tsettings.endingEnd \t = WrapAroundEnding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_scheduleFading: function ( duration, weightNow, weightThen ) {\r\n\r\n\t\t\tvar mixer = this._mixer, now = mixer.time,\r\n\t\t\t\tinterpolant = this._weightInterpolant;\r\n\r\n\t\t\tif ( interpolant === null ) {\r\n\r\n\t\t\t\tinterpolant = mixer._lendControlInterpolant();\r\n\t\t\t\tthis._weightInterpolant = interpolant;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar times = interpolant.parameterPositions,\r\n\t\t\t\tvalues = interpolant.sampleValues;\r\n\r\n\t\t\ttimes[ 0 ] = now;\r\n\t\t\tvalues[ 0 ] = weightNow;\r\n\t\t\ttimes[ 1 ] = now + duration;\r\n\t\t\tvalues[ 1 ] = weightThen;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t *\r\n\t * Player for AnimationClips.\r\n\t *\r\n\t *\r\n\t * @author Ben Houston / http://clara.io/\r\n\t * @author David Sarno / http://lighthaus.us/\r\n\t * @author tschw\r\n\t */\r\n\r\n\tfunction AnimationMixer( root ) {\r\n\r\n\t\tthis._root = root;\r\n\t\tthis._initMemoryManager();\r\n\t\tthis._accuIndex = 0;\r\n\r\n\t\tthis.time = 0;\r\n\r\n\t\tthis.timeScale = 1.0;\r\n\r\n\t}\r\n\r\n\tAnimationMixer.prototype = Object.assign( Object.create( EventDispatcher.prototype ), {\r\n\r\n\t\tconstructor: AnimationMixer,\r\n\r\n\t\t_bindAction: function ( action, prototypeAction ) {\r\n\r\n\t\t\tvar root = action._localRoot || this._root,\r\n\t\t\t\ttracks = action._clip.tracks,\r\n\t\t\t\tnTracks = tracks.length,\r\n\t\t\t\tbindings = action._propertyBindings,\r\n\t\t\t\tinterpolants = action._interpolants,\r\n\t\t\t\trootUuid = root.uuid,\r\n\t\t\t\tbindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\t\tbindingsByName = bindingsByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( bindingsByName === undefined ) {\r\n\r\n\t\t\t\tbindingsByName = {};\r\n\t\t\t\tbindingsByRoot[ rootUuid ] = bindingsByName;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i !== nTracks; ++ i ) {\r\n\r\n\t\t\t\tvar track = tracks[ i ],\r\n\t\t\t\t\ttrackName = track.name,\r\n\t\t\t\t\tbinding = bindingsByName[ trackName ];\r\n\r\n\t\t\t\tif ( binding !== undefined ) {\r\n\r\n\t\t\t\t\tbindings[ i ] = binding;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tbinding = bindings[ i ];\r\n\r\n\t\t\t\t\tif ( binding !== undefined ) {\r\n\r\n\t\t\t\t\t\t// existing binding, make sure the cache knows\r\n\r\n\t\t\t\t\t\tif ( binding._cacheIndex === null ) {\r\n\r\n\t\t\t\t\t\t\t++ binding.referenceCount;\r\n\t\t\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar path = prototypeAction && prototypeAction.\r\n\t\t\t\t\t\t_propertyBindings[ i ].binding.parsedPath;\r\n\r\n\t\t\t\t\tbinding = new PropertyMixer(\r\n\t\t\t\t\t\tPropertyBinding.create( root, trackName, path ),\r\n\t\t\t\t\t\ttrack.ValueTypeName, track.getValueSize() );\r\n\r\n\t\t\t\t\t++ binding.referenceCount;\r\n\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\r\n\r\n\t\t\t\t\tbindings[ i ] = binding;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tinterpolants[ i ].resultBuffer = binding.buffer;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_activateAction: function ( action ) {\r\n\r\n\t\t\tif ( ! this._isActiveAction( action ) ) {\r\n\r\n\t\t\t\tif ( action._cacheIndex === null ) {\r\n\r\n\t\t\t\t\t// this action has been forgotten by the cache, but the user\r\n\t\t\t\t\t// appears to be still using it -> rebind\r\n\r\n\t\t\t\t\tvar rootUuid = ( action._localRoot || this._root ).uuid,\r\n\t\t\t\t\t\tclipUuid = action._clip.uuid,\r\n\t\t\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\r\n\r\n\t\t\t\t\tthis._bindAction( action,\r\n\t\t\t\t\t\tactionsForClip && actionsForClip.knownActions[ 0 ] );\r\n\r\n\t\t\t\t\tthis._addInactiveAction( action, clipUuid, rootUuid );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar bindings = action._propertyBindings;\r\n\r\n\t\t\t\t// increment reference counts / sort out state\r\n\t\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\t\tif ( binding.useCount ++ === 0 ) {\r\n\r\n\t\t\t\t\t\tthis._lendBinding( binding );\r\n\t\t\t\t\t\tbinding.saveOriginalState();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._lendAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_deactivateAction: function ( action ) {\r\n\r\n\t\t\tif ( this._isActiveAction( action ) ) {\r\n\r\n\t\t\t\tvar bindings = action._propertyBindings;\r\n\r\n\t\t\t\t// decrement reference counts / sort out state\r\n\t\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\t\tif ( -- binding.useCount === 0 ) {\r\n\r\n\t\t\t\t\t\tbinding.restoreOriginalState();\r\n\t\t\t\t\t\tthis._takeBackBinding( binding );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._takeBackAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// Memory manager\r\n\r\n\t\t_initMemoryManager: function () {\r\n\r\n\t\t\tthis._actions = []; // 'nActiveActions' followed by inactive ones\r\n\t\t\tthis._nActiveActions = 0;\r\n\r\n\t\t\tthis._actionsByClip = {};\r\n\t\t\t// inside:\r\n\t\t\t// {\r\n\t\t\t// \tknownActions: Array< AnimationAction > - used as prototypes\r\n\t\t\t// \tactionByRoot: AnimationAction - lookup\r\n\t\t\t// }\r\n\r\n\r\n\t\t\tthis._bindings = []; // 'nActiveBindings' followed by inactive ones\r\n\t\t\tthis._nActiveBindings = 0;\r\n\r\n\t\t\tthis._bindingsByRootAndName = {}; // inside: Map< name, PropertyMixer >\r\n\r\n\r\n\t\t\tthis._controlInterpolants = []; // same game as above\r\n\t\t\tthis._nActiveControlInterpolants = 0;\r\n\r\n\t\t\tvar scope = this;\r\n\r\n\t\t\tthis.stats = {\r\n\r\n\t\t\t\tactions: {\r\n\t\t\t\t\tget total() {\r\n\r\n\t\t\t\t\t\treturn scope._actions.length;\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget inUse() {\r\n\r\n\t\t\t\t\t\treturn scope._nActiveActions;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tbindings: {\r\n\t\t\t\t\tget total() {\r\n\r\n\t\t\t\t\t\treturn scope._bindings.length;\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget inUse() {\r\n\r\n\t\t\t\t\t\treturn scope._nActiveBindings;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcontrolInterpolants: {\r\n\t\t\t\t\tget total() {\r\n\r\n\t\t\t\t\t\treturn scope._controlInterpolants.length;\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget inUse() {\r\n\r\n\t\t\t\t\t\treturn scope._nActiveControlInterpolants;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\t// Memory management for AnimationAction objects\r\n\r\n\t\t_isActiveAction: function ( action ) {\r\n\r\n\t\t\tvar index = action._cacheIndex;\r\n\t\t\treturn index !== null && index < this._nActiveActions;\r\n\r\n\t\t},\r\n\r\n\t\t_addInactiveAction: function ( action, clipUuid, rootUuid ) {\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\t\tactionsForClip = actionsByClip[ clipUuid ];\r\n\r\n\t\t\tif ( actionsForClip === undefined ) {\r\n\r\n\t\t\t\tactionsForClip = {\r\n\r\n\t\t\t\t\tknownActions: [ action ],\r\n\t\t\t\t\tactionByRoot: {}\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\taction._byClipCacheIndex = 0;\r\n\r\n\t\t\t\tactionsByClip[ clipUuid ] = actionsForClip;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar knownActions = actionsForClip.knownActions;\r\n\r\n\t\t\t\taction._byClipCacheIndex = knownActions.length;\r\n\t\t\t\tknownActions.push( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t\taction._cacheIndex = actions.length;\r\n\t\t\tactions.push( action );\r\n\r\n\t\t\tactionsForClip.actionByRoot[ rootUuid ] = action;\r\n\r\n\t\t},\r\n\r\n\t\t_removeInactiveAction: function ( action ) {\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ],\r\n\t\t\t\tcacheIndex = action._cacheIndex;\r\n\r\n\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\r\n\t\t\tactions[ cacheIndex ] = lastInactiveAction;\r\n\t\t\tactions.pop();\r\n\r\n\t\t\taction._cacheIndex = null;\r\n\r\n\r\n\t\t\tvar clipUuid = action._clip.uuid,\r\n\t\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\t\tactionsForClip = actionsByClip[ clipUuid ],\r\n\t\t\t\tknownActionsForClip = actionsForClip.knownActions,\r\n\r\n\t\t\t\tlastKnownAction =\r\n\t\t\t\t\tknownActionsForClip[ knownActionsForClip.length - 1 ],\r\n\r\n\t\t\t\tbyClipCacheIndex = action._byClipCacheIndex;\r\n\r\n\t\t\tlastKnownAction._byClipCacheIndex = byClipCacheIndex;\r\n\t\t\tknownActionsForClip[ byClipCacheIndex ] = lastKnownAction;\r\n\t\t\tknownActionsForClip.pop();\r\n\r\n\t\t\taction._byClipCacheIndex = null;\r\n\r\n\r\n\t\t\tvar actionByRoot = actionsForClip.actionByRoot,\r\n\t\t\t\trootUuid = ( action._localRoot || this._root ).uuid;\r\n\r\n\t\t\tdelete actionByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( knownActionsForClip.length === 0 ) {\r\n\r\n\t\t\t\tdelete actionsByClip[ clipUuid ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._removeInactiveBindingsForAction( action );\r\n\r\n\t\t},\r\n\r\n\t\t_removeInactiveBindingsForAction: function ( action ) {\r\n\r\n\t\t\tvar bindings = action._propertyBindings;\r\n\t\t\tfor ( var i = 0, n = bindings.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\tvar binding = bindings[ i ];\r\n\r\n\t\t\t\tif ( -- binding.referenceCount === 0 ) {\r\n\r\n\t\t\t\t\tthis._removeInactiveBinding( binding );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_lendAction: function ( action ) {\r\n\r\n\t\t\t// [ active actions |  inactive actions  ]\r\n\t\t\t// [  active actions >| inactive actions ]\r\n\t\t\t//                 s        a\r\n\t\t\t//                  <-swap->\r\n\t\t\t//                 a        s\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tprevIndex = action._cacheIndex,\r\n\r\n\t\t\t\tlastActiveIndex = this._nActiveActions ++,\r\n\r\n\t\t\t\tfirstInactiveAction = actions[ lastActiveIndex ];\r\n\r\n\t\t\taction._cacheIndex = lastActiveIndex;\r\n\t\t\tactions[ lastActiveIndex ] = action;\r\n\r\n\t\t\tfirstInactiveAction._cacheIndex = prevIndex;\r\n\t\t\tactions[ prevIndex ] = firstInactiveAction;\r\n\r\n\t\t},\r\n\r\n\t\t_takeBackAction: function ( action ) {\r\n\r\n\t\t\t// [  active actions  | inactive actions ]\r\n\t\t\t// [ active actions |< inactive actions  ]\r\n\t\t\t//        a        s\r\n\t\t\t//         <-swap->\r\n\t\t\t//        s        a\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tprevIndex = action._cacheIndex,\r\n\r\n\t\t\t\tfirstInactiveIndex = -- this._nActiveActions,\r\n\r\n\t\t\t\tlastActiveAction = actions[ firstInactiveIndex ];\r\n\r\n\t\t\taction._cacheIndex = firstInactiveIndex;\r\n\t\t\tactions[ firstInactiveIndex ] = action;\r\n\r\n\t\t\tlastActiveAction._cacheIndex = prevIndex;\r\n\t\t\tactions[ prevIndex ] = lastActiveAction;\r\n\r\n\t\t},\r\n\r\n\t\t// Memory management for PropertyMixer objects\r\n\r\n\t\t_addInactiveBinding: function ( binding, rootUuid, trackName ) {\r\n\r\n\t\t\tvar bindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\r\n\r\n\t\t\t\tbindings = this._bindings;\r\n\r\n\t\t\tif ( bindingByName === undefined ) {\r\n\r\n\t\t\t\tbindingByName = {};\r\n\t\t\t\tbindingsByRoot[ rootUuid ] = bindingByName;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tbindingByName[ trackName ] = binding;\r\n\r\n\t\t\tbinding._cacheIndex = bindings.length;\r\n\t\t\tbindings.push( binding );\r\n\r\n\t\t},\r\n\r\n\t\t_removeInactiveBinding: function ( binding ) {\r\n\r\n\t\t\tvar bindings = this._bindings,\r\n\t\t\t\tpropBinding = binding.binding,\r\n\t\t\t\trootUuid = propBinding.rootNode.uuid,\r\n\t\t\t\ttrackName = propBinding.path,\r\n\t\t\t\tbindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\r\n\r\n\t\t\t\tlastInactiveBinding = bindings[ bindings.length - 1 ],\r\n\t\t\t\tcacheIndex = binding._cacheIndex;\r\n\r\n\t\t\tlastInactiveBinding._cacheIndex = cacheIndex;\r\n\t\t\tbindings[ cacheIndex ] = lastInactiveBinding;\r\n\t\t\tbindings.pop();\r\n\r\n\t\t\tdelete bindingByName[ trackName ];\r\n\r\n\t\t\tif ( Object.keys( bindingByName ).length === 0 ) {\r\n\r\n\t\t\t\tdelete bindingsByRoot[ rootUuid ];\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t_lendBinding: function ( binding ) {\r\n\r\n\t\t\tvar bindings = this._bindings,\r\n\t\t\t\tprevIndex = binding._cacheIndex,\r\n\r\n\t\t\t\tlastActiveIndex = this._nActiveBindings ++,\r\n\r\n\t\t\t\tfirstInactiveBinding = bindings[ lastActiveIndex ];\r\n\r\n\t\t\tbinding._cacheIndex = lastActiveIndex;\r\n\t\t\tbindings[ lastActiveIndex ] = binding;\r\n\r\n\t\t\tfirstInactiveBinding._cacheIndex = prevIndex;\r\n\t\t\tbindings[ prevIndex ] = firstInactiveBinding;\r\n\r\n\t\t},\r\n\r\n\t\t_takeBackBinding: function ( binding ) {\r\n\r\n\t\t\tvar bindings = this._bindings,\r\n\t\t\t\tprevIndex = binding._cacheIndex,\r\n\r\n\t\t\t\tfirstInactiveIndex = -- this._nActiveBindings,\r\n\r\n\t\t\t\tlastActiveBinding = bindings[ firstInactiveIndex ];\r\n\r\n\t\t\tbinding._cacheIndex = firstInactiveIndex;\r\n\t\t\tbindings[ firstInactiveIndex ] = binding;\r\n\r\n\t\t\tlastActiveBinding._cacheIndex = prevIndex;\r\n\t\t\tbindings[ prevIndex ] = lastActiveBinding;\r\n\r\n\t\t},\r\n\r\n\r\n\t\t// Memory management of Interpolants for weight and time scale\r\n\r\n\t\t_lendControlInterpolant: function () {\r\n\r\n\t\t\tvar interpolants = this._controlInterpolants,\r\n\t\t\t\tlastActiveIndex = this._nActiveControlInterpolants ++,\r\n\t\t\t\tinterpolant = interpolants[ lastActiveIndex ];\r\n\r\n\t\t\tif ( interpolant === undefined ) {\r\n\r\n\t\t\t\tinterpolant = new LinearInterpolant(\r\n\t\t\t\t\tnew Float32Array( 2 ), new Float32Array( 2 ),\r\n\t\t\t\t\t1, this._controlInterpolantsResultBuffer );\r\n\r\n\t\t\t\tinterpolant.__cacheIndex = lastActiveIndex;\r\n\t\t\t\tinterpolants[ lastActiveIndex ] = interpolant;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn interpolant;\r\n\r\n\t\t},\r\n\r\n\t\t_takeBackControlInterpolant: function ( interpolant ) {\r\n\r\n\t\t\tvar interpolants = this._controlInterpolants,\r\n\t\t\t\tprevIndex = interpolant.__cacheIndex,\r\n\r\n\t\t\t\tfirstInactiveIndex = -- this._nActiveControlInterpolants,\r\n\r\n\t\t\t\tlastActiveInterpolant = interpolants[ firstInactiveIndex ];\r\n\r\n\t\t\tinterpolant.__cacheIndex = firstInactiveIndex;\r\n\t\t\tinterpolants[ firstInactiveIndex ] = interpolant;\r\n\r\n\t\t\tlastActiveInterpolant.__cacheIndex = prevIndex;\r\n\t\t\tinterpolants[ prevIndex ] = lastActiveInterpolant;\r\n\r\n\t\t},\r\n\r\n\t\t_controlInterpolantsResultBuffer: new Float32Array( 1 ),\r\n\r\n\t\t// return an action for a clip optionally using a custom root target\r\n\t\t// object (this method allocates a lot of dynamic memory in case a\r\n\t\t// previously unknown clip/root combination is specified)\r\n\t\tclipAction: function ( clip, optionalRoot ) {\r\n\r\n\t\t\tvar root = optionalRoot || this._root,\r\n\t\t\t\trootUuid = root.uuid,\r\n\r\n\t\t\t\tclipObject = typeof clip === 'string' ?\r\n\t\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\r\n\r\n\t\t\t\tclipUuid = clipObject !== null ? clipObject.uuid : clip,\r\n\r\n\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ],\r\n\t\t\t\tprototypeAction = null;\r\n\r\n\t\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\t\tvar existingAction =\r\n\t\t\t\t\t\tactionsForClip.actionByRoot[ rootUuid ];\r\n\r\n\t\t\t\tif ( existingAction !== undefined ) {\r\n\r\n\t\t\t\t\treturn existingAction;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// we know the clip, so we don't have to parse all\r\n\t\t\t\t// the bindings again but can just copy\r\n\t\t\t\tprototypeAction = actionsForClip.knownActions[ 0 ];\r\n\r\n\t\t\t\t// also, take the clip from the prototype action\r\n\t\t\t\tif ( clipObject === null )\r\n\t\t\t\t\t{ clipObject = prototypeAction._clip; }\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// clip must be known when specified via string\r\n\t\t\tif ( clipObject === null ) { return null; }\r\n\r\n\t\t\t// allocate all resources required to run it\r\n\t\t\tvar newAction = new AnimationAction( this, clipObject, optionalRoot );\r\n\r\n\t\t\tthis._bindAction( newAction, prototypeAction );\r\n\r\n\t\t\t// and make the action known to the memory manager\r\n\t\t\tthis._addInactiveAction( newAction, clipUuid, rootUuid );\r\n\r\n\t\t\treturn newAction;\r\n\r\n\t\t},\r\n\r\n\t\t// get an existing action\r\n\t\texistingAction: function ( clip, optionalRoot ) {\r\n\r\n\t\t\tvar root = optionalRoot || this._root,\r\n\t\t\t\trootUuid = root.uuid,\r\n\r\n\t\t\t\tclipObject = typeof clip === 'string' ?\r\n\t\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\r\n\r\n\t\t\t\tclipUuid = clipObject ? clipObject.uuid : clip,\r\n\r\n\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\r\n\r\n\t\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\t\treturn actionsForClip.actionByRoot[ rootUuid ] || null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\r\n\t\t},\r\n\r\n\t\t// deactivates all previously scheduled actions\r\n\t\tstopAllAction: function () {\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tnActions = this._nActiveActions,\r\n\t\t\t\tbindings = this._bindings,\r\n\t\t\t\tnBindings = this._nActiveBindings;\r\n\r\n\t\t\tthis._nActiveActions = 0;\r\n\t\t\tthis._nActiveBindings = 0;\r\n\r\n\t\t\tfor ( var i = 0; i !== nActions; ++ i ) {\r\n\r\n\t\t\t\tactions[ i ].reset();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].useCount = 0;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// advance the time and update apply the animation\r\n\t\tupdate: function ( deltaTime ) {\r\n\r\n\t\t\tdeltaTime *= this.timeScale;\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tnActions = this._nActiveActions,\r\n\r\n\t\t\t\ttime = this.time += deltaTime,\r\n\t\t\t\ttimeDirection = Math.sign( deltaTime ),\r\n\r\n\t\t\t\taccuIndex = this._accuIndex ^= 1;\r\n\r\n\t\t\t// run active actions\r\n\r\n\t\t\tfor ( var i = 0; i !== nActions; ++ i ) {\r\n\r\n\t\t\t\tvar action = actions[ i ];\r\n\r\n\t\t\t\taction._update( time, deltaTime, timeDirection, accuIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// update scene graph\r\n\r\n\t\t\tvar bindings = this._bindings,\r\n\t\t\t\tnBindings = this._nActiveBindings;\r\n\r\n\t\t\tfor ( var i = 0; i !== nBindings; ++ i ) {\r\n\r\n\t\t\t\tbindings[ i ].apply( accuIndex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// Allows you to seek to a specific time in an animation.\r\n\t\tsetTime: function ( timeInSeconds ) {\r\n\r\n\t\t\tthis.time = 0; // Zero out time attribute for AnimationMixer object;\r\n\t\t\tfor ( var i = 0; i < this._actions.length; i ++ ) {\r\n\r\n\t\t\t\tthis._actions[ i ].time = 0; // Zero out time attribute for all associated AnimationAction objects.\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.update( timeInSeconds ); // Update used to set exact time. Returns \"this\" AnimationMixer object.\r\n\r\n\t\t},\r\n\r\n\t\t// return this mixer's root target object\r\n\t\tgetRoot: function () {\r\n\r\n\t\t\treturn this._root;\r\n\r\n\t\t},\r\n\r\n\t\t// free all resources specific to a particular clip\r\n\t\tuncacheClip: function ( clip ) {\r\n\r\n\t\t\tvar actions = this._actions,\r\n\t\t\t\tclipUuid = clip.uuid,\r\n\t\t\t\tactionsByClip = this._actionsByClip,\r\n\t\t\t\tactionsForClip = actionsByClip[ clipUuid ];\r\n\r\n\t\t\tif ( actionsForClip !== undefined ) {\r\n\r\n\t\t\t\t// note: just calling _removeInactiveAction would mess up the\r\n\t\t\t\t// iteration state and also require updating the state we can\r\n\t\t\t\t// just throw away\r\n\r\n\t\t\t\tvar actionsToRemove = actionsForClip.knownActions;\r\n\r\n\t\t\t\tfor ( var i = 0, n = actionsToRemove.length; i !== n; ++ i ) {\r\n\r\n\t\t\t\t\tvar action = actionsToRemove[ i ];\r\n\r\n\t\t\t\t\tthis._deactivateAction( action );\r\n\r\n\t\t\t\t\tvar cacheIndex = action._cacheIndex,\r\n\t\t\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ];\r\n\r\n\t\t\t\t\taction._cacheIndex = null;\r\n\t\t\t\t\taction._byClipCacheIndex = null;\r\n\r\n\t\t\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\r\n\t\t\t\t\tactions[ cacheIndex ] = lastInactiveAction;\r\n\t\t\t\t\tactions.pop();\r\n\r\n\t\t\t\t\tthis._removeInactiveBindingsForAction( action );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdelete actionsByClip[ clipUuid ];\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// free all resources specific to a particular root target object\r\n\t\tuncacheRoot: function ( root ) {\r\n\r\n\t\t\tvar rootUuid = root.uuid,\r\n\t\t\t\tactionsByClip = this._actionsByClip;\r\n\r\n\t\t\tfor ( var clipUuid in actionsByClip ) {\r\n\r\n\t\t\t\tvar actionByRoot = actionsByClip[ clipUuid ].actionByRoot,\r\n\t\t\t\t\taction = actionByRoot[ rootUuid ];\r\n\r\n\t\t\t\tif ( action !== undefined ) {\r\n\r\n\t\t\t\t\tthis._deactivateAction( action );\r\n\t\t\t\t\tthis._removeInactiveAction( action );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar bindingsByRoot = this._bindingsByRootAndName,\r\n\t\t\t\tbindingByName = bindingsByRoot[ rootUuid ];\r\n\r\n\t\t\tif ( bindingByName !== undefined ) {\r\n\r\n\t\t\t\tfor ( var trackName in bindingByName ) {\r\n\r\n\t\t\t\t\tvar binding = bindingByName[ trackName ];\r\n\t\t\t\t\tbinding.restoreOriginalState();\r\n\t\t\t\t\tthis._removeInactiveBinding( binding );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t// remove a targeted clip from the cache\r\n\t\tuncacheAction: function ( clip, optionalRoot ) {\r\n\r\n\t\t\tvar action = this.existingAction( clip, optionalRoot );\r\n\r\n\t\t\tif ( action !== null ) {\r\n\r\n\t\t\t\tthis._deactivateAction( action );\r\n\t\t\t\tthis._removeInactiveAction( action );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Uniform( value ) {\r\n\r\n\t\tif ( typeof value === 'string' ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Uniform: Type parameter is no longer needed.' );\r\n\t\t\tvalue = arguments[ 1 ];\r\n\r\n\t\t}\r\n\r\n\t\tthis.value = value;\r\n\r\n\t}\r\n\r\n\tUniform.prototype.clone = function () {\r\n\r\n\t\treturn new Uniform( this.value.clone === undefined ? this.value : this.value.clone() );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author benaadams / https://twitter.com/ben_a_adams\r\n\t */\r\n\r\n\tfunction InstancedInterleavedBuffer( array, stride, meshPerAttribute ) {\r\n\r\n\t\tInterleavedBuffer.call( this, array, stride );\r\n\r\n\t\tthis.meshPerAttribute = meshPerAttribute || 1;\r\n\r\n\t}\r\n\r\n\tInstancedInterleavedBuffer.prototype = Object.assign( Object.create( InterleavedBuffer.prototype ), {\r\n\r\n\t\tconstructor: InstancedInterleavedBuffer,\r\n\r\n\t\tisInstancedInterleavedBuffer: true,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tInterleavedBuffer.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.meshPerAttribute = source.meshPerAttribute;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author bhouston / http://clara.io/\r\n\t * @author stephomi / http://stephaneginier.com/\r\n\t */\r\n\r\n\tfunction Raycaster( origin, direction, near, far ) {\r\n\r\n\t\tthis.ray = new Ray( origin, direction );\r\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\tthis.near = near || 0;\r\n\t\tthis.far = far || Infinity;\r\n\t\tthis.camera = null;\r\n\t\tthis.layers = new Layers();\r\n\r\n\t\tthis.params = {\r\n\t\t\tMesh: {},\r\n\t\t\tLine: { threshold: 1 },\r\n\t\t\tLOD: {},\r\n\t\t\tPoints: { threshold: 1 },\r\n\t\t\tSprite: {}\r\n\t\t};\r\n\r\n\t\tObject.defineProperties( this.params, {\r\n\t\t\tPointCloud: {\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.Raycaster: params.PointCloud has been renamed to params.Points.' );\r\n\t\t\t\t\treturn this.Points;\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\tfunction ascSort( a, b ) {\r\n\r\n\t\treturn a.distance - b.distance;\r\n\r\n\t}\r\n\r\n\tfunction intersectObject( object, raycaster, intersects, recursive ) {\r\n\r\n\t\tif ( object.layers.test( raycaster.layers ) ) {\r\n\r\n\t\t\tobject.raycast( raycaster, intersects );\r\n\r\n\t\t}\r\n\r\n\t\tif ( recursive === true ) {\r\n\r\n\t\t\tvar children = object.children;\r\n\r\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tObject.assign( Raycaster.prototype, {\r\n\r\n\t\tset: function ( origin, direction ) {\r\n\r\n\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\r\n\r\n\t\t\tthis.ray.set( origin, direction );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCamera: function ( coords, camera ) {\r\n\r\n\t\t\tif ( ( camera && camera.isPerspectiveCamera ) ) {\r\n\r\n\t\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\r\n\t\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\r\n\t\t\t\tthis.camera = camera;\r\n\r\n\t\t\t} else if ( ( camera && camera.isOrthographicCamera ) ) {\r\n\r\n\t\t\t\tthis.ray.origin.set( coords.x, coords.y, ( camera.near + camera.far ) / ( camera.near - camera.far ) ).unproject( camera ); // set origin in plane of camera\r\n\t\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\r\n\t\t\t\tthis.camera = camera;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tintersectObject: function ( object, recursive, optionalTarget ) {\r\n\r\n\t\t\tvar intersects = optionalTarget || [];\r\n\r\n\t\t\tintersectObject( object, this, intersects, recursive );\r\n\r\n\t\t\tintersects.sort( ascSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t},\r\n\r\n\t\tintersectObjects: function ( objects, recursive, optionalTarget ) {\r\n\r\n\t\t\tvar intersects = optionalTarget || [];\r\n\r\n\t\t\tif ( Array.isArray( objects ) === false ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Raycaster.intersectObjects: objects is not an Array.' );\r\n\t\t\t\treturn intersects;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tintersects.sort( ascSort );\r\n\r\n\t\t\treturn intersects;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t *\r\n\t * Ref: https://en.wikipedia.org/wiki/Spherical_coordinate_system\r\n\t *\r\n\t * The polar angle (phi) is measured from the positive y-axis. The positive y-axis is up.\r\n\t * The azimuthal angle (theta) is measured from the positive z-axis.\r\n\t */\r\n\r\n\tfunction Spherical( radius, phi, theta ) {\r\n\r\n\t\tthis.radius = ( radius !== undefined ) ? radius : 1.0;\r\n\t\tthis.phi = ( phi !== undefined ) ? phi : 0; // polar angle\r\n\t\tthis.theta = ( theta !== undefined ) ? theta : 0; // azimuthal angle\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tObject.assign( Spherical.prototype, {\r\n\r\n\t\tset: function ( radius, phi, theta ) {\r\n\r\n\t\t\tthis.radius = radius;\r\n\t\t\tthis.phi = phi;\r\n\t\t\tthis.theta = theta;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( other ) {\r\n\r\n\t\t\tthis.radius = other.radius;\r\n\t\t\tthis.phi = other.phi;\r\n\t\t\tthis.theta = other.theta;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\t// restrict phi to be betwee EPS and PI-EPS\r\n\t\tmakeSafe: function () {\r\n\r\n\t\t\tvar EPS = 0.000001;\r\n\t\t\tthis.phi = Math.max( EPS, Math.min( Math.PI - EPS, this.phi ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromVector3: function ( v ) {\r\n\r\n\t\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCartesianCoords: function ( x, y, z ) {\r\n\r\n\t\t\tthis.radius = Math.sqrt( x * x + y * y + z * z );\r\n\r\n\t\t\tif ( this.radius === 0 ) {\r\n\r\n\t\t\t\tthis.theta = 0;\r\n\t\t\t\tthis.phi = 0;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.theta = Math.atan2( x, z );\r\n\t\t\t\tthis.phi = Math.acos( MathUtils.clamp( y / this.radius, - 1, 1 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t * Ref: https://en.wikipedia.org/wiki/Cylindrical_coordinate_system\r\n\t *\r\n\t */\r\n\r\n\tfunction Cylindrical( radius, theta, y ) {\r\n\r\n\t\tthis.radius = ( radius !== undefined ) ? radius : 1.0; // distance from the origin to a point in the x-z plane\r\n\t\tthis.theta = ( theta !== undefined ) ? theta : 0; // counterclockwise angle in the x-z plane measured in radians from the positive z-axis\r\n\t\tthis.y = ( y !== undefined ) ? y : 0; // height above the x-z plane\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tObject.assign( Cylindrical.prototype, {\r\n\r\n\t\tset: function ( radius, theta, y ) {\r\n\r\n\t\t\tthis.radius = radius;\r\n\t\t\tthis.theta = theta;\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( other ) {\r\n\r\n\t\t\tthis.radius = other.radius;\r\n\t\t\tthis.theta = other.theta;\r\n\t\t\tthis.y = other.y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromVector3: function ( v ) {\r\n\r\n\t\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCartesianCoords: function ( x, y, z ) {\r\n\r\n\t\t\tthis.radius = Math.sqrt( x * x + z * z );\r\n\t\t\tthis.theta = Math.atan2( x, z );\r\n\t\t\tthis.y = y;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tvar _vector$7 = new Vector2();\r\n\r\n\tfunction Box2( min, max ) {\r\n\r\n\t\tthis.min = ( min !== undefined ) ? min : new Vector2( + Infinity, + Infinity );\r\n\t\tthis.max = ( max !== undefined ) ? max : new Vector2( - Infinity, - Infinity );\r\n\r\n\t}\r\n\r\n\tObject.assign( Box2.prototype, {\r\n\r\n\t\tset: function ( min, max ) {\r\n\r\n\t\t\tthis.min.copy( min );\r\n\t\t\tthis.max.copy( max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromPoints: function ( points ) {\r\n\r\n\t\t\tthis.makeEmpty();\r\n\r\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\r\n\r\n\t\t\t\tthis.expandByPoint( points[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetFromCenterAndSize: function ( center, size ) {\r\n\r\n\t\t\tvar halfSize = _vector$7.copy( size ).multiplyScalar( 0.5 );\r\n\t\t\tthis.min.copy( center ).sub( halfSize );\r\n\t\t\tthis.max.copy( center ).add( halfSize );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( box ) {\r\n\r\n\t\t\tthis.min.copy( box.min );\r\n\t\t\tthis.max.copy( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeEmpty: function () {\r\n\r\n\t\t\tthis.min.x = this.min.y = + Infinity;\r\n\t\t\tthis.max.x = this.max.y = - Infinity;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tisEmpty: function () {\r\n\r\n\t\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\r\n\r\n\t\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\r\n\r\n\t\t},\r\n\r\n\t\tgetCenter: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box2: .getCenter() target is now required' );\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\r\n\r\n\t\t},\r\n\r\n\t\tgetSize: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box2: .getSize() target is now required' );\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.subVectors( this.max, this.min );\r\n\r\n\t\t},\r\n\r\n\t\texpandByPoint: function ( point ) {\r\n\r\n\t\t\tthis.min.min( point );\r\n\t\t\tthis.max.max( point );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByVector: function ( vector ) {\r\n\r\n\t\t\tthis.min.sub( vector );\r\n\t\t\tthis.max.add( vector );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\texpandByScalar: function ( scalar ) {\r\n\r\n\t\t\tthis.min.addScalar( - scalar );\r\n\t\t\tthis.max.addScalar( scalar );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcontainsPoint: function ( point ) {\r\n\r\n\t\t\treturn point.x < this.min.x || point.x > this.max.x ||\r\n\t\t\t\tpoint.y < this.min.y || point.y > this.max.y ? false : true;\r\n\r\n\t\t},\r\n\r\n\t\tcontainsBox: function ( box ) {\r\n\r\n\t\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\r\n\t\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y;\r\n\r\n\t\t},\r\n\r\n\t\tgetParameter: function ( point, target ) {\r\n\r\n\t\t\t// This can potentially have a divide by zero if the box\r\n\t\t\t// has a size dimension of 0.\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box2: .getParameter() target is now required' );\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.set(\r\n\t\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\r\n\t\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\r\n\t\t\t);\r\n\r\n\t\t},\r\n\r\n\t\tintersectsBox: function ( box ) {\r\n\r\n\t\t\t// using 4 splitting planes to rule out intersections\r\n\r\n\t\t\treturn box.max.x < this.min.x || box.min.x > this.max.x ||\r\n\t\t\t\tbox.max.y < this.min.y || box.min.y > this.max.y ? false : true;\r\n\r\n\t\t},\r\n\r\n\t\tclampPoint: function ( point, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Box2: .clampPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector2();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.copy( point ).clamp( this.min, this.max );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceToPoint: function ( point ) {\r\n\r\n\t\t\tvar clampedPoint = _vector$7.copy( point ).clamp( this.min, this.max );\r\n\t\t\treturn clampedPoint.sub( point ).length();\r\n\r\n\t\t},\r\n\r\n\t\tintersect: function ( box ) {\r\n\r\n\t\t\tthis.min.max( box.min );\r\n\t\t\tthis.max.min( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tunion: function ( box ) {\r\n\r\n\t\t\tthis.min.min( box.min );\r\n\t\t\tthis.max.max( box.max );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttranslate: function ( offset ) {\r\n\r\n\t\t\tthis.min.add( offset );\r\n\t\t\tthis.max.add( offset );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( box ) {\r\n\r\n\t\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author bhouston / http://clara.io\r\n\t */\r\n\r\n\tvar _startP = new Vector3();\r\n\tvar _startEnd = new Vector3();\r\n\r\n\tfunction Line3( start, end ) {\r\n\r\n\t\tthis.start = ( start !== undefined ) ? start : new Vector3();\r\n\t\tthis.end = ( end !== undefined ) ? end : new Vector3();\r\n\r\n\t}\r\n\r\n\tObject.assign( Line3.prototype, {\r\n\r\n\t\tset: function ( start, end ) {\r\n\r\n\t\t\tthis.start.copy( start );\r\n\t\t\tthis.end.copy( end );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( line ) {\r\n\r\n\t\t\tthis.start.copy( line.start );\r\n\t\t\tthis.end.copy( line.end );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetCenter: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Line3: .getCenter() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\r\n\r\n\t\t},\r\n\r\n\t\tdelta: function ( target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Line3: .delta() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn target.subVectors( this.end, this.start );\r\n\r\n\t\t},\r\n\r\n\t\tdistanceSq: function () {\r\n\r\n\t\t\treturn this.start.distanceToSquared( this.end );\r\n\r\n\t\t},\r\n\r\n\t\tdistance: function () {\r\n\r\n\t\t\treturn this.start.distanceTo( this.end );\r\n\r\n\t\t},\r\n\r\n\t\tat: function ( t, target ) {\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Line3: .at() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\r\n\r\n\t\t},\r\n\r\n\t\tclosestPointToPointParameter: function ( point, clampToLine ) {\r\n\r\n\t\t\t_startP.subVectors( point, this.start );\r\n\t\t\t_startEnd.subVectors( this.end, this.start );\r\n\r\n\t\t\tvar startEnd2 = _startEnd.dot( _startEnd );\r\n\t\t\tvar startEnd_startP = _startEnd.dot( _startP );\r\n\r\n\t\t\tvar t = startEnd_startP / startEnd2;\r\n\r\n\t\t\tif ( clampToLine ) {\r\n\r\n\t\t\t\tt = MathUtils.clamp( t, 0, 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn t;\r\n\r\n\t\t},\r\n\r\n\t\tclosestPointToPoint: function ( point, clampToLine, target ) {\r\n\r\n\t\t\tvar t = this.closestPointToPointParameter( point, clampToLine );\r\n\r\n\t\t\tif ( target === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Line3: .closestPointToPoint() target is now required' );\r\n\t\t\t\ttarget = new Vector3();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\r\n\r\n\t\t},\r\n\r\n\t\tapplyMatrix4: function ( matrix ) {\r\n\r\n\t\t\tthis.start.applyMatrix4( matrix );\r\n\t\t\tthis.end.applyMatrix4( matrix );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( line ) {\r\n\r\n\t\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t */\r\n\r\n\tfunction ImmediateRenderObject( material ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.material = material;\r\n\t\tthis.render = function ( /* renderCallback */ ) {};\r\n\r\n\t}\r\n\r\n\tImmediateRenderObject.prototype = Object.create( Object3D.prototype );\r\n\tImmediateRenderObject.prototype.constructor = ImmediateRenderObject;\r\n\r\n\tImmediateRenderObject.prototype.isImmediateRenderObject = true;\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tvar _vector$8 = new Vector3();\r\n\r\n\tfunction SpotLightHelper( light, color ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tvar positions = [\r\n\t\t\t0, 0, 0, \t0, 0, 1,\r\n\t\t\t0, 0, 0, \t1, 0, 1,\r\n\t\t\t0, 0, 0,\t- 1, 0, 1,\r\n\t\t\t0, 0, 0, \t0, 1, 1,\r\n\t\t\t0, 0, 0, \t0, - 1, 1\r\n\t\t];\r\n\r\n\t\tfor ( var i = 0, j = 1, l = 32; i < l; i ++, j ++ ) {\r\n\r\n\t\t\tvar p1 = ( i / l ) * Math.PI * 2;\r\n\t\t\tvar p2 = ( j / l ) * Math.PI * 2;\r\n\r\n\t\t\tpositions.push(\r\n\t\t\t\tMath.cos( p1 ), Math.sin( p1 ), 1,\r\n\t\t\t\tMath.cos( p2 ), Math.sin( p2 ), 1\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { fog: false, toneMapped: false } );\r\n\r\n\t\tthis.cone = new LineSegments( geometry, material );\r\n\t\tthis.add( this.cone );\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tSpotLightHelper.prototype = Object.create( Object3D.prototype );\r\n\tSpotLightHelper.prototype.constructor = SpotLightHelper;\r\n\r\n\tSpotLightHelper.prototype.dispose = function () {\r\n\r\n\t\tthis.cone.geometry.dispose();\r\n\t\tthis.cone.material.dispose();\r\n\r\n\t};\r\n\r\n\tSpotLightHelper.prototype.update = function () {\r\n\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tvar coneLength = this.light.distance ? this.light.distance : 1000;\r\n\t\tvar coneWidth = coneLength * Math.tan( this.light.angle );\r\n\r\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\r\n\r\n\t\t_vector$8.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\r\n\t\tthis.cone.lookAt( _vector$8 );\r\n\r\n\t\tif ( this.color !== undefined ) {\r\n\r\n\t\t\tthis.cone.material.color.set( this.color );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.cone.material.color.copy( this.light.color );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author Sean Griffin / http://twitter.com/sgrif\r\n\t * @author Michael Guerrero / http://realitymeltdown.com\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author ikerr / http://verold.com\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tvar _vector$9 = new Vector3();\r\n\tvar _boneMatrix = new Matrix4();\r\n\tvar _matrixWorldInv = new Matrix4();\r\n\r\n\tfunction getBoneList( object ) {\r\n\r\n\t\tvar boneList = [];\r\n\r\n\t\tif ( object && object.isBone ) {\r\n\r\n\t\t\tboneList.push( object );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < object.children.length; i ++ ) {\r\n\r\n\t\t\tboneList.push.apply( boneList, getBoneList( object.children[ i ] ) );\r\n\r\n\t\t}\r\n\r\n\t\treturn boneList;\r\n\r\n\t}\r\n\r\n\tfunction SkeletonHelper( object ) {\r\n\r\n\t\tvar bones = getBoneList( object );\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tvar vertices = [];\r\n\t\tvar colors = [];\r\n\r\n\t\tvar color1 = new Color( 0, 0, 1 );\r\n\t\tvar color2 = new Color( 0, 1, 0 );\r\n\r\n\t\tfor ( var i = 0; i < bones.length; i ++ ) {\r\n\r\n\t\t\tvar bone = bones[ i ];\r\n\r\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\r\n\r\n\t\t\t\tvertices.push( 0, 0, 0 );\r\n\t\t\t\tvertices.push( 0, 0, 0 );\r\n\t\t\t\tcolors.push( color1.r, color1.g, color1.b );\r\n\t\t\t\tcolors.push( color2.r, color2.g, color2.b );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { vertexColors: true, depthTest: false, depthWrite: false, toneMapped: false, transparent: true } );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t\tthis.root = object;\r\n\t\tthis.bones = bones;\r\n\r\n\t\tthis.matrix = object.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t}\r\n\r\n\tSkeletonHelper.prototype = Object.create( LineSegments.prototype );\r\n\tSkeletonHelper.prototype.constructor = SkeletonHelper;\r\n\r\n\tSkeletonHelper.prototype.isSkeletonHelper = true;\r\n\r\n\tSkeletonHelper.prototype.updateMatrixWorld = function ( force ) {\r\n\r\n\t\tvar bones = this.bones;\r\n\r\n\t\tvar geometry = this.geometry;\r\n\t\tvar position = geometry.getAttribute( 'position' );\r\n\r\n\t\t_matrixWorldInv.getInverse( this.root.matrixWorld );\r\n\r\n\t\tfor ( var i = 0, j = 0; i < bones.length; i ++ ) {\r\n\r\n\t\t\tvar bone = bones[ i ];\r\n\r\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\r\n\r\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.matrixWorld );\r\n\t\t\t\t_vector$9.setFromMatrixPosition( _boneMatrix );\r\n\t\t\t\tposition.setXYZ( j, _vector$9.x, _vector$9.y, _vector$9.z );\r\n\r\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.parent.matrixWorld );\r\n\t\t\t\t_vector$9.setFromMatrixPosition( _boneMatrix );\r\n\t\t\t\tposition.setXYZ( j + 1, _vector$9.x, _vector$9.y, _vector$9.z );\r\n\r\n\t\t\t\tj += 2;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\r\n\r\n\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction PointLightHelper( light, sphereSize, color ) {\r\n\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\tvar geometry = new SphereBufferGeometry( sphereSize, 4, 2 );\r\n\t\tvar material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\r\n\r\n\t\tMesh.call( this, geometry, material );\r\n\r\n\t\tthis.matrix = this.light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.update();\r\n\r\n\r\n\t\t/*\r\n\t\tvar distanceGeometry = new THREE.IcosahedronBufferGeometry( 1, 2 );\r\n\t\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\r\n\r\n\t\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\r\n\t\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\r\n\r\n\t\tvar d = light.distance;\r\n\r\n\t\tif ( d === 0.0 ) {\r\n\r\n\t\t\tthis.lightDistance.visible = false;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t\t}\r\n\r\n\t\tthis.add( this.lightDistance );\r\n\t\t*/\r\n\r\n\t}\r\n\r\n\tPointLightHelper.prototype = Object.create( Mesh.prototype );\r\n\tPointLightHelper.prototype.constructor = PointLightHelper;\r\n\r\n\tPointLightHelper.prototype.dispose = function () {\r\n\r\n\t\tthis.geometry.dispose();\r\n\t\tthis.material.dispose();\r\n\r\n\t};\r\n\r\n\tPointLightHelper.prototype.update = function () {\r\n\r\n\t\tif ( this.color !== undefined ) {\r\n\r\n\t\t\tthis.material.color.set( this.color );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.material.color.copy( this.light.color );\r\n\r\n\t\t}\r\n\r\n\t\t/*\r\n\t\tvar d = this.light.distance;\r\n\r\n\t\tif ( d === 0.0 ) {\r\n\r\n\t\t\tthis.lightDistance.visible = false;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.lightDistance.visible = true;\r\n\t\t\tthis.lightDistance.scale.set( d, d, d );\r\n\r\n\t\t}\r\n\t\t*/\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t */\r\n\r\n\tvar _vector$a = new Vector3();\r\n\tvar _color1 = new Color();\r\n\tvar _color2 = new Color();\r\n\r\n\tfunction HemisphereLightHelper( light, size, color ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\tvar geometry = new OctahedronBufferGeometry( size );\r\n\t\tgeometry.rotateY( Math.PI * 0.5 );\r\n\r\n\t\tthis.material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\r\n\t\tif ( this.color === undefined ) { this.material.vertexColors = true; }\r\n\r\n\t\tvar position = geometry.getAttribute( 'position' );\r\n\t\tvar colors = new Float32Array( position.count * 3 );\r\n\r\n\t\tgeometry.setAttribute( 'color', new BufferAttribute( colors, 3 ) );\r\n\r\n\t\tthis.add( new Mesh( geometry, this.material ) );\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tHemisphereLightHelper.prototype = Object.create( Object3D.prototype );\r\n\tHemisphereLightHelper.prototype.constructor = HemisphereLightHelper;\r\n\r\n\tHemisphereLightHelper.prototype.dispose = function () {\r\n\r\n\t\tthis.children[ 0 ].geometry.dispose();\r\n\t\tthis.children[ 0 ].material.dispose();\r\n\r\n\t};\r\n\r\n\tHemisphereLightHelper.prototype.update = function () {\r\n\r\n\t\tvar mesh = this.children[ 0 ];\r\n\r\n\t\tif ( this.color !== undefined ) {\r\n\r\n\t\t\tthis.material.color.set( this.color );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tvar colors = mesh.geometry.getAttribute( 'color' );\r\n\r\n\t\t\t_color1.copy( this.light.color );\r\n\t\t\t_color2.copy( this.light.groundColor );\r\n\r\n\t\t\tfor ( var i = 0, l = colors.count; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar color = ( i < ( l / 2 ) ) ? _color1 : _color2;\r\n\r\n\t\t\t\tcolors.setXYZ( i, color.r, color.g, color.b );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcolors.needsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tmesh.lookAt( _vector$a.setFromMatrixPosition( this.light.matrixWorld ).negate() );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction GridHelper( size, divisions, color1, color2 ) {\r\n\r\n\t\tsize = size || 10;\r\n\t\tdivisions = divisions || 10;\r\n\t\tcolor1 = new Color( color1 !== undefined ? color1 : 0x444444 );\r\n\t\tcolor2 = new Color( color2 !== undefined ? color2 : 0x888888 );\r\n\r\n\t\tvar center = divisions / 2;\r\n\t\tvar step = size / divisions;\r\n\t\tvar halfSize = size / 2;\r\n\r\n\t\tvar vertices = [], colors = [];\r\n\r\n\t\tfor ( var i = 0, j = 0, k = - halfSize; i <= divisions; i ++, k += step ) {\r\n\r\n\t\t\tvertices.push( - halfSize, 0, k, halfSize, 0, k );\r\n\t\t\tvertices.push( k, 0, - halfSize, k, 0, halfSize );\r\n\r\n\t\t\tvar color = i === center ? color1 : color2;\r\n\r\n\t\t\tcolor.toArray( colors, j ); j += 3;\r\n\t\t\tcolor.toArray( colors, j ); j += 3;\r\n\t\t\tcolor.toArray( colors, j ); j += 3;\r\n\t\t\tcolor.toArray( colors, j ); j += 3;\r\n\r\n\t\t}\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t}\r\n\r\n\tGridHelper.prototype = Object.assign( Object.create( LineSegments.prototype ), {\r\n\r\n\t\tconstructor: GridHelper,\r\n\r\n\t\tcopy: function ( source ) {\r\n\r\n\t\t\tLineSegments.prototype.copy.call( this, source );\r\n\r\n\t\t\tthis.geometry.copy( source.geometry );\r\n\t\t\tthis.material.copy( source.material );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / http://github.com/Mugen87\r\n\t * @author Hectate / http://www.github.com/Hectate\r\n\t */\r\n\r\n\tfunction PolarGridHelper( radius, radials, circles, divisions, color1, color2 ) {\r\n\r\n\t\tradius = radius || 10;\r\n\t\tradials = radials || 16;\r\n\t\tcircles = circles || 8;\r\n\t\tdivisions = divisions || 64;\r\n\t\tcolor1 = new Color( color1 !== undefined ? color1 : 0x444444 );\r\n\t\tcolor2 = new Color( color2 !== undefined ? color2 : 0x888888 );\r\n\r\n\t\tvar vertices = [];\r\n\t\tvar colors = [];\r\n\r\n\t\tvar x, z;\r\n\t\tvar v, i, j, r, color;\r\n\r\n\t\t// create the radials\r\n\r\n\t\tfor ( i = 0; i <= radials; i ++ ) {\r\n\r\n\t\t\tv = ( i / radials ) * ( Math.PI * 2 );\r\n\r\n\t\t\tx = Math.sin( v ) * radius;\r\n\t\t\tz = Math.cos( v ) * radius;\r\n\r\n\t\t\tvertices.push( 0, 0, 0 );\r\n\t\t\tvertices.push( x, 0, z );\r\n\r\n\t\t\tcolor = ( i & 1 ) ? color1 : color2;\r\n\r\n\t\t\tcolors.push( color.r, color.g, color.b );\r\n\t\t\tcolors.push( color.r, color.g, color.b );\r\n\r\n\t\t}\r\n\r\n\t\t// create the circles\r\n\r\n\t\tfor ( i = 0; i <= circles; i ++ ) {\r\n\r\n\t\t\tcolor = ( i & 1 ) ? color1 : color2;\r\n\r\n\t\t\tr = radius - ( radius / circles * i );\r\n\r\n\t\t\tfor ( j = 0; j < divisions; j ++ ) {\r\n\r\n\t\t\t\t// first vertex\r\n\r\n\t\t\t\tv = ( j / divisions ) * ( Math.PI * 2 );\r\n\r\n\t\t\t\tx = Math.sin( v ) * r;\r\n\t\t\t\tz = Math.cos( v ) * r;\r\n\r\n\t\t\t\tvertices.push( x, 0, z );\r\n\t\t\t\tcolors.push( color.r, color.g, color.b );\r\n\r\n\t\t\t\t// second vertex\r\n\r\n\t\t\t\tv = ( ( j + 1 ) / divisions ) * ( Math.PI * 2 );\r\n\r\n\t\t\t\tx = Math.sin( v ) * r;\r\n\t\t\t\tz = Math.cos( v ) * r;\r\n\r\n\t\t\t\tvertices.push( x, 0, z );\r\n\t\t\t\tcolors.push( color.r, color.g, color.b );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t}\r\n\r\n\tPolarGridHelper.prototype = Object.create( LineSegments.prototype );\r\n\tPolarGridHelper.prototype.constructor = PolarGridHelper;\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tvar _v1$5 = new Vector3();\r\n\tvar _v2$3 = new Vector3();\r\n\tvar _v3$1 = new Vector3();\r\n\r\n\tfunction DirectionalLightHelper( light, size, color ) {\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tthis.light = light;\r\n\t\tthis.light.updateMatrixWorld();\r\n\r\n\t\tthis.matrix = light.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.color = color;\r\n\r\n\t\tif ( size === undefined ) { size = 1; }\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [\r\n\t\t\t- size, size, 0,\r\n\t\t\tsize, size, 0,\r\n\t\t\tsize, - size, 0,\r\n\t\t\t- size, - size, 0,\r\n\t\t\t- size, size, 0\r\n\t\t], 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { fog: false, toneMapped: false } );\r\n\r\n\t\tthis.lightPlane = new Line( geometry, material );\r\n\t\tthis.add( this.lightPlane );\r\n\r\n\t\tgeometry = new BufferGeometry();\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 0, 1 ], 3 ) );\r\n\r\n\t\tthis.targetLine = new Line( geometry, material );\r\n\t\tthis.add( this.targetLine );\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tDirectionalLightHelper.prototype = Object.create( Object3D.prototype );\r\n\tDirectionalLightHelper.prototype.constructor = DirectionalLightHelper;\r\n\r\n\tDirectionalLightHelper.prototype.dispose = function () {\r\n\r\n\t\tthis.lightPlane.geometry.dispose();\r\n\t\tthis.lightPlane.material.dispose();\r\n\t\tthis.targetLine.geometry.dispose();\r\n\t\tthis.targetLine.material.dispose();\r\n\r\n\t};\r\n\r\n\tDirectionalLightHelper.prototype.update = function () {\r\n\r\n\t\t_v1$5.setFromMatrixPosition( this.light.matrixWorld );\r\n\t\t_v2$3.setFromMatrixPosition( this.light.target.matrixWorld );\r\n\t\t_v3$1.subVectors( _v2$3, _v1$5 );\r\n\r\n\t\tthis.lightPlane.lookAt( _v2$3 );\r\n\r\n\t\tif ( this.color !== undefined ) {\r\n\r\n\t\t\tthis.lightPlane.material.color.set( this.color );\r\n\t\t\tthis.targetLine.material.color.set( this.color );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.lightPlane.material.color.copy( this.light.color );\r\n\t\t\tthis.targetLine.material.color.copy( this.light.color );\r\n\r\n\t\t}\r\n\r\n\t\tthis.targetLine.lookAt( _v2$3 );\r\n\t\tthis.targetLine.scale.z = _v3$1.length();\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author alteredq / http://alteredqualia.com/\r\n\t * @author Mugen87 / https://github.com/Mugen87\r\n\t *\r\n\t *\t- shows frustum, line of sight and up of the camera\r\n\t *\t- suitable for fast updates\r\n\t * \t- based on frustum visualization in lightgl.js shadowmap example\r\n\t *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\r\n\t */\r\n\r\n\tvar _vector$b = new Vector3();\r\n\tvar _camera = new Camera();\r\n\r\n\tfunction CameraHelper( camera ) {\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tvar material = new LineBasicMaterial( { color: 0xffffff, vertexColors: true, toneMapped: false } );\r\n\r\n\t\tvar vertices = [];\r\n\t\tvar colors = [];\r\n\r\n\t\tvar pointMap = {};\r\n\r\n\t\t// colors\r\n\r\n\t\tvar colorFrustum = new Color( 0xffaa00 );\r\n\t\tvar colorCone = new Color( 0xff0000 );\r\n\t\tvar colorUp = new Color( 0x00aaff );\r\n\t\tvar colorTarget = new Color( 0xffffff );\r\n\t\tvar colorCross = new Color( 0x333333 );\r\n\r\n\t\t// near\r\n\r\n\t\taddLine( 'n1', 'n2', colorFrustum );\r\n\t\taddLine( 'n2', 'n4', colorFrustum );\r\n\t\taddLine( 'n4', 'n3', colorFrustum );\r\n\t\taddLine( 'n3', 'n1', colorFrustum );\r\n\r\n\t\t// far\r\n\r\n\t\taddLine( 'f1', 'f2', colorFrustum );\r\n\t\taddLine( 'f2', 'f4', colorFrustum );\r\n\t\taddLine( 'f4', 'f3', colorFrustum );\r\n\t\taddLine( 'f3', 'f1', colorFrustum );\r\n\r\n\t\t// sides\r\n\r\n\t\taddLine( 'n1', 'f1', colorFrustum );\r\n\t\taddLine( 'n2', 'f2', colorFrustum );\r\n\t\taddLine( 'n3', 'f3', colorFrustum );\r\n\t\taddLine( 'n4', 'f4', colorFrustum );\r\n\r\n\t\t// cone\r\n\r\n\t\taddLine( 'p', 'n1', colorCone );\r\n\t\taddLine( 'p', 'n2', colorCone );\r\n\t\taddLine( 'p', 'n3', colorCone );\r\n\t\taddLine( 'p', 'n4', colorCone );\r\n\r\n\t\t// up\r\n\r\n\t\taddLine( 'u1', 'u2', colorUp );\r\n\t\taddLine( 'u2', 'u3', colorUp );\r\n\t\taddLine( 'u3', 'u1', colorUp );\r\n\r\n\t\t// target\r\n\r\n\t\taddLine( 'c', 't', colorTarget );\r\n\t\taddLine( 'p', 'c', colorCross );\r\n\r\n\t\t// cross\r\n\r\n\t\taddLine( 'cn1', 'cn2', colorCross );\r\n\t\taddLine( 'cn3', 'cn4', colorCross );\r\n\r\n\t\taddLine( 'cf1', 'cf2', colorCross );\r\n\t\taddLine( 'cf3', 'cf4', colorCross );\r\n\r\n\t\tfunction addLine( a, b, color ) {\r\n\r\n\t\t\taddPoint( a, color );\r\n\t\t\taddPoint( b, color );\r\n\r\n\t\t}\r\n\r\n\t\tfunction addPoint( id, color ) {\r\n\r\n\t\t\tvertices.push( 0, 0, 0 );\r\n\t\t\tcolors.push( color.r, color.g, color.b );\r\n\r\n\t\t\tif ( pointMap[ id ] === undefined ) {\r\n\r\n\t\t\t\tpointMap[ id ] = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tpointMap[ id ].push( ( vertices.length / 3 ) - 1 );\r\n\r\n\t\t}\r\n\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t\tthis.camera = camera;\r\n\t\tif ( this.camera.updateProjectionMatrix ) { this.camera.updateProjectionMatrix(); }\r\n\r\n\t\tthis.matrix = camera.matrixWorld;\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.pointMap = pointMap;\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tCameraHelper.prototype = Object.create( LineSegments.prototype );\r\n\tCameraHelper.prototype.constructor = CameraHelper;\r\n\r\n\tCameraHelper.prototype.update = function () {\r\n\r\n\t\tvar geometry = this.geometry;\r\n\t\tvar pointMap = this.pointMap;\r\n\r\n\t\tvar w = 1, h = 1;\r\n\r\n\t\t// we need just camera projection matrix inverse\r\n\t\t// world matrix must be identity\r\n\r\n\t\t_camera.projectionMatrixInverse.copy( this.camera.projectionMatrixInverse );\r\n\r\n\t\t// center / target\r\n\r\n\t\tsetPoint( 'c', pointMap, geometry, _camera, 0, 0, - 1 );\r\n\t\tsetPoint( 't', pointMap, geometry, _camera, 0, 0, 1 );\r\n\r\n\t\t// near\r\n\r\n\t\tsetPoint( 'n1', pointMap, geometry, _camera, - w, - h, - 1 );\r\n\t\tsetPoint( 'n2', pointMap, geometry, _camera, w, - h, - 1 );\r\n\t\tsetPoint( 'n3', pointMap, geometry, _camera, - w, h, - 1 );\r\n\t\tsetPoint( 'n4', pointMap, geometry, _camera, w, h, - 1 );\r\n\r\n\t\t// far\r\n\r\n\t\tsetPoint( 'f1', pointMap, geometry, _camera, - w, - h, 1 );\r\n\t\tsetPoint( 'f2', pointMap, geometry, _camera, w, - h, 1 );\r\n\t\tsetPoint( 'f3', pointMap, geometry, _camera, - w, h, 1 );\r\n\t\tsetPoint( 'f4', pointMap, geometry, _camera, w, h, 1 );\r\n\r\n\t\t// up\r\n\r\n\t\tsetPoint( 'u1', pointMap, geometry, _camera, w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( 'u2', pointMap, geometry, _camera, - w * 0.7, h * 1.1, - 1 );\r\n\t\tsetPoint( 'u3', pointMap, geometry, _camera, 0, h * 2, - 1 );\r\n\r\n\t\t// cross\r\n\r\n\t\tsetPoint( 'cf1', pointMap, geometry, _camera, - w, 0, 1 );\r\n\t\tsetPoint( 'cf2', pointMap, geometry, _camera, w, 0, 1 );\r\n\t\tsetPoint( 'cf3', pointMap, geometry, _camera, 0, - h, 1 );\r\n\t\tsetPoint( 'cf4', pointMap, geometry, _camera, 0, h, 1 );\r\n\r\n\t\tsetPoint( 'cn1', pointMap, geometry, _camera, - w, 0, - 1 );\r\n\t\tsetPoint( 'cn2', pointMap, geometry, _camera, w, 0, - 1 );\r\n\t\tsetPoint( 'cn3', pointMap, geometry, _camera, 0, - h, - 1 );\r\n\t\tsetPoint( 'cn4', pointMap, geometry, _camera, 0, h, - 1 );\r\n\r\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\r\n\r\n\t};\r\n\r\n\tfunction setPoint( point, pointMap, geometry, camera, x, y, z ) {\r\n\r\n\t\t_vector$b.set( x, y, z ).unproject( camera );\r\n\r\n\t\tvar points = pointMap[ point ];\r\n\r\n\t\tif ( points !== undefined ) {\r\n\r\n\t\t\tvar position = geometry.getAttribute( 'position' );\r\n\r\n\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tposition.setXYZ( points[ i ], _vector$b.x, _vector$b.y, _vector$b.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t * @author Mugen87 / http://github.com/Mugen87\r\n\t */\r\n\r\n\tvar _box$3 = new Box3();\r\n\r\n\tfunction BoxHelper( object, color ) {\r\n\r\n\t\tthis.object = object;\r\n\r\n\t\tif ( color === undefined ) { color = 0xffff00; }\r\n\r\n\t\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\r\n\t\tvar positions = new Float32Array( 8 * 3 );\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\r\n\t\tgeometry.setAttribute( 'position', new BufferAttribute( positions, 3 ) );\r\n\r\n\t\tLineSegments.call( this, geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\r\n\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tBoxHelper.prototype = Object.create( LineSegments.prototype );\r\n\tBoxHelper.prototype.constructor = BoxHelper;\r\n\r\n\tBoxHelper.prototype.update = function ( object ) {\r\n\r\n\t\tif ( object !== undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BoxHelper: .update() has no longer arguments.' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.object !== undefined ) {\r\n\r\n\t\t\t_box$3.setFromObject( this.object );\r\n\r\n\t\t}\r\n\r\n\t\tif ( _box$3.isEmpty() ) { return; }\r\n\r\n\t\tvar min = _box$3.min;\r\n\t\tvar max = _box$3.max;\r\n\r\n\t\t/*\r\n\t\t  5____4\r\n\t\t1/___0/|\r\n\t\t| 6__|_7\r\n\t\t2/___3/\r\n\r\n\t\t0: max.x, max.y, max.z\r\n\t\t1: min.x, max.y, max.z\r\n\t\t2: min.x, min.y, max.z\r\n\t\t3: max.x, min.y, max.z\r\n\t\t4: max.x, max.y, min.z\r\n\t\t5: min.x, max.y, min.z\r\n\t\t6: min.x, min.y, min.z\r\n\t\t7: max.x, min.y, min.z\r\n\t\t*/\r\n\r\n\t\tvar position = this.geometry.attributes.position;\r\n\t\tvar array = position.array;\r\n\r\n\t\tarray[ 0 ] = max.x; array[ 1 ] = max.y; array[ 2 ] = max.z;\r\n\t\tarray[ 3 ] = min.x; array[ 4 ] = max.y; array[ 5 ] = max.z;\r\n\t\tarray[ 6 ] = min.x; array[ 7 ] = min.y; array[ 8 ] = max.z;\r\n\t\tarray[ 9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\r\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\r\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\r\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\r\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t\tthis.geometry.computeBoundingSphere();\r\n\r\n\r\n\t};\r\n\r\n\tBoxHelper.prototype.setFromObject = function ( object ) {\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.update();\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tBoxHelper.prototype.copy = function ( source ) {\r\n\r\n\t\tLineSegments.prototype.copy.call( this, source );\r\n\r\n\t\tthis.object = source.object;\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tBoxHelper.prototype.clone = function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction Box3Helper( box, color ) {\r\n\r\n\t\tthis.type = 'Box3Helper';\r\n\r\n\t\tthis.box = box;\r\n\r\n\t\tcolor = color || 0xffff00;\r\n\r\n\t\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\r\n\r\n\t\tvar positions = [ 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, - 1, 1, 1, 1, - 1, - 1, 1, - 1, - 1, - 1, - 1, 1, - 1, - 1 ];\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\r\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\r\n\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\r\n\r\n\t\tLineSegments.call( this, geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\r\n\r\n\t\tthis.geometry.computeBoundingSphere();\r\n\r\n\t}\r\n\r\n\tBox3Helper.prototype = Object.create( LineSegments.prototype );\r\n\tBox3Helper.prototype.constructor = Box3Helper;\r\n\r\n\tBox3Helper.prototype.updateMatrixWorld = function ( force ) {\r\n\r\n\t\tvar box = this.box;\r\n\r\n\t\tif ( box.isEmpty() ) { return; }\r\n\r\n\t\tbox.getCenter( this.position );\r\n\r\n\t\tbox.getSize( this.scale );\r\n\r\n\t\tthis.scale.multiplyScalar( 0.5 );\r\n\r\n\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t */\r\n\r\n\tfunction PlaneHelper( plane, size, hex ) {\r\n\r\n\t\tthis.type = 'PlaneHelper';\r\n\r\n\t\tthis.plane = plane;\r\n\r\n\t\tthis.size = ( size === undefined ) ? 1 : size;\r\n\r\n\t\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\r\n\r\n\t\tvar positions = [ 1, - 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, - 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0 ];\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\r\n\t\tgeometry.computeBoundingSphere();\r\n\r\n\t\tLine.call( this, geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\r\n\r\n\t\t//\r\n\r\n\t\tvar positions2 = [ 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, 1, 1, - 1, - 1, 1, 1, - 1, 1 ];\r\n\r\n\t\tvar geometry2 = new BufferGeometry();\r\n\t\tgeometry2.setAttribute( 'position', new Float32BufferAttribute( positions2, 3 ) );\r\n\t\tgeometry2.computeBoundingSphere();\r\n\r\n\t\tthis.add( new Mesh( geometry2, new MeshBasicMaterial( { color: color, opacity: 0.2, transparent: true, depthWrite: false, toneMapped: false } ) ) );\r\n\r\n\t}\r\n\r\n\tPlaneHelper.prototype = Object.create( Line.prototype );\r\n\tPlaneHelper.prototype.constructor = PlaneHelper;\r\n\r\n\tPlaneHelper.prototype.updateMatrixWorld = function ( force ) {\r\n\r\n\t\tvar scale = - this.plane.constant;\r\n\r\n\t\tif ( Math.abs( scale ) < 1e-8 ) { scale = 1e-8; } // sign does not matter\r\n\r\n\t\tthis.scale.set( 0.5 * this.size, 0.5 * this.size, scale );\r\n\r\n\t\tthis.children[ 0 ].material.side = ( scale < 0 ) ? BackSide : FrontSide; // renderer flips side when determinant < 0; flipping not wanted here\r\n\r\n\t\tthis.lookAt( this.plane.normal );\r\n\r\n\t\tObject3D.prototype.updateMatrixWorld.call( this, force );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author WestLangley / http://github.com/WestLangley\r\n\t * @author zz85 / http://github.com/zz85\r\n\t * @author bhouston / http://clara.io\r\n\t *\r\n\t * Creates an arrow for visualizing directions\r\n\t *\r\n\t * Parameters:\r\n\t *  dir - Vector3\r\n\t *  origin - Vector3\r\n\t *  length - Number\r\n\t *  color - color in hex value\r\n\t *  headLength - Number\r\n\t *  headWidth - Number\r\n\t */\r\n\r\n\tvar _axis = new Vector3();\r\n\tvar _lineGeometry, _coneGeometry;\r\n\r\n\tfunction ArrowHelper( dir, origin, length, color, headLength, headWidth ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tObject3D.call( this );\r\n\r\n\t\tif ( dir === undefined ) { dir = new Vector3( 0, 0, 1 ); }\r\n\t\tif ( origin === undefined ) { origin = new Vector3( 0, 0, 0 ); }\r\n\t\tif ( length === undefined ) { length = 1; }\r\n\t\tif ( color === undefined ) { color = 0xffff00; }\r\n\t\tif ( headLength === undefined ) { headLength = 0.2 * length; }\r\n\t\tif ( headWidth === undefined ) { headWidth = 0.2 * headLength; }\r\n\r\n\t\tif ( _lineGeometry === undefined ) {\r\n\r\n\t\t\t_lineGeometry = new BufferGeometry();\r\n\t\t\t_lineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 1, 0 ], 3 ) );\r\n\r\n\t\t\t_coneGeometry = new CylinderBufferGeometry( 0, 0.5, 1, 5, 1 );\r\n\t\t\t_coneGeometry.translate( 0, - 0.5, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tthis.position.copy( origin );\r\n\r\n\t\tthis.line = new Line( _lineGeometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\r\n\t\tthis.line.matrixAutoUpdate = false;\r\n\t\tthis.add( this.line );\r\n\r\n\t\tthis.cone = new Mesh( _coneGeometry, new MeshBasicMaterial( { color: color, toneMapped: false } ) );\r\n\t\tthis.cone.matrixAutoUpdate = false;\r\n\t\tthis.add( this.cone );\r\n\r\n\t\tthis.setDirection( dir );\r\n\t\tthis.setLength( length, headLength, headWidth );\r\n\r\n\t}\r\n\r\n\tArrowHelper.prototype = Object.create( Object3D.prototype );\r\n\tArrowHelper.prototype.constructor = ArrowHelper;\r\n\r\n\tArrowHelper.prototype.setDirection = function ( dir ) {\r\n\r\n\t\t// dir is assumed to be normalized\r\n\r\n\t\tif ( dir.y > 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\r\n\r\n\t\t} else if ( dir.y < - 0.99999 ) {\r\n\r\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_axis.set( dir.z, 0, - dir.x ).normalize();\r\n\r\n\t\t\tvar radians = Math.acos( dir.y );\r\n\r\n\t\t\tthis.quaternion.setFromAxisAngle( _axis, radians );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tArrowHelper.prototype.setLength = function ( length, headLength, headWidth ) {\r\n\r\n\t\tif ( headLength === undefined ) { headLength = 0.2 * length; }\r\n\t\tif ( headWidth === undefined ) { headWidth = 0.2 * headLength; }\r\n\r\n\t\tthis.line.scale.set( 1, Math.max( 0.0001, length - headLength ), 1 ); // see #17458\r\n\t\tthis.line.updateMatrix();\r\n\r\n\t\tthis.cone.scale.set( headWidth, headLength, headWidth );\r\n\t\tthis.cone.position.y = length;\r\n\t\tthis.cone.updateMatrix();\r\n\r\n\t};\r\n\r\n\tArrowHelper.prototype.setColor = function ( color ) {\r\n\r\n\t\tthis.line.material.color.set( color );\r\n\t\tthis.cone.material.color.set( color );\r\n\r\n\t};\r\n\r\n\tArrowHelper.prototype.copy = function ( source ) {\r\n\r\n\t\tObject3D.prototype.copy.call( this, source, false );\r\n\r\n\t\tthis.line.copy( source.line );\r\n\t\tthis.cone.copy( source.cone );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n\tArrowHelper.prototype.clone = function () {\r\n\r\n\t\treturn new this.constructor().copy( this );\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * @author sroucheray / http://sroucheray.org/\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction AxesHelper( size ) {\r\n\r\n\t\tsize = size || 1;\r\n\r\n\t\tvar vertices = [\r\n\t\t\t0, 0, 0,\tsize, 0, 0,\r\n\t\t\t0, 0, 0,\t0, size, 0,\r\n\t\t\t0, 0, 0,\t0, 0, size\r\n\t\t];\r\n\r\n\t\tvar colors = [\r\n\t\t\t1, 0, 0,\t1, 0.6, 0,\r\n\t\t\t0, 1, 0,\t0.6, 1, 0,\r\n\t\t\t0, 0, 1,\t0, 0.6, 1\r\n\t\t];\r\n\r\n\t\tvar geometry = new BufferGeometry();\r\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\tvar material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\r\n\r\n\t\tLineSegments.call( this, geometry, material );\r\n\r\n\t}\r\n\r\n\tAxesHelper.prototype = Object.create( LineSegments.prototype );\r\n\tAxesHelper.prototype.constructor = AxesHelper;\r\n\r\n\t/**\r\n\t * @author Emmett Lalish / elalish\r\n\t *\r\n\t * This class generates a Prefiltered, Mipmapped Radiance Environment Map\r\n\t * (PMREM) from a cubeMap environment texture. This allows different levels of\r\n\t * blur to be quickly accessed based on material roughness. It is packed into a\r\n\t * special CubeUV format that allows us to perform custom interpolation so that\r\n\t * we can support nonlinear formats such as RGBE. Unlike a traditional mipmap\r\n\t * chain, it only goes down to the LOD_MIN level (above), and then creates extra\r\n\t * even more filtered 'mips' at the same LOD_MIN resolution, associated with\r\n\t * higher roughness levels. In this way we maintain resolution to smoothly\r\n\t * interpolate diffuse lighting while limiting sampling computation.\r\n\t */\r\n\r\n\tvar LOD_MIN = 4;\r\n\tvar LOD_MAX = 8;\r\n\tvar SIZE_MAX = Math.pow( 2, LOD_MAX );\r\n\t// The standard deviations (radians) associated with the extra mips. These are\r\n\t// chosen to approximate a Trowbridge-Reitz distribution function times the\r\n\t// geometric shadowing function. These sigma values squared must match the\r\n\t// variance #defines in cube_uv_reflection_fragment.glsl.js.\r\n\tvar EXTRA_LOD_SIGMA = [ 0.125, 0.215, 0.35, 0.446, 0.526, 0.582 ];\r\n\tvar TOTAL_LODS = LOD_MAX - LOD_MIN + 1 + EXTRA_LOD_SIGMA.length;\r\n\t// The maximum length of the blur for loop. Smaller sigmas will use fewer\r\n\t// samples and exit early, but not recompile the shader.\r\n\tvar MAX_SAMPLES = 20;\r\n\tvar ENCODINGS = {};\r\n\tENCODINGS[ LinearEncoding ] = 0;\r\n\tENCODINGS[ sRGBEncoding ] = 1;\r\n\tENCODINGS[ RGBEEncoding ] = 2;\r\n\tENCODINGS[ RGBM7Encoding ] = 3;\r\n\tENCODINGS[ RGBM16Encoding ] = 4;\r\n\tENCODINGS[ RGBDEncoding ] = 5;\r\n\tENCODINGS[ GammaEncoding ] = 6;\r\n\r\n\tvar _flatCamera = new OrthographicCamera();\r\n\tvar _blurMaterial = _getBlurShader( MAX_SAMPLES );\r\n\tvar _equirectShader = null;\r\n\tvar _cubemapShader = null;\r\n\r\n\tvar ref = _createPlanes();\r\n\tvar _lodPlanes = ref._lodPlanes;\r\n\tvar _sizeLods = ref._sizeLods;\r\n\tvar _sigmas = ref._sigmas;\r\n\tvar _pingPongRenderTarget = null;\r\n\tvar _renderer = null;\r\n\r\n\tvar _oldTarget = null;\r\n\r\n\t// Golden Ratio\r\n\tvar PHI = ( 1 + Math.sqrt( 5 ) ) / 2;\r\n\tvar INV_PHI = 1 / PHI;\r\n\t// Vertices of a dodecahedron (except the opposites, which represent the\r\n\t// same axis), used as axis directions evenly spread on a sphere.\r\n\tvar _axisDirections = [\r\n\t\tnew Vector3( 1, 1, 1 ),\r\n\t\tnew Vector3( - 1, 1, 1 ),\r\n\t\tnew Vector3( 1, 1, - 1 ),\r\n\t\tnew Vector3( - 1, 1, - 1 ),\r\n\t\tnew Vector3( 0, PHI, INV_PHI ),\r\n\t\tnew Vector3( 0, PHI, - INV_PHI ),\r\n\t\tnew Vector3( INV_PHI, 0, PHI ),\r\n\t\tnew Vector3( - INV_PHI, 0, PHI ),\r\n\t\tnew Vector3( PHI, INV_PHI, 0 ),\r\n\t\tnew Vector3( - PHI, INV_PHI, 0 ) ];\r\n\r\n\tfunction PMREMGenerator( renderer ) {\r\n\r\n\t\t_renderer = renderer;\r\n\t\t_compileMaterial( _blurMaterial );\r\n\r\n\t}\r\n\r\n\tPMREMGenerator.prototype = {\r\n\r\n\t\tconstructor: PMREMGenerator,\r\n\r\n\t\t/**\r\n\t\t * Generates a PMREM from a supplied Scene, which can be faster than using an\r\n\t\t * image if networking bandwidth is low. Optional sigma specifies a blur radius\r\n\t\t * in radians to be applied to the scene before PMREM generation. Optional near\r\n\t\t * and far planes ensure the scene is rendered in its entirety (the cubeCamera\r\n\t\t * is placed at the origin).\r\n\t\t */\r\n\t\tfromScene: function ( scene, sigma, near, far ) {\r\n\t\t\tif ( sigma === void 0 ) sigma = 0;\r\n\t\t\tif ( near === void 0 ) near = 0.1;\r\n\t\t\tif ( far === void 0 ) far = 100;\r\n\r\n\r\n\t\t\t_oldTarget = _renderer.getRenderTarget();\r\n\t\t\tvar cubeUVRenderTarget = _allocateTargets();\r\n\t\t\t_sceneToCubeUV( scene, near, far, cubeUVRenderTarget );\r\n\t\t\tif ( sigma > 0 ) {\r\n\r\n\t\t\t\t_blur( cubeUVRenderTarget, 0, 0, sigma );\r\n\r\n\t\t\t}\r\n\t\t\t_applyPMREM( cubeUVRenderTarget );\r\n\t\t\t_cleanup( cubeUVRenderTarget );\r\n\r\n\t\t\treturn cubeUVRenderTarget;\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Generates a PMREM from an equirectangular texture, which can be either LDR\r\n\t\t * (RGBFormat) or HDR (RGBEFormat). The ideal input image size is 1k (1024 x 512),\r\n\t\t * as this matches best with the 256 x 256 cubemap output.\r\n\t\t */\r\n\t\tfromEquirectangular: function ( equirectangular ) {\r\n\r\n\t\t\tequirectangular.magFilter = NearestFilter;\r\n\t\t\tequirectangular.minFilter = NearestFilter;\r\n\t\t\tequirectangular.generateMipmaps = false;\r\n\r\n\t\t\treturn this.fromCubemap( equirectangular );\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Generates a PMREM from an cubemap texture, which can be either LDR\r\n\t\t * (RGBFormat) or HDR (RGBEFormat). The ideal input cube size is 256 x 256,\r\n\t\t * as this matches best with the 256 x 256 cubemap output.\r\n\t\t */\r\n\t\tfromCubemap: function ( cubemap ) {\r\n\r\n\t\t\t_oldTarget = _renderer.getRenderTarget();\r\n\t\t\tvar cubeUVRenderTarget = _allocateTargets( cubemap );\r\n\t\t\t_textureToCubeUV( cubemap, cubeUVRenderTarget );\r\n\t\t\t_applyPMREM( cubeUVRenderTarget );\r\n\t\t\t_cleanup( cubeUVRenderTarget );\r\n\r\n\t\t\treturn cubeUVRenderTarget;\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Pre-compiles the cubemap shader. You can get faster start-up by invoking this method during\r\n\t\t * your texture's network fetch for increased concurrency.\r\n\t\t */\r\n\t\tcompileCubemapShader: function () {\r\n\r\n\t\t\tif ( _cubemapShader == null ) {\r\n\r\n\t\t\t\t_cubemapShader = _getCubemapShader();\r\n\t\t\t\t_compileMaterial( _cubemapShader );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Pre-compiles the equirectangular shader. You can get faster start-up by invoking this method during\r\n\t\t * your texture's network fetch for increased concurrency.\r\n\t\t */\r\n\t\tcompileEquirectangularShader: function () {\r\n\r\n\t\t\tif ( _equirectShader == null ) {\r\n\r\n\t\t\t\t_equirectShader = _getEquirectShader();\r\n\t\t\t\t_compileMaterial( _equirectShader );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Disposes of the PMREMGenerator's internal memory. Note that PMREMGenerator is a static class,\r\n\t\t * so you should not need more than one PMREMGenerator object. If you do, calling dispose() on\r\n\t\t * one of them will cause any others to also become unusable.\r\n\t\t */\r\n\t\tdispose: function () {\r\n\r\n\t\t\t_blurMaterial.dispose();\r\n\r\n\t\t\tif ( _cubemapShader != null ) { _cubemapShader.dispose(); }\r\n\t\t\tif ( _equirectShader != null ) { _equirectShader.dispose(); }\r\n\r\n\t\t\tfor ( var i = 0; i < _lodPlanes.length; i ++ ) {\r\n\r\n\t\t\t\t_lodPlanes[ i ].dispose();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t};\r\n\r\n\tfunction _createPlanes() {\r\n\r\n\t\tvar _lodPlanes = [];\r\n\t\tvar _sizeLods = [];\r\n\t\tvar _sigmas = [];\r\n\r\n\t\tvar lod = LOD_MAX;\r\n\t\tfor ( var i = 0; i < TOTAL_LODS; i ++ ) {\r\n\r\n\t\t\tvar sizeLod = Math.pow( 2, lod );\r\n\t\t\t_sizeLods.push( sizeLod );\r\n\t\t\tvar sigma = 1.0 / sizeLod;\r\n\t\t\tif ( i > LOD_MAX - LOD_MIN ) {\r\n\r\n\t\t\t\tsigma = EXTRA_LOD_SIGMA[ i - LOD_MAX + LOD_MIN - 1 ];\r\n\r\n\t\t\t} else if ( i == 0 ) {\r\n\r\n\t\t\t\tsigma = 0;\r\n\r\n\t\t\t}\r\n\t\t\t_sigmas.push( sigma );\r\n\r\n\t\t\tvar texelSize = 1.0 / ( sizeLod - 1 );\r\n\t\t\tvar min = - texelSize / 2;\r\n\t\t\tvar max = 1 + texelSize / 2;\r\n\t\t\tvar uv1 = [ min, min, max, min, max, max, min, min, max, max, min, max ];\r\n\r\n\t\t\tvar cubeFaces = 6;\r\n\t\t\tvar vertices = 6;\r\n\t\t\tvar positionSize = 3;\r\n\t\t\tvar uvSize = 2;\r\n\t\t\tvar faceIndexSize = 1;\r\n\r\n\t\t\tvar position = new Float32Array( positionSize * vertices * cubeFaces );\r\n\t\t\tvar uv = new Float32Array( uvSize * vertices * cubeFaces );\r\n\t\t\tvar faceIndex = new Float32Array( faceIndexSize * vertices * cubeFaces );\r\n\r\n\t\t\tfor ( var face = 0; face < cubeFaces; face ++ ) {\r\n\r\n\t\t\t\tvar x = ( face % 3 ) * 2 / 3 - 1;\r\n\t\t\t\tvar y = face > 2 ? 0 : - 1;\r\n\t\t\t\tvar coordinates = [\r\n\t\t\t\t\tx, y, 0,\r\n\t\t\t\t\tx + 2 / 3, y, 0,\r\n\t\t\t\t\tx + 2 / 3, y + 1, 0,\r\n\t\t\t\t\tx, y, 0,\r\n\t\t\t\t\tx + 2 / 3, y + 1, 0,\r\n\t\t\t\t\tx, y + 1, 0\r\n\t\t\t\t];\r\n\t\t\t\tposition.set( coordinates, positionSize * vertices * face );\r\n\t\t\t\tuv.set( uv1, uvSize * vertices * face );\r\n\t\t\t\tvar fill = [ face, face, face, face, face, face ];\r\n\t\t\t\tfaceIndex.set( fill, faceIndexSize * vertices * face );\r\n\r\n\t\t\t}\r\n\t\t\tvar planes = new BufferGeometry();\r\n\t\t\tplanes.setAttribute( 'position', new BufferAttribute( position, positionSize ) );\r\n\t\t\tplanes.setAttribute( 'uv', new BufferAttribute( uv, uvSize ) );\r\n\t\t\tplanes.setAttribute( 'faceIndex', new BufferAttribute( faceIndex, faceIndexSize ) );\r\n\t\t\t_lodPlanes.push( planes );\r\n\r\n\t\t\tif ( lod > LOD_MIN ) {\r\n\r\n\t\t\t\tlod --;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn { _lodPlanes: _lodPlanes, _sizeLods: _sizeLods, _sigmas: _sigmas };\r\n\r\n\t}\r\n\r\n\tfunction _allocateTargets( equirectangular ) {\r\n\r\n\t\tvar params = {\r\n\t\t\tmagFilter: NearestFilter,\r\n\t\t\tminFilter: NearestFilter,\r\n\t\t\tgenerateMipmaps: false,\r\n\t\t\ttype: equirectangular ? equirectangular.type : UnsignedByteType,\r\n\t\t\tformat: equirectangular ? equirectangular.format : RGBEFormat,\r\n\t\t\tencoding: equirectangular ? equirectangular.encoding : RGBEEncoding,\r\n\t\t\tdepthBuffer: false,\r\n\t\t\tstencilBuffer: false\r\n\t\t};\r\n\t\tvar cubeUVRenderTarget = _createRenderTarget( params );\r\n\t\tcubeUVRenderTarget.depthBuffer = equirectangular ? false : true;\r\n\t\t_pingPongRenderTarget = _createRenderTarget( params );\r\n\t\treturn cubeUVRenderTarget;\r\n\r\n\t}\r\n\r\n\tfunction _cleanup( outputTarget ) {\r\n\r\n\t\t_pingPongRenderTarget.dispose();\r\n\t\t_renderer.setRenderTarget( _oldTarget );\r\n\t\toutputTarget.scissorTest = false;\r\n\t\t// reset viewport and scissor\r\n\t\toutputTarget.setSize( outputTarget.width, outputTarget.height );\r\n\r\n\t}\r\n\r\n\tfunction _sceneToCubeUV( scene, near, far, cubeUVRenderTarget ) {\r\n\r\n\t\tvar fov = 90;\r\n\t\tvar aspect = 1;\r\n\t\tvar cubeCamera = new PerspectiveCamera( fov, aspect, near, far );\r\n\t\tvar upSign = [ 1, 1, 1, 1, - 1, 1 ];\r\n\t\tvar forwardSign = [ 1, 1, - 1, - 1, - 1, 1 ];\r\n\r\n\t\tvar outputEncoding = _renderer.outputEncoding;\r\n\t\tvar toneMapping = _renderer.toneMapping;\r\n\t\tvar toneMappingExposure = _renderer.toneMappingExposure;\r\n\t\tvar clearColor = _renderer.getClearColor();\r\n\t\tvar clearAlpha = _renderer.getClearAlpha();\r\n\r\n\t\t_renderer.toneMapping = LinearToneMapping;\r\n\t\t_renderer.toneMappingExposure = 1.0;\r\n\t\t_renderer.outputEncoding = LinearEncoding;\r\n\t\tscene.scale.z *= - 1;\r\n\r\n\t\tvar background = scene.background;\r\n\t\tif ( background && background.isColor ) {\r\n\r\n\t\t\tbackground.convertSRGBToLinear();\r\n\t\t\t// Convert linear to RGBE\r\n\t\t\tvar maxComponent = Math.max( background.r, background.g, background.b );\r\n\t\t\tvar fExp = Math.min( Math.max( Math.ceil( Math.log2( maxComponent ) ), - 128.0 ), 127.0 );\r\n\t\t\tbackground = background.multiplyScalar( Math.pow( 2.0, - fExp ) );\r\n\t\t\tvar alpha = ( fExp + 128.0 ) / 255.0;\r\n\t\t\t_renderer.setClearColor( background, alpha );\r\n\t\t\tscene.background = null;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < 6; i ++ ) {\r\n\r\n\t\t\tvar col = i % 3;\r\n\t\t\tif ( col == 0 ) {\r\n\r\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\r\n\t\t\t\tcubeCamera.lookAt( forwardSign[ i ], 0, 0 );\r\n\r\n\t\t\t} else if ( col == 1 ) {\r\n\r\n\t\t\t\tcubeCamera.up.set( 0, 0, upSign[ i ] );\r\n\t\t\t\tcubeCamera.lookAt( 0, forwardSign[ i ], 0 );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\r\n\t\t\t\tcubeCamera.lookAt( 0, 0, forwardSign[ i ] );\r\n\r\n\t\t\t}\r\n\t\t\t_setViewport( cubeUVRenderTarget,\r\n\t\t\t\tcol * SIZE_MAX, i > 2 ? SIZE_MAX : 0, SIZE_MAX, SIZE_MAX );\r\n\t\t\t_renderer.setRenderTarget( cubeUVRenderTarget );\r\n\t\t\t_renderer.render( scene, cubeCamera );\r\n\r\n\t\t}\r\n\r\n\t\t_renderer.toneMapping = toneMapping;\r\n\t\t_renderer.toneMappingExposure = toneMappingExposure;\r\n\t\t_renderer.outputEncoding = outputEncoding;\r\n\t\t_renderer.setClearColor( clearColor, clearAlpha );\r\n\t\tscene.scale.z *= - 1;\r\n\r\n\t}\r\n\r\n\tfunction _textureToCubeUV( texture, cubeUVRenderTarget ) {\r\n\r\n\t\tvar scene = new Scene();\r\n\t\tif ( texture.isCubeTexture ) {\r\n\r\n\t\t\tif ( _cubemapShader == null ) {\r\n\r\n\t\t\t\t_cubemapShader = _getCubemapShader();\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tif ( _equirectShader == null ) {\r\n\r\n\t\t\t\t_equirectShader = _getEquirectShader();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tvar material = texture.isCubeTexture ? _cubemapShader : _equirectShader;\r\n\t\tscene.add( new Mesh( _lodPlanes[ 0 ], material ) );\r\n\t\tvar uniforms = material.uniforms;\r\n\r\n\t\tuniforms[ 'envMap' ].value = texture;\r\n\t\tif ( ! texture.isCubeTexture ) {\r\n\r\n\t\t\tuniforms[ 'texelSize' ].value.set( 1.0 / texture.image.width, 1.0 / texture.image.height );\r\n\r\n\t\t}\r\n\t\tuniforms[ 'inputEncoding' ].value = ENCODINGS[ texture.encoding ];\r\n\t\tuniforms[ 'outputEncoding' ].value = ENCODINGS[ texture.encoding ];\r\n\r\n\t\t_setViewport( cubeUVRenderTarget, 0, 0, 3 * SIZE_MAX, 2 * SIZE_MAX );\r\n\t\t_renderer.setRenderTarget( cubeUVRenderTarget );\r\n\t\t_renderer.render( scene, _flatCamera );\r\n\r\n\t}\r\n\r\n\tfunction _compileMaterial( material ) {\r\n\r\n\t\tvar tmpScene = new Scene();\r\n\t\ttmpScene.add( new Mesh( _lodPlanes[ 0 ], material ) );\r\n\t\t_renderer.compile( tmpScene, _flatCamera );\r\n\r\n\t}\r\n\r\n\tfunction _createRenderTarget( params ) {\r\n\r\n\t\tvar cubeUVRenderTarget = new WebGLRenderTarget( 3 * SIZE_MAX, 3 * SIZE_MAX, params );\r\n\t\tcubeUVRenderTarget.texture.mapping = CubeUVReflectionMapping;\r\n\t\tcubeUVRenderTarget.texture.name = 'PMREM.cubeUv';\r\n\t\tcubeUVRenderTarget.scissorTest = true;\r\n\t\treturn cubeUVRenderTarget;\r\n\r\n\t}\r\n\r\n\tfunction _setViewport( target, x, y, width, height ) {\r\n\r\n\t\ttarget.viewport.set( x, y, width, height );\r\n\t\ttarget.scissor.set( x, y, width, height );\r\n\r\n\t}\r\n\r\n\tfunction _applyPMREM( cubeUVRenderTarget ) {\r\n\r\n\t\tvar autoClear = _renderer.autoClear;\r\n\t\t_renderer.autoClear = false;\r\n\r\n\t\tfor ( var i = 1; i < TOTAL_LODS; i ++ ) {\r\n\r\n\t\t\tvar sigma = Math.sqrt(\r\n\t\t\t\t_sigmas[ i ] * _sigmas[ i ] -\r\n\t\t\t_sigmas[ i - 1 ] * _sigmas[ i - 1 ] );\r\n\t\t\tvar poleAxis =\r\n\t\t\t_axisDirections[ ( i - 1 ) % _axisDirections.length ];\r\n\t\t\t_blur( cubeUVRenderTarget, i - 1, i, sigma, poleAxis );\r\n\r\n\t\t}\r\n\r\n\t\t_renderer.autoClear = autoClear;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * This is a two-pass Gaussian blur for a cubemap. Normally this is done\r\n\t * vertically and horizontally, but this breaks down on a cube. Here we apply\r\n\t * the blur latitudinally (around the poles), and then longitudinally (towards\r\n\t * the poles) to approximate the orthogonally-separable blur. It is least\r\n\t * accurate at the poles, but still does a decent job.\r\n\t */\r\n\tfunction _blur( cubeUVRenderTarget, lodIn, lodOut, sigma, poleAxis ) {\r\n\r\n\t\t_halfBlur(\r\n\t\t\tcubeUVRenderTarget,\r\n\t\t\t_pingPongRenderTarget,\r\n\t\t\tlodIn,\r\n\t\t\tlodOut,\r\n\t\t\tsigma,\r\n\t\t\t'latitudinal',\r\n\t\t\tpoleAxis );\r\n\r\n\t\t_halfBlur(\r\n\t\t\t_pingPongRenderTarget,\r\n\t\t\tcubeUVRenderTarget,\r\n\t\t\tlodOut,\r\n\t\t\tlodOut,\r\n\t\t\tsigma,\r\n\t\t\t'longitudinal',\r\n\t\t\tpoleAxis );\r\n\r\n\t}\r\n\r\n\tfunction _halfBlur( targetIn, targetOut, lodIn, lodOut, sigmaRadians, direction, poleAxis ) {\r\n\r\n\t\tif ( direction !== 'latitudinal' && direction !== 'longitudinal' ) {\r\n\r\n\t\t\tconsole.error(\r\n\t\t\t\t'blur direction must be either latitudinal or longitudinal!' );\r\n\r\n\t\t}\r\n\r\n\t\t// Number of standard deviations at which to cut off the discrete approximation.\r\n\t\tvar STANDARD_DEVIATIONS = 3;\r\n\r\n\t\tvar blurScene = new Scene();\r\n\t\tblurScene.add( new Mesh( _lodPlanes[ lodOut ], _blurMaterial ) );\r\n\t\tvar blurUniforms = _blurMaterial.uniforms;\r\n\r\n\t\tvar pixels = _sizeLods[ lodIn ] - 1;\r\n\t\tvar radiansPerPixel = isFinite( sigmaRadians ) ? Math.PI / ( 2 * pixels ) : 2 * Math.PI / ( 2 * MAX_SAMPLES - 1 );\r\n\t\tvar sigmaPixels = sigmaRadians / radiansPerPixel;\r\n\t\tvar samples = isFinite( sigmaRadians ) ? 1 + Math.floor( STANDARD_DEVIATIONS * sigmaPixels ) : MAX_SAMPLES;\r\n\r\n\t\tif ( samples > MAX_SAMPLES ) {\r\n\r\n\t\t\tconsole.warn( (\"sigmaRadians, \" + sigmaRadians + \", is too large and will clip, as it requested \" + samples + \" samples when the maximum is set to \" + MAX_SAMPLES) );\r\n\r\n\t\t}\r\n\r\n\t\tvar weights = [];\r\n\t\tvar sum = 0;\r\n\r\n\t\tfor ( var i = 0; i < MAX_SAMPLES; ++ i ) {\r\n\r\n\t\t\tvar x = i / sigmaPixels;\r\n\t\t\tvar weight = Math.exp( - x * x / 2 );\r\n\t\t\tweights.push( weight );\r\n\r\n\t\t\tif ( i == 0 ) {\r\n\r\n\t\t\t\tsum += weight;\r\n\r\n\t\t\t} else if ( i < samples ) {\r\n\r\n\t\t\t\tsum += 2 * weight;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < weights.length; i ++ ) {\r\n\r\n\t\t\tweights[ i ] = weights[ i ] / sum;\r\n\r\n\t\t}\r\n\r\n\t\tblurUniforms[ 'envMap' ].value = targetIn.texture;\r\n\t\tblurUniforms[ 'samples' ].value = samples;\r\n\t\tblurUniforms[ 'weights' ].value = weights;\r\n\t\tblurUniforms[ 'latitudinal' ].value = direction === 'latitudinal';\r\n\t\tif ( poleAxis ) {\r\n\r\n\t\t\tblurUniforms[ 'poleAxis' ].value = poleAxis;\r\n\r\n\t\t}\r\n\t\tblurUniforms[ 'dTheta' ].value = radiansPerPixel;\r\n\t\tblurUniforms[ 'mipInt' ].value = LOD_MAX - lodIn;\r\n\t\tblurUniforms[ 'inputEncoding' ].value = ENCODINGS[ targetIn.texture.encoding ];\r\n\t\tblurUniforms[ 'outputEncoding' ].value = ENCODINGS[ targetIn.texture.encoding ];\r\n\r\n\t\tvar outputSize = _sizeLods[ lodOut ];\r\n\t\tvar x = 3 * Math.max( 0, SIZE_MAX - 2 * outputSize );\r\n\t\tvar y = ( lodOut === 0 ? 0 : 2 * SIZE_MAX ) +\r\n\t\t2 * outputSize *\r\n\t\t\t( lodOut > LOD_MAX - LOD_MIN ? lodOut - LOD_MAX + LOD_MIN : 0 );\r\n\r\n\t\t_setViewport( targetOut, x, y, 3 * outputSize, 2 * outputSize );\r\n\t\t_renderer.setRenderTarget( targetOut );\r\n\t\t_renderer.render( blurScene, _flatCamera );\r\n\r\n\t}\r\n\r\n\tfunction _getBlurShader( maxSamples ) {\r\n\r\n\t\tvar weights = new Float32Array( maxSamples );\r\n\t\tvar poleAxis = new Vector3( 0, 1, 0 );\r\n\t\tvar shaderMaterial = new RawShaderMaterial( {\r\n\r\n\t\t\tdefines: { 'n': maxSamples },\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\t'envMap': { value: null },\r\n\t\t\t\t'samples': { value: 1 },\r\n\t\t\t\t'weights': { value: weights },\r\n\t\t\t\t'latitudinal': { value: false },\r\n\t\t\t\t'dTheta': { value: 0 },\r\n\t\t\t\t'mipInt': { value: 0 },\r\n\t\t\t\t'poleAxis': { value: poleAxis },\r\n\t\t\t\t'inputEncoding': { value: ENCODINGS[ LinearEncoding ] },\r\n\t\t\t\t'outputEncoding': { value: ENCODINGS[ LinearEncoding ] }\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: _getCommonVertexShader(),\r\n\r\n\t\t\tfragmentShader: (\"\\nprecision mediump float;\\nprecision mediump int;\\nvarying vec3 vOutputDirection;\\nuniform sampler2D envMap;\\nuniform int samples;\\nuniform float weights[n];\\nuniform bool latitudinal;\\nuniform float dTheta;\\nuniform float mipInt;\\nuniform vec3 poleAxis;\\n\\n\" + (_getEncodings()) + \"\\n\\n#define ENVMAP_TYPE_CUBE_UV\\n#include <cube_uv_reflection_fragment>\\n\\nvec3 getSample(float theta, vec3 axis) {\\n\\tfloat cosTheta = cos(theta);\\n\\t// Rodrigues' axis-angle rotation\\n\\tvec3 sampleDirection = vOutputDirection * cosTheta\\n\\t\\t+ cross(axis, vOutputDirection) * sin(theta)\\n\\t\\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\\n\\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\\n}\\n\\nvoid main() {\\n\\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\\n\\tif (all(equal(axis, vec3(0.0))))\\n\\t\\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\\n\\taxis = normalize(axis);\\n\\tgl_FragColor = vec4(0.0);\\n\\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\\n\\tfor (int i = 1; i < n; i++) {\\n\\t\\tif (i >= samples)\\n\\t\\t\\tbreak;\\n\\t\\tfloat theta = dTheta * float(i);\\n\\t\\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\\n\\t\\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\\n\\t}\\n\\tgl_FragColor = linearToOutputTexel(gl_FragColor);\\n}\\n\\t\\t\"),\r\n\r\n\t\t\tblending: NoBlending,\r\n\t\t\tdepthTest: false,\r\n\t\t\tdepthWrite: false\r\n\r\n\t\t} );\r\n\r\n\t\tshaderMaterial.type = 'SphericalGaussianBlur';\r\n\r\n\t\treturn shaderMaterial;\r\n\r\n\t}\r\n\r\n\tfunction _getEquirectShader() {\r\n\r\n\t\tvar texelSize = new Vector2( 1, 1 );\r\n\t\tvar shaderMaterial = new RawShaderMaterial( {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\t'envMap': { value: null },\r\n\t\t\t\t'texelSize': { value: texelSize },\r\n\t\t\t\t'inputEncoding': { value: ENCODINGS[ LinearEncoding ] },\r\n\t\t\t\t'outputEncoding': { value: ENCODINGS[ LinearEncoding ] }\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: _getCommonVertexShader(),\r\n\r\n\t\t\tfragmentShader: (\"\\nprecision mediump float;\\nprecision mediump int;\\nvarying vec3 vOutputDirection;\\nuniform sampler2D envMap;\\nuniform vec2 texelSize;\\n\\n\" + (_getEncodings()) + \"\\n\\n#define RECIPROCAL_PI 0.31830988618\\n#define RECIPROCAL_PI2 0.15915494\\n\\nvoid main() {\\n\\tgl_FragColor = vec4(0.0);\\n\\tvec3 outputDirection = normalize(vOutputDirection);\\n\\tvec2 uv;\\n\\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\\n\\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\\n\\tvec2 f = fract(uv / texelSize - 0.5);\\n\\tuv -= f * texelSize;\\n\\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\\n\\tuv.x += texelSize.x;\\n\\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\\n\\tuv.y += texelSize.y;\\n\\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\\n\\tuv.x -= texelSize.x;\\n\\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\\n\\tvec3 tm = mix(tl, tr, f.x);\\n\\tvec3 bm = mix(bl, br, f.x);\\n\\tgl_FragColor.rgb = mix(tm, bm, f.y);\\n\\tgl_FragColor = linearToOutputTexel(gl_FragColor);\\n}\\n\\t\\t\"),\r\n\r\n\t\t\tblending: NoBlending,\r\n\t\t\tdepthTest: false,\r\n\t\t\tdepthWrite: false\r\n\r\n\t\t} );\r\n\r\n\t\tshaderMaterial.type = 'EquirectangularToCubeUV';\r\n\r\n\t\treturn shaderMaterial;\r\n\r\n\t}\r\n\r\n\tfunction _getCubemapShader() {\r\n\r\n\t\tvar shaderMaterial = new RawShaderMaterial( {\r\n\r\n\t\t\tuniforms: {\r\n\t\t\t\t'envMap': { value: null },\r\n\t\t\t\t'inputEncoding': { value: ENCODINGS[ LinearEncoding ] },\r\n\t\t\t\t'outputEncoding': { value: ENCODINGS[ LinearEncoding ] }\r\n\t\t\t},\r\n\r\n\t\t\tvertexShader: _getCommonVertexShader(),\r\n\r\n\t\t\tfragmentShader: (\"\\nprecision mediump float;\\nprecision mediump int;\\nvarying vec3 vOutputDirection;\\nuniform samplerCube envMap;\\n\\n\" + (_getEncodings()) + \"\\n\\nvoid main() {\\n\\tgl_FragColor = vec4(0.0);\\n\\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\\n\\tgl_FragColor = linearToOutputTexel(gl_FragColor);\\n}\\n\\t\\t\"),\r\n\r\n\t\t\tblending: NoBlending,\r\n\t\t\tdepthTest: false,\r\n\t\t\tdepthWrite: false\r\n\r\n\t\t} );\r\n\r\n\t\tshaderMaterial.type = 'CubemapToCubeUV';\r\n\r\n\t\treturn shaderMaterial;\r\n\r\n\t}\r\n\r\n\tfunction _getCommonVertexShader() {\r\n\r\n\t\treturn \"\\nprecision mediump float;\\nprecision mediump int;\\nattribute vec3 position;\\nattribute vec2 uv;\\nattribute float faceIndex;\\nvarying vec3 vOutputDirection;\\nvec3 getDirection(vec2 uv, float face) {\\n\\tuv = 2.0 * uv - 1.0;\\n\\tvec3 direction = vec3(uv, 1.0);\\n\\tif (face == 0.0) {\\n\\t\\tdirection = direction.zyx;\\n\\t\\tdirection.z *= -1.0;\\n\\t} else if (face == 1.0) {\\n\\t\\tdirection = direction.xzy;\\n\\t\\tdirection.z *= -1.0;\\n\\t} else if (face == 3.0) {\\n\\t\\tdirection = direction.zyx;\\n\\t\\tdirection.x *= -1.0;\\n\\t} else if (face == 4.0) {\\n\\t\\tdirection = direction.xzy;\\n\\t\\tdirection.y *= -1.0;\\n\\t} else if (face == 5.0) {\\n\\t\\tdirection.xz *= -1.0;\\n\\t}\\n\\treturn direction;\\n}\\nvoid main() {\\n\\tvOutputDirection = getDirection(uv, faceIndex);\\n\\tgl_Position = vec4( position, 1.0 );\\n}\\n\\t\";\r\n\r\n\t}\r\n\r\n\tfunction _getEncodings() {\r\n\r\n\t\treturn \"\\nuniform int inputEncoding;\\nuniform int outputEncoding;\\n\\n#include <encodings_pars_fragment>\\n\\nvec4 inputTexelToLinear(vec4 value){\\n\\tif(inputEncoding == 0){\\n\\t\\treturn value;\\n\\t}else if(inputEncoding == 1){\\n\\t\\treturn sRGBToLinear(value);\\n\\t}else if(inputEncoding == 2){\\n\\t\\treturn RGBEToLinear(value);\\n\\t}else if(inputEncoding == 3){\\n\\t\\treturn RGBMToLinear(value, 7.0);\\n\\t}else if(inputEncoding == 4){\\n\\t\\treturn RGBMToLinear(value, 16.0);\\n\\t}else if(inputEncoding == 5){\\n\\t\\treturn RGBDToLinear(value, 256.0);\\n\\t}else{\\n\\t\\treturn GammaToLinear(value, 2.2);\\n\\t}\\n}\\n\\nvec4 linearToOutputTexel(vec4 value){\\n\\tif(outputEncoding == 0){\\n\\t\\treturn value;\\n\\t}else if(outputEncoding == 1){\\n\\t\\treturn LinearTosRGB(value);\\n\\t}else if(outputEncoding == 2){\\n\\t\\treturn LinearToRGBE(value);\\n\\t}else if(outputEncoding == 3){\\n\\t\\treturn LinearToRGBM(value, 7.0);\\n\\t}else if(outputEncoding == 4){\\n\\t\\treturn LinearToRGBM(value, 16.0);\\n\\t}else if(outputEncoding == 5){\\n\\t\\treturn LinearToRGBD(value, 256.0);\\n\\t}else{\\n\\t\\treturn LinearToGamma(value, 2.2);\\n\\t}\\n}\\n\\nvec4 envMapTexelToLinear(vec4 color) {\\n\\treturn inputTexelToLinear(color);\\n}\\n\\t\";\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * @author mrdoob / http://mrdoob.com/\r\n\t */\r\n\r\n\tfunction Face4( a, b, c, d, normal, color, materialIndex ) {\r\n\r\n\t\tconsole.warn( 'THREE.Face4 has been removed. A THREE.Face3 will be created instead.' );\r\n\t\treturn new Face3( a, b, c, normal, color, materialIndex );\r\n\r\n\t}\r\n\r\n\tvar LineStrip = 0;\r\n\tvar LinePieces = 1;\r\n\tvar NoColors = 0;\r\n\tvar FaceColors = 1;\r\n\tvar VertexColors = 2;\r\n\r\n\tfunction MeshFaceMaterial( materials ) {\r\n\r\n\t\tconsole.warn( 'THREE.MeshFaceMaterial has been removed. Use an Array instead.' );\r\n\t\treturn materials;\r\n\r\n\t}\r\n\r\n\tfunction MultiMaterial( materials ) {\r\n\r\n\t\tif ( materials === undefined ) { materials = []; }\r\n\r\n\t\tconsole.warn( 'THREE.MultiMaterial has been removed. Use an Array instead.' );\r\n\t\tmaterials.isMultiMaterial = true;\r\n\t\tmaterials.materials = materials;\r\n\t\tmaterials.clone = function () {\r\n\r\n\t\t\treturn materials.slice();\r\n\r\n\t\t};\r\n\t\treturn materials;\r\n\r\n\t}\r\n\r\n\tfunction PointCloud( geometry, material ) {\r\n\r\n\t\tconsole.warn( 'THREE.PointCloud has been renamed to THREE.Points.' );\r\n\t\treturn new Points( geometry, material );\r\n\r\n\t}\r\n\r\n\tfunction Particle( material ) {\r\n\r\n\t\tconsole.warn( 'THREE.Particle has been renamed to THREE.Sprite.' );\r\n\t\treturn new Sprite( material );\r\n\r\n\t}\r\n\r\n\tfunction ParticleSystem( geometry, material ) {\r\n\r\n\t\tconsole.warn( 'THREE.ParticleSystem has been renamed to THREE.Points.' );\r\n\t\treturn new Points( geometry, material );\r\n\r\n\t}\r\n\r\n\tfunction PointCloudMaterial( parameters ) {\r\n\r\n\t\tconsole.warn( 'THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new PointsMaterial( parameters );\r\n\r\n\t}\r\n\r\n\tfunction ParticleBasicMaterial( parameters ) {\r\n\r\n\t\tconsole.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new PointsMaterial( parameters );\r\n\r\n\t}\r\n\r\n\tfunction ParticleSystemMaterial( parameters ) {\r\n\r\n\t\tconsole.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.' );\r\n\t\treturn new PointsMaterial( parameters );\r\n\r\n\t}\r\n\r\n\tfunction Vertex( x, y, z ) {\r\n\r\n\t\tconsole.warn( 'THREE.Vertex has been removed. Use THREE.Vector3 instead.' );\r\n\t\treturn new Vector3( x, y, z );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction DynamicBufferAttribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead.' );\r\n\t\treturn new BufferAttribute( array, itemSize ).setUsage( DynamicDrawUsage );\r\n\r\n\t}\r\n\r\n\tfunction Int8Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.' );\r\n\t\treturn new Int8BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Uint8Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.' );\r\n\t\treturn new Uint8BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Uint8ClampedAttribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.' );\r\n\t\treturn new Uint8ClampedBufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Int16Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.' );\r\n\t\treturn new Int16BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Uint16Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.' );\r\n\t\treturn new Uint16BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Int32Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.' );\r\n\t\treturn new Int32BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Uint32Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.' );\r\n\t\treturn new Uint32BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Float32Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.' );\r\n\t\treturn new Float32BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\tfunction Float64Attribute( array, itemSize ) {\r\n\r\n\t\tconsole.warn( 'THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.' );\r\n\t\treturn new Float64BufferAttribute( array, itemSize );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tCurve.create = function ( construct, getPoint ) {\r\n\r\n\t\tconsole.log( 'THREE.Curve.create() has been deprecated' );\r\n\r\n\t\tconstruct.prototype = Object.create( Curve.prototype );\r\n\t\tconstruct.prototype.constructor = construct;\r\n\t\tconstruct.prototype.getPoint = getPoint;\r\n\r\n\t\treturn construct;\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tObject.assign( CurvePath.prototype, {\r\n\r\n\t\tcreatePointsGeometry: function ( divisions ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.' );\r\n\r\n\t\t\t// generate geometry from path points (for Line or Points objects)\r\n\r\n\t\t\tvar pts = this.getPoints( divisions );\r\n\t\t\treturn this.createGeometry( pts );\r\n\r\n\t\t},\r\n\r\n\t\tcreateSpacedPointsGeometry: function ( divisions ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.' );\r\n\r\n\t\t\t// generate geometry from equidistant sampling along the path\r\n\r\n\t\t\tvar pts = this.getSpacedPoints( divisions );\r\n\t\t\treturn this.createGeometry( pts );\r\n\r\n\t\t},\r\n\r\n\t\tcreateGeometry: function ( points ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.' );\r\n\r\n\t\t\tvar geometry = new Geometry();\r\n\r\n\t\t\tfor ( var i = 0, l = points.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar point = points[ i ];\r\n\t\t\t\tgeometry.vertices.push( new Vector3( point.x, point.y, point.z || 0 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.assign( Path.prototype, {\r\n\r\n\t\tfromPoints: function ( points ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Path: .fromPoints() has been renamed to .setFromPoints().' );\r\n\t\t\treturn this.setFromPoints( points );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tfunction ClosedSplineCurve3( points ) {\r\n\r\n\t\tconsole.warn( 'THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.' );\r\n\r\n\t\tCatmullRomCurve3.call( this, points );\r\n\t\tthis.type = 'catmullrom';\r\n\t\tthis.closed = true;\r\n\r\n\t}\r\n\r\n\tClosedSplineCurve3.prototype = Object.create( CatmullRomCurve3.prototype );\r\n\r\n\t//\r\n\r\n\tfunction SplineCurve3( points ) {\r\n\r\n\t\tconsole.warn( 'THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.' );\r\n\r\n\t\tCatmullRomCurve3.call( this, points );\r\n\t\tthis.type = 'catmullrom';\r\n\r\n\t}\r\n\r\n\tSplineCurve3.prototype = Object.create( CatmullRomCurve3.prototype );\r\n\r\n\t//\r\n\r\n\tfunction Spline( points ) {\r\n\r\n\t\tconsole.warn( 'THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.' );\r\n\r\n\t\tCatmullRomCurve3.call( this, points );\r\n\t\tthis.type = 'catmullrom';\r\n\r\n\t}\r\n\r\n\tSpline.prototype = Object.create( CatmullRomCurve3.prototype );\r\n\r\n\tObject.assign( Spline.prototype, {\r\n\r\n\t\tinitFromArray: function ( /* a */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Spline: .initFromArray() has been removed.' );\r\n\r\n\t\t},\r\n\t\tgetControlPointsArray: function ( /* optionalTarget */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Spline: .getControlPointsArray() has been removed.' );\r\n\r\n\t\t},\r\n\t\treparametrizeByArcLength: function ( /* samplingCoef */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Spline: .reparametrizeByArcLength() has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tfunction AxisHelper( size ) {\r\n\r\n\t\tconsole.warn( 'THREE.AxisHelper has been renamed to THREE.AxesHelper.' );\r\n\t\treturn new AxesHelper( size );\r\n\r\n\t}\r\n\r\n\tfunction BoundingBoxHelper( object, color ) {\r\n\r\n\t\tconsole.warn( 'THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.' );\r\n\t\treturn new BoxHelper( object, color );\r\n\r\n\t}\r\n\r\n\tfunction EdgesHelper( object, hex ) {\r\n\r\n\t\tconsole.warn( 'THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.' );\r\n\t\treturn new LineSegments( new EdgesGeometry( object.geometry ), new LineBasicMaterial( { color: hex !== undefined ? hex : 0xffffff } ) );\r\n\r\n\t}\r\n\r\n\tGridHelper.prototype.setColors = function () {\r\n\r\n\t\tconsole.error( 'THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.' );\r\n\r\n\t};\r\n\r\n\tSkeletonHelper.prototype.update = function () {\r\n\r\n\t\tconsole.error( 'THREE.SkeletonHelper: update() no longer needs to be called.' );\r\n\r\n\t};\r\n\r\n\tfunction WireframeHelper( object, hex ) {\r\n\r\n\t\tconsole.warn( 'THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.' );\r\n\t\treturn new LineSegments( new WireframeGeometry( object.geometry ), new LineBasicMaterial( { color: hex !== undefined ? hex : 0xffffff } ) );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tObject.assign( Loader.prototype, {\r\n\r\n\t\textractUrlBase: function ( url ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.' );\r\n\t\t\treturn LoaderUtils.extractUrlBase( url );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tLoader.Handlers = {\r\n\r\n\t\tadd: function ( /* regex, loader */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.' );\r\n\r\n\t\t},\r\n\r\n\t\tget: function ( /* file */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.' );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction XHRLoader( manager ) {\r\n\r\n\t\tconsole.warn( 'THREE.XHRLoader has been renamed to THREE.FileLoader.' );\r\n\t\treturn new FileLoader( manager );\r\n\r\n\t}\r\n\r\n\tfunction BinaryTextureLoader( manager ) {\r\n\r\n\t\tconsole.warn( 'THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.' );\r\n\t\treturn new DataTextureLoader( manager );\r\n\r\n\t}\r\n\r\n\tObject.assign( ObjectLoader.prototype, {\r\n\r\n\t\tsetTexturePath: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().' );\r\n\t\t\treturn this.setResourcePath( value );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.assign( Box2.prototype, {\r\n\r\n\t\tcenter: function ( optionalTarget ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box2: .center() has been renamed to .getCenter().' );\r\n\t\t\treturn this.getCenter( optionalTarget );\r\n\r\n\t\t},\r\n\t\tempty: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box2: .empty() has been renamed to .isEmpty().' );\r\n\t\t\treturn this.isEmpty();\r\n\r\n\t\t},\r\n\t\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\t\treturn this.intersectsBox( box );\r\n\r\n\t\t},\r\n\t\tsize: function ( optionalTarget ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box2: .size() has been renamed to .getSize().' );\r\n\t\t\treturn this.getSize( optionalTarget );\r\n\r\n\t\t}\r\n\t} );\r\n\r\n\tObject.assign( Box3.prototype, {\r\n\r\n\t\tcenter: function ( optionalTarget ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .center() has been renamed to .getCenter().' );\r\n\t\t\treturn this.getCenter( optionalTarget );\r\n\r\n\t\t},\r\n\t\tempty: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .empty() has been renamed to .isEmpty().' );\r\n\t\t\treturn this.isEmpty();\r\n\r\n\t\t},\r\n\t\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\t\treturn this.intersectsBox( box );\r\n\r\n\t\t},\r\n\t\tisIntersectionSphere: function ( sphere ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t},\r\n\t\tsize: function ( optionalTarget ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Box3: .size() has been renamed to .getSize().' );\r\n\t\t\treturn this.getSize( optionalTarget );\r\n\r\n\t\t}\r\n\t} );\r\n\r\n\tFrustum.prototype.setFromMatrix = function ( m ) {\r\n\r\n\t\tconsole.warn( 'THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix().' );\r\n\t\treturn this.setFromProjectionMatrix( m );\r\n\r\n\t};\r\n\r\n\tLine3.prototype.center = function ( optionalTarget ) {\r\n\r\n\t\tconsole.warn( 'THREE.Line3: .center() has been renamed to .getCenter().' );\r\n\t\treturn this.getCenter( optionalTarget );\r\n\r\n\t};\r\n\r\n\tObject.assign( MathUtils, {\r\n\r\n\t\trandom16: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Math: .random16() has been deprecated. Use Math.random() instead.' );\r\n\t\t\treturn Math.random();\r\n\r\n\t\t},\r\n\r\n\t\tnearestPowerOfTwo: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().' );\r\n\t\t\treturn MathUtils.floorPowerOfTwo( value );\r\n\r\n\t\t},\r\n\r\n\t\tnextPowerOfTwo: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().' );\r\n\t\t\treturn MathUtils.ceilPowerOfTwo( value );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Matrix3.prototype, {\r\n\r\n\t\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\t\tconsole.warn( \"THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\" );\r\n\t\t\treturn this.toArray( array, offset );\r\n\r\n\t\t},\r\n\t\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix3( this );\r\n\r\n\t\t},\r\n\t\tmultiplyVector3Array: function ( /* a */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix3: .multiplyVector3Array() has been removed.' );\r\n\r\n\t\t},\r\n\t\tapplyToBufferAttribute: function ( attribute ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead.' );\r\n\t\t\treturn attribute.applyMatrix3( this );\r\n\r\n\t\t},\r\n\t\tapplyToVector3Array: function ( /* array, offset, length */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix3: .applyToVector3Array() has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Matrix4.prototype, {\r\n\r\n\t\textractPosition: function ( m ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\r\n\t\t\treturn this.copyPosition( m );\r\n\r\n\t\t},\r\n\t\tflattenToArrayOffset: function ( array, offset ) {\r\n\r\n\t\t\tconsole.warn( \"THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.\" );\r\n\t\t\treturn this.toArray( array, offset );\r\n\r\n\t\t},\r\n\t\tgetPosition: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\r\n\t\t\treturn new Vector3().setFromMatrixColumn( this, 3 );\r\n\r\n\t\t},\r\n\t\tsetRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\r\n\t\t\treturn this.makeRotationFromQuaternion( q );\r\n\r\n\t\t},\r\n\t\tmultiplyToArray: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyToArray() has been removed.' );\r\n\r\n\t\t},\r\n\t\tmultiplyVector3: function ( vector ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\r\n\t\t},\r\n\t\tmultiplyVector4: function ( vector ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\r\n\t\t},\r\n\t\tmultiplyVector3Array: function ( /* a */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .multiplyVector3Array() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateAxis: function ( v ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\r\n\t\t\tv.transformDirection( this );\r\n\r\n\t\t},\r\n\t\tcrossVector: function ( vector ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn vector.applyMatrix4( this );\r\n\r\n\t\t},\r\n\t\ttranslate: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .translate() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateX: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateX() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateY: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateY() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateZ: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\r\n\r\n\t\t},\r\n\t\trotateByAxis: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\r\n\r\n\t\t},\r\n\t\tapplyToBufferAttribute: function ( attribute ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead.' );\r\n\t\t\treturn attribute.applyMatrix4( this );\r\n\r\n\t\t},\r\n\t\tapplyToVector3Array: function ( /* array, offset, length */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.Matrix4: .applyToVector3Array() has been removed.' );\r\n\r\n\t\t},\r\n\t\tmakeFrustum: function ( left, right, bottom, top, near, far ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.' );\r\n\t\t\treturn this.makePerspective( left, right, top, bottom, near, far );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tPlane.prototype.isIntersectionLine = function ( line ) {\r\n\r\n\t\tconsole.warn( 'THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().' );\r\n\t\treturn this.intersectsLine( line );\r\n\r\n\t};\r\n\r\n\tQuaternion.prototype.multiplyVector3 = function ( vector ) {\r\n\r\n\t\tconsole.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\r\n\t\treturn vector.applyQuaternion( this );\r\n\r\n\t};\r\n\r\n\tObject.assign( Ray.prototype, {\r\n\r\n\t\tisIntersectionBox: function ( box ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().' );\r\n\t\t\treturn this.intersectsBox( box );\r\n\r\n\t\t},\r\n\t\tisIntersectionPlane: function ( plane ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().' );\r\n\t\t\treturn this.intersectsPlane( plane );\r\n\r\n\t\t},\r\n\t\tisIntersectionSphere: function ( sphere ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().' );\r\n\t\t\treturn this.intersectsSphere( sphere );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Triangle.prototype, {\r\n\r\n\t\tarea: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .area() has been renamed to .getArea().' );\r\n\t\t\treturn this.getArea();\r\n\r\n\t\t},\r\n\t\tbarycoordFromPoint: function ( point, target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().' );\r\n\t\t\treturn this.getBarycoord( point, target );\r\n\r\n\t\t},\r\n\t\tmidpoint: function ( target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .midpoint() has been renamed to .getMidpoint().' );\r\n\t\t\treturn this.getMidpoint( target );\r\n\r\n\t\t},\r\n\t\tnormal: function ( target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .normal() has been renamed to .getNormal().' );\r\n\t\t\treturn this.getNormal( target );\r\n\r\n\t\t},\r\n\t\tplane: function ( target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .plane() has been renamed to .getPlane().' );\r\n\t\t\treturn this.getPlane( target );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Triangle, {\r\n\r\n\t\tbarycoordFromPoint: function ( point, a, b, c, target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().' );\r\n\t\t\treturn Triangle.getBarycoord( point, a, b, c, target );\r\n\r\n\t\t},\r\n\t\tnormal: function ( a, b, c, target ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Triangle: .normal() has been renamed to .getNormal().' );\r\n\t\t\treturn Triangle.getNormal( a, b, c, target );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Shape.prototype, {\r\n\r\n\t\textractAllPoints: function ( divisions ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.' );\r\n\t\t\treturn this.extractPoints( divisions );\r\n\r\n\t\t},\r\n\t\textrude: function ( options ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.' );\r\n\t\t\treturn new ExtrudeGeometry( this, options );\r\n\r\n\t\t},\r\n\t\tmakeGeometry: function ( options ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.' );\r\n\t\t\treturn new ShapeGeometry( this, options );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Vector2.prototype, {\r\n\r\n\t\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().' );\r\n\t\t\treturn this.fromBufferAttribute( attribute, index, offset );\r\n\r\n\t\t},\r\n\t\tdistanceToManhattan: function ( v ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().' );\r\n\t\t\treturn this.manhattanDistanceTo( v );\r\n\r\n\t\t},\r\n\t\tlengthManhattan: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().' );\r\n\t\t\treturn this.manhattanLength();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Vector3.prototype, {\r\n\r\n\t\tsetEulerFromRotationMatrix: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\r\n\r\n\t\t},\r\n\t\tsetEulerFromQuaternion: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\r\n\r\n\t\t},\r\n\t\tgetPositionFromMatrix: function ( m ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\r\n\t\t\treturn this.setFromMatrixPosition( m );\r\n\r\n\t\t},\r\n\t\tgetScaleFromMatrix: function ( m ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\r\n\t\t\treturn this.setFromMatrixScale( m );\r\n\r\n\t\t},\r\n\t\tgetColumnFromMatrix: function ( index, matrix ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\r\n\t\t\treturn this.setFromMatrixColumn( matrix, index );\r\n\r\n\t\t},\r\n\t\tapplyProjection: function ( m ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.' );\r\n\t\t\treturn this.applyMatrix4( m );\r\n\r\n\t\t},\r\n\t\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().' );\r\n\t\t\treturn this.fromBufferAttribute( attribute, index, offset );\r\n\r\n\t\t},\r\n\t\tdistanceToManhattan: function ( v ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().' );\r\n\t\t\treturn this.manhattanDistanceTo( v );\r\n\r\n\t\t},\r\n\t\tlengthManhattan: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().' );\r\n\t\t\treturn this.manhattanLength();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Vector4.prototype, {\r\n\r\n\t\tfromAttribute: function ( attribute, index, offset ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().' );\r\n\t\t\treturn this.fromBufferAttribute( attribute, index, offset );\r\n\r\n\t\t},\r\n\t\tlengthManhattan: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().' );\r\n\t\t\treturn this.manhattanLength();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.assign( Geometry.prototype, {\r\n\r\n\t\tcomputeTangents: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry: .computeTangents() has been removed.' );\r\n\r\n\t\t},\r\n\t\tcomputeLineDistances: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.' );\r\n\r\n\t\t},\r\n\t\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4().' );\r\n\t\t\treturn this.applyMatrix4( matrix );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Object3D.prototype, {\r\n\r\n\t\tgetChildByName: function ( name ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\r\n\t\t\treturn this.getObjectByName( name );\r\n\r\n\t\t},\r\n\t\trenderDepth: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.' );\r\n\r\n\t\t},\r\n\t\ttranslate: function ( distance, axis ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\r\n\t\t\treturn this.translateOnAxis( axis, distance );\r\n\r\n\t\t},\r\n\t\tgetWorldRotation: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.' );\r\n\r\n\t\t},\r\n\t\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4().' );\r\n\t\t\treturn this.applyMatrix4( matrix );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( Object3D.prototype, {\r\n\r\n\t\teulerOrder: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\t\t\treturn this.rotation.order;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .eulerOrder is now .rotation.order.' );\r\n\t\t\t\tthis.rotation.order = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tuseQuaternion: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( Mesh.prototype, {\r\n\r\n\t\tsetDrawMode: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.' );\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( Mesh.prototype, {\r\n\r\n\t\tdrawMode: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode.' );\r\n\t\t\t\treturn TrianglesDrawMode;\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.error( 'THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( LOD.prototype, {\r\n\r\n\t\tobjects: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.LOD: .objects has been renamed to .levels.' );\r\n\t\t\t\treturn this.levels;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperty( Skeleton.prototype, 'useVertexTexture', {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Skeleton: useVertexTexture has been removed.' );\r\n\r\n\t\t},\r\n\t\tset: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Skeleton: useVertexTexture has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tSkinnedMesh.prototype.initBones = function () {\r\n\r\n\t\tconsole.error( 'THREE.SkinnedMesh: initBones() has been removed.' );\r\n\r\n\t};\r\n\r\n\tObject.defineProperty( Curve.prototype, '__arcLengthDivisions', {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.' );\r\n\t\t\treturn this.arcLengthDivisions;\r\n\r\n\t\t},\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.' );\r\n\t\t\tthis.arcLengthDivisions = value;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tPerspectiveCamera.prototype.setLens = function ( focalLength, filmGauge ) {\r\n\r\n\t\tconsole.warn( \"THREE.PerspectiveCamera.setLens is deprecated. \" +\r\n\t\t\t\t\"Use .setFocalLength and .filmGauge for a photographic setup.\" );\r\n\r\n\t\tif ( filmGauge !== undefined ) { this.filmGauge = filmGauge; }\r\n\t\tthis.setFocalLength( focalLength );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( Light.prototype, {\r\n\t\tonlyShadow: {\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .onlyShadow has been removed.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraFov: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFov is now .shadow.camera.fov.' );\r\n\t\t\t\tthis.shadow.camera.fov = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraLeft: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraLeft is now .shadow.camera.left.' );\r\n\t\t\t\tthis.shadow.camera.left = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraRight: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraRight is now .shadow.camera.right.' );\r\n\t\t\t\tthis.shadow.camera.right = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraTop: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraTop is now .shadow.camera.top.' );\r\n\t\t\t\tthis.shadow.camera.top = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraBottom: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.' );\r\n\t\t\t\tthis.shadow.camera.bottom = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraNear: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraNear is now .shadow.camera.near.' );\r\n\t\t\t\tthis.shadow.camera.near = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraFar: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraFar is now .shadow.camera.far.' );\r\n\t\t\t\tthis.shadow.camera.far = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowCameraVisible: {\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowBias: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowBias is now .shadow.bias.' );\r\n\t\t\t\tthis.shadow.bias = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowDarkness: {\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowDarkness has been removed.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapWidth: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.' );\r\n\t\t\t\tthis.shadow.mapSize.width = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapHeight: {\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.' );\r\n\t\t\t\tthis.shadow.mapSize.height = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( BufferAttribute.prototype, {\r\n\r\n\t\tlength: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Use .count instead.' );\r\n\t\t\t\treturn this.array.length;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tdynamic: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.' );\r\n\t\t\t\treturn this.usage === DynamicDrawUsage;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( /* value */ ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead.' );\r\n\t\t\t\tthis.setUsage( DynamicDrawUsage );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( BufferAttribute.prototype, {\r\n\t\tsetDynamic: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead.' );\r\n\t\t\tthis.setUsage( value === true ? DynamicDrawUsage : StaticDrawUsage );\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\t\tcopyIndicesArray: function ( /* indices */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.BufferAttribute: .copyIndicesArray() has been removed.' );\r\n\r\n\t\t},\r\n\t\tsetArray: function ( /* array */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers' );\r\n\r\n\t\t}\r\n\t} );\r\n\r\n\tObject.assign( BufferGeometry.prototype, {\r\n\r\n\t\taddIndex: function ( index ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().' );\r\n\t\t\tthis.setIndex( index );\r\n\r\n\t\t},\r\n\t\taddAttribute: function ( name, attribute ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute().' );\r\n\r\n\t\t\tif ( ! ( attribute && attribute.isBufferAttribute ) && ! ( attribute && attribute.isInterleavedBufferAttribute ) ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\r\n\r\n\t\t\t\treturn this.setAttribute( name, new BufferAttribute( arguments[ 1 ], arguments[ 2 ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( name === 'index' ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.' );\r\n\t\t\t\tthis.setIndex( attribute );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.setAttribute( name, attribute );\r\n\r\n\t\t},\r\n\t\taddDrawCall: function ( start, count, indexOffset ) {\r\n\r\n\t\t\tif ( indexOffset !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.' );\r\n\r\n\t\t\t}\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() is now .addGroup().' );\r\n\t\t\tthis.addGroup( start, count );\r\n\r\n\t\t},\r\n\t\tclearDrawCalls: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().' );\r\n\t\t\tthis.clearGroups();\r\n\r\n\t\t},\r\n\t\tcomputeTangents: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeTangents() has been removed.' );\r\n\r\n\t\t},\r\n\t\tcomputeOffsets: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .computeOffsets() has been removed.' );\r\n\r\n\t\t},\r\n\t\tremoveAttribute: function ( name ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute().' );\r\n\r\n\t\t\treturn this.deleteAttribute( name );\r\n\r\n\t\t},\r\n\t\tapplyMatrix: function ( matrix ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4().' );\r\n\t\t\treturn this.applyMatrix4( matrix );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( BufferGeometry.prototype, {\r\n\r\n\t\tdrawcalls: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.error( 'THREE.BufferGeometry: .drawcalls has been renamed to .groups.' );\r\n\t\t\t\treturn this.groups;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\toffsets: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: .offsets has been renamed to .groups.' );\r\n\t\t\t\treturn this.groups;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( Raycaster.prototype, {\r\n\r\n\t\tlinePrecision: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead.' );\r\n\t\t\t\treturn this.params.Line.threshold;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead.' );\r\n\t\t\t\tthis.params.Line.threshold = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( InterleavedBuffer.prototype, {\r\n\r\n\t\tdynamic: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead.' );\r\n\t\t\t\treturn this.usage === DynamicDrawUsage;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead.' );\r\n\t\t\t\tthis.setUsage( value );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.assign( InterleavedBuffer.prototype, {\r\n\t\tsetDynamic: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead.' );\r\n\t\t\tthis.setUsage( value === true ? DynamicDrawUsage : StaticDrawUsage );\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\t\tsetArray: function ( /* array */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers' );\r\n\r\n\t\t}\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.assign( ExtrudeBufferGeometry.prototype, {\r\n\r\n\t\tgetArrays: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.ExtrudeBufferGeometry: .getArrays() has been removed.' );\r\n\r\n\t\t},\r\n\r\n\t\taddShapeList: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.' );\r\n\r\n\t\t},\r\n\r\n\t\taddShape: function () {\r\n\r\n\t\t\tconsole.error( 'THREE.ExtrudeBufferGeometry: .addShape() has been removed.' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( Uniform.prototype, {\r\n\r\n\t\tdynamic: {\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tonUpdate: {\r\n\t\t\tvalue: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.' );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( Material.prototype, {\r\n\r\n\t\twrapAround: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Material: .wrapAround has been removed.' );\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Material: .wrapAround has been removed.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\toverdraw: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Material: .overdraw has been removed.' );\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Material: .overdraw has been removed.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\twrapRGB: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Material: .wrapRGB has been removed.' );\r\n\t\t\t\treturn new Color();\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tshading: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.error( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .shading has been removed. Use the boolean .flatShading instead.' );\r\n\t\t\t\tthis.flatShading = ( value === FlatShading );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tstencilMask: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .stencilMask has been removed. Use .stencilFuncMask instead.' );\r\n\t\t\t\treturn this.stencilFuncMask;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.' + this.type + ': .stencilMask has been removed. Use .stencilFuncMask instead.' );\r\n\t\t\t\tthis.stencilFuncMask = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( MeshPhongMaterial.prototype, {\r\n\r\n\t\tmetal: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.' );\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( ShaderMaterial.prototype, {\r\n\r\n\t\tderivatives: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\r\n\t\t\t\treturn this.extensions.derivatives;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.' );\r\n\t\t\t\tthis.extensions.derivatives = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.assign( WebGLRenderer.prototype, {\r\n\r\n\t\tclearTarget: function ( renderTarget, color, depth, stencil ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.' );\r\n\t\t\tthis.setRenderTarget( renderTarget );\r\n\t\t\tthis.clear( color, depth, stencil );\r\n\r\n\t\t},\r\n\t\tanimate: function ( callback ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .animate() is now .setAnimationLoop().' );\r\n\t\t\tthis.setAnimationLoop( callback );\r\n\r\n\t\t},\r\n\t\tgetCurrentRenderTarget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().' );\r\n\t\t\treturn this.getRenderTarget();\r\n\r\n\t\t},\r\n\t\tgetMaxAnisotropy: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().' );\r\n\t\t\treturn this.capabilities.getMaxAnisotropy();\r\n\r\n\t\t},\r\n\t\tgetPrecision: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.' );\r\n\t\t\treturn this.capabilities.precision;\r\n\r\n\t\t},\r\n\t\tresetGLState: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .resetGLState() is now .state.reset().' );\r\n\t\t\treturn this.state.reset();\r\n\r\n\t\t},\r\n\t\tsupportsFloatTextures: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).' );\r\n\t\t\treturn this.extensions.get( 'OES_texture_float' );\r\n\r\n\t\t},\r\n\t\tsupportsHalfFloatTextures: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).' );\r\n\t\t\treturn this.extensions.get( 'OES_texture_half_float' );\r\n\r\n\t\t},\r\n\t\tsupportsStandardDerivatives: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).' );\r\n\t\t\treturn this.extensions.get( 'OES_standard_derivatives' );\r\n\r\n\t\t},\r\n\t\tsupportsCompressedTextureS3TC: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).' );\r\n\t\t\treturn this.extensions.get( 'WEBGL_compressed_texture_s3tc' );\r\n\r\n\t\t},\r\n\t\tsupportsCompressedTexturePVRTC: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).' );\r\n\t\t\treturn this.extensions.get( 'WEBGL_compressed_texture_pvrtc' );\r\n\r\n\t\t},\r\n\t\tsupportsBlendMinMax: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).' );\r\n\t\t\treturn this.extensions.get( 'EXT_blend_minmax' );\r\n\r\n\t\t},\r\n\t\tsupportsVertexTextures: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.' );\r\n\t\t\treturn this.capabilities.vertexTextures;\r\n\r\n\t\t},\r\n\t\tsupportsInstancedArrays: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).' );\r\n\t\t\treturn this.extensions.get( 'ANGLE_instanced_arrays' );\r\n\r\n\t\t},\r\n\t\tenableScissorTest: function ( boolean ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().' );\r\n\t\t\tthis.setScissorTest( boolean );\r\n\r\n\t\t},\r\n\t\tinitMaterial: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\r\n\r\n\t\t},\r\n\t\taddPrePlugin: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\r\n\r\n\t\t},\r\n\t\taddPostPlugin: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\r\n\r\n\t\t},\r\n\t\tupdateShadowMap: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\r\n\r\n\t\t},\r\n\t\tsetFaceCulling: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .setFaceCulling() has been removed.' );\r\n\r\n\t\t},\r\n\t\tallocTextureUnit: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .allocTextureUnit() has been removed.' );\r\n\r\n\t\t},\r\n\t\tsetTexture: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .setTexture() has been removed.' );\r\n\r\n\t\t},\r\n\t\tsetTexture2D: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .setTexture2D() has been removed.' );\r\n\r\n\t\t},\r\n\t\tsetTextureCube: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .setTextureCube() has been removed.' );\r\n\r\n\t\t},\r\n\t\tgetActiveMipMapLevel: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel().' );\r\n\t\t\treturn this.getActiveMipmapLevel();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( WebGLRenderer.prototype, {\r\n\r\n\t\tshadowMapEnabled: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.shadowMap.enabled;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.' );\r\n\t\t\t\tthis.shadowMap.enabled = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapType: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn this.shadowMap.type;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.' );\r\n\t\t\t\tthis.shadowMap.type = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tshadowMapCullFace: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.' );\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( /* value */ ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tcontext: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .context has been removed. Use .getContext() instead.' );\r\n\t\t\t\treturn this.getContext();\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tvr: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .vr has been renamed to .xr' );\r\n\t\t\t\treturn this.xr;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tgammaInput: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.' );\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tgammaOutput: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.' );\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead.' );\r\n\t\t\t\tthis.outputEncoding = ( value === true ) ? sRGBEncoding : LinearEncoding;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tObject.defineProperties( WebGLShadowMap.prototype, {\r\n\r\n\t\tcullFace: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.' );\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( /* cullFace */ ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\trenderReverseSided: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.' );\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.' );\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\trenderSingleSided: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.' );\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction WebGLRenderTargetCube( width, height, options ) {\r\n\r\n\t\tconsole.warn( 'THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options ).' );\r\n\t\treturn new WebGLCubeRenderTarget( width, options );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( WebGLRenderTarget.prototype, {\r\n\r\n\t\twrapS: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\t\t\treturn this.texture.wrapS;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.' );\r\n\t\t\t\tthis.texture.wrapS = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\twrapT: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\t\t\treturn this.texture.wrapT;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.' );\r\n\t\t\t\tthis.texture.wrapT = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tmagFilter: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\t\t\treturn this.texture.magFilter;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.' );\r\n\t\t\t\tthis.texture.magFilter = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tminFilter: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\t\t\treturn this.texture.minFilter;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.' );\r\n\t\t\t\tthis.texture.minFilter = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tanisotropy: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\t\t\treturn this.texture.anisotropy;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.' );\r\n\t\t\t\tthis.texture.anisotropy = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\toffset: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\t\t\treturn this.texture.offset;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .offset is now .texture.offset.' );\r\n\t\t\t\tthis.texture.offset = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\trepeat: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\t\t\treturn this.texture.repeat;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .repeat is now .texture.repeat.' );\r\n\t\t\t\tthis.texture.repeat = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tformat: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\t\t\treturn this.texture.format;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .format is now .texture.format.' );\r\n\t\t\t\tthis.texture.format = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\ttype: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\t\t\treturn this.texture.type;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .type is now .texture.type.' );\r\n\t\t\t\tthis.texture.type = value;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tgenerateMipmaps: {\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\t\t\treturn this.texture.generateMipmaps;\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.' );\r\n\t\t\t\tthis.texture.generateMipmaps = value;\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t//\r\n\r\n\tObject.defineProperties( Audio.prototype, {\r\n\r\n\t\tload: {\r\n\t\t\tvalue: function ( file ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.' );\r\n\t\t\t\tvar scope = this;\r\n\t\t\t\tvar audioLoader = new AudioLoader();\r\n\t\t\t\taudioLoader.load( file, function ( buffer ) {\r\n\r\n\t\t\t\t\tscope.setBuffer( buffer );\r\n\r\n\t\t\t\t} );\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tstartTime: {\r\n\t\t\tset: function () {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Audio: .startTime is now .play( delay ).' );\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tAudioAnalyser.prototype.getData = function () {\r\n\r\n\t\tconsole.warn( 'THREE.AudioAnalyser: .getData() is now .getFrequencyData().' );\r\n\t\treturn this.getFrequencyData();\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tCubeCamera.prototype.updateCubeMap = function ( renderer, scene ) {\r\n\r\n\t\tconsole.warn( 'THREE.CubeCamera: .updateCubeMap() is now .update().' );\r\n\t\treturn this.update( renderer, scene );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tvar GeometryUtils = {\r\n\r\n\t\tmerge: function ( geometry1, geometry2, materialIndexOffset ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.' );\r\n\t\t\tvar matrix;\r\n\r\n\t\t\tif ( geometry2.isMesh ) {\r\n\r\n\t\t\t\tgeometry2.matrixAutoUpdate && geometry2.updateMatrix();\r\n\r\n\t\t\t\tmatrix = geometry2.matrix;\r\n\t\t\t\tgeometry2 = geometry2.geometry;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry1.merge( geometry2, matrix, materialIndexOffset );\r\n\r\n\t\t},\r\n\r\n\t\tcenter: function ( geometry ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.' );\r\n\t\t\treturn geometry.center();\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tImageUtils.crossOrigin = undefined;\r\n\r\n\tImageUtils.loadTexture = function ( url, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.' );\r\n\r\n\t\tvar loader = new TextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( url, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) { texture.mapping = mapping; }\r\n\r\n\t\treturn texture;\r\n\r\n\t};\r\n\r\n\tImageUtils.loadTextureCube = function ( urls, mapping, onLoad, onError ) {\r\n\r\n\t\tconsole.warn( 'THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.' );\r\n\r\n\t\tvar loader = new CubeTextureLoader();\r\n\t\tloader.setCrossOrigin( this.crossOrigin );\r\n\r\n\t\tvar texture = loader.load( urls, onLoad, undefined, onError );\r\n\r\n\t\tif ( mapping ) { texture.mapping = mapping; }\r\n\r\n\t\treturn texture;\r\n\r\n\t};\r\n\r\n\tImageUtils.loadCompressedTexture = function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' );\r\n\r\n\t};\r\n\r\n\tImageUtils.loadCompressedTextureCube = function () {\r\n\r\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tfunction CanvasRenderer() {\r\n\r\n\t\tconsole.error( 'THREE.CanvasRenderer has been removed' );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction JSONLoader() {\r\n\r\n\t\tconsole.error( 'THREE.JSONLoader has been removed.' );\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar SceneUtils = {\r\n\r\n\t\tcreateMultiMaterialObject: function ( /* geometry, materials */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js' );\r\n\r\n\t\t},\r\n\r\n\t\tdetach: function ( /* child, parent, scene */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js' );\r\n\r\n\t\t},\r\n\r\n\t\tattach: function ( /* child, scene, parent */ ) {\r\n\r\n\t\t\tconsole.error( 'THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js' );\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tfunction LensFlare() {\r\n\r\n\t\tconsole.error( 'THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js' );\r\n\r\n\t}\r\n\r\n\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\r\n\r\n\t\t/* eslint-disable no-undef */\r\n\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'register', { detail: {\r\n\t\t\trevision: REVISION,\r\n\t\t} } ) );\r\n\t\t/* eslint-enable no-undef */\r\n\r\n\t}\r\n\r\n\texports.ACESFilmicToneMapping = ACESFilmicToneMapping;\r\n\texports.AddEquation = AddEquation;\r\n\texports.AddOperation = AddOperation;\r\n\texports.AdditiveBlending = AdditiveBlending;\r\n\texports.AlphaFormat = AlphaFormat;\r\n\texports.AlwaysDepth = AlwaysDepth;\r\n\texports.AlwaysStencilFunc = AlwaysStencilFunc;\r\n\texports.AmbientLight = AmbientLight;\r\n\texports.AmbientLightProbe = AmbientLightProbe;\r\n\texports.AnimationClip = AnimationClip;\r\n\texports.AnimationLoader = AnimationLoader;\r\n\texports.AnimationMixer = AnimationMixer;\r\n\texports.AnimationObjectGroup = AnimationObjectGroup;\r\n\texports.AnimationUtils = AnimationUtils;\r\n\texports.ArcCurve = ArcCurve;\r\n\texports.ArrayCamera = ArrayCamera;\r\n\texports.ArrowHelper = ArrowHelper;\r\n\texports.Audio = Audio;\r\n\texports.AudioAnalyser = AudioAnalyser;\r\n\texports.AudioContext = AudioContext;\r\n\texports.AudioListener = AudioListener;\r\n\texports.AudioLoader = AudioLoader;\r\n\texports.AxesHelper = AxesHelper;\r\n\texports.AxisHelper = AxisHelper;\r\n\texports.BackSide = BackSide;\r\n\texports.BasicDepthPacking = BasicDepthPacking;\r\n\texports.BasicShadowMap = BasicShadowMap;\r\n\texports.BinaryTextureLoader = BinaryTextureLoader;\r\n\texports.Bone = Bone;\r\n\texports.BooleanKeyframeTrack = BooleanKeyframeTrack;\r\n\texports.BoundingBoxHelper = BoundingBoxHelper;\r\n\texports.Box2 = Box2;\r\n\texports.Box3 = Box3;\r\n\texports.Box3Helper = Box3Helper;\r\n\texports.BoxBufferGeometry = BoxBufferGeometry;\r\n\texports.BoxGeometry = BoxGeometry;\r\n\texports.BoxHelper = BoxHelper;\r\n\texports.BufferAttribute = BufferAttribute;\r\n\texports.BufferGeometry = BufferGeometry;\r\n\texports.BufferGeometryLoader = BufferGeometryLoader;\r\n\texports.ByteType = ByteType;\r\n\texports.Cache = Cache;\r\n\texports.Camera = Camera;\r\n\texports.CameraHelper = CameraHelper;\r\n\texports.CanvasRenderer = CanvasRenderer;\r\n\texports.CanvasTexture = CanvasTexture;\r\n\texports.CatmullRomCurve3 = CatmullRomCurve3;\r\n\texports.CineonToneMapping = CineonToneMapping;\r\n\texports.CircleBufferGeometry = CircleBufferGeometry;\r\n\texports.CircleGeometry = CircleGeometry;\r\n\texports.ClampToEdgeWrapping = ClampToEdgeWrapping;\r\n\texports.Clock = Clock;\r\n\texports.ClosedSplineCurve3 = ClosedSplineCurve3;\r\n\texports.Color = Color;\r\n\texports.ColorKeyframeTrack = ColorKeyframeTrack;\r\n\texports.CompressedTexture = CompressedTexture;\r\n\texports.CompressedTextureLoader = CompressedTextureLoader;\r\n\texports.ConeBufferGeometry = ConeBufferGeometry;\r\n\texports.ConeGeometry = ConeGeometry;\r\n\texports.CubeCamera = CubeCamera;\r\n\texports.CubeGeometry = BoxGeometry;\r\n\texports.CubeReflectionMapping = CubeReflectionMapping;\r\n\texports.CubeRefractionMapping = CubeRefractionMapping;\r\n\texports.CubeTexture = CubeTexture;\r\n\texports.CubeTextureLoader = CubeTextureLoader;\r\n\texports.CubeUVReflectionMapping = CubeUVReflectionMapping;\r\n\texports.CubeUVRefractionMapping = CubeUVRefractionMapping;\r\n\texports.CubicBezierCurve = CubicBezierCurve;\r\n\texports.CubicBezierCurve3 = CubicBezierCurve3;\r\n\texports.CubicInterpolant = CubicInterpolant;\r\n\texports.CullFaceBack = CullFaceBack;\r\n\texports.CullFaceFront = CullFaceFront;\r\n\texports.CullFaceFrontBack = CullFaceFrontBack;\r\n\texports.CullFaceNone = CullFaceNone;\r\n\texports.Curve = Curve;\r\n\texports.CurvePath = CurvePath;\r\n\texports.CustomBlending = CustomBlending;\r\n\texports.CylinderBufferGeometry = CylinderBufferGeometry;\r\n\texports.CylinderGeometry = CylinderGeometry;\r\n\texports.Cylindrical = Cylindrical;\r\n\texports.DataTexture = DataTexture;\r\n\texports.DataTexture2DArray = DataTexture2DArray;\r\n\texports.DataTexture3D = DataTexture3D;\r\n\texports.DataTextureLoader = DataTextureLoader;\r\n\texports.DecrementStencilOp = DecrementStencilOp;\r\n\texports.DecrementWrapStencilOp = DecrementWrapStencilOp;\r\n\texports.DefaultLoadingManager = DefaultLoadingManager;\r\n\texports.DepthFormat = DepthFormat;\r\n\texports.DepthStencilFormat = DepthStencilFormat;\r\n\texports.DepthTexture = DepthTexture;\r\n\texports.DirectionalLight = DirectionalLight;\r\n\texports.DirectionalLightHelper = DirectionalLightHelper;\r\n\texports.DirectionalLightShadow = DirectionalLightShadow;\r\n\texports.DiscreteInterpolant = DiscreteInterpolant;\r\n\texports.DodecahedronBufferGeometry = DodecahedronBufferGeometry;\r\n\texports.DodecahedronGeometry = DodecahedronGeometry;\r\n\texports.DoubleSide = DoubleSide;\r\n\texports.DstAlphaFactor = DstAlphaFactor;\r\n\texports.DstColorFactor = DstColorFactor;\r\n\texports.DynamicBufferAttribute = DynamicBufferAttribute;\r\n\texports.DynamicCopyUsage = DynamicCopyUsage;\r\n\texports.DynamicDrawUsage = DynamicDrawUsage;\r\n\texports.DynamicReadUsage = DynamicReadUsage;\r\n\texports.EdgesGeometry = EdgesGeometry;\r\n\texports.EdgesHelper = EdgesHelper;\r\n\texports.EllipseCurve = EllipseCurve;\r\n\texports.EqualDepth = EqualDepth;\r\n\texports.EqualStencilFunc = EqualStencilFunc;\r\n\texports.EquirectangularReflectionMapping = EquirectangularReflectionMapping;\r\n\texports.EquirectangularRefractionMapping = EquirectangularRefractionMapping;\r\n\texports.Euler = Euler;\r\n\texports.EventDispatcher = EventDispatcher;\r\n\texports.ExtrudeBufferGeometry = ExtrudeBufferGeometry;\r\n\texports.ExtrudeGeometry = ExtrudeGeometry;\r\n\texports.Face3 = Face3;\r\n\texports.Face4 = Face4;\r\n\texports.FaceColors = FaceColors;\r\n\texports.FileLoader = FileLoader;\r\n\texports.FlatShading = FlatShading;\r\n\texports.Float32Attribute = Float32Attribute;\r\n\texports.Float32BufferAttribute = Float32BufferAttribute;\r\n\texports.Float64Attribute = Float64Attribute;\r\n\texports.Float64BufferAttribute = Float64BufferAttribute;\r\n\texports.FloatType = FloatType;\r\n\texports.Fog = Fog;\r\n\texports.FogExp2 = FogExp2;\r\n\texports.Font = Font;\r\n\texports.FontLoader = FontLoader;\r\n\texports.FrontFaceDirectionCCW = FrontFaceDirectionCCW;\r\n\texports.FrontFaceDirectionCW = FrontFaceDirectionCW;\r\n\texports.FrontSide = FrontSide;\r\n\texports.Frustum = Frustum;\r\n\texports.GammaEncoding = GammaEncoding;\r\n\texports.Geometry = Geometry;\r\n\texports.GeometryUtils = GeometryUtils;\r\n\texports.GreaterDepth = GreaterDepth;\r\n\texports.GreaterEqualDepth = GreaterEqualDepth;\r\n\texports.GreaterEqualStencilFunc = GreaterEqualStencilFunc;\r\n\texports.GreaterStencilFunc = GreaterStencilFunc;\r\n\texports.GridHelper = GridHelper;\r\n\texports.Group = Group;\r\n\texports.HalfFloatType = HalfFloatType;\r\n\texports.HemisphereLight = HemisphereLight;\r\n\texports.HemisphereLightHelper = HemisphereLightHelper;\r\n\texports.HemisphereLightProbe = HemisphereLightProbe;\r\n\texports.IcosahedronBufferGeometry = IcosahedronBufferGeometry;\r\n\texports.IcosahedronGeometry = IcosahedronGeometry;\r\n\texports.ImageBitmapLoader = ImageBitmapLoader;\r\n\texports.ImageLoader = ImageLoader;\r\n\texports.ImageUtils = ImageUtils;\r\n\texports.ImmediateRenderObject = ImmediateRenderObject;\r\n\texports.IncrementStencilOp = IncrementStencilOp;\r\n\texports.IncrementWrapStencilOp = IncrementWrapStencilOp;\r\n\texports.InstancedBufferAttribute = InstancedBufferAttribute;\r\n\texports.InstancedBufferGeometry = InstancedBufferGeometry;\r\n\texports.InstancedInterleavedBuffer = InstancedInterleavedBuffer;\r\n\texports.InstancedMesh = InstancedMesh;\r\n\texports.Int16Attribute = Int16Attribute;\r\n\texports.Int16BufferAttribute = Int16BufferAttribute;\r\n\texports.Int32Attribute = Int32Attribute;\r\n\texports.Int32BufferAttribute = Int32BufferAttribute;\r\n\texports.Int8Attribute = Int8Attribute;\r\n\texports.Int8BufferAttribute = Int8BufferAttribute;\r\n\texports.IntType = IntType;\r\n\texports.InterleavedBuffer = InterleavedBuffer;\r\n\texports.InterleavedBufferAttribute = InterleavedBufferAttribute;\r\n\texports.Interpolant = Interpolant;\r\n\texports.InterpolateDiscrete = InterpolateDiscrete;\r\n\texports.InterpolateLinear = InterpolateLinear;\r\n\texports.InterpolateSmooth = InterpolateSmooth;\r\n\texports.InvertStencilOp = InvertStencilOp;\r\n\texports.JSONLoader = JSONLoader;\r\n\texports.KeepStencilOp = KeepStencilOp;\r\n\texports.KeyframeTrack = KeyframeTrack;\r\n\texports.LOD = LOD;\r\n\texports.LatheBufferGeometry = LatheBufferGeometry;\r\n\texports.LatheGeometry = LatheGeometry;\r\n\texports.Layers = Layers;\r\n\texports.LensFlare = LensFlare;\r\n\texports.LessDepth = LessDepth;\r\n\texports.LessEqualDepth = LessEqualDepth;\r\n\texports.LessEqualStencilFunc = LessEqualStencilFunc;\r\n\texports.LessStencilFunc = LessStencilFunc;\r\n\texports.Light = Light;\r\n\texports.LightProbe = LightProbe;\r\n\texports.LightShadow = LightShadow;\r\n\texports.Line = Line;\r\n\texports.Line3 = Line3;\r\n\texports.LineBasicMaterial = LineBasicMaterial;\r\n\texports.LineCurve = LineCurve;\r\n\texports.LineCurve3 = LineCurve3;\r\n\texports.LineDashedMaterial = LineDashedMaterial;\r\n\texports.LineLoop = LineLoop;\r\n\texports.LinePieces = LinePieces;\r\n\texports.LineSegments = LineSegments;\r\n\texports.LineStrip = LineStrip;\r\n\texports.LinearEncoding = LinearEncoding;\r\n\texports.LinearFilter = LinearFilter;\r\n\texports.LinearInterpolant = LinearInterpolant;\r\n\texports.LinearMipMapLinearFilter = LinearMipMapLinearFilter;\r\n\texports.LinearMipMapNearestFilter = LinearMipMapNearestFilter;\r\n\texports.LinearMipmapLinearFilter = LinearMipmapLinearFilter;\r\n\texports.LinearMipmapNearestFilter = LinearMipmapNearestFilter;\r\n\texports.LinearToneMapping = LinearToneMapping;\r\n\texports.Loader = Loader;\r\n\texports.LoaderUtils = LoaderUtils;\r\n\texports.LoadingManager = LoadingManager;\r\n\texports.LogLuvEncoding = LogLuvEncoding;\r\n\texports.LoopOnce = LoopOnce;\r\n\texports.LoopPingPong = LoopPingPong;\r\n\texports.LoopRepeat = LoopRepeat;\r\n\texports.LuminanceAlphaFormat = LuminanceAlphaFormat;\r\n\texports.LuminanceFormat = LuminanceFormat;\r\n\texports.MOUSE = MOUSE;\r\n\texports.Material = Material;\r\n\texports.MaterialLoader = MaterialLoader;\r\n\texports.Math = MathUtils;\r\n\texports.MathUtils = MathUtils;\r\n\texports.Matrix3 = Matrix3;\r\n\texports.Matrix4 = Matrix4;\r\n\texports.MaxEquation = MaxEquation;\r\n\texports.Mesh = Mesh;\r\n\texports.MeshBasicMaterial = MeshBasicMaterial;\r\n\texports.MeshDepthMaterial = MeshDepthMaterial;\r\n\texports.MeshDistanceMaterial = MeshDistanceMaterial;\r\n\texports.MeshFaceMaterial = MeshFaceMaterial;\r\n\texports.MeshLambertMaterial = MeshLambertMaterial;\r\n\texports.MeshMatcapMaterial = MeshMatcapMaterial;\r\n\texports.MeshNormalMaterial = MeshNormalMaterial;\r\n\texports.MeshPhongMaterial = MeshPhongMaterial;\r\n\texports.MeshPhysicalMaterial = MeshPhysicalMaterial;\r\n\texports.MeshStandardMaterial = MeshStandardMaterial;\r\n\texports.MeshToonMaterial = MeshToonMaterial;\r\n\texports.MinEquation = MinEquation;\r\n\texports.MirroredRepeatWrapping = MirroredRepeatWrapping;\r\n\texports.MixOperation = MixOperation;\r\n\texports.MultiMaterial = MultiMaterial;\r\n\texports.MultiplyBlending = MultiplyBlending;\r\n\texports.MultiplyOperation = MultiplyOperation;\r\n\texports.NearestFilter = NearestFilter;\r\n\texports.NearestMipMapLinearFilter = NearestMipMapLinearFilter;\r\n\texports.NearestMipMapNearestFilter = NearestMipMapNearestFilter;\r\n\texports.NearestMipmapLinearFilter = NearestMipmapLinearFilter;\r\n\texports.NearestMipmapNearestFilter = NearestMipmapNearestFilter;\r\n\texports.NeverDepth = NeverDepth;\r\n\texports.NeverStencilFunc = NeverStencilFunc;\r\n\texports.NoBlending = NoBlending;\r\n\texports.NoColors = NoColors;\r\n\texports.NoToneMapping = NoToneMapping;\r\n\texports.NormalBlending = NormalBlending;\r\n\texports.NotEqualDepth = NotEqualDepth;\r\n\texports.NotEqualStencilFunc = NotEqualStencilFunc;\r\n\texports.NumberKeyframeTrack = NumberKeyframeTrack;\r\n\texports.Object3D = Object3D;\r\n\texports.ObjectLoader = ObjectLoader;\r\n\texports.ObjectSpaceNormalMap = ObjectSpaceNormalMap;\r\n\texports.OctahedronBufferGeometry = OctahedronBufferGeometry;\r\n\texports.OctahedronGeometry = OctahedronGeometry;\r\n\texports.OneFactor = OneFactor;\r\n\texports.OneMinusDstAlphaFactor = OneMinusDstAlphaFactor;\r\n\texports.OneMinusDstColorFactor = OneMinusDstColorFactor;\r\n\texports.OneMinusSrcAlphaFactor = OneMinusSrcAlphaFactor;\r\n\texports.OneMinusSrcColorFactor = OneMinusSrcColorFactor;\r\n\texports.OrthographicCamera = OrthographicCamera;\r\n\texports.PCFShadowMap = PCFShadowMap;\r\n\texports.PCFSoftShadowMap = PCFSoftShadowMap;\r\n\texports.PMREMGenerator = PMREMGenerator;\r\n\texports.ParametricBufferGeometry = ParametricBufferGeometry;\r\n\texports.ParametricGeometry = ParametricGeometry;\r\n\texports.Particle = Particle;\r\n\texports.ParticleBasicMaterial = ParticleBasicMaterial;\r\n\texports.ParticleSystem = ParticleSystem;\r\n\texports.ParticleSystemMaterial = ParticleSystemMaterial;\r\n\texports.Path = Path;\r\n\texports.PerspectiveCamera = PerspectiveCamera;\r\n\texports.Plane = Plane;\r\n\texports.PlaneBufferGeometry = PlaneBufferGeometry;\r\n\texports.PlaneGeometry = PlaneGeometry;\r\n\texports.PlaneHelper = PlaneHelper;\r\n\texports.PointCloud = PointCloud;\r\n\texports.PointCloudMaterial = PointCloudMaterial;\r\n\texports.PointLight = PointLight;\r\n\texports.PointLightHelper = PointLightHelper;\r\n\texports.Points = Points;\r\n\texports.PointsMaterial = PointsMaterial;\r\n\texports.PolarGridHelper = PolarGridHelper;\r\n\texports.PolyhedronBufferGeometry = PolyhedronBufferGeometry;\r\n\texports.PolyhedronGeometry = PolyhedronGeometry;\r\n\texports.PositionalAudio = PositionalAudio;\r\n\texports.PropertyBinding = PropertyBinding;\r\n\texports.PropertyMixer = PropertyMixer;\r\n\texports.QuadraticBezierCurve = QuadraticBezierCurve;\r\n\texports.QuadraticBezierCurve3 = QuadraticBezierCurve3;\r\n\texports.Quaternion = Quaternion;\r\n\texports.QuaternionKeyframeTrack = QuaternionKeyframeTrack;\r\n\texports.QuaternionLinearInterpolant = QuaternionLinearInterpolant;\r\n\texports.REVISION = REVISION;\r\n\texports.RGBADepthPacking = RGBADepthPacking;\r\n\texports.RGBAFormat = RGBAFormat;\r\n\texports.RGBAIntegerFormat = RGBAIntegerFormat;\r\n\texports.RGBA_ASTC_10x10_Format = RGBA_ASTC_10x10_Format;\r\n\texports.RGBA_ASTC_10x5_Format = RGBA_ASTC_10x5_Format;\r\n\texports.RGBA_ASTC_10x6_Format = RGBA_ASTC_10x6_Format;\r\n\texports.RGBA_ASTC_10x8_Format = RGBA_ASTC_10x8_Format;\r\n\texports.RGBA_ASTC_12x10_Format = RGBA_ASTC_12x10_Format;\r\n\texports.RGBA_ASTC_12x12_Format = RGBA_ASTC_12x12_Format;\r\n\texports.RGBA_ASTC_4x4_Format = RGBA_ASTC_4x4_Format;\r\n\texports.RGBA_ASTC_5x4_Format = RGBA_ASTC_5x4_Format;\r\n\texports.RGBA_ASTC_5x5_Format = RGBA_ASTC_5x5_Format;\r\n\texports.RGBA_ASTC_6x5_Format = RGBA_ASTC_6x5_Format;\r\n\texports.RGBA_ASTC_6x6_Format = RGBA_ASTC_6x6_Format;\r\n\texports.RGBA_ASTC_8x5_Format = RGBA_ASTC_8x5_Format;\r\n\texports.RGBA_ASTC_8x6_Format = RGBA_ASTC_8x6_Format;\r\n\texports.RGBA_ASTC_8x8_Format = RGBA_ASTC_8x8_Format;\r\n\texports.RGBA_BPTC_Format = RGBA_BPTC_Format;\r\n\texports.RGBA_ETC2_EAC_Format = RGBA_ETC2_EAC_Format;\r\n\texports.RGBA_PVRTC_2BPPV1_Format = RGBA_PVRTC_2BPPV1_Format;\r\n\texports.RGBA_PVRTC_4BPPV1_Format = RGBA_PVRTC_4BPPV1_Format;\r\n\texports.RGBA_S3TC_DXT1_Format = RGBA_S3TC_DXT1_Format;\r\n\texports.RGBA_S3TC_DXT3_Format = RGBA_S3TC_DXT3_Format;\r\n\texports.RGBA_S3TC_DXT5_Format = RGBA_S3TC_DXT5_Format;\r\n\texports.RGBDEncoding = RGBDEncoding;\r\n\texports.RGBEEncoding = RGBEEncoding;\r\n\texports.RGBEFormat = RGBEFormat;\r\n\texports.RGBFormat = RGBFormat;\r\n\texports.RGBIntegerFormat = RGBIntegerFormat;\r\n\texports.RGBM16Encoding = RGBM16Encoding;\r\n\texports.RGBM7Encoding = RGBM7Encoding;\r\n\texports.RGB_ETC1_Format = RGB_ETC1_Format;\r\n\texports.RGB_ETC2_Format = RGB_ETC2_Format;\r\n\texports.RGB_PVRTC_2BPPV1_Format = RGB_PVRTC_2BPPV1_Format;\r\n\texports.RGB_PVRTC_4BPPV1_Format = RGB_PVRTC_4BPPV1_Format;\r\n\texports.RGB_S3TC_DXT1_Format = RGB_S3TC_DXT1_Format;\r\n\texports.RGFormat = RGFormat;\r\n\texports.RGIntegerFormat = RGIntegerFormat;\r\n\texports.RawShaderMaterial = RawShaderMaterial;\r\n\texports.Ray = Ray;\r\n\texports.Raycaster = Raycaster;\r\n\texports.RectAreaLight = RectAreaLight;\r\n\texports.RedFormat = RedFormat;\r\n\texports.RedIntegerFormat = RedIntegerFormat;\r\n\texports.ReinhardToneMapping = ReinhardToneMapping;\r\n\texports.RepeatWrapping = RepeatWrapping;\r\n\texports.ReplaceStencilOp = ReplaceStencilOp;\r\n\texports.ReverseSubtractEquation = ReverseSubtractEquation;\r\n\texports.RingBufferGeometry = RingBufferGeometry;\r\n\texports.RingGeometry = RingGeometry;\r\n\texports.SRGB8_ALPHA8_ASTC_10x10_Format = SRGB8_ALPHA8_ASTC_10x10_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_10x5_Format = SRGB8_ALPHA8_ASTC_10x5_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_10x6_Format = SRGB8_ALPHA8_ASTC_10x6_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_10x8_Format = SRGB8_ALPHA8_ASTC_10x8_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_12x10_Format = SRGB8_ALPHA8_ASTC_12x10_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_12x12_Format = SRGB8_ALPHA8_ASTC_12x12_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_4x4_Format = SRGB8_ALPHA8_ASTC_4x4_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_5x4_Format = SRGB8_ALPHA8_ASTC_5x4_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_5x5_Format = SRGB8_ALPHA8_ASTC_5x5_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_6x5_Format = SRGB8_ALPHA8_ASTC_6x5_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_6x6_Format = SRGB8_ALPHA8_ASTC_6x6_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_8x5_Format = SRGB8_ALPHA8_ASTC_8x5_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_8x6_Format = SRGB8_ALPHA8_ASTC_8x6_Format;\r\n\texports.SRGB8_ALPHA8_ASTC_8x8_Format = SRGB8_ALPHA8_ASTC_8x8_Format;\r\n\texports.Scene = Scene;\r\n\texports.SceneUtils = SceneUtils;\r\n\texports.ShaderChunk = ShaderChunk;\r\n\texports.ShaderLib = ShaderLib;\r\n\texports.ShaderMaterial = ShaderMaterial;\r\n\texports.ShadowMaterial = ShadowMaterial;\r\n\texports.Shape = Shape;\r\n\texports.ShapeBufferGeometry = ShapeBufferGeometry;\r\n\texports.ShapeGeometry = ShapeGeometry;\r\n\texports.ShapePath = ShapePath;\r\n\texports.ShapeUtils = ShapeUtils;\r\n\texports.ShortType = ShortType;\r\n\texports.Skeleton = Skeleton;\r\n\texports.SkeletonHelper = SkeletonHelper;\r\n\texports.SkinnedMesh = SkinnedMesh;\r\n\texports.SmoothShading = SmoothShading;\r\n\texports.Sphere = Sphere;\r\n\texports.SphereBufferGeometry = SphereBufferGeometry;\r\n\texports.SphereGeometry = SphereGeometry;\r\n\texports.Spherical = Spherical;\r\n\texports.SphericalHarmonics3 = SphericalHarmonics3;\r\n\texports.SphericalReflectionMapping = SphericalReflectionMapping;\r\n\texports.Spline = Spline;\r\n\texports.SplineCurve = SplineCurve;\r\n\texports.SplineCurve3 = SplineCurve3;\r\n\texports.SpotLight = SpotLight;\r\n\texports.SpotLightHelper = SpotLightHelper;\r\n\texports.SpotLightShadow = SpotLightShadow;\r\n\texports.Sprite = Sprite;\r\n\texports.SpriteMaterial = SpriteMaterial;\r\n\texports.SrcAlphaFactor = SrcAlphaFactor;\r\n\texports.SrcAlphaSaturateFactor = SrcAlphaSaturateFactor;\r\n\texports.SrcColorFactor = SrcColorFactor;\r\n\texports.StaticCopyUsage = StaticCopyUsage;\r\n\texports.StaticDrawUsage = StaticDrawUsage;\r\n\texports.StaticReadUsage = StaticReadUsage;\r\n\texports.StereoCamera = StereoCamera;\r\n\texports.StreamCopyUsage = StreamCopyUsage;\r\n\texports.StreamDrawUsage = StreamDrawUsage;\r\n\texports.StreamReadUsage = StreamReadUsage;\r\n\texports.StringKeyframeTrack = StringKeyframeTrack;\r\n\texports.SubtractEquation = SubtractEquation;\r\n\texports.SubtractiveBlending = SubtractiveBlending;\r\n\texports.TOUCH = TOUCH;\r\n\texports.TangentSpaceNormalMap = TangentSpaceNormalMap;\r\n\texports.TetrahedronBufferGeometry = TetrahedronBufferGeometry;\r\n\texports.TetrahedronGeometry = TetrahedronGeometry;\r\n\texports.TextBufferGeometry = TextBufferGeometry;\r\n\texports.TextGeometry = TextGeometry;\r\n\texports.Texture = Texture;\r\n\texports.TextureLoader = TextureLoader;\r\n\texports.TorusBufferGeometry = TorusBufferGeometry;\r\n\texports.TorusGeometry = TorusGeometry;\r\n\texports.TorusKnotBufferGeometry = TorusKnotBufferGeometry;\r\n\texports.TorusKnotGeometry = TorusKnotGeometry;\r\n\texports.Triangle = Triangle;\r\n\texports.TriangleFanDrawMode = TriangleFanDrawMode;\r\n\texports.TriangleStripDrawMode = TriangleStripDrawMode;\r\n\texports.TrianglesDrawMode = TrianglesDrawMode;\r\n\texports.TubeBufferGeometry = TubeBufferGeometry;\r\n\texports.TubeGeometry = TubeGeometry;\r\n\texports.UVMapping = UVMapping;\r\n\texports.Uint16Attribute = Uint16Attribute;\r\n\texports.Uint16BufferAttribute = Uint16BufferAttribute;\r\n\texports.Uint32Attribute = Uint32Attribute;\r\n\texports.Uint32BufferAttribute = Uint32BufferAttribute;\r\n\texports.Uint8Attribute = Uint8Attribute;\r\n\texports.Uint8BufferAttribute = Uint8BufferAttribute;\r\n\texports.Uint8ClampedAttribute = Uint8ClampedAttribute;\r\n\texports.Uint8ClampedBufferAttribute = Uint8ClampedBufferAttribute;\r\n\texports.Uncharted2ToneMapping = Uncharted2ToneMapping;\r\n\texports.Uniform = Uniform;\r\n\texports.UniformsLib = UniformsLib;\r\n\texports.UniformsUtils = UniformsUtils;\r\n\texports.UnsignedByteType = UnsignedByteType;\r\n\texports.UnsignedInt248Type = UnsignedInt248Type;\r\n\texports.UnsignedIntType = UnsignedIntType;\r\n\texports.UnsignedShort4444Type = UnsignedShort4444Type;\r\n\texports.UnsignedShort5551Type = UnsignedShort5551Type;\r\n\texports.UnsignedShort565Type = UnsignedShort565Type;\r\n\texports.UnsignedShortType = UnsignedShortType;\r\n\texports.VSMShadowMap = VSMShadowMap;\r\n\texports.Vector2 = Vector2;\r\n\texports.Vector3 = Vector3;\r\n\texports.Vector4 = Vector4;\r\n\texports.VectorKeyframeTrack = VectorKeyframeTrack;\r\n\texports.Vertex = Vertex;\r\n\texports.VertexColors = VertexColors;\r\n\texports.VideoTexture = VideoTexture;\r\n\texports.WebGLCubeRenderTarget = WebGLCubeRenderTarget;\r\n\texports.WebGLMultisampleRenderTarget = WebGLMultisampleRenderTarget;\r\n\texports.WebGLRenderTarget = WebGLRenderTarget;\r\n\texports.WebGLRenderTargetCube = WebGLRenderTargetCube;\r\n\texports.WebGLRenderer = WebGLRenderer;\r\n\texports.WebGLUtils = WebGLUtils;\r\n\texports.WireframeGeometry = WireframeGeometry;\r\n\texports.WireframeHelper = WireframeHelper;\r\n\texports.WrapAroundEnding = WrapAroundEnding;\r\n\texports.XHRLoader = XHRLoader;\r\n\texports.ZeroCurvatureEnding = ZeroCurvatureEnding;\r\n\texports.ZeroFactor = ZeroFactor;\r\n\texports.ZeroSlopeEnding = ZeroSlopeEnding;\r\n\texports.ZeroStencilOp = ZeroStencilOp;\r\n\texports.sRGBEncoding = sRGBEncoding;\r\n\r\n\tObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\n})));"]}